{"version":3,"file":"libfancy.8a5b95844ed281c81eb4.js","sources":["webpack://fancy/./_static/modules/libf/CDNUtils.js","webpack://fancy/./_static/modules/libf/CopyToClipboard.js","webpack://fancy/./_static/modules/libf/DOMHelper.ts","webpack://fancy/./_static/modules/libf/FancyMixin.js","webpack://fancy/./_static/modules/libf/FancyUtils.ts","webpack://fancy/./_static/modules/libf/PopupHelper.js","webpack://fancy/./_static/modules/libf/common-components/AddlistAction.js","webpack://fancy/./_static/modules/libf/common-components/AddlistPopover.js","webpack://fancy/./_static/modules/libf/common-components/History.ts","webpack://fancy/./_static/modules/libf/common-components/MoreShare.js","webpack://fancy/./_static/modules/libf/common-components/MoreShareFacade.js","webpack://fancy/./_static/modules/libf/common-components/MoreShareUtils.js","webpack://fancy/./_static/modules/libf/common-components/Popup.js","webpack://fancy/./_static/modules/libf/common-components/ProductSlide.js","webpack://fancy/./_static/modules/libf/common-components/SharePopover.js","webpack://fancy/./_static/modules/libf/common-components/Video.js","webpack://fancy/./_static/modules/libf/common-components/index.js"],"sourcesContent":["import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nvar CDNUtils = /*#__PURE__*/function () {\n  function CDNUtils() {\n    _classCallCheck(this, CDNUtils);\n\n    _defineProperty(this, \"HOSTS\", {});\n\n    // init hosts\n    this.makeServer('THINGD_MEDIA', 'thingd-media-ec.thefancy.com');\n    this.makeServer('THEFANCY_MEDIA', 'thefancy-media-ec.thefancy.com');\n    this.makeServer('RESIZE_IMAGE', 'resize-ec.thefancy.com');\n    this.makeServer('STATICFILES', 'static-ec.thefancy.com');\n    this.makeServer('FANCY_WEB', 'site-ec.thefancy.com');\n  }\n\n  _createClass(CDNUtils, [{\n    key: \"makeServer\",\n    value: function makeServer(type, template) {\n      var HOSTS = this.HOSTS;\n\n      if (!HOSTS[type]) {\n        HOSTS[type] = [];\n      }\n\n      HOSTS[type].push(template);\n    }\n  }, {\n    key: \"getResizeURL\",\n    value: function getResizeURL(url, size, method, isSchemeless, cdn) {\n      var parts = window.parseURL(url);\n      var fixedName = /test_default/.test(parts.pathname) ? 'thingd' : 'thefancy';\n      var path = \"/resize/\".concat(method ? method + '/' : '').concat(size, \"/\").concat(fixedName).concat(parts.pathname);\n      var resizeUrl;\n\n      if (cdn) {\n        resizeUrl = this.getCDNURL(path);\n      } else {\n        resizeUrl = \"\".concat(parts.protocol, \"//\").concat(parts.hostname).concat(path);\n      }\n\n      if (isSchemeless) {\n        resizeUrl = schemeless(resizeUrl);\n      }\n\n      return resizeUrl;\n    }\n  }, {\n    key: \"getCDNURL\",\n    value: function getCDNURL(url) {\n      var HOSTS = this.HOSTS;\n      var candidates;\n      var parts = window.parseURL ? window.parseURL(url) : {};\n      var path = parts.pathname;\n\n      if (parts.hostname == 's3.amazonaws.com') {\n        if (/\\/media\\.thefancy\\.com/.test(parts.pathname)) {\n          path = parts.pathname.replace(/^\\/media\\.thefancy\\.com/, '');\n          candidates = HOSTS.THEFANCY_MEDIA;\n        } else if (/\\/media\\.thingd\\.com/.test(parts.pathname)) {\n          path = parts.pathname.replace(/^\\/media\\.thingd\\.com/, '');\n          candidates = HOSTS.THINGD_MEDIA;\n        }\n      } else if (/^\\/(test_)?default/.test(path)) {\n        candidates = HOSTS.THINGD_MEDIA;\n      } else if (/^\\/_ui/.test(path)) {\n        candidates = HOSTS.FANCY_WEB;\n      } else if (/^\\/(resize|mark)/.test(path)) {\n        candidates = HOSTS.RESIZE_IMAGE;\n      } else if (/^\\/_static_gen/.test(path)) {\n        candidates = HOSTS.STATICFILES;\n      } else {\n        candidates = HOSTS.THEFANCY_MEDIA;\n      }\n\n      var hostname = candidates[sumChars(path.replace(/[^a-zA-Z0-9_]+/g, '')) % candidates.length];\n      return '//' + hostname + path;\n    } // Get REST URI for given resized_schemeless_image arguments\n    // See `fancy.templatetags.resized_images`\n\n  }, {\n    key: \"resizedSchemelessImage\",\n    value: function resizedSchemelessImage(url, size, method) {\n      // FIXME: some url (like cover image, user image, etc) gives weird url\n      //        and `window.parseURL()` attaches it to location.pathname.\n      //        This is temporary fix for it\n      if (url.match(/^(CoverImages\\/|UserImages\\/)/)) {\n        url = \"/\".concat(url);\n      }\n\n      return this.getResizeURL(url, size, method, true, true);\n    }\n  }]);\n\n  return CDNUtils;\n}();\n\nfunction sumChars(str) {\n  var sum = 0,\n      i,\n      c;\n\n  for (i = 0, c = str.length; i < c; i++) {\n    sum += str.charCodeAt(i);\n  }\n\n  return sum;\n}\n\nexport function schemeless(url) {\n  var match = typeof url === 'string' && url.match(/[http|https]\\:(\\/\\/.*)/);\n  return match == null ? url : match[1];\n}\nexport var cdnUtils = new CDNUtils();","// Removed prompt from 'copy-to-clipboard'\n// https://github.com/sudodoki/copy-to-clipboard/blob/04386fe925e10fec353e35e81684c5c96920102e/index.js\nimport deselectCurrent from 'toggle-selection';\nexport function copyToClipboard(text, options) {\n  var cb, reselectPrevious, range, selection, mark;\n\n  if (!options) {\n    options = {};\n  }\n\n  cb = options.cb || Function.prototype;\n\n  try {\n    reselectPrevious = deselectCurrent();\n    range = document.createRange();\n    selection = document.getSelection();\n    mark = document.createElement('mark');\n    mark.textContent = text; // used to conserve newline, etc\n\n    mark.style.whiteSpace = 'pre';\n    document.body.appendChild(mark);\n    range.selectNode(mark);\n    selection.addRange(range);\n    var successful = document.execCommand('copy');\n\n    if (!successful) {\n      console.warn('unable to copy via execCommand');\n      window.clipboardData.setData('text', text);\n    }\n  } catch (err) {\n    console.warn(err);\n  } finally {\n    cb(null);\n\n    if (selection) {\n      if (typeof selection.removeRange == 'function') {\n        selection.removeRange(range);\n      } else {\n        selection.removeAllRanges();\n      }\n    }\n\n    if (mark) {\n      document.body.removeChild(mark);\n    }\n\n    reselectPrevious();\n  }\n}","import React from \"react\";\nimport ReactDOM from \"react-dom\"; // render without using JSX\n\nexport function jsRender(Component) {\n  var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var targetElement = arguments.length > 2 ? arguments[2] : undefined;\n  var callback = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : function () {};\n  var rEl = /*#__PURE__*/React.createElement(Component, data);\n  return ReactDOM.render(rEl, targetElement, callback);\n} // Render to specific element position with a wrap.\n// function wrappedRenderCreator(\n//     $WrapperMethodKey/* appendTo, prependTo, insertAfter, insertBefore, ... */,\n//     Component,\n//     data,\n//     targetElement,\n//     wrapElementTag='div',\n//     callback\n// ) {\n//     let wrapper = $(`<${wrapElementTag} />`)[$WrapperMethodKey](targetElement).get(0);\n//     return function renderAfter() {\n//         return jsRender(Component, data, wrapper, callback);\n//     };\n// }\n\nfunction Prepend(rctElDomRef, targetElement) {\n  $(rctElDomRef).prependTo(targetElement);\n}\n\nfunction Append(rctElDomRef, targetElement) {\n  $(rctElDomRef).appendTo(targetElement);\n}\n\nfunction After(rctElDomRef, targetElement) {\n  $(rctElDomRef).insertAfter(targetElement);\n}\n\nfunction Before(rctElDomRef, targetElement) {\n  $(rctElDomRef).insertBefore(targetElement);\n}\n\nfunction Replace(rctElDomRef, targetElement) {\n  $(targetElement).replaceWith(rctElDomRef);\n}\n\nexport var RenderModes = {\n  Prepend: Prepend,\n  Append: Append,\n  After: After,\n  Before: Before,\n  Replace: Replace\n};\nvar FACTORY_DIV_ID = \"__external_render_factory__\"; // Warning: this works until React 16, and it could get broken at some point.\n\nexport function externalRender(mode, Component, data, targetElement, callback) {\n  var FACTORY_DIV_REF = document.createElement(\"div\");\n  FACTORY_DIV_REF.id = FACTORY_DIV_ID;\n  document.body.appendChild(FACTORY_DIV_REF);\n  var rctElRef = jsRender(Component, data, FACTORY_DIV_REF);\n  var rctElDomRef;\n\n  if (rctElRef) {\n    // non-stateless component\n    rctElDomRef = ReactDOM.findDOMNode(rctElRef);\n  } else {\n    // Stateless component\n    var cs = FACTORY_DIV_REF.children;\n\n    if (cs.length === 0) {\n      console.warn(\"externalRender: There might be a chance element is not rendered.\");\n    }\n\n    rctElDomRef = cs[0];\n  }\n\n  if (rctElDomRef && rctElDomRef instanceof Element) {\n    mode(rctElDomRef, targetElement);\n\n    if (callback) {\n      callback([rctElRef, rctElDomRef]);\n    }\n\n    FACTORY_DIV_REF.remove(); // Due to restriction, need to remove\n\n    return [rctElRef, rctElDomRef];\n  }\n}\n/*\n// TEST\nconst ASDF = ({foo}) => <div className=\"asdfasdfasdfasdfasadsfdasfasdfdasf\">{foo}</div>\nclass ASDF2 extends React.Component {\n    render() {\n        return <div className=\"213480123794578902349870239804129830\">{this.props.foo}</div>\n    }\n}\nexternalRender(RenderModes.Prepend, ASDF, {foo: 1}, document.body);\nexternalRender(RenderModes.Prepend, ASDF2, {foo: 'heydsaasdfasdfldasflasdflfdaslkfsdakmdsaf'}, document.body);\n*/\n\nexport function mountToDisposable(unmountedDOM) {\n  // Create/Select disposable mounting DIV to correctly modify a element.\n  var $disposable = $(document.body).find(\".disposable\");\n\n  if ($disposable.length > 0) {\n    $disposable = $disposable.eq(0).empty();\n  } else {\n    $disposable = $(\"<div />\", {\n      id: \"disposable\",\n      style: \"display:none;\"\n    }).appendTo(document.body);\n  }\n\n  if (unmountedDOM) {\n    // Append unmounted DOM if exists\n    $disposable.append(unmountedDOM);\n  } // return disposable DOM\n\n\n  return $disposable;\n}","// built from 'webpack.FancyUtils.config.js'\n// loaded from 'FancyUtils.js' and exported as global module 'fancymixin'\nimport React from 'react';\nimport { schemeless as getSchemelessURL } from './FancyUtils';\nexport var initialDisplayNone = {\n  display: 'none'\n}; // DEPRECATED\n\nexport var Display = {\n  None: {\n    display: 'none'\n  },\n  Block: {\n    display: 'block'\n  },\n  Inline: {\n    display: 'inline'\n  },\n  InlineBlock: {\n    display: 'inline-block'\n  },\n  NoneIf: function NoneIf(cond) {\n    return cond ? Display.None : undefined;\n  },\n  BlockIf: function BlockIf(cond) {\n    return cond ? Display.Block : undefined;\n  },\n  InlineIf: function InlineIf(cond) {\n    return cond ? Display.Inline : undefined;\n  },\n  InlineBlockIf: function InlineBlockIf(cond) {\n    return cond ? Display.InlineBlock : undefined;\n  }\n}; // Image using background-image\n\nexport var BGImage = function BGImage(_ref) {\n  var alt = _ref.alt,\n      className = _ref.className,\n      schemeless = _ref.schemeless,\n      url = _ref.url;\n  var backgroundImage = '';\n\n  if (url) {\n    backgroundImage = \"url(\".concat(schemeless ? getSchemelessURL(url) : url, \")\");\n  }\n\n  return /*#__PURE__*/React.createElement(\"img\", {\n    src: \"/_ui/images/common/blank.gif\",\n    style: {\n      backgroundImage: backgroundImage\n    },\n    className: className,\n    alt: alt\n  });\n}; // measurePointElement = .figure-item.btn-more\n// https://app.asana.com/0/260912680807/218844368911219\n\nexport function getElementGapFromHeader(measurePointElement\n/*:Element*/\n)\n/*:number*/\n{\n  var $headerFeatured = $('#header .header-featured');\n  var $header = $('#header');\n  var destHeight = $header.height();\n\n  if ($headerFeatured.attr('data-expanded') === 'true') {\n    destHeight += $headerFeatured.height();\n  }\n\n  return ~(document.body.scrollTop - $(measurePointElement).offset().top + destHeight) + 1; // convert - => + / + => -, integer\n}","import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _typeof from \"@babel/runtime/helpers/typeof\";\nvar __KEY__ = '__F';\nvar _window = window,\n    _ = _window._;\n\nwindow.requestIdleCallback = window.requestIdleCallback || function (cb) {\n  var _window2;\n\n  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n\n  (_window2 = window).setTimeout.apply(_window2, [cb, 0].concat(args));\n}; // Polyfills\n\n\nNumber.isNaN = Number.isNaN || function isNaN(value) {\n  return value !== value;\n};\n\nNumber.isInteger = Number.isInteger || function (value) {\n  return typeof value === \"number\" && isFinite(value) && Math.floor(value) === value;\n}; // https://ponyfoo.com/articles/ecmascript-string-padding\n\n\nexport function padStart(text, max, mask) {\n  var cur = text.length;\n\n  if (max <= cur) {\n    return text;\n  }\n\n  var masked = max - cur;\n  var filler = String(mask) || ' ';\n\n  while (filler.length < masked) {\n    filler += filler;\n  }\n\n  var fillerSlice = filler.slice(0, masked);\n  return fillerSlice + text;\n}\nexport function zfill(text, max) {\n  return padStart(text, max, '0');\n} // Select element or create element via selector\n\nexport function selectOrCreate(selector) {\n  var container = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document.body;\n  var element = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'div';\n  var attr;\n  var attrValue;\n\n  if (selector[0] === '.') {\n    attr = 'class';\n    var classNames = selector.split('.').filter(function (e) {\n      return e;\n    });\n\n    if (classNames.length > 1) {\n      // .abc.def\n      attrValue = classNames.join(' ');\n    } else {\n      // .abc\n      attrValue = selector.substr(1);\n    }\n  } else if (selector[0] === '#') {\n    attr = 'id';\n    attrValue = selector.substr(1);\n  } else {\n    // TODO: error handling - redirect to the page\n    throw new Error('non-recognized selector:' + selector);\n  }\n\n  var target = $(container).find(selector).get(0);\n\n  if (target == null) {\n    target = $(\"<\".concat(element, \" \").concat(attr, \"=\\\"\").concat(attrValue, \"\\\" />\")).appendTo(container).get(0);\n  }\n\n  return target;\n}\nvar thingRegex = /^\\/(sales|things)\\/(\\d+)/;\nexport function extractMetaFromURL(url) {\n  url = stripDomain(url);\n  var match = url.match(thingRegex); // [\"/(sales|things)/1234\", \"sales\", \"1234\"] | null\n\n  var ret = {};\n\n  if (match != null) {\n    ret.href = stripURL(url); // Stripped relative URL\n\n    ret.type = match[1]; // either { 'sales' | 'things' }\n\n    ret.id = match[2]; // Integer\n  }\n\n  return ret;\n}\nvar articleRegex = /^\\/(articles)\\/([^\\?]+)/;\nexport function extractMetaFromArticleURL(url) {\n  url = stripDomain(url);\n  var match = url.match(articleRegex); // [\"/articles/test\", \"articles\", \"test\"] | null\n\n  var ret = {};\n\n  if (match != null) {\n    ret.href = stripURL(url); // Stripped relative URL\n\n    ret.type = match[1]; // always { 'article' }\n\n    ret.id = match[2]; // String\n  }\n\n  return ret;\n}\n\nfunction createElementParser(url) {\n  var a = document.createElement('a');\n  a.setAttribute('href', url);\n  return a;\n}\n\nfunction stripDomain(url) {\n  if (url) {\n    var parser = createElementParser(url);\n    var result = parser.pathname + parser.search + parser.hash; // IE FIX\n\n    if (result.indexOf('/') !== 0) {\n      result = '/' + result;\n    }\n\n    return result;\n  } else {\n    return '/';\n  }\n}\n\nexport function getObjectTypeFromUrl(url) {\n  var path = stripDomain(url);\n\n  if (thingRegex.test(path)) {\n    return 'Thing';\n  } else if (articleRegex.test(path)) {\n    return 'Article';\n  } else {\n    return null;\n  }\n} // Due to <a href=# /> -> a.pathname = location.pathname, we need cleaner\n\nexport function getPathname(aElement) {\n  if (aElement.pathname === location.pathname) {\n    return '';\n  } else {\n    return aElement.pathname;\n  }\n} // http://domain/things/1234 => /things/1234\n// deprecated, use stripDomain()\n\nfunction stripURL(url) {\n  var stripped = stripDomain(url);\n\n  if (stripped) {\n    return stripped;\n  } else {\n    return null;\n  }\n}\n\nexport function floatFormatMinusTwo(number) {\n  // simulates effect of floatformat:-2|intcomma\n  var num = numberFormat(number, 2);\n  var splitted = numberFormat(number, 2).split('.');\n\n  if (splitted[1] === '00') {\n    return splitted[0];\n  } else return num;\n} // Either empty or null/undefined; Python-side falsy values like {}, []\n\nexport function isEmpty(obj) {\n  return obj == null || obj === '' || obj instanceof Array && obj.length === 0 || _typeof(obj) === 'object' && Object.getOwnPropertyNames(obj).length === 0;\n}\nexport function setCaretPos(element, position) {\n  element.focus();\n\n  if (element.setSelectionRange) {\n    element.setSelectionRange(position, position);\n  } else if (element.createTextRange) {\n    var range = element.createTextRange();\n    range.moveEnd('character', position);\n    range.collapse(false);\n    range.select();\n  }\n}\n;\nexport function getCaretPos(element) {\n  if (element.selectionStart) {\n    return element.selectionStart;\n  } else if (document.selection) {\n    var range = document.selection.createRange();\n    range.moveStart('character', -element.value.length);\n    return range.text.length;\n  } else {\n    return -1;\n  }\n}\nexport var KEYS = {\n  TAB: 9,\n  ENTER: 13,\n  SPACE: 32,\n  ESC: 27,\n  UP: 38,\n  DOWN: 40,\n  LEFT: 37,\n  RIGHT: 39,\n  SEMICOLON: 186,\n  COMMA: 188 // ,\n\n}; // Using DOM high-level event triggering system for React to recognize event\n\nexport function triggerEvent(DOMRef, eventName, data) {\n  var event;\n\n  if (data) {\n    event = new CustomEvent(eventName, {\n      'bubbles': true,\n      // Whether the event will bubble up through the DOM or not\n      'cancelable': true,\n      // Whether the event may be canceled or not\n      'detail': data\n    });\n  } else {\n    event = new Event(eventName, {\n      'bubbles': true,\n      // Whether the event will bubble up through the DOM or not\n      'cancelable': true // Whether the event may be canceled or not\n\n    });\n  }\n\n  return DOMRef.dispatchEvent(event);\n} // Deep merge for reducers\n\nexport function update(state, next) {\n  var args = [true, {}, state];\n\n  if (next) {\n    args.push(next);\n  }\n\n  return $.extend.apply(null, args);\n} // 'Shallow merge'\n\nexport function updateShallow(state, next) {\n  var args = [{}, state];\n\n  if (next) {\n    args.push(next);\n  }\n\n  return _.extend.apply(null, args);\n}\nexport function getDisplay(display) {\n  return {\n    display: display ? 'block' : 'none'\n  };\n} // '<a>b</a>' => 'b'\n\nexport function stripTags(html) {\n  var div = document.createElement(\"div\");\n  div.innerHTML = html;\n  return div.textContent || div.innerText || null;\n}\nexport function isPlainLeftClick(event) {\n  return !(event.button !== 0 || event.altKey || event.metaKey || event.ctrlKey || event.shiftKey);\n}\n\nfunction testLegacyContextLocation() {\n  try {\n    // Root - /\n    if (location.pathname === '/' && $('#container-wrapper .timeline').length > 0) {\n      return true; // Search page - /search?q=foo\n    } else if (/\\/search\\?q\\=/.test(location.href)) {\n      return true; // User page - /foo\n    } else if ($('#container-wrapper .wrapper-content.profile-section').length > 0 && /^\\/((?!\\/).)*$/.test(location.pathname)) {\n      return true;\n    } else if ('/shop' === location.pathname || /^\\/shop\\/.*/.test(location.pathname)) {\n      return true; // <username | shopname>/lists/<id>\n      // <shopname>/collection/<id>\n    } else if (/.*\\/list\\/\\d+/.test(location.pathname) || /.*\\/collection\\/\\d+/.test(location.pathname)) {\n      return true;\n    }\n  } catch (e) {}\n\n  return false;\n}\n\nvar _isHomepage;\n\nexport function isHomepage() {\n  if (_isHomepage == null) {\n    _isHomepage = location.pathname === '/';\n  }\n\n  return _isHomepage;\n}\n\nvar _isStream;\n\nexport function isStream() {\n  if (_isStream == null) {\n    return _isStream = testLegacyContextLocation();\n  } else {\n    return _isStream;\n  }\n}\nexport function promisifiedFetchImage(src, resolveCallback, timeout) {\n  var deferred = $.Deferred();\n  deferred.then(resolveCallback);\n\n  if (timeout) {\n    setTimeout(function () {\n      deferred.resolve();\n    }, timeout);\n  }\n\n  var img = new Image();\n\n  img.onload = function () {\n    deferred.resolve();\n  };\n\n  img.onerror = function () {\n    deferred.resolve();\n  };\n\n  img.src = src;\n}\nexport function debounceUntilTimeout(fun, delay) {\n  var context = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  var timer;\n  return function delayedFunctionWrapper() {\n    clearTimeout(timer);\n\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    args.unshift(context);\n    timer = setTimeout(fun.bind.apply(fun, args), delay);\n  };\n}\nexport function debounceEventUntilTimeout(eventHandler, delay) {\n  var timer;\n  return function (e) {\n    e.persist();\n    clearTimeout(timer);\n    timer = setTimeout(function () {\n      return eventHandler(e);\n    }, delay);\n  };\n}\nvar numberUnitPostfixes = ['', 'K', 'M', 'B', 'T'];\nexport function getConciseNumberString(_num) {\n  var num = Number(_num);\n\n  if (_.isNaN(num) || !_.isNumber(num)) {\n    return '';\n  }\n\n  var pos = 0;\n\n  while (num > 1000) {\n    num = num / 1000;\n    pos += 1;\n  }\n\n  if (num % 1 !== 0) {\n    // has some number after decimal point, i.e.) 10.5\n    return num.toFixed(1) + numberUnitPostfixes[pos];\n  } else {\n    // integer i.e.) 10\n    return String(num) + numberUnitPostfixes[pos];\n  }\n} // humanize.js\n\nexport function numberFormat(number, decimals, decPoint, thousandsSep) {\n  decimals = isNaN(decimals) ? 2 : Math.abs(decimals);\n  decPoint = decPoint === undefined ? '.' : decPoint;\n  thousandsSep = thousandsSep === undefined ? ',' : thousandsSep;\n  var sign = number < 0 ? '-' : '';\n  number = Math.abs(+number || 0);\n  var intPartNum = parseInt(number.toFixed(decimals), 10);\n  var intPart = intPartNum + '';\n  var j = intPart.length > 3 ? intPart.length % 3 : 0;\n  return sign + (j ? intPart.substr(0, j) + thousandsSep : '') + intPart.substr(j).replace(/(\\d{3})(?=\\d)/g, '$1' + thousandsSep) + (decimals ? decPoint + Math.abs(number - intPartNum).toFixed(decimals).slice(2) : '');\n} // Number formatting utility i.e) 0.1 => 10%\n\nexport function proportionFormat(number, isFixed) {\n  var num = Number(number);\n\n  if (_.isNumber(num) && !_.isNaN(num)) {\n    if (isFixed) {\n      return (num * 100).toFixed(0) + '%';\n    } else {\n      return num * 100 + '%';\n    }\n  } else {\n    return '';\n  }\n}\nexport function isStaticPage() {\n  return document.body.className.indexOf('static-ot') !== -1;\n}\nexport function isStaticArticlePage() {\n  return document.body.className.indexOf('static-article') !== -1;\n} // http://stackoverflow.com/questions/6393943/convert-javascript-string-in-dot-notation-into-an-object-reference\n\nexport function index(obj, is, value) {\n  if (typeof is == 'string') {\n    return index(obj, is.split('.'), value);\n  } else if (is.length === 1 && value !== undefined) {\n    obj[is[0]] = value;\n    return value;\n  } else if (is.length === 0) {\n    return obj;\n  } else if (obj[is[0]] !== undefined) {\n    return index(obj[is[0]], is.slice(1), value);\n  } else {// was unable to reach via selector\n  }\n} // export function dateFormat(format, datetime) {\n//     return $.datepicker ? $.datepicker.formatDate(format, datetime) : datetime;\n// }\n\nexport function log() {\n  if (process.env.NODE_ENV !== 'production') {\n    for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      args[_key3] = arguments[_key3];\n    }\n\n    console.debug.apply(console, args);\n  }\n}\nexport function isVisible(elm) {\n  var vpH = $(window).height(); // Viewport Height\n\n  var st = $(window).scrollTop(); // Scroll Top\n\n  var $elm = $(elm);\n  var offset = $elm.offset();\n  var elementHeight = $elm.height();\n\n  if (offset !== undefined && vpH !== undefined && st !== undefined && elementHeight !== undefined) {\n    var y = offset.top;\n    return y < vpH + st && y > st - elementHeight;\n  }\n} // http://stackoverflow.com/a/32533637/1189421\n// Object deduping / boxed value is not supported.\n\nexport function dedupeArray(vals) {\n  if (vals) {\n    return vals.sort().reduce(function (a, b) {\n      if (b !== a[0]) {\n        a.unshift(b);\n      }\n\n      return a;\n    }, []);\n  } else {\n    return null;\n  }\n} // Access global state\n\nexport function getFancyDepsRoot() {\n  window[__KEY__] = window[__KEY__] || {};\n  return window[__KEY__];\n} // eitherFancy('jQuery', $ => $(...)); -> $(...)\n\nexport function eitherFancy(namespace)\n/*:object? */\n{\n  var doWith = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function (Deps) {\n    return Deps;\n  };\n\n  if (window[__KEY__]) {\n    if (window[__KEY__][namespace]) {\n      return doWith(window[__KEY__][namespace]);\n    }\n  } else {\n    getFancyDepsRoot();\n  }\n\n  return null;\n}\nexport function didClickOn($targ, selector) {\n  return $targ.parents(selector).length > 0 || $targ.is(selector);\n}\nexport var xmlUtil = {\n  isSuccess: function isSuccess(xml) {\n    var sc = $(xml).find(\"status_code\");\n    return sc.length > 0 && sc.text() === '1';\n  },\n  isFail: function isFail(xml) {\n    var sc = $(xml).find(\"status_code\");\n    return sc.length > 0 && sc.text() === '0';\n  }\n};\nexport function MP() {\n  if (process.env.NODE_ENV === 'production') {\n    var _window3;\n\n    window.track_event && (_window3 = window).track_event.apply(_window3, arguments);\n  }\n} // ?a=1 -> ['a', '1']\n\nexport function getLocationArgPairs(key) {\n  var originalArgStr = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : location.search;\n  var argStr = originalArgStr.substr(1, originalArgStr.length);\n\n  if (argStr) {\n    var args = argStr.split('&').map(function (e) {\n      return e.split('=');\n    });\n\n    if (key) {\n      var ret;\n      args.some(function (argPair) {\n        if (argPair[0] === key) {\n          ret = argPair;\n        }\n      });\n\n      if (ret) {\n        return ret;\n      }\n    } else {\n      return args;\n    }\n  }\n}\nexport function formatDuration(value) {\n  if (value == null) {\n    // console.warn('formatDuration: undefined value', value)\n    return '00:00';\n  }\n\n  var val = Number(value);\n\n  if (_.isNaN(val)) {\n    // console.warn('formatDuration: value causing NaN', value)\n    return '00:00';\n  }\n\n  var remainder = val % 3600 | 0;\n  var minutes = remainder / 60 | 0;\n  var seconds = remainder % 60 | 0;\n  return \"\".concat(zfill(String(minutes), 2), \":\").concat(zfill(String(seconds), 2));\n}\nexport function minmax(value, lb, ub) {\n  return Math.max(Math.min(value, ub), lb);\n}\nexport { openPopup, closePopup, renderPopup } from './PopupHelper';\nexport { cdnUtils, schemeless } from './CDNUtils';\nexport function mergeObjectArgs(args) {\n  return args.reduce(function (p, n) {\n    return $.extend(true, p, n);\n  }, null);\n}\n\nfunction closestUntil(startingElement, targetElement) {\n  var start = startingElement;\n\n  while (start != null) {\n    if (start === targetElement) return targetElement;\n\n    if (start === document.body || start === document.documentElement) {\n      return null;\n    }\n\n    start = start.parentElement;\n  }\n\n  return null;\n}\n\nexport var ClickOutside = /*#__PURE__*/function () {\n  function ClickOutside(_ref) {\n    var _this = this;\n\n    var _component = _ref.component,\n        _ref$popupElementRefK = _ref.popupElementRefKey,\n        _popupElementRefKey = _ref$popupElementRefK === void 0 ? 'popupElement' : _ref$popupElementRefK;\n\n    _classCallCheck(this, ClickOutside);\n\n    _defineProperty(this, \"eventKey\", '');\n\n    _defineProperty(this, \"component\", undefined);\n\n    _defineProperty(this, \"popupElementRefKey\", '');\n\n    _defineProperty(this, \"attached\", false);\n\n    _defineProperty(this, \"handleAttach\", function (closePopupFunction) {\n      if (_this.attached || closePopupFunction == null) {\n        return;\n      }\n\n      var component = _this.component,\n          eventKey = _this.eventKey,\n          handleDetach = _this.handleDetach,\n          popupElementRefKey = _this.popupElementRefKey;\n      $(document.body).on(eventKey, function (event) {\n        if (!event.isTrigger && $.contains(document.body, event.target) && // check if element exists on DOM\n        closestUntil(event.target, component[popupElementRefKey]) === null // is target element exist below popup element?\n        ) {\n            closePopupFunction(component);\n            handleDetach();\n          }\n      });\n      _this.attached = true;\n    });\n\n    _defineProperty(this, \"handleDetach\", function () {\n      $(document.body).off(_this.eventKey);\n      _this.attached = false;\n    });\n\n    var key = Math.random().toString().substr(2, 8);\n    this.eventKey = \"click.attachClickOutside\" + key;\n    this.component = _component;\n    this.popupElementRefKey = _popupElementRefKey;\n  }\n\n  _createClass(ClickOutside, [{\n    key: \"destroy\",\n    value: function destroy() {\n      delete this.component;\n      this.handleDetach();\n    }\n  }]);\n\n  return ClickOutside;\n}();\nexport { copyToClipboard } from './CopyToClipboard';\nexport function isClipboardSupported() {\n  return document.queryCommandSupported != null && document.queryCommandSupported('copy');\n}\n\nfunction isSaleResponse(sales) {\n  return sales != null && sales[0] != null;\n} // Adapt server response (thing.to_v1 -> rest API)\n\n\nexport function convertThingsV1ToRest(things) {\n  return things.map(function (thing) {\n    var converted = Object.assign({\n      sales_available: false,\n      id: thing.id_str,\n      name: thing.name,\n      fancyd: thing[\"fancy'd\"],\n      thumb_image_url_310: thing.thumb_image_url_310,\n      thumb_image_url_558: thing.thumb_image_url_558,\n      fancyd_count: thing.fancys,\n      image: {\n        src: thing.image_url,\n        width: thing.image_url_width,\n        height: thing.image_url_height\n      },\n      owner: thing.user,\n      html_url: window.parseURL(thing.url).pathname,\n      fancyd_users: thing.fancyd_users,\n      sales: thing.sales\n    }, thing);\n    var sales = thing.sales;\n\n    if (isSaleResponse(sales)) {\n      var _sales = thing.sales[0];\n\n      if (_sales.id == null && _sales.sale_id != null) {\n        _sales.id = _sales.sale_id;\n      } // converted.sales.waiting = sales.waiting;\n\n\n      converted.sales = _sales;\n      converted.sales.quantity = _sales.remaining_quantity;\n      converted.sales.price = _sales.fancy_price;\n      converted.sales_available = _sales.available_for_sale;\n    } else {\n      converted.sales = null;\n    } // Flag for cache\n\n\n    converted.isCrawled = true;\n    return converted;\n  });\n}\nexport function isElementOutsideViewport(element, excludingElement) {\n  var elementRect = element.getBoundingClientRect();\n  var upperBound = 0;\n  var leftBound = 0;\n\n  if (excludingElement) {\n    var _element = excludingElement.element,\n        type = excludingElement.type;\n\n    if (_element) {\n      var exclusionRect = _element.getBoundingClientRect();\n\n      if (type === 'top') {\n        upperBound = exclusionRect.bottom; // exclusion on top of el (header, etc)\n      } else if (type === 'left') {\n        leftBound = exclusionRect.right; // exclusion on left of el (sidebar, etc)\n      } // right, bottom is TODO\n\n    }\n  }\n\n  var html = document.documentElement;\n  var lowerBound = window.innerHeight || html.clientHeight;\n  var rightBound = window.innerWidth || html.clientWidth;\n  var bottom = elementRect.bottom,\n      top = elementRect.top,\n      left = elementRect.left,\n      right = elementRect.right;\n  return top <= upperBound && bottom <= upperBound || top >= lowerBound && bottom >= upperBound || left <= leftBound && right <= leftBound || left >= rightBound && right >= rightBound;\n}\nvar _FancyUser = {\n  loggedIn: false,\n  merchant: false,\n  id: null\n};\n\nif (window.__FancyUser) {\n  Object.assign(_FancyUser, window.__FancyUser);\n}\n\nexport var FancyUser = _FancyUser;\nvar locationHostname = \"\".concat(location.protocol, \"//\").concat(location.hostname);\nexport function stripPathname(href) {\n  var sp = href.split(locationHostname);\n  return sp.length > 1 ? sp[1] : sp[0];\n} // https://gist.github.com/ijy/6094414\n\nexport function cartesianProductOf() {\n  for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n    args[_key4] = arguments[_key4];\n  }\n\n  return _.reduce(args, function (a, b) {\n    return _.flatten(_.map(a, function (x) {\n      return _.map(b, function (y) {\n        return x.concat([y]);\n      });\n    }), true);\n  }, [[]]);\n}\nexport function jQueryPromiseAll(arrayOfPromises) {\n  return jQuery.when.apply(jQuery, arrayOfPromises).then(function () {\n    return Array.prototype.slice.call(arguments, 0);\n  });\n}\nvar _loaded = {};\nexport function loadCss(AppName) {\n  var B = window.Bundle;\n\n  if (_loaded[AppName]) {\n    return;\n  }\n\n  if (B && B.cssToLoad && B.cssToLoad[AppName] && B.cssToLoad[AppName].length > 0) {\n    while (B.cssToLoad[AppName].length > 0) {\n      var nextUrl = B.cssToLoad[AppName].pop();\n      $(document.head).append(\"<link href=\\\"\".concat(nextUrl, \"\\\" rel=\\\"stylesheet\\\">\"));\n      _loaded[AppName] = true;\n    }\n  }\n}\n\nvar _alertify = window.alertify || {\n  alert: function alert() {\n    var _window4;\n\n    (_window4 = window).alert.apply(_window4, arguments);\n  },\n  prompt: function prompt(message, fn, placeholder, cssClass) {\n    if (fn) {\n      var msg;\n\n      if (placeholder) {\n        msg = window.prompt(message, placeholder);\n      } else {\n        msg = window.prompt(message);\n      }\n\n      if (msg === null) {\n        fn(false);\n      } else {\n        fn(true, msg);\n      }\n    }\n  },\n  confirm: function confirm(message, fn, cssClass) {\n    if (fn) {\n      fn(window.confirm(message));\n    }\n  },\n  set: function set() {},\n  labels: {\n    ok: 'OK',\n    cancel: 'Cancel'\n  }\n};\n\nexport var alertify = _alertify; // https://code.jquery.com/jquery-3.3.1.js\n\nexport function escapeSelector(sel) {\n  // $.escapeSelector()\n  var rcssescape = /([\\0-\\x1f\\x7f]|^-?\\d)|^-$|[^\\0-\\x1f\\x7f-\\uFFFF\\w-]/g;\n\n  var fcssescape = function fcssescape(ch, asCodePoint) {\n    if (asCodePoint) {\n      // U+0000 NULL becomes U+FFFD REPLACEMENT CHARACTER\n      if (ch === \"\\0\") {\n        return \"\\uFFFD\";\n      } // Control characters and (dependent upon position) numbers get escaped as code points\n\n\n      return ch.slice(0, -1) + \"\\\\\" + ch.charCodeAt(ch.length - 1).toString(16) + \" \";\n    } // Other potentially-special ASCII characters get backslash-escaped\n\n\n    return \"\\\\\" + ch;\n  };\n\n  return (sel + '').replace(rcssescape, fcssescape);\n}\n;\nvar isSafari_cac;\nexport var isSafari = function isSafari() {\n  if (isSafari_cac === undefined) {\n    isSafari_cac = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n  }\n\n  return isSafari_cac;\n};","import ReactDOM from 'react-dom';\nimport React from 'react';\nimport { selectOrCreate } from './FancyUtils';\n\nfunction selectPopup(popupName) {\n  if ($(\"#popup_container .\".concat(popupName)).length > 0) {\n    if (popupName) {\n      return $.dialog(popupName);\n    }\n  }\n\n  return null;\n}\n\nexport function openPopup(popupName) {\n  var bindOverlayData = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  var popup = selectPopup(popupName);\n\n  if (popup) {\n    if (bindOverlayData) {\n      popup.$obj.data('via-overlay', true);\n      popup.$obj.one('close', function () {\n        $(this).data('via-overlay', false);\n      });\n    }\n\n    popup.open();\n  }\n}\nexport function closePopup(popupName) {\n  var popup = selectPopup(popupName);\n\n  if (popup) {\n    popup.$obj.data('via-overlay', false);\n    popup.close();\n  }\n}\nvar popupContainer = document.getElementById('popup_container');\nexport function renderPopup(PopupComponent, attrs, callback) {\n  // unless `attrs.openOnMount` is explicitly set as `false` and callback is set, it will open right after mount.\n  attrs = attrs || {};\n\n  if (attrs.openOnMount !== false && callback == null) {\n    callback = function callback() {\n      openPopup(PopupComponent.popupName);\n    };\n  }\n\n  if (!PopupComponent.popupName) {\n    console.warn(\"renderPopup: Please set `popupName` property of \".concat(PopupComponent.name));\n  }\n\n  return ReactDOM.render( /*#__PURE__*/React.createElement(PopupComponent, attrs), selectOrCreate(\".popup.\".concat(PopupComponent.popupName || ''), popupContainer), callback);\n}","import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from \"react\";\nimport classnames from \"classnames\";\nimport { KEYS, MP, getDisplay, isEmpty, alertify } from \"fancyutils\";\nimport { Display } from \"fancymixin\";\nexport var AddlistAction = /*#__PURE__*/function (_Component) {\n  _inherits(AddlistAction, _Component);\n\n  function AddlistAction() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, AddlistAction);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(AddlistAction)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      lists: [],\n      wanted: false,\n      listSearchQuery: \"\",\n      listCreationQuery: \"\",\n      createListFocused: false,\n      showList: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleListSearch\", function (event) {\n      var listSearchQuery = event.target.value;\n\n      _this.setStateSafe({\n        listSearchQuery: listSearchQuery\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleListCreation\", function (event) {\n      event.preventDefault();\n\n      if (event.type === \"keyup\" && event.which !== KEYS.ENTER) {\n        return;\n      }\n\n      var listCreationQuery = $.trim(_this.state.listCreationQuery);\n      var _this$props = _this.props,\n          objectId = _this$props.objectId,\n          objectType = _this$props.objectType,\n          merchantId = _this$props.merchantId;\n\n      if (isEmpty(listCreationQuery)) {\n        return;\n      } // save new list\n\n\n      createList({\n        merchantId: merchantId,\n        listCreationQuery: listCreationQuery,\n        callback: function callback() {\n          _this.setStateSafe({\n            listCreationQuery: \"\"\n          }, function () {\n            _this.drawUserList(objectId);\n\n            _this.quickCreateList.focus();\n\n            if (objectType === \"thing\") {\n              MP(\"Create New List\", {\n                \"thing id\": objectId,\n                \"list name\": listCreationQuery,\n                via: \"thing detail\"\n              });\n            }\n          });\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleWishlistCheckboxChange\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n      var targ = event.currentTarget;\n      var _this$props2 = _this.props,\n          objectType = _this$props2.objectType,\n          objectId = _this$props2.objectId,\n          handleHide = _this$props2.handleHide;\n      var name = \"wanted\";\n      var params = {\n        owned: false,\n        wanted: targ.checked\n      };\n      var eventName = targ.checked ? \"Add to List\" : \"Remove from List\";\n\n      if (objectType === \"thing\") {\n        if (params.wanted && window.dataLayer) {\n          window.dataLayer.push({\n            event: \"Add_to_Wishlist_Check\",\n            product_id: undefined,\n            products_info: undefined,\n            products: undefined,\n            revenue: undefined,\n            option_id: undefined\n          });\n        }\n\n        $.ajax(\"/rest-api/v1/things/\".concat(objectId), {\n          type: \"PUT\",\n          data: params\n        }).done(function () {\n          _this.drawUserList(objectId);\n\n          _this.setStateSafe({\n            wanted: params.wanted\n          });\n\n          if (params.wanted) {\n            handleHide && handleHide();\n          }\n        }).error(function (err) {\n          console.warn(err);\n        });\n        MP(eventName, {\n          \"thing id\": objectId,\n          \"list name\": name,\n          \"list id\": -1,\n          via: \"thing detail\"\n        });\n      } else {\n        console.warn(\"Add to list does not work with non-thing type\");\n        return;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleListCheckboxChange\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n      var targ = event.currentTarget;\n      var isChecked = targ.checked;\n      var _this$props3 = _this.props,\n          objectId = _this$props3.objectId,\n          objectType = _this$props3.objectType,\n          handleHide = _this$props3.handleHide,\n          merchantId = _this$props3.merchantId;\n      var lists = _this.state.lists;\n      var selectedListId = targ.getAttribute(\"data-listid\");\n      var collectionAction = [Number(selectedListId), targ.checked];\n\n      if (objectType === \"thing\") {\n        var eventName = isChecked ? \"Add to List\" : \"Remove from List\";\n        var theList = lists.filter(function (list) {\n          return list.id === selectedListId;\n        })[0];\n\n        var callback = function callback() {\n          _this.drawUserList(objectId);\n\n          if (isChecked) {\n            handleHide && handleHide();\n          }\n\n          MP(eventName, {\n            \"thing id\": objectId,\n            \"list name\": theList.name,\n            \"list id\": theList.id,\n            via: \"thing detail\"\n          });\n        };\n\n        if (merchantId) {\n          updateList({\n            merchantId: merchantId,\n            objectId: objectId,\n            collectionAction: collectionAction,\n            callback: callback\n          });\n        } else {\n          var checked = [];\n          var unchecked = [];\n          $(_this.lists).find('input[type=\"checkbox\"]:not(.tag)').each(function () {\n            var listId = this.getAttribute(\"data-listid\");\n\n            if (this.checked) {\n              checked.push(listId);\n            } else {\n              unchecked.push(listId);\n            }\n          });\n          updateList({\n            checked: checked,\n            unchecked: unchecked,\n            objectId: objectId,\n            callback: callback\n          });\n        }\n      } else {\n        console.warn(\"Add to list does not work with non-thing type\");\n        return;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCreateListLabelClick\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      _this.setStateSafe({\n        createListFocused: true\n      }, function () {\n        _this.quickCreateList.focus();\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCreateListBlur\", function () {\n      _this.setStateSafe({\n        createListFocused: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCreateListQueryChange\", function (event) {\n      _this.setStateSafe({\n        listCreationQuery: event.target.value\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(AddlistAction, [{\n    key: \"setStateSafe\",\n    value: function setStateSafe() {\n      if (this.mounted) {\n        this.setState.apply(this, arguments);\n      }\n    }\n  }, {\n    key: \"drawUserList\",\n    value: function drawUserList(objectId) {\n      var _this2 = this;\n\n      objectId = objectId || this.props.objectId;\n      getListCheckbox({\n        merchantId: this.props.merchantId,\n        objectId: objectId,\n        callback: function callback(res) {\n          _this2.setStateSafe(res);\n        }\n      });\n    }\n  }, {\n    key: \"isWishlistQuery\",\n    value: function isWishlistQuery(listSearchQuery) {\n      return \"wishlist\".indexOf($.trim(listSearchQuery).toLowerCase()) !== -1;\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.mounted = true;\n      this.listDrawn = false;\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.mounted = false;\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(pp, ps) {\n      var _this3 = this;\n\n      if ((ps.showList !== this.state.showList || this.listDrawn === false) && this.state.showList === true) {\n        if (this.listDrawn === false) {\n          this.listDrawn = true;\n        }\n\n        this.drawUserList(this.props.objectId);\n        setTimeout(function () {\n          _this3.listSearchInput.focus();\n        }, 0);\n      }\n    }\n  }, {\n    key: \"show\",\n    value: function show() {\n      this.setStateSafe({\n        showList: true\n      });\n    }\n  }, {\n    key: \"hide\",\n    value: function hide() {\n      this.setStateSafe({\n        showList: false\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var _this$props4 = this.props,\n          objectId = _this$props4.objectId,\n          merchantId = _this$props4.merchantId;\n      var _this$state = this.state,\n          lists = _this$state.lists,\n          wanted = _this$state.wanted,\n          listSearchQuery = _this$state.listSearchQuery,\n          listCreationQuery = _this$state.listCreationQuery,\n          createListFocused = _this$state.createListFocused,\n          showList = _this$state.showList;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        id: \"show-addlist\",\n        className: \"has-arrow more-share-popup addlist-action\",\n        style: getDisplay(showList)\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"tit\"\n      }, merchantId ? gettext(\"Add to Collection\") : gettext(\"Add to List\")), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"search before-bg-share2\"\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        ref: function ref(element) {\n          _this4.listSearchInput = element;\n        },\n        type: \"text\",\n        className: \"text\",\n        placeholder: merchantId ? gettext(\"Search your collections\") : gettext(\"Search your lists\"),\n        value: listSearchQuery,\n        onChange: this.handleListSearch\n      })), /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"lists\",\n        ref: function ref(element) {\n          _this4.lists = element;\n        }\n      }, !merchantId && /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"label\", {\n        htmlFor: \"wanted-\".concat(objectId)\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        name: \"wanted\",\n        checked: wanted,\n        id: \"wanted-\".concat(objectId),\n        className: \"tag \".concat(wanted ? \"checked\" : \"\"),\n        style: {\n          display: this.isWishlistQuery(listSearchQuery) ? null : \"none\"\n        },\n        onChange: this.handleWishlistCheckboxChange\n      }), \" \", gettext(\"Wish List\"))), lists && lists.map(function (list, idx) {\n        var term = $.trim(listSearchQuery).toLowerCase();\n        var style;\n\n        if (_.isString(term) && term.length > 0) {\n          style = Display.NoneIf(list.name.toLowerCase().indexOf(term.toLowerCase()) === -1);\n        }\n\n        var className = list.selected ? \"selected\" : null;\n        var ident = \"\".concat(objectId, \"-\").concat(list.id);\n        return /*#__PURE__*/React.createElement(\"li\", {\n          key: idx,\n          style: style\n        }, /*#__PURE__*/React.createElement(\"label\", {\n          htmlFor: ident\n        }, /*#__PURE__*/React.createElement(\"input\", {\n          className: className,\n          type: \"checkbox\",\n          name: ident,\n          id: ident,\n          checked: list.selected,\n          \"data-listid\": list.id,\n          onChange: _this4.handleListCheckboxChange\n        }), \" \", list.name));\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"new-list\"\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        htmlFor: \"quick-create-list\",\n        style: {\n          display: createListFocused ? \"none\" : \"block\"\n        },\n        onClick: this.handleCreateListLabelClick\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"icon\"\n      }), merchantId ? gettext(\"Create New Collection\") : gettext(\"Create New List\")), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        id: \"quick-create-list\",\n        ref: function ref(element) {\n          _this4.quickCreateList = element;\n        },\n        onBlur: this.handleCreateListBlur,\n        onKeyUp: this.handleListCreation,\n        onChange: this.handleCreateListQueryChange,\n        value: listCreationQuery,\n        placeholder: merchantId ? gettext(\"Create New Collection\") : gettext(\"Create New List\")\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn-create\",\n        onClick: this.handleListCreation\n      }, gettext(\"Create\"))));\n    }\n  }]);\n\n  return AddlistAction;\n}(Component);\n\nfunction getListCheckbox(_ref) {\n  var merchantId = _ref.merchantId,\n      objectId = _ref.objectId,\n      callback = _ref.callback;\n\n  if (merchantId) {\n    $.get(\"/rest-api/v1/seller/\".concat(merchantId, \"/collections\"), {\n      selected_object_id: objectId\n    }).done(function () {\n      var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          collections = _ref2.collections;\n\n      var lists;\n\n      if (collections.length > 0) {\n        lists = collections.sort(function (a, b) {\n          var aText = $.trim(a).toLowerCase();\n          var bText = $.trim(b).toLowerCase();\n          return aText < bText ? -1 : 1;\n        }).map(function (_ref3) {\n          var id = _ref3.id,\n              name = _ref3.name,\n              selected = _ref3.selected;\n          return {\n            id: id,\n            name: name,\n            selected: selected\n          };\n        });\n      } else {\n        lists = [];\n      }\n\n      callback && callback({\n        lists: lists,\n        wanted: null\n      });\n    }).error(function (err) {\n      console.warn(err);\n    });\n  } else {\n    $.get(\"/_get_list_checkbox.html\", {\n      tid: objectId\n    }).done(function (html) {\n      var $html = $(html);\n      var $items = $html.filter(\"li\").find(\"img\").remove().end();\n      var lists;\n\n      if ($items.length > 0) {\n        lists = $items.sort(function (a, b) {\n          var aText = $.trim($(a).text()).toLowerCase();\n          var bText = $.trim($(b).text()).toLowerCase();\n          return aText < bText ? -1 : 1;\n        }).map(function (_, item) {\n          var $item = $(item);\n          return {\n            id: $item.find(\"label\").attr(\"for\"),\n            name: $.trim($item.find(\"label\").text()),\n            selected: $item.find(\"input\").prop(\"checked\")\n          };\n        }).get();\n      } else {\n        lists = [];\n      }\n\n      var wanted = $html.filter('input[name=\"wanted\"]').val() === \"true\";\n      callback && callback({\n        lists: lists,\n        wanted: wanted\n      });\n    }).error(function (err) {\n      console.warn(err);\n    });\n  }\n}\n\nfunction createList(_ref4) {\n  var merchantId = _ref4.merchantId,\n      listCreationQuery = _ref4.listCreationQuery,\n      callback = _ref4.callback;\n\n  if (merchantId) {\n    $.post(\"/rest-api/v1/seller/\".concat(merchantId, \"/collections\"), {\n      list_name: listCreationQuery\n    }).done(function (res) {\n      // if ($(res).find(\"created\").text() == 'False') {\n      // if (false){\n      //     alertify.alert(`List Title Not Available`, `There is already a list named ${listCreationQuery}. Try again with a different name.`);\n      // } else {\n      callback && callback(); // }\n    }).error(function (err) {\n      console.warn(err);\n    });\n  } else {\n    $.post(\"/create_list.xml\", {\n      list_name: listCreationQuery,\n      reaction: 0\n    }).done(function (res) {\n      if ($(res).find(\"created\").text() == \"False\") {\n        alertify.alert(\"<b>List Title Not Available</b><br><br>There is already a list named \".concat(listCreationQuery, \". Try again with a different name.\"));\n      } else {\n        callback && callback();\n      }\n    }).error(function (err) {\n      console.warn(err);\n    });\n  }\n}\n\nfunction updateList(_ref5) {\n  var merchantId = _ref5.merchantId,\n      collectionAction = _ref5.collectionAction,\n      objectId = _ref5.objectId,\n      checked = _ref5.checked,\n      unchecked = _ref5.unchecked,\n      callback = _ref5.callback;\n\n  if (merchantId) {\n    var _collectionAction = _slicedToArray(collectionAction, 2),\n        collectionId = _collectionAction[0],\n        add = _collectionAction[1];\n\n    $.ajax({\n      url: \"/rest-api/v1/seller/\".concat(merchantId, \"/collections/\").concat(collectionId),\n      type: \"POST\",\n      data: {\n        object_id: objectId,\n        action: add ? \"add\" : \"remove\"\n      }\n    }).done(callback).error(function (err) {\n      console.warn(err);\n    });\n  } else {\n    $.post(\"/save_list_items\", {\n      tid: objectId,\n      checked_list_ids: checked.join(\",\"),\n      unchecked_list_ids: unchecked.join(\",\")\n    }).done(callback).error(function (err) {\n      console.warn(err);\n    });\n  }\n}","import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from 'react';\nimport classnames from 'classnames';\nimport { KEYS, MP, getDisplay, isEmpty, alertify } from 'fancyutils';\nimport { Display } from 'fancymixin';\nexport var AddlistPopover = /*#__PURE__*/function (_Component) {\n  _inherits(AddlistPopover, _Component);\n\n  function AddlistPopover() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, AddlistPopover);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(AddlistPopover)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      lists: [],\n      wanted: false,\n      listSearchQuery: '',\n      listCreationQuery: '',\n      createListFocused: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleListSearch\", function (event) {\n      var listSearchQuery = event.target.value;\n\n      _this.setStateSafe({\n        listSearchQuery: listSearchQuery\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleListCreation\", function (event) {\n      event.preventDefault();\n\n      if (event.type === 'keyup' && event.which !== KEYS.ENTER) {\n        return;\n      }\n\n      var listCreationQuery = $.trim(_this.state.listCreationQuery);\n      var _this$props = _this.props,\n          objectId = _this$props.objectId,\n          objectType = _this$props.objectType,\n          merchantId = _this$props.merchantId;\n\n      if (isEmpty(listCreationQuery)) {\n        return;\n      } // save new list\n\n\n      createList({\n        merchantId: merchantId,\n        listCreationQuery: listCreationQuery,\n        callback: function callback() {\n          _this.setStateSafe({\n            listCreationQuery: ''\n          }, function () {\n            _this.drawUserList(objectId);\n\n            _this.quickCreateList.focus();\n\n            if (objectType === 'thing') {\n              MP('Create New List', {\n                'thing id': objectId,\n                'list name': listCreationQuery,\n                'via': 'thing detail'\n              });\n            }\n          });\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleWishlistCheckboxChange\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n      var targ = event.currentTarget;\n      var _this$props2 = _this.props,\n          objectType = _this$props2.objectType,\n          objectId = _this$props2.objectId,\n          handleHide = _this$props2.handleHide;\n      var name = 'wanted';\n      var params = {\n        owned: false,\n        wanted: targ.checked\n      };\n      var eventName = targ.checked ? \"Add to List\" : \"Remove from List\";\n\n      if (objectType === 'thing') {\n        if (params.wanted && window.dataLayer) {\n          window.dataLayer.push({\n            'event': 'Add_to_Wishlist_Check',\n            'product_id': undefined,\n            'products_info': undefined,\n            'products': undefined,\n            'revenue': undefined,\n            'option_id': undefined\n          });\n        }\n\n        $.ajax(\"/rest-api/v1/things/\".concat(objectId), {\n          type: 'PUT',\n          data: params\n        }).done(function () {\n          _this.drawUserList(objectId);\n\n          _this.setStateSafe({\n            wanted: params.wanted\n          });\n\n          if (params.wanted) {\n            handleHide && handleHide();\n          }\n        }).error(function (err) {\n          console.warn(err);\n        });\n        MP(eventName, {\n          'thing id': objectId,\n          'list name': name,\n          'list id': -1,\n          'via': 'thing detail'\n        });\n      } else {\n        console.warn('Add to list does not work with non-thing type');\n        return;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleListCheckboxChange\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n      var targ = event.currentTarget;\n      var isChecked = targ.checked;\n      var _this$props3 = _this.props,\n          objectId = _this$props3.objectId,\n          objectType = _this$props3.objectType,\n          handleHide = _this$props3.handleHide,\n          merchantId = _this$props3.merchantId;\n      var lists = _this.state.lists;\n      var selectedListId = targ.getAttribute('data-listid');\n      var collectionAction = [Number(selectedListId), targ.checked];\n\n      if (objectType === 'thing') {\n        var eventName = isChecked ? \"Add to List\" : \"Remove from List\";\n        var theList = lists.filter(function (list) {\n          return list.id === selectedListId;\n        })[0];\n\n        var callback = function callback() {\n          _this.drawUserList(objectId);\n\n          if (isChecked) {\n            handleHide && handleHide();\n          }\n\n          MP(eventName, {\n            'thing id': objectId,\n            'list name': theList.name,\n            'list id': theList.id,\n            'via': 'thing detail'\n          });\n        };\n\n        if (merchantId) {\n          updateList({\n            merchantId: merchantId,\n            objectId: objectId,\n            collectionAction: collectionAction,\n            callback: callback\n          });\n        } else {\n          var checked = [];\n          var unchecked = [];\n          $(_this.lists).find('input[type=\"checkbox\"]:not(.tag)').each(function () {\n            var listId = this.getAttribute('data-listid');\n\n            if (this.checked) {\n              checked.push(listId);\n            } else {\n              unchecked.push(listId);\n            }\n          });\n          updateList({\n            checked: checked,\n            unchecked: unchecked,\n            objectId: objectId,\n            callback: callback\n          });\n        }\n      } else {\n        console.warn('Add to list does not work with non-thing type');\n        return;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCreateListLabelClick\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      _this.setStateSafe({\n        createListFocused: true\n      }, function () {\n        _this.quickCreateList.focus();\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCreateListBlur\", function () {\n      _this.setStateSafe({\n        createListFocused: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCreateListQueryChange\", function (event) {\n      _this.setStateSafe({\n        listCreationQuery: event.target.value\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(AddlistPopover, [{\n    key: \"setStateSafe\",\n    value: function setStateSafe() {\n      if (this.mounted) {\n        this.setState.apply(this, arguments);\n      }\n    }\n  }, {\n    key: \"drawUserList\",\n    value: function drawUserList(objectId) {\n      var _this2 = this;\n\n      objectId = objectId || this.props.objectId;\n      getListCheckbox({\n        merchantId: this.props.merchantId,\n        objectId: objectId,\n        callback: function callback(res) {\n          _this2.setStateSafe(res);\n        }\n      });\n    }\n  }, {\n    key: \"isWishlistQuery\",\n    value: function isWishlistQuery(listSearchQuery) {\n      return 'wishlist'.indexOf($.trim(listSearchQuery).toLowerCase()) !== -1;\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.mounted = true;\n      this.listDrawn = false;\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.mounted = false;\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(pp) {\n      var _this3 = this;\n\n      if ((pp.showList !== this.props.showList || this.listDrawn === false) && this.props.showList === true) {\n        if (this.listDrawn === false) {\n          this.listDrawn = true;\n        }\n\n        this.drawUserList(this.props.objectId);\n        setTimeout(function () {\n          _this3.listSearchInput.focus();\n        }, 0);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var _this$props4 = this.props,\n          objectId = _this$props4.objectId,\n          showList = _this$props4.showList,\n          headerGap = _this$props4.headerGap,\n          merchantId = _this$props4.merchantId;\n      var _this$state = this.state,\n          lists = _this$state.lists,\n          wanted = _this$state.wanted,\n          listSearchQuery = _this$state.listSearchQuery,\n          listCreationQuery = _this$state.listCreationQuery,\n          createListFocused = _this$state.createListFocused;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        id: \"show-addlist\",\n        className: classnames(\"has-arrow more-share-popup\", {\n          bot: headerGap && headerGap < 16 + 269\n          /*= tip + bubble*/\n\n        }),\n        style: getDisplay(showList)\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"tit\"\n      }, merchantId ? gettext(\"Add to Collection\") : gettext(\"Add to List\")), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"search before-bg-share2\"\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        ref: function ref(element) {\n          _this4.listSearchInput = element;\n        },\n        type: \"text\",\n        className: \"text\",\n        placeholder: merchantId ? gettext('Search your collections') : gettext('Search your lists'),\n        value: listSearchQuery,\n        onChange: this.handleListSearch\n      })), /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"lists\",\n        ref: function ref(element) {\n          _this4.lists = element;\n        }\n      }, !merchantId && /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"label\", {\n        htmlFor: \"wanted-\".concat(objectId)\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        name: \"wanted\",\n        checked: wanted,\n        id: \"wanted-\".concat(objectId),\n        className: \"tag \".concat(wanted ? 'checked' : ''),\n        style: {\n          display: this.isWishlistQuery(listSearchQuery) ? null : 'none'\n        },\n        onChange: this.handleWishlistCheckboxChange\n      }), \" \", gettext('Wish List'))), lists && lists.map(function (list, idx) {\n        var term = $.trim(listSearchQuery).toLowerCase();\n        var style;\n\n        if (_.isString(term) && term.length > 0) {\n          style = Display.NoneIf(list.name.toLowerCase().indexOf(term.toLowerCase()) === -1);\n        }\n\n        var className = list.selected ? \"selected\" : null;\n        var ident = \"\".concat(objectId, \"-\").concat(list.id);\n        return /*#__PURE__*/React.createElement(\"li\", {\n          key: idx,\n          style: style\n        }, /*#__PURE__*/React.createElement(\"label\", {\n          htmlFor: ident\n        }, /*#__PURE__*/React.createElement(\"input\", {\n          className: className,\n          type: \"checkbox\",\n          name: ident,\n          id: ident,\n          checked: list.selected,\n          \"data-listid\": list.id,\n          onChange: _this4.handleListCheckboxChange\n        }), \" \", list.name));\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"new-list\"\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        htmlFor: \"quick-create-list\",\n        style: {\n          display: createListFocused ? 'none' : 'block'\n        },\n        onClick: this.handleCreateListLabelClick\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"icon\"\n      }), merchantId ? gettext('Create New Collection') : gettext(\"Create New List\")), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        id: \"quick-create-list\",\n        ref: function ref(element) {\n          _this4.quickCreateList = element;\n        },\n        onBlur: this.handleCreateListBlur,\n        onKeyUp: this.handleListCreation,\n        onChange: this.handleCreateListQueryChange,\n        value: listCreationQuery,\n        placeholder: merchantId ? gettext('Create New Collection') : gettext(\"Create New List\")\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn-create\",\n        onClick: this.handleListCreation\n      }, gettext(\"Create\"))));\n    }\n  }]);\n\n  return AddlistPopover;\n}(Component);\n\nfunction getListCheckbox(_ref) {\n  var merchantId = _ref.merchantId,\n      objectId = _ref.objectId,\n      callback = _ref.callback;\n\n  if (merchantId) {\n    $.get(\"/rest-api/v1/seller/\".concat(merchantId, \"/collections\"), {\n      selected_object_id: objectId\n    }).done(function () {\n      var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          collections = _ref2.collections;\n\n      var lists;\n\n      if (collections.length > 0) {\n        lists = collections.sort(function (a, b) {\n          var aText = $.trim(a).toLowerCase();\n          var bText = $.trim(b).toLowerCase();\n          return aText < bText ? -1 : 1;\n        }).map(function (_ref3) {\n          var id = _ref3.id,\n              name = _ref3.name,\n              selected = _ref3.selected;\n          return {\n            id: id,\n            name: name,\n            selected: selected\n          };\n        });\n      } else {\n        lists = [];\n      }\n\n      callback && callback({\n        lists: lists,\n        wanted: null\n      });\n    }).error(function (err) {\n      console.warn(err);\n    });\n  } else {\n    $.get('/_get_list_checkbox.html', {\n      tid: objectId\n    }).done(function (html) {\n      var $html = $(html);\n      var $items = $html.filter('li').find('img').remove().end();\n      var lists;\n\n      if ($items.length > 0) {\n        lists = $items.sort(function (a, b) {\n          var aText = $.trim($(a).text()).toLowerCase();\n          var bText = $.trim($(b).text()).toLowerCase();\n          return aText < bText ? -1 : 1;\n        }).map(function (_, item) {\n          var $item = $(item);\n          return {\n            id: $item.find('label').attr('for'),\n            name: $.trim($item.find('label').text()),\n            selected: $item.find('input').prop('checked')\n          };\n        }).get();\n      } else {\n        lists = [];\n      }\n\n      var wanted = $html.filter('input[name=\"wanted\"]').val() === 'true';\n      callback && callback({\n        lists: lists,\n        wanted: wanted\n      });\n    }).error(function (err) {\n      console.warn(err);\n    });\n  }\n}\n\nfunction createList(_ref4) {\n  var merchantId = _ref4.merchantId,\n      listCreationQuery = _ref4.listCreationQuery,\n      callback = _ref4.callback;\n\n  if (merchantId) {\n    $.post(\"/rest-api/v1/seller/\".concat(merchantId, \"/collections\"), {\n      list_name: listCreationQuery\n    }).done(function (res) {\n      // if ($(res).find(\"created\").text() == 'False') {\n      // if (false){\n      //     alertify.alert(`List Title Not Available`, `There is already a list named ${listCreationQuery}. Try again with a different name.`);\n      // } else {\n      callback && callback(); // }\n    }).error(function (err) {\n      console.warn(err);\n    });\n  } else {\n    $.post('/create_list.xml', {\n      list_name: listCreationQuery,\n      reaction: 0\n    }).done(function (res) {\n      if ($(res).find(\"created\").text() == 'False') {\n        alertify.alert(\"<b>List Title Not Available</b><br><br>There is already a list named \".concat(listCreationQuery, \". Try again with a different name.\"));\n      } else {\n        callback && callback();\n      }\n    }).error(function (err) {\n      console.warn(err);\n    });\n  }\n}\n\nfunction updateList(_ref5) {\n  var merchantId = _ref5.merchantId,\n      collectionAction = _ref5.collectionAction,\n      objectId = _ref5.objectId,\n      checked = _ref5.checked,\n      unchecked = _ref5.unchecked,\n      callback = _ref5.callback;\n\n  if (merchantId) {\n    var _collectionAction = _slicedToArray(collectionAction, 2),\n        collectionId = _collectionAction[0],\n        add = _collectionAction[1];\n\n    $.ajax({\n      url: \"/rest-api/v1/seller/\".concat(merchantId, \"/collections/\").concat(collectionId),\n      type: 'POST',\n      data: {\n        object_id: objectId,\n        action: add ? 'add' : 'remove'\n      }\n    }).done(callback).error(function (err) {\n      console.warn(err);\n    });\n  } else {\n    $.post('/save_list_items', {\n      tid: objectId,\n      checked_list_ids: checked.join(','),\n      unchecked_list_ids: unchecked.join(',')\n    }).done(callback).error(function (err) {\n      console.warn(err);\n    });\n  }\n}","import createHistory from \"history/createBrowserHistory\";\nexport var history = createHistory();","import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from \"react\";\nimport classnames from \"classnames\";\nimport { renderPopup, copyToClipboard, isElementOutsideViewport, MP, ClickOutside, FancyUser } from \"fancyutils\";\nimport { getElementGapFromHeader } from \"fancymixin\";\nimport { SharePopover } from \"./SharePopover\";\nimport { AddlistPopover } from \"./AddlistPopover\";\nimport { ShareObjectTypes, getShareURL } from \"./MoreShareUtils\";\nimport { FancydByPopup } from \"./Popup\"; // returns dictionary with only one value true and else is false\n\nfunction makeToggle(keys) {\n  var obj = {};\n  return function toggle() {\n    keys.forEach(function (key) {\n      obj[key] = false;\n    });\n\n    for (var _len = arguments.length, toggleKeys = new Array(_len), _key = 0; _key < _len; _key++) {\n      toggleKeys[_key] = arguments[_key];\n    }\n\n    if (toggleKeys) {\n      toggleKeys.forEach(function (key) {\n        obj[key] = true;\n      });\n    }\n\n    return obj;\n  };\n}\n\nvar toggleShow = makeToggle([\"showShare\", \"showList\", \"showSellerList\", \"showMenu\"]);\nexport var MoreShare = /*#__PURE__*/function (_Component) {\n  _inherits(MoreShare, _Component);\n\n  function MoreShare() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MoreShare);\n\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MoreShare)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      showShare: false,\n      showList: false,\n      showMenu: false,\n      headerGap: null,\n      referrerURL: null,\n      linkCopied: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleShareDisplay\", function () {\n      _this.setStateSafe({\n        showShare: !_this.state.showShare,\n        showList: false,\n        showMenu: false,\n        headerGap: getElementGapFromHeader(_this.moreMenuButton)\n      }, _this.handleHook);\n\n      if (_this.props.objectType === ShareObjectTypes.thing) {\n        MP(\"Share\", {\n          \"thing id\": _this.props.objectId\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleListDisplay\", function () {\n      if (!FancyUser.loggedIn) {\n        _this.closePopup();\n\n        window.require_login();\n        return;\n      }\n\n      var showList = !_this.state.showList;\n\n      _this.setStateSafe(toggleShow(showList ? \"showList\" : null), _this.handleHook);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleMerchantListDisplay\", function () {\n      if (!FancyUser.loggedIn) {\n        _this.closePopup();\n\n        window.require_login();\n        return;\n      }\n\n      var showSellerList = !_this.state.showSellerList;\n\n      _this.setStateSafe(toggleShow(showSellerList ? \"showSellerList\" : null), _this.handleHook);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"closePopup\", function () {\n      _this.removeViewportCheck();\n\n      _this.setStateSafe(toggleShow(), _this.handleHook);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"viewPortChecking\", false);\n\n    _defineProperty(_assertThisInitialized(_this), \"evtName\", \"scrollstop.MoreShare\");\n\n    _defineProperty(_assertThisInitialized(_this), \"checkViewport\", function () {\n      if (_this.viewPortChecking) {\n        return;\n      }\n\n      _this.viewPortChecking = true;\n      $(window).on(_this.evtName, function () {\n        var $root = $(_this.MoreShareEl);\n        var headerEl = $(\"#header .header-featured\").get(0);\n        var _this$state = _this.state,\n            showMenu = _this$state.showMenu,\n            showShare = _this$state.showShare,\n            showList = _this$state.showList,\n            showSellerList = _this$state.showSellerList;\n        var sel;\n\n        if (showMenu) {\n          sel = \"#more-menu\";\n        } else if (showShare) {\n          sel = \"#show-share\";\n        } else if (showList || showSellerList) {\n          sel = \"#show-addlist\";\n        }\n\n        var el = $root.find(sel).get(0);\n\n        if (el) {\n          var outsideViewport = isElementOutsideViewport(el, {\n            element: headerEl,\n            type: \"top\"\n          });\n\n          if (outsideViewport) {\n            _this.closePopup();\n          }\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"removeViewportCheck\", function () {\n      _this.viewPortChecking = false;\n      $(window).off(_this.evtName);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleMoreShareToggle\", function () {\n      var objectType = _this.props.objectType;\n      var _this$state2 = _this.state,\n          showMenu = _this$state2.showMenu,\n          showShare = _this$state2.showShare,\n          showList = _this$state2.showList,\n          showSellerList = _this$state2.showSellerList; // thing types will show menu\n\n      if (objectType === ShareObjectTypes.thing || objectType === ShareObjectTypes.article) {\n        if (showMenu || showShare || showList || showSellerList) {\n          _this.closePopup();\n        } else {\n          _this.setStateSafe({\n            showMenu: true,\n            headerGap: getElementGapFromHeader(_this.moreMenuButton)\n          }, _this.handleHook);\n        } // non-thing types will show share popover directly, because add-to-list is not available\n\n      } else {\n        _this.handleShareDisplay();\n      }\n\n      return false;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleHook\", function () {\n      if (_this.props.onShowSomething) {\n        var _this$state3 = _this.state,\n            showList = _this$state3.showList,\n            showShare = _this$state3.showShare,\n            showMenu = _this$state3.showMenu,\n            showSellerList = _this$state3.showSellerList;\n\n        _this.props.onShowSomething(showList || showShare || showMenu || showSellerList, _assertThisInitialized(_this));\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleHideList\", function () {\n      _this.setStateSafe({\n        showList: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleHideShare\", function () {\n      _this.setStateSafe({\n        showShare: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"linkCopiedRemovalTimer\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCopyLink\", function () {\n      if (_this.linkCopiedRemovalTimer != null) {\n        return;\n      }\n\n      copyToClipboard(_this.state.referrerURL, {\n        cb: function cb() {\n          _this.setState({\n            linkCopied: true\n          });\n\n          _this.linkCopiedRemovalTimer = setTimeout(function () {\n            _this.setState({\n              linkCopied: false\n            });\n          }, 5000);\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleFancydByDisplay\", function () {\n      event.preventDefault();\n      event.stopPropagation();\n      var _this$props = _this.props,\n          viewerUsername = _this$props.viewerUsername,\n          objectId = _this$props.objectId,\n          objectType = _this$props.objectType;\n      renderPopup(FancydByPopup, {\n        objectId: objectId,\n        objectType: objectType,\n        loggedIn: FancyUser.loggedIn,\n        viewerId: viewerUsername\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(MoreShare, [{\n    key: \"setStateSafe\",\n    value: function setStateSafe() {\n      if (this.mounted) {\n        this.setState.apply(this, arguments);\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.mounted = true;\n      this.clickOutside = new ClickOutside({\n        component: this,\n        popupElementRefKey: \"MoreShareEl\"\n      });\n\n      if (this.props.facadeShowShare) {\n        this.handleShareDisplay();\n      }\n\n      if (this.props.facadeShowList) {\n        this.handleMoreShareToggle();\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.mounted = false;\n      this.clickOutside.destroy();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(pp, ps) {\n      var ns = this.state;\n      var showList = ns.showList,\n          showShare = ns.showShare,\n          showMenu = ns.showMenu;\n\n      if (showList || showShare || showMenu) {\n        this.clickOutside.handleAttach(this.closePopup);\n        this.checkViewport();\n\n        if (showShare || showMenu) {\n          getShareURL(this);\n        }\n      }\n\n      if (ns.showMenu !== ps.showMenu && ns.showMenu === false) {\n        this.setState({\n          linkCopied: false\n        });\n        clearTimeout(this.linkCopiedRemovalTimer);\n        this.linkCopiedRemovalTimer = null;\n      }\n    }\n  }, {\n    key: \"shouldShowMerchantCollection\",\n    value: function shouldShowMerchantCollection() {\n      return FancyUser.merchant && FancyUser.active_merchant;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props2 = this.props,\n          title = _this$props2.title,\n          viewerUsername = _this$props2.viewerUsername,\n          _this$props2$componen = _this$props2.componentClass,\n          componentClass = _this$props2$componen === void 0 ? \"menu-container\" : _this$props2$componen,\n          _this$props2$btnClass = _this$props2.btnClass,\n          btnClass = _this$props2$btnClass === void 0 ? \"btn-more\" : _this$props2$btnClass,\n          objectType = _this$props2.objectType,\n          objectMeta = _this$props2.objectMeta,\n          objectId = _this$props2.objectId,\n          _this$props2$showShor = _this$props2.showShortcuts,\n          showShortcuts = _this$props2$showShor === void 0 ? true : _this$props2$showShor,\n          _this$props2$fromThin = _this$props2.fromThingSidebar,\n          fromThingSidebar = _this$props2$fromThin === void 0 ? false : _this$props2$fromThin;\n\n      if (objectType == null) {\n        console.warn(\"objectType is not defined\");\n      }\n\n      var _this$state4 = this.state,\n          showShare = _this$state4.showShare,\n          showList = _this$state4.showList,\n          showMenu = _this$state4.showMenu,\n          headerGap = _this$state4.headerGap,\n          referrerURL = _this$state4.referrerURL,\n          linkCopied = _this$state4.linkCopied,\n          showSellerList = _this$state4.showSellerList;\n      var isThing = objectType === ShareObjectTypes.thing;\n      var isArticle = objectType === ShareObjectTypes.article;\n      var showMerchantList = this.shouldShowMerchantCollection();\n      var merchantId = showMerchantList && showSellerList ? FancyUser.id : null;\n      var newLayout = fromThingSidebar;\n      return /*#__PURE__*/React.createElement(\"em\", {\n        className: classnames(componentClass, \"on-home ignore-ext\", {\n          open: showShare || showList || showMenu\n        }),\n        ref: function ref(el) {\n          _this2.MoreShareEl = el;\n        },\n        \"data-rendered\": \"true\"\n      }, newLayout && /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn-share\",\n        onClick: this.handleShareDisplay\n      }), /*#__PURE__*/React.createElement(\"small\", {\n        className: btnClass,\n        onClick: this.handleMoreShareToggle,\n        ref: function ref(element) {\n          _this2.moreMenuButton = element;\n        }\n      }, /*#__PURE__*/React.createElement(\"em\", null, SharePopover.getShareMessage(objectType, \"Share & Lists\"))), (isThing || isArticle) && /*#__PURE__*/React.createElement(\"small\", {\n        id: \"more-menu\",\n        className: classnames(\"has-arrow menu-content react new\", {\n          opened: showMenu,\n          bot: headerGap && headerGap < 16 + 109\n          /*= tip + bubble*/\n\n        })\n      }, !newLayout && /*#__PURE__*/React.createElement(\"button\", {\n        className: \"share before-bg-share2\",\n        onClick: this.handleShareDisplay\n      }, /*#__PURE__*/React.createElement(\"b\", null, gettext(\"Share item\")), /*#__PURE__*/React.createElement(\"small\", null, gettext(\"Share this with friends\"))), newLayout && /*#__PURE__*/React.createElement(\"button\", {\n        className: \"fancyd-by before-bg-share2\",\n        onClick: this.handleFancydByDisplay\n      }, /*#__PURE__*/React.createElement(\"b\", null, gettext(\"Fancy'd By\")), /*#__PURE__*/React.createElement(\"small\", null, gettext(\"People who fancy'd this\"))), isThing && /*#__PURE__*/React.createElement(\"button\", {\n        className: \"add-list before-bg-share2\",\n        onClick: this.handleListDisplay\n      }, /*#__PURE__*/React.createElement(\"b\", null, gettext(\"Lists\")), /*#__PURE__*/React.createElement(\"small\", null, gettext(\"Add this to your saved lists\"))), showMerchantList && /*#__PURE__*/React.createElement(\"button\", {\n        className: \"add-list before-bg-share2\",\n        onClick: this.handleMerchantListDisplay\n      }, /*#__PURE__*/React.createElement(\"b\", null, gettext(\"Add to Collection\")), /*#__PURE__*/React.createElement(\"small\", null, gettext(\"Save this to your collections\"))), showShortcuts && /*#__PURE__*/React.createElement(\"span\", null, /*#__PURE__*/React.createElement(\"button\", {\n        style: referrerURL ? null : {\n          opacity: 0.7\n        },\n        className: classnames(\"copy-link\"),\n        onClick: this.handleCopyLink\n      }, /*#__PURE__*/React.createElement(\"b\", null, linkCopied ? \"Copied to clipboard\" : \"Item link\"), /*#__PURE__*/React.createElement(\"small\", null, \"Copy link to clipboard\")))), isThing && /*#__PURE__*/React.createElement(AddlistPopover, {\n        key: \"\".concat(objectId, \"-\").concat(merchantId) || \"\".concat(objectId, \"-addlist\"),\n        objectType: objectType,\n        objectId: objectId,\n        showList: showList || showSellerList,\n        merchantId: merchantId,\n        viewerUsername: viewerUsername,\n        handleHide: this.handleHideList,\n        headerGap: headerGap\n      }), /*#__PURE__*/React.createElement(SharePopover, {\n        objectType: objectType,\n        objectId: objectId,\n        objectMeta: objectMeta,\n        showShare: showShare,\n        title: title,\n        referrerURL: this.state.referrerURL,\n        viewerUsername: viewerUsername,\n        headerGap: headerGap,\n        handleHide: this.handleHideShare\n      }));\n    }\n  }]);\n\n  return MoreShare;\n}(Component);","import _extends from \"@babel/runtime/helpers/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from \"react\";\nimport { MoreShare } from \"common-components\";\nexport var MoreShareFacade = /*#__PURE__*/function (_Component) {\n  _inherits(MoreShareFacade, _Component);\n\n  function MoreShareFacade() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MoreShareFacade);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MoreShareFacade)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      share: false,\n      list: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleClickShare\", function () {\n      _this.setState({\n        share: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleClickList\", function () {\n      _this.setState({\n        list: true\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(MoreShareFacade, [{\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          share = _this$state.share,\n          list = _this$state.list;\n      return /*#__PURE__*/React.createElement(React.Fragment, null, !(share || list) && /*#__PURE__*/React.createElement(FakeMoreShare, {\n        onClickShare: this.handleClickShare,\n        onClickAddlist: this.handleClickList\n      }), (share || list) && /*#__PURE__*/React.createElement(MoreShare, _extends({}, this.props, {\n        facadeShowShare: share,\n        facadeShowList: list\n      })));\n    }\n  }]);\n\n  return MoreShareFacade;\n}(Component);\n\nvar FakeMoreShare = /*#__PURE__*/function (_Component2) {\n  _inherits(FakeMoreShare, _Component2);\n\n  function FakeMoreShare() {\n    _classCallCheck(this, FakeMoreShare);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(FakeMoreShare).apply(this, arguments));\n  }\n\n  _createClass(FakeMoreShare, [{\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(\"em\", {\n        className: \"menu-container on-home ignore-ext\",\n        \"data-rendered\": \"true\"\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn-share\",\n        onClick: this.props.onClickShare\n      }), /*#__PURE__*/React.createElement(\"small\", {\n        className: \"btn-more\",\n        onClick: this.props.onClickAddlist\n      }, /*#__PURE__*/React.createElement(\"em\", null, \"Share & Lists\")));\n    }\n  }]);\n\n  return FakeMoreShare;\n}(Component);","export var ShareObjectTypes = {\n  thing: 'thing',\n  list: 'list',\n  store: 'store',\n  user: 'user',\n  article: 'article'\n};\n\nfunction createReferredUrl(viewerUsername, objectId, objectType, objectMeta) {\n  var url;\n\n  if (objectType === ShareObjectTypes.thing) {\n    url = \"https://\".concat(location.hostname, \"/things/\").concat(objectId);\n  } else if (objectType === ShareObjectTypes.article && objectMeta) {\n    url = \"https://\".concat(location.hostname, \"/articles/\").concat(objectMeta.slug);\n  } else {\n    url = location.href.replace(/(#.*)/, ''); // Remove hash\n  }\n\n  if (viewerUsername) {\n    var connector = ~url.indexOf('?') ? '&' : '?';\n    url = \"\".concat(url).concat(connector, \"ref=\").concat(viewerUsername);\n  }\n\n  return url;\n}\n\nexport function getShareURL(component, callback) {\n  if (component.loading || component.state.referrerURL || component.props.referrerURL) {\n    callback && callback(true);\n    return;\n  }\n\n  component.loading = true; // If async loading is needed, assign setState callback.\n\n  var cb = null;\n\n  if (callback) {\n    cb = function cb() {\n      callback(false);\n      component.loading = false;\n    };\n  }\n\n  var _component$props = component.props,\n      viewerUsername = _component$props.viewerUsername,\n      objectId = _component$props.objectId,\n      objectType = _component$props.objectType,\n      objectMeta = _component$props.objectMeta;\n  var originalUrl = createReferredUrl(viewerUsername, objectId, objectType, objectMeta);\n  $.post('/get_short_url.json', {\n    url: originalUrl\n  }).done(function (res) {\n    component.setState({\n      referrerURL: res.short_url\n    }, cb);\n  }).fail(function () {\n    component.setState({\n      referrerURL: originalUrl\n    }, cb);\n    console.warn('/get_short_url failed');\n  });\n}","import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React from \"react\";\nimport classnames from \"classnames\";\nimport { FancyUser, renderPopup, isPlainLeftClick } from \"fancyutils\";\nimport { ShareObjectTypes } from './MoreShareUtils';\nexport var FancydPerson = /*#__PURE__*/function (_React$Component) {\n  _inherits(FancydPerson, _React$Component);\n\n  function FancydPerson(props) {\n    var _this;\n\n    _classCallCheck(this, FancydPerson);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(FancydPerson).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleFollow\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n      var user = _this.props.user;\n      var _this$state = _this.state,\n          following = _this$state.following,\n          loading = _this$state.loading;\n\n      if (_this.props.loggedIn !== true) {\n        window.require_login();\n        return;\n      }\n\n      if (loading) {\n        return;\n      }\n\n      var url = following ? \"/delete_follow.xml\" : \"/add_follow.xml\";\n\n      _this.setState({\n        loading: true\n      }, function () {\n        $.ajax({\n          type: \"post\",\n          url: url,\n          data: {\n            user_id: user.id\n          },\n          dataType: \"xml\"\n        }).done(function (xml) {\n          var nextFollowing = !following;\n          var $status = $(xml).find(\"status_code\");\n\n          if ($status.length && $status.text() !== 0) {\n            _this.setState({\n              following: nextFollowing\n            });\n          }\n        }).always(function () {\n          _this.setState({\n            loading: false\n          });\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleTransition\", function (event) {\n      if (isPlainLeftClick(event)) {\n        var href = event.currentTarget.getAttribute(\"href\");\n\n        if (href) {\n          location.href = href;\n        }\n      }\n    });\n\n    _this.state = {\n      loading: false,\n      following: false\n    };\n    return _this;\n  }\n\n  _createClass(FancydPerson, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var following = this.props.following || this.props.user.following;\n\n      if (following) {\n        this.setState({\n          following: following\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          user = _this$props.user,\n          isAddedUser = _this$props.isAddedUser,\n          viewerId = _this$props.viewerId;\n      var following = this.state.following;\n      return /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"a\", {\n        href: \"/\".concat(user.username),\n        className: \"username\",\n        onClick: this.handleTransition\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: \"/_ui/images/common/blank.gif\",\n        style: {\n          backgroundImage: \"url(\".concat(user.image_url || user.user_square_image_small, \")\")\n        }\n      }), isAddedUser ? \"Added by \" : \"\", /*#__PURE__*/React.createElement(\"b\", null, user.fullname || user.full_name), isAddedUser ? \"\" : \"@\".concat(user.username)), viewerId !== user.id && /*#__PURE__*/React.createElement(\"button\", {\n        className: classnames(\"btns-gray-embo\", following ? \"following\" : \"follow\"),\n        onClick: this.handleFollow\n      }));\n    }\n  }]);\n\n  return FancydPerson;\n}(React.Component);\nexport var FancydByPopup = /*#__PURE__*/function (_React$Component2) {\n  _inherits(FancydByPopup, _React$Component2);\n\n  function FancydByPopup(props) {\n    var _this2;\n\n    _classCallCheck(this, FancydByPopup);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(FancydByPopup).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this2), \"handleMore\", function (event) {\n      event.preventDefault();\n\n      _this2.getFollowList();\n    });\n\n    _this2.state = _this2._getInitialState();\n    return _this2;\n  }\n\n  _createClass(FancydByPopup, [{\n    key: \"_getInitialState\",\n    value: function _getInitialState() {\n      return {\n        loading: false,\n        nextPage: 1,\n        ended: null,\n        added_user: null,\n        users: [],\n        owner: null\n      };\n    }\n  }, {\n    key: \"getFollowList\",\n    value: function getFollowList(nextProps, reset) {\n      var _this3 = this;\n\n      var _ref = nextProps || this.props,\n          objectId = _ref.objectId,\n          objectType = _ref.objectType;\n\n      var nextPage = this.state.nextPage;\n      var immediateNextStateUpdate;\n\n      if (reset) {\n        immediateNextStateUpdate = this._getInitialState();\n        immediateNextStateUpdate.loading = true;\n      } else {\n        immediateNextStateUpdate = {\n          loading: true\n        };\n      }\n\n      if (reset || this.state.loading !== true && this.state.ended !== true) {\n        this.setState(immediateNextStateUpdate, function () {\n          if (objectType === ShareObjectTypes.thing) {\n            $.get(\"/thing_follower_list.json\", {\n              thing_id: objectId,\n              page: nextPage\n            }, function (_ref2) {\n              var has_next = _ref2.has_next,\n                  users = _ref2.users,\n                  owner = _ref2.owner;\n              var nextState = {\n                loading: false,\n                users: _this3.state.users.concat(users),\n                owner: owner\n              };\n\n              if (has_next) {\n                nextState.nextPage = _this3.state.nextPage + 1;\n                nextState.ended = false;\n              } else {\n                nextState.ended = true;\n              }\n\n              _this3.setState(nextState);\n            }).fail(function () {\n              _this3.setState({\n                loading: false\n              });\n            });\n          } else if (objectType === ShareObjectTypes.article) {\n            $.get(\"/rest-api/v1/articles/\".concat(objectId, \"/saved_users\"), {\n              page: nextPage\n            }, function (_ref3) {\n              var max_page = _ref3.max_page,\n                  current_page = _ref3.current_page,\n                  saved_users = _ref3.saved_users;\n              var users = saved_users;\n              var has_next = max_page > current_page;\n              var nextState = {\n                loading: false,\n                users: _this3.state.users.concat(users),\n                owner: null\n              };\n\n              if (has_next) {\n                nextState.nextPage = _this3.state.nextPage + 1;\n                nextState.ended = false;\n              } else {\n                nextState.ended = true;\n              }\n\n              _this3.setState(nextState);\n            }).fail(function () {\n              _this3.setState({\n                loading: false\n              });\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getFollowList();\n      this.__last_tid = this.props.objectId;\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(nextProps) {\n      if (this.__last_tid !== nextProps.objectId) {\n        this.__last_tid = nextProps.objectId;\n        this.getFollowList(nextProps, true);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state2 = this.state,\n          ended = _this$state2.ended,\n          users = _this$state2.users,\n          owner = _this$state2.owner;\n      var _this$props2 = this.props,\n          loggedIn = _this$props2.loggedIn,\n          viewerId = _this$props2.viewerId;\n      return /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"p\", {\n        className: \"ltit\"\n      }, gettext(\"Fancy'd by\")), /*#__PURE__*/React.createElement(\"ul\", null, owner ? /*#__PURE__*/React.createElement(FancydPerson, {\n        user: owner,\n        isAddedUser: true,\n        viewerId: viewerId,\n        loggedIn: loggedIn\n      }) : null, users.map(function (user, idx) {\n        return /*#__PURE__*/React.createElement(FancydPerson, {\n          key: \"FancydBy-\".concat(idx),\n          user: user,\n          viewerId: viewerId,\n          loggedIn: loggedIn\n        });\n      }), ended === false && /*#__PURE__*/React.createElement(\"li\", {\n        className: \"more\"\n      }, /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handleMore\n      }, gettext(\"View More\")))), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"ly-close\",\n        title: \"Close\"\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"ic-del-black\"\n      })));\n    }\n  }]);\n\n  return FancydByPopup;\n}(React.Component);\n\n_defineProperty(FancydByPopup, \"popupName\", \"fancyd_list\");\n\nvar onLoad = function onLoad() {\n  $(document.body).on(\"click\", \".buttons .fancyd_user\", function () {\n    if ($(this).closest('#overlay-thing').length > 0) {\n      return true;\n    }\n\n    var $container = $(this).closest(\".buttons\");\n    var objectId = $container.find(\".fancy, .fancyd\").attr(\"tid\");\n    var objectType = 'thing';\n\n    if (objectId) {\n      renderPopup(FancydByPopup, {\n        objectId: objectId,\n        objectType: objectType,\n        loggedIn: FancyUser.loggedIn,\n        viewerId: FancyUser.id\n      });\n      return false;\n    }\n  });\n};\n\nif (document.readyState !== 'loading') {\n  onLoad();\n} else {\n  document.addEventListener(\"DOMContentLoaded\", onLoad);\n}","// fork of recommend-slide (accacb79d2af557369e02132ef5f486d226aa5d3)\nexport default function applyProductSlide() {\n  $(function () {\n    var mWidth = 920;\n\n    function initSlide($el, option) {\n      var $slide;\n\n      if ($el.is('.itemSlide, .slideshow')) {\n        $slide = $el;\n      } else {\n        $slide = $el.find(\".itemSlide, .slideshow\");\n      }\n\n      $slide.data('slideInit', true);\n      var $list = $el.find(\"ul\"),\n          $li = $list.find(\"li\"),\n          itemWidth = $li.width() + 20,\n          $prev = $el.find(\"a.prev\"),\n          $next = $el.find(\"a.next\");\n      var slideWidth = null;\n      if (option.itemPerSlide) slideWidth = itemWidth * option.itemPerSlide;\n\n      function resetRecommend() {\n        if (!$slide || !$li) {\n          $el.css(\"visibility\", \"visible\");\n          return;\n        }\n\n        if (slideWidth && slideWidth > itemWidth * $li.length) {\n          $el.css(\"visibility\", \"visible\");\n          return;\n        }\n\n        if ($(window).width() < mWidth) {\n          if (option.center) {\n            $slide.find(\".itemList\").scrollLeft(($li.length * 147 - $(window).width() + 20) / 2);\n          }\n\n          $prev.removeClass(\"disabled\");\n          $next.removeClass(\"disabled\");\n        } else {\n          if ($slide.width() > itemWidth * $li.length) {\n            $prev.addClass(\"disabled\");\n            $next.addClass(\"disabled\");\n\n            if (option.center) {\n              $slide.find(\".itemList\").css(\"left\", \"0px\");\n            }\n          } else {\n            if (option.center) {\n              $slide.find(\".itemList\").css(\"left\", -parseInt(($li.length * 285 - $(window).width() + 20) / 2) + \"px\");\n            }\n\n            $prev.removeClass(\"disabled\");\n            $next.removeClass(\"disabled\");\n          }\n        }\n\n        $el.css(\"visibility\", \"visible\");\n      }\n\n      function getPrevLeft($el) {\n        preparePrev();\n        var left = Math.abs(parseInt($list.css(\"left\"))),\n            nextLeft,\n            width = $slide.width();\n        if (slideWidth) width = slideWidth;\n        nextLeft = left - width;\n        return nextLeft;\n      }\n\n      function getNextLeft($el) {\n        prepareNext();\n        var left = Math.abs(parseInt($list.css(\"left\"))),\n            nextLeft,\n            width = $slide.width();\n        if (slideWidth) width = slideWidth;\n        nextLeft = left + width;\n        return nextLeft;\n      }\n\n      function preparePrev() {\n        var $li = $list.find(\"li\"),\n            left = Math.abs(parseInt($list.css(\"left\"))),\n            width = $slide.width(),\n            itemWidth = $li.width() + 20;\n        if (slideWidth) width = slideWidth;\n\n        if (left < width) {\n          var prepareCount = Math.ceil(Math.abs(width - left) / itemWidth);\n\n          for (var i = 0; i < prepareCount; i++) {\n            var $el = $list.find(\"li:not([_prev])\").last();\n            $el.clone().insertBefore($list.find(\"li\").first());\n            $el.attr(\"_prev\", true);\n          }\n\n          $list.css(\"left\", 0 - left - prepareCount * itemWidth + \"px\");\n        }\n      }\n\n      function prepareNext() {\n        var $li = $list.find(\"li\"),\n            left = Math.abs(parseInt($list.css(\"left\"))),\n            width = $slide.width(),\n            listWidth = $li.length * ($li.width() + 20),\n            itemWidth = $li.width() + 20,\n            spare = listWidth - (left + width);\n        if (slideWidth) width = slideWidth;\n\n        if (spare - width < width) {\n          var prepareCount = Math.ceil(Math.abs(width - (listWidth - (left + width))) / itemWidth);\n\n          for (var i = 0; i < prepareCount; i++) {\n            var $el = $list.find(\"li:not([_next])\").first();\n            $el.clone().insertAfter($list.find(\"li\").last());\n            $el.attr(\"_next\", true);\n          }\n        }\n      }\n\n      function clearOld() {\n        var $li = $list.find(\"li\"),\n            left = Math.abs(parseInt($list.css(\"left\"))),\n            itemWidth = $li.width() + 20,\n            $prev = $list.find(\"li[_next]:not(:in-viewport)\"),\n            prevCnt = $prev.length;\n        $list.find(\"li[_prev]:not(:in-viewport)\").remove();\n        $prev.remove();\n        $list.css(\"left\", 0 - left + prevCnt * itemWidth + \"px\");\n      }\n\n      resetRecommend();\n\n      if (slideWidth && slideWidth > itemWidth * $li.length) {\n        $prev.hide();\n        $next.hide();\n      }\n\n      $el.on(\"click\", \"a.prev\", function (e) {\n        e.preventDefault();\n        var $this = $(this);\n        if ($this.hasClass(\"_disabled\")) return;\n        var left = getPrevLeft($el);\n        $this.addClass(\"_disabled\");\n        $list.animate({\n          left: 0 - left + \"px\"\n        }, 300, \"easeInOutExpo\", function () {\n          clearOld();\n          $this.removeClass(\"_disabled\");\n        });\n      }).on(\"click\", \"a.next\", function (e) {\n        e.preventDefault();\n        var $this = $(this);\n        if ($this.hasClass(\"_disabled\")) return;\n        var left = getNextLeft($el);\n        $this.addClass(\"_disabled\");\n        $list.animate({\n          left: 0 - left + \"px\"\n        }, 300, \"easeInOutExpo\", function () {\n          clearOld();\n          $this.removeClass(\"_disabled\");\n        });\n      });\n    }\n\n    $.fn.productSlide = function (option) {\n      var option = option || {\n        center: true\n      };\n      var self = this;\n      var $slides = this.each(function () {\n        var $el = $(this);\n        initSlide($el, option);\n      });\n      return $slides;\n    };\n  });\n}","import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React from 'react';\nimport classnames from 'classnames';\nimport { FancyUser, debounceUntilTimeout, MP, getDisplay, triggerEvent, alertify } from 'fancyutils';\nimport { ShareObjectTypes, getShareURL } from './MoreShareUtils';\nimport { Display } from 'fancymixin';\nvar SNSDict = {\n  \"fb\": \"Facebook\",\n  \"tw\": \"Twitter\",\n  \"tb\": \"Tumblr\"\n};\nvar followingUsers = [];\nvar followingUsersRequested = false;\nvar ViewClasses = {\n  Success: 'empty success',\n  Default: 'empty default',\n  Searching: 'empty searching',\n  NoResult: 'empty no-result'\n};\nexport var SharePopover = /*#__PURE__*/function (_React$Component) {\n  _inherits(SharePopover, _React$Component);\n\n  function SharePopover(props) {\n    var _this;\n\n    _classCallCheck(this, SharePopover);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SharePopover).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      friendSearchQuery: '',\n      searchedFriends: [],\n      selectedUserID: null,\n      sentUser: null,\n      sendNote: '',\n      sendSuccess: false,\n      searching: false,\n      isContact: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"mailUser\", {\n      id: 'EMAIL',\n      type: 'email',\n      profile_image_url: '/_ui/images/common/blank.gif',\n      fullname: 'Email',\n\n      /* mut */\n      username: null\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleContinue\", function (event) {\n      event.preventDefault();\n\n      _this.clearFriendList();\n\n      if (_this.props.handleHide) {\n        _this.props.handleHide();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleFriendSearch\", function (event) {\n      var friendSearchQuery = event.target.value;\n      var prevQuery = _this.state.friendSearchQuery;\n\n      _this.setState({\n        friendSearchQuery: friendSearchQuery,\n        sendSuccess: false,\n        searching: true\n      }, function () {\n        _this.searchFriends(prevQuery, friendSearchQuery);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSend\", function () {\n      var _this$state = _this.state,\n          sendNote = _this$state.sendNote,\n          selectedUserID = _this$state.selectedUserID,\n          searchedFriends = _this$state.searchedFriends;\n      var _this$props = _this.props,\n          title = _this$props.title,\n          referrerURL = _this$props.referrerURL;\n\n      if (_this.sending) {\n        return;\n      }\n\n      var isMailuser = selectedUserID === _this.mailUser.id;\n\n      if (isMailuser) {\n        _this.handleSendMail();\n\n        return;\n      } else if (searchedFriends.length === 0 || selectedUserID == null) {\n        return;\n      }\n\n      var objectType = _this.props.objectType;\n      var params;\n\n      if (objectType === ShareObjectTypes.thing) {\n        params = {\n          things: _this.props.objectId,\n          user_id: selectedUserID\n        };\n      } else {\n        params = {\n          user_id: selectedUserID,\n          message: \"\".concat(title, \" \").concat(referrerURL)\n        };\n      }\n\n      _this.sending = true;\n\n      if ($.trim(sendNote)) {\n        params.message += ' ' + $.trim(sendNote);\n      }\n\n      $.post('/messages/send-message.json', params).done(function (json) {\n        if (json.status_code !== 1) {\n          if (json.message) {\n            alertify.alert(json.message);\n          } else {\n            alertify.alert(\"There was an error while sending message. Please try again.\");\n          }\n\n          return;\n        }\n\n        _this.clearFriendList({\n          sendSuccess: true,\n          sentUserID: selectedUserID,\n          selectedUserID: null\n        }, ['searchedFriends']);\n\n        MP('Complete Share', {\n          \"thing id\": params.things,\n          \"type\": \"FancyMessage\"\n        });\n      }).fail(function (xhr) {\n        console.warn(xhr);\n      }).always(function () {\n        _this.sending = false;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSendMail\", function () {\n      if (_this.sending) {\n        return;\n      }\n\n      if (_this.props.objectType == null) {\n        console.warn('objectType should be provided.');\n      }\n\n      var object_type = _this.props.objectType || 'thing';\n\n      var email_address = _this.mailUser.username.trim();\n\n      var object_id = _this.props.objectId;\n      _this.sending = true;\n      var params = {\n        email_address: email_address,\n        object_type: object_type,\n        object_id: object_id\n      };\n      var message = $.trim(_this.state.sendNote);\n\n      if (message) {\n        params.message = message;\n      }\n\n      if (_this.props.objectMeta && _this.props.objectMeta.type === 'shoplist') {\n        params.object_meta = _this.props.objectMeta.type;\n      }\n\n      $.post('/messages/send-email.json', params).done(function (json) {\n        if (json.status_code !== 1) {\n          if (json.message) {\n            alertify.alert(json.message);\n          } else {\n            alertify.alert(\"There was an error while sending message. Please try again.\");\n          }\n\n          return;\n        }\n\n        _this.clearFriendList({\n          sendSuccess: true,\n          sentUserID: params.email_address,\n          selectedUserID: null\n        });\n\n        MP('Complete Share', {\n          \"object id\": params.object_id,\n          \"object type\": params.object_type,\n          \"type\": \"Email\"\n        });\n      }).fail(function (xhr) {\n        var responseObject = null;\n\n        try {\n          responseObject = JSON.parse(xhr.responseText);\n        } catch (e) {}\n\n        if (responseObject && responseObject.message) {\n          alertify.alert(responseObject.message);\n        } else {\n          alertify.alert(\"Error occured. please try again.\\n\" + xhr.status + ' ' + xhr.statusText);\n        }\n\n        console.warn(xhr);\n      }).always(function () {\n        _this.sending = false;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"clearFriendList\", function (additionals, excludes) {\n      // remove search history for users\n      var nextState = _.extend({\n        friendSearchQuery: '',\n        searchedFriends: [],\n        sendNote: '',\n        sendSuccess: false,\n        sentUserID: null\n      }, additionals);\n\n      if (excludes) {\n        excludes.forEach(function (excludeKey) {\n          delete nextState[excludeKey];\n          nextState[excludeKey] = _this.state[excludeKey];\n        });\n      }\n\n      _this.setState(nextState);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSendNoteInput\", function (event) {\n      var sendNote = event.target.value;\n\n      _this.setState({\n        sendNote: sendNote\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleUserSelect\", function (event) {\n      event.preventDefault();\n      var selectedUserID = _this.state.selectedUserID;\n      var nextID = $(event.currentTarget).attr('data-userid'); // Canceling\n\n      if (String(selectedUserID) === $(event.currentTarget).attr('data-userid')) {\n        _this.setState({\n          selectedUserID: null\n        }); // Selecting\n\n      } else {\n        _this.setState({\n          selectedUserID: nextID\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getSelectedUser\", function () {\n      var selectedUserID = _this.state.selectedUserID;\n      return _.find(_this.getSearchedFriends(), function (e) {\n        return String(e.id) === selectedUserID;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getSentUser\", function () {\n      var sentUserID = _this.state.sentUserID;\n      return _.find(_this.getSearchedFriends(), function (e) {\n        return String(e.id) === sentUserID;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getDisplayUsers\", function () {\n      if (followingUsersRequested) {\n        return;\n      }\n\n      _this.loadingDisplayUsers = true;\n      followingUsersRequested = true;\n      $.get('/get-share-display-users.json').done(function (res) {\n        if (res.status_code === 1 && res.users.length > 0) {\n          followingUsers.push.apply(followingUsers, res.users);\n        }\n      }).fail(function () {\n        console.warn('failed to fetch display users');\n      }).always(function () {\n        _this.loadingDisplayUsers = false;\n\n        _this.forceUpdate();\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleClickBackFromContact\", function () {\n      _this.setState({\n        isContact: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleClickContactImport\", function (event) {\n      event.preventDefault();\n\n      _this.setState({\n        isContact: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getSharedMailUser\", function () {\n      var friendSearchQuery = _this.state.friendSearchQuery;\n      _this.mailUser.username = friendSearchQuery;\n      return [_this.mailUser];\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getSearchedFriends\", function () {\n      if (_this.state.friendSearchQuery.length !== 0 || _this.state.sendSuccess) {\n        if (_this.isInputEmail()) {\n          return _this.getSharedMailUser();\n        } else {\n          return _this.state.searchedFriends;\n        }\n      } else {\n        return followingUsers;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isInputEmail\", function () {\n      var friendSearchQuery = _this.state.friendSearchQuery;\n      return friendSearchQuery.length > 1 && friendSearchQuery.indexOf('@') > 0;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isEmailOnlyMode\", function () {\n      return !(_this.props.objectType === ShareObjectTypes.thing || _this.props.objectType === ShareObjectTypes.article) || !FancyUser.loggedIn;\n    });\n\n    _this.searchFriends = debounceUntilTimeout(function searchFriends(prevQuery, friendSearchQuery) {\n      var _this2 = this;\n\n      if (this.isEmailOnlyMode()) {\n        this.setState({\n          searching: false\n        });\n        return;\n      }\n\n      var term = $.trim(friendSearchQuery);\n\n      if ($.trim(prevQuery) === term) {\n        return;\n      }\n\n      if (term === '') {\n        this.setState({\n          searchedFriends: [],\n          selectedUserID: null\n        });\n        return;\n      }\n\n      this.setState({\n        searching: true\n      }, function () {\n        $.get('/search-users.json', {\n          term: term,\n          filter_messages_permission: true\n        }).done(function (searchedFriends) {\n          var nextState = {\n            searching: false\n          };\n\n          if (_this2.state.friendSearchQuery === friendSearchQuery) {\n            nextState.searchedFriends = searchedFriends;\n            nextState.selectedUserID = null;\n          }\n\n          _this2.setState(nextState);\n        });\n      });\n    }, 200, _assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(SharePopover, [{\n    key: \"getPrefix\",\n    value: function getPrefix(user) {\n      return user.type === 'email' ? '' : '@';\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var showShare = this.props.showShare;\n      var isContact = this.state.isContact; // share is closed, if contact mode close it.\n\n      if (isContact && !showShare && prevProps.showShare !== showShare) {\n        this.setState({\n          isContact: false\n        });\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // Do loading friends stuff.\n      if (!this.isEmailOnlyMode()) {\n        this.getDisplayUsers();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$props2 = this.props,\n          showShare = _this$props2.showShare,\n          title = _this$props2.title,\n          headerGap = _this$props2.headerGap,\n          objectType = _this$props2.objectType,\n          objectId = _this$props2.objectId,\n          objectMeta = _this$props2.objectMeta,\n          viewerUsername = _this$props2.viewerUsername,\n          referrerURL = _this$props2.referrerURL;\n\n      if (process.env.NODE_ENV !== 'production') {\n        viewerUsername == null && console.warn('SharePopover: viewerUsername missing');\n      }\n\n      var _this$state2 = this.state,\n          friendSearchQuery = _this$state2.friendSearchQuery,\n          sendNote = _this$state2.sendNote,\n          sendSuccess = _this$state2.sendSuccess,\n          sentUserID = _this$state2.sentUserID,\n          searching = _this$state2.searching,\n          isContact = _this$state2.isContact;\n      var searchedFriends = this.getSearchedFriends();\n      var selectedUser = this.getSelectedUser();\n      var sentUser = this.getSentUser();\n      var emptyDisplay = Display.Block;\n      var emptyClassName;\n      var searchedFriendsDisplay;\n      var inputIsEmail = this.isInputEmail();\n      var emailOnlyMode = this.isEmailOnlyMode(); // Search returns nothing\n\n      if (sendSuccess) {\n        emptyClassName = ViewClasses.Success;\n      } else {\n        if (emailOnlyMode && !inputIsEmail) {\n          emptyClassName = ViewClasses.Default;\n        } else if (searchedFriends.length > 0) {\n          if (!inputIsEmail && searching) {\n            emptyClassName = ViewClasses.Searching;\n          }\n        } else if (searchedFriends.length === 0) {\n          if (friendSearchQuery.length === 0) {\n            if (this.loadingDisplayUsers) {\n              emptyClassName = ViewClasses.Searching;\n            } else {\n              emptyClassName = ViewClasses.Default;\n            }\n          } else {\n            if (searching) {\n              emptyClassName = ViewClasses.Searching;\n            } else {\n              emptyClassName = ViewClasses.NoResult;\n            }\n          }\n        }\n      }\n\n      if (emptyClassName) {\n        searchedFriendsDisplay = Display.None;\n      } else {\n        emptyDisplay = Display.None;\n      }\n\n      if (selectedUser) {\n        searchedFriendsDisplay = Display.None;\n      }\n\n      var noteSendable = !this.sending && searchedFriends.length > 0 && !!selectedUser; // Sliding indicator style\n\n      var isSNS = !(selectedUser || sendSuccess);\n      var sentMessage = '';\n\n      if (sendSuccess) {\n        sentMessage += gettext(\"Sent to \");\n        sentMessage += sentUser ? sentUser.fullname || sentUser.username : sentUserID;\n      }\n\n      var bottom = false;\n\n      if (headerGap < 290) {\n        bottom = true;\n      }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        id: \"show-share\",\n        className: classnames(\"more-share-popup more-share-popup-2 has-arrow\", {\n          bot: bottom\n        }),\n        style: getDisplay(showShare)\n      }, /*#__PURE__*/React.createElement(\"h3\", {\n        className: \"tit\",\n        style: Display.NoneIf(isContact || selectedUser)\n      }, SharePopover.getShareMessage(objectType, 'Share')), /*#__PURE__*/React.createElement(\"a\", {\n        className: \"btn-back\",\n        style: Display.NoneIf(!selectedUser || sentUser),\n        onClick: function onClick() {\n          _this3.setState({\n            selectedUserID: null\n          });\n\n          return false;\n        }\n      }, \"Back\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"frm\",\n        style: Display.NoneIf(isContact)\n      }, FancyUser.loggedIn && /*#__PURE__*/React.createElement(\"div\", {\n        id: \"more-share-send\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"textbox before-bg-share2\",\n        style: Display.NoneIf(selectedUser || sendSuccess)\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        id: \"more-share-email\",\n        className: \"text\",\n        type: \"text\",\n        placeholder: emailOnlyMode ? gettext(\"Enter email address\") : gettext(\"Username or email address\"),\n        autoComplete: \"off\",\n        onChange: this.handleFriendSearch,\n        value: friendSearchQuery\n      })), /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"lists\",\n        style: searchedFriendsDisplay\n      }, searchedFriends.map(function (user, idx) {\n        var term = $.trim(friendSearchQuery).toLowerCase();\n\n        var prefix = _this3.getPrefix(user);\n\n        var style;\n\n        if (term) {\n          if (\"\".concat(user.fullname, \" \").concat(prefix).concat(user.username).toLowerCase().indexOf(term) === -1) {\n            style = Display.None;\n          }\n        }\n\n        var username;\n        var imgClass;\n\n        if (user.type === 'email') {\n          username = user.username;\n          imgClass = 'email';\n        } else {\n          username = \"\".concat(prefix).concat(user.username);\n        }\n\n        return /*#__PURE__*/React.createElement(\"li\", {\n          key: idx,\n          style: style\n        }, /*#__PURE__*/React.createElement(\"a\", {\n          className: \"before-bg-share2\",\n          onClick: _this3.handleUserSelect,\n          \"data-userid\": user.id\n        }, /*#__PURE__*/React.createElement(\"img\", {\n          alt: \"\",\n          className: imgClass,\n          src: user.profile_image_url\n        }), /*#__PURE__*/React.createElement(\"b\", null, user.fullname), /*#__PURE__*/React.createElement(\"small\", null, username)));\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: emptyClassName,\n        style: emptyDisplay\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"circle bg-share2\"\n      }), emailOnlyMode ? /*#__PURE__*/React.createElement(\"span\", {\n        className: \"default\"\n      }, gettext(\"Share this via Email\")) : /*#__PURE__*/React.createElement(\"span\", {\n        className: \"default\"\n      }, /*#__PURE__*/React.createElement(\"b\", null, gettext(\"Find people to share with\")), /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handleClickContactImport\n      }, gettext(\"Import from contacts\"))), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"searching\"\n      }, gettext(\"Searching...\")), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"no-result\"\n      }, gettext(\"No users found\")), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"success\"\n      }, /*#__PURE__*/React.createElement(\"b\", null, gettext(\"Success!\")), sentMessage, /*#__PURE__*/React.createElement(\"a\", {\n        className: \"close\",\n        onClick: this.handleContinue\n      }, gettext(\"Continue\")))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"send\",\n        style: Display.NoneIf(selectedUser == null)\n      }, selectedUser && /*#__PURE__*/React.createElement(\"span\", {\n        className: \"recipient\"\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        alt: \"user image\",\n        className: selectedUser.type === 'email' && 'email',\n        src: selectedUser.profile_image_url\n      }), /*#__PURE__*/React.createElement(\"b\", null, selectedUser.fullname), /*#__PURE__*/React.createElement(\"small\", null, this.getPrefix(selectedUser), selectedUser.username)), /*#__PURE__*/React.createElement(\"fieldset\", null, /*#__PURE__*/React.createElement(\"textarea\", {\n        placeholder: \"Add a message\",\n        value: sendNote,\n        onChange: this.handleSendNoteInput\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn-send\",\n        disabled: !noteSendable,\n        onClick: this.handleSend\n      }, \"Send\")))), /*#__PURE__*/React.createElement(SNSShareBox, {\n        showShareBox: isSNS,\n        title: title,\n        referrerURL: referrerURL,\n        objectId: objectId,\n        objectType: objectType,\n        objectMeta: objectMeta,\n        viewerUsername: viewerUsername\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"contact-sns\",\n        style: Display.NoneIf(!isContact)\n      }, /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handleClickBackFromContact,\n        className: \"back\"\n      }, \"Back\"), /*#__PURE__*/React.createElement(\"a\", {\n        href: \"/find-friends\",\n        className: \"fb\",\n        target: \"_blank\"\n      }, /*#__PURE__*/React.createElement(\"em\", null, \" Facebook\")), /*#__PURE__*/React.createElement(\"a\", {\n        href: \"/find-friends?type=twitter\",\n        className: \"tw\",\n        target: \"_blank\"\n      }, /*#__PURE__*/React.createElement(\"em\", null, \" Twitter\")), /*#__PURE__*/React.createElement(\"a\", {\n        href: \"/find-friends?type=gmail\",\n        className: \"gm\",\n        target: \"_blank\"\n      }, /*#__PURE__*/React.createElement(\"em\", null, \" Gmail\"))));\n    }\n  }], [{\n    key: \"getShareMessage\",\n    value: function getShareMessage(objectType) {\n      var defaultMessage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n      var shareMessage = defaultMessage;\n\n      if (objectType === ShareObjectTypes.list) {\n        shareMessage = 'Share collection';\n      } else if (objectType === ShareObjectTypes.store) {\n        shareMessage = 'Share store';\n      } else if (objectType === ShareObjectTypes.user) {\n        shareMessage = 'Share profile';\n      } else if (objectType === ShareObjectTypes.article) {\n        shareMessage = 'Share article';\n      }\n\n      return shareMessage;\n    }\n  }]);\n\n  return SharePopover;\n}(React.Component);\nexport var SNSShareBox = /*#__PURE__*/function (_React$Component2) {\n  _inherits(SNSShareBox, _React$Component2);\n\n  function SNSShareBox() {\n    var _getPrototypeOf2;\n\n    var _this4;\n\n    _classCallCheck(this, SNSShareBox);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this4 = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(SNSShareBox)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this4), \"state\", {\n      copied: false,\n      referrerURL: '',\n      textboxDisplay: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this4), \"loading\", false);\n\n    _defineProperty(_assertThisInitialized(_this4), \"snsShareWindow\", null);\n\n    _defineProperty(_assertThisInitialized(_this4), \"handleEmbed\", function () {\n      var _assertThisInitialize = _assertThisInitialized(_this4),\n          updateEmbedOption = _assertThisInitialize.updateEmbedOption,\n          _assertThisInitialize2 = _assertThisInitialize.props,\n          objectType = _assertThisInitialize2.objectType,\n          objectId = _assertThisInitialize2.objectId,\n          viewerUsername = _assertThisInitialize2.viewerUsername;\n\n      if (objectType === ShareObjectTypes.thing) {\n        var $ep = $(\"#embed_popup\");\n        $ep.off('click.fancyembed').off('keyup.fancyembed').on('click.fancyembed', 'input[name=\"embed-info\"]', function () {\n          updateEmbedOption($(\"#embed_popup\"), viewerUsername);\n        }).on('keyup.fancyembed', 'input[name=\"embed-width\"]', function () {\n          updateEmbedOption($(\"#embed_popup\"), viewerUsername);\n        });\n        $ep.find('.customize').removeClass('opened');\n        $ep.find('input[name=\"embed-info\"]').prop('checked', true);\n        $ep.find('input[name=\"embed-width\"]').val(450);\n        $ep.attr('tid', objectId);\n        updateEmbedOption($(\"#embed_popup\"), viewerUsername);\n        $.dialog(\"embed_item\").open(true);\n      }\n\n      return false;\n    });\n\n    _defineProperty(_assertThisInitialized(_this4), \"handleShare\", function (event) {\n      var _assertThisInitialize3 = _assertThisInitialized(_this4),\n          _assertThisInitialize4 = _assertThisInitialize3.props,\n          objectId = _assertThisInitialize4.objectId,\n          objectType = _assertThisInitialize4.objectType;\n\n      var element = event.currentTarget; // redirect to acquired URL using blank window, which does not blocked by blocker usually.\n      // Low possiblity, but if assign fails with DOMException, silently pass so\n      // user can retry without confusion.\n\n      if (event.detail && event.detail.faintClick) {\n        try {\n          _this4.snsShareWindow.location.assign(element.getAttribute('href'));\n        } catch (e) {} // Remove disposable window \n\n\n        _this4.snsShareWindow = null;\n        return;\n      } else {\n        if (!_this4.getRefURL()) {\n          _this4.snsShareWindow = window.open('about:blank', '_fancy_sns_share');\n        }\n\n        event.preventDefault();\n      }\n\n      getShareURL(_assertThisInitialized(_this4), function (directClick) {\n        if (directClick) {\n          window.open(element.getAttribute('href'), '_fancy_sns_share');\n        } else {\n          triggerEvent(element, 'click', {\n            faintClick: true\n          });\n        }\n      });\n\n      if (objectType === ShareObjectTypes.thing) {\n        var type = SNSDict[element.className];\n        MP('Complete Share', {\n          \"thing id\": objectId,\n          type: type\n        });\n      }\n    });\n\n    return _this4;\n  }\n\n  _createClass(SNSShareBox, [{\n    key: \"getRefURL\",\n    value: function getRefURL() {\n      return this.state.referrerURL || this.props.referrerURL;\n    }\n  }, {\n    key: \"updateEmbedOption\",\n    value: function updateEmbedOption($li, viewerUsername) {\n      var $thumb = $li.find('.embed-thum');\n      var $options = $li.find('input[name=\"embed-info\"]');\n      var types = [];\n      $options.each(function () {\n        var value = this.value,\n            checked = this.checked;\n\n        if (checked) {\n          $thumb.addClass(value);\n          types.push(value);\n        } else {\n          $thumb.removeClass(value);\n        }\n      });\n      var width = parseInt($li.find('input[name=\"embed-width\"]').val(), 10) || undefined;\n      var snippet = $('<script />', {\n        'src': \"//\".concat(location.hostname, \"/embed.js?v=150608\"),\n        'async': true,\n        'class': 'fancy-embed',\n        'data-id': $li.attr('tid') || $li.attr('objectId') || '',\n        'data-ref': viewerUsername,\n        'data-type': types.length > 0 ? types.join(',') : '',\n        'data-width': width\n      }).prop('outerHTML');\n      $li.find('textarea[name=\"embed-code\"]').val(snippet);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props3 = this.props,\n          title = _this$props3.title,\n          showShareBox = _this$props3.showShareBox,\n          objectType = _this$props3.objectType;\n      var textboxDisplay = this.state.textboxDisplay;\n      var referrerURL = this.getRefURL();\n      return /*#__PURE__*/React.createElement(\"div\", {\n        id: \"more-share-sns\",\n        className: \"more-share-sns\",\n        style: showShareBox ? Display.Block : Display.None\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"via after\",\n        style: Display.NoneIf(textboxDisplay)\n      }, /*#__PURE__*/React.createElement(\"a\", {\n        href: \"https://www.facebook.com/sharer.php?u=\".concat(referrerURL),\n        onClick: this.handleShare,\n        className: \"fb\",\n        target: \"_blank\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"ic-fb\"\n      }), \" \", /*#__PURE__*/React.createElement(\"em\", null, gettext(\"Share with Facebook\"))), /*#__PURE__*/React.createElement(\"a\", {\n        href: \"https://twitter.com/share?text=\".concat(encodeURI(title), \"&url=\").concat(referrerURL, \"&via=fancy\"),\n        onClick: this.handleShare,\n        className: \"tw\",\n        target: \"_blank\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"ic-tw\"\n      }), \" \", /*#__PURE__*/React.createElement(\"em\", null, gettext(\"Share with Twitter\"))), /*#__PURE__*/React.createElement(\"a\", {\n        href: \"https://www.tumblr.com/share/link?url=\".concat(referrerURL, \"&name=\").concat(encodeURI(title), \"&description=\").concat(encodeURI(title)),\n        onClick: this.handleShare,\n        className: \"tb\",\n        target: \"_blank\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"ic-tb\"\n      }), \" \", /*#__PURE__*/React.createElement(\"em\", null, gettext(\"Share with Tumblr\"))), objectType === ShareObjectTypes.thing && /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handleEmbed,\n        className: \"embed\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"ic-em\"\n      }), \" \", /*#__PURE__*/React.createElement(\"em\", null, gettext(\"Embed this item\")))));\n    }\n  }]);\n\n  return SNSShareBox;\n}(React.Component);","import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React from \"react\"; // import classnames from \"classnames\";\n// import { proportionFormat, isSafari as isSafariUtil } from \"fancyutils\";\n\nimport { Display } from \"fancymixin\";\nexport function getVideo(object) {\n  if (object.h264_1000k_url) return object;\n  var saleVideo = object && object.sales && object.sales.video;\n  var thingOrArticleVideo = object && object.video_cover || object && object.cover_video;\n\n  if (saleVideo) {\n    return saleVideo;\n  } else if (thingOrArticleVideo) {\n    try {\n      if (!thingOrArticleVideo.h264_1000k_url && object.cover_video.outputs.h264_1000k) {\n        thingOrArticleVideo.h264_1000k_url = object.cover_video.outputs.h264_1000k.url;\n      }\n    } catch (e) {}\n\n    return thingOrArticleVideo;\n  } else if (object.metadata && object.metadata.video_url) {\n    return {\n      thumbnail_url: object.image.src,\n      original_url: object.metadata.video_url\n    };\n  } else {\n    console.warn(\"<Video /> component is mounted but with unknown type\");\n    return {};\n  }\n}\nexport var Video = /*#__PURE__*/function (_React$Component) {\n  _inherits(Video, _React$Component);\n\n  function Video(props) {\n    var _this;\n\n    _classCallCheck(this, Video);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Video).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"el\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"videoEl\", null);\n\n    _this.id = +new Date();\n    return _this;\n  }\n\n  _createClass(Video, [{\n    key: \"getSrc\",\n    value: function getSrc() {\n      var object = this.props.object;\n      var video = getVideo(object);\n      return video.h264_1000k_url || video.original_url || video.original;\n    }\n  }, {\n    key: \"getThumbnail\",\n    value: function getThumbnail() {\n      var object = this.props.object;\n      var video = getVideo(object);\n      return video.thumbnail_url;\n    }\n  }, {\n    key: \"getLoop\",\n    value: function getLoop() {\n      var object = this.props.object;\n      return getVideo(object).loop;\n    }\n  }, {\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps) {\n      return nextProps.lastFullyRenderedObjectID !== this.props.lastFullyRenderedObjectID || nextProps.display !== this.props.display || nextProps.playing !== this.props.playing || nextProps.object !== this.props.object;\n    }\n  }, {\n    key: \"prepare\",\n    value: function prepare() {\n      var domCls = \"video-\".concat(this.id);\n      var $el = $(\".\".concat(domCls));\n\n      if ($el.length) {\n        if ($el[0].src !== this.getSrc()) {\n          $el[0].src = this.getSrc();\n          $el[0].loop = !!this.getLoop();\n          $el[0].currentTime = 0;\n        }\n      } else {\n        $el = $(\"<video id=\\\"myVideo\\\" class=\\\"\".concat(domCls, \"\\\" preload=\\\"auto\\\" playsInline disablePictureInPicture autoplay muted controls controlslist=\\\"nodownload nofullscreen noremoteplayback\\\" src=\\\"\").concat(this.getSrc(), \"\\\" loop=\\\"\").concat(!!this.getLoop(), \"\\\" poster=\\\"\").concat(this.getThumbnail(), \"\\\"/>\")).on(\"ended\", function () {\n          this.currentTime = 0;\n        });\n        this.videoEl = $el.get(0);\n        $(this.el).empty().append(this.videoEl);\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var np = this.props;\n\n      if (np.display !== prevProps.display) {\n        if (np.display === false) {\n          this.videoEl && this.videoEl.pause();\n        } else {\n          this.videoEl && this.videoEl.play();\n        }\n      }\n\n      if (np.display && np.playing != prevProps.playing) {\n        if (np.playing === false) {\n          this.videoEl && this.videoEl.pause();\n        } else {\n          this.videoEl && this.videoEl.play();\n        }\n      }\n\n      this.prepare();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          display = _this$props.display,\n          _this$props$style = _this$props.style,\n          style = _this$props$style === void 0 ? {} : _this$props$style,\n          playing = _this$props.playing;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        style: _.extend(style, Display.NoneIf(!display)),\n        className: \"video_player nozoom\",\n        ref: function ref(el) {\n          _this2.el = el;\n\n          if (!_this2.videoEl) {\n            _this2.prepare();\n          }\n        }\n      });\n    }\n  }], [{\n    key: \"isVideoAvailableForThing\",\n    value: function isVideoAvailableForThing(thing) {\n      var thingHasVideo = false;\n\n      if (thing) {\n        if (thing.video_cover) {\n          thingHasVideo = true;\n        } else if (thing.metadata) {\n          if (thing.metadata.video_url) {\n            thingHasVideo = true;\n          }\n        } else if (thing.sales) {\n          if (thing.sales.video) {\n            thingHasVideo = true;\n          }\n        }\n      }\n\n      return thingHasVideo;\n    }\n  }, {\n    key: \"isVideoAvailableForArticle\",\n    value: function isVideoAvailableForArticle(article) {\n      if (article && article.cover_video && article.cover_video.status == \"ready\") {\n        return true;\n      } else {\n        return false;\n      }\n    }\n  }]);\n\n  return Video;\n}(React.Component);","export { Video } from './Video';\nexport * from './MoreShare';\nexport * from './MoreShareFacade';\nexport * from './MoreShareUtils';\nexport { SharePopover } from './SharePopover';\nexport { AddlistPopover } from './AddlistPopover';\nexport { AddlistAction } from './AddlistAction';\nexport * from './Popup';\nexport { history } from './History';\nexport { default as applyProductSlide } from './ProductSlide';"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;ACpHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;ACvHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;ACj1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACniBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;ACzhBA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5ZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;AC5FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;AC9TA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC30BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;A","sourceRoot":""}