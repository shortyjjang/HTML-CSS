{"version":3,"file":"OverlayThing.main.3cce1baea545ce90a9fc.js","sources":["webpack://fancy/./_static/modules/ui/overlay-thing/Shared.js","webpack://fancy/./_static/modules/ui/overlay-thing/ThingTypes.js","webpack://fancy/./_static/modules/ui/overlay-thing/action/action-constants.js","webpack://fancy/./_static/modules/ui/overlay-thing/action/action-helpers.ts","webpack://fancy/./_static/modules/ui/overlay-thing/action/actions.js","webpack://fancy/./_static/modules/ui/overlay-thing/appstate.ts","webpack://fancy/./_static/modules/ui/overlay-thing/cache.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/Perf.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/map.ts","webpack://fancy/./_static/modules/ui/overlay-thing/components/popup/AddlistPopup.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/popup/AdminPopup.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/popup/SimpleSharePopup.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/v2/FancyContext.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/v2/MerchantInfo.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/v2/Recommendation.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/v2/Reviews.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/v2/Thing/ActionButtons.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/v2/Thing/Detail.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/v2/Thing/Image/index.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/v2/Thing/Image/zoom.ts","webpack://fancy/./_static/modules/ui/overlay-thing/components/v2/Thing/Info.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/v2/Thing/SaleItem.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/v2/Thing/SaleItemForm.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/v2/Thing/index.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/v2/ThingCard.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/v2/index.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/config.js","webpack://fancy/./_static/modules/ui/overlay-thing/container/entry-events.js","webpack://fancy/./_static/modules/ui/overlay-thing/container/history.js","webpack://fancy/./_static/modules/ui/overlay-thing/container/routeutils.js","webpack://fancy/./_static/modules/ui/overlay-thing/index.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/reducers.ts","webpack://fancy/./_static/modules/ui/overlay-thing/store/initial-store.ts","webpack://fancy/./_static/modules/ui/overlay-thing/store/store.ts"],"sourcesContent":["import { getFancyDepsRoot } from 'fancyutils';\nimport store from './store/store';\nimport { cache } from './cache';\nimport { pagingContext, transition } from './container/routeutils';\nimport { reloadCurrentThing } from './container/history';\ngetFancyDepsRoot().Shared = {\n  getStore: function getStore() {\n    return store.getState();\n  },\n  cache: cache,\n  pagingContext: pagingContext,\n  transition: transition,\n  reloadCurrentThing: reloadCurrentThing\n};","import _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n// -- Members --\n// className: string\n// - class name that used from sidebar head 'wrapper figure-info {className}'.\n// type: string\n// - meta string that indicates type name\nimport { mergeObjectArgs } from 'fancyutils';\nexport var ThingTypeMeta = /*#__PURE__*/function () {\n  function ThingTypeMeta() {\n    _classCallCheck(this, ThingTypeMeta);\n  }\n\n  _createClass(ThingTypeMeta, [{\n    key: \"getName\",\n    value: function getName(thingContext) {\n      return thingContext.name;\n    }\n  }]);\n\n  return ThingTypeMeta;\n}();\n\n_defineProperty(ThingTypeMeta, \"isSale\", false);\n\n_defineProperty(ThingTypeMeta, \"type\", 'ThingTypeMeta');\n\nexport var PlainThingType = /*#__PURE__*/function (_ThingTypeMeta) {\n  _inherits(PlainThingType, _ThingTypeMeta);\n\n  function PlainThingType() {\n    _classCallCheck(this, PlainThingType);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(PlainThingType).apply(this, arguments));\n  }\n\n  _createClass(PlainThingType, null, [{\n    key: \"createEmptyObject\",\n    value: function createEmptyObject() {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      var objectArgs = mergeObjectArgs(args);\n      var thing = $.extend(true, {\n        id: '1',\n        url: '/',\n        isCrawled: false,\n        owner: {},\n        image: {\n          src: '',\n          width: 1,\n          height: 1\n        },\n        user: {},\n        type: 'thing',\n        fancyd_friends: []\n      }, objectArgs);\n      thing.META = getThingType(thing);\n      return thing;\n    }\n  }]);\n\n  return PlainThingType;\n}(ThingTypeMeta);\n\n_defineProperty(PlainThingType, \"className\", '');\n\n_defineProperty(PlainThingType, \"type\", 'PlainThing');\n\nexport var SaleItemType = /*#__PURE__*/function (_ThingTypeMeta2) {\n  _inherits(SaleItemType, _ThingTypeMeta2);\n\n  function SaleItemType() {\n    _classCallCheck(this, SaleItemType);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(SaleItemType).apply(this, arguments));\n  }\n\n  _createClass(SaleItemType, null, [{\n    key: \"getName\",\n    value: function getName(thingContext) {\n      return thingContext.sales.name;\n    }\n  }, {\n    key: \"createEmptyObject\",\n    value: function createEmptyObject(objectArgs) {\n      return PlainThingType.createEmptyObject({\n        sales_available: true,\n        sales: {\n          id: '1',\n          review_rating: 1,\n          review_count: 1,\n          size_chart_ids: ['1'],\n          images: [{\n            src: '',\n            width: 1,\n            height: 1\n          }],\n          seller: {\n            id: '1'\n          }\n        },\n        type: 'sales'\n      }, objectArgs);\n    }\n  }]);\n\n  return SaleItemType;\n}(ThingTypeMeta);\n\n_defineProperty(SaleItemType, \"className\", '');\n\n_defineProperty(SaleItemType, \"type\", 'SaleItem');\n\nexport var GiftcardType = /*#__PURE__*/function (_SaleItemType) {\n  _inherits(GiftcardType, _SaleItemType);\n\n  function GiftcardType() {\n    _classCallCheck(this, GiftcardType);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(GiftcardType).apply(this, arguments));\n  }\n\n  _createClass(GiftcardType, null, [{\n    key: \"getName\",\n    value: function getName() {\n      return window.gettext(\"Fancy Gift Card\");\n    }\n  }]);\n\n  return GiftcardType;\n}(SaleItemType);\n\n_defineProperty(GiftcardType, \"className\", 'giftcard');\n\n_defineProperty(GiftcardType, \"type\", 'Giftcard');\n\nexport var HotelType = /*#__PURE__*/function (_SaleItemType2) {\n  _inherits(HotelType, _SaleItemType2);\n\n  function HotelType() {\n    _classCallCheck(this, HotelType);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(HotelType).apply(this, arguments));\n  }\n\n  _createClass(HotelType, null, [{\n    key: \"getName\",\n    value: function getName(thingContext) {\n      return thingContext.hotel_search.hotel.name;\n    }\n  }]);\n\n  return HotelType;\n}(SaleItemType);\n\n_defineProperty(HotelType, \"className\", 'hotel');\n\n_defineProperty(HotelType, \"type\", 'Hotel');\n\nexport var VanityType = /*#__PURE__*/function (_SaleItemType3) {\n  _inherits(VanityType, _SaleItemType3);\n\n  function VanityType() {\n    _classCallCheck(this, VanityType);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(VanityType).apply(this, arguments));\n  }\n\n  return VanityType;\n}(SaleItemType);\n\n_defineProperty(VanityType, \"className\", 'vanity');\n\n_defineProperty(VanityType, \"type\", 'Vanity');\n\nexport var LaunchAppType = /*#__PURE__*/function (_ThingTypeMeta3) {\n  _inherits(LaunchAppType, _ThingTypeMeta3);\n\n  function LaunchAppType() {\n    _classCallCheck(this, LaunchAppType);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(LaunchAppType).apply(this, arguments));\n  }\n\n  return LaunchAppType;\n}(ThingTypeMeta); // Retrieve meta by looking up thing object.\n\n_defineProperty(LaunchAppType, \"className\", '');\n\n_defineProperty(LaunchAppType, \"type\", 'LaunchApp');\n\nexport function getThingType(thingContext) {\n  var ThingType;\n\n  if (thingContext.hotel_search) {\n    ThingType = HotelType;\n  } else if (thingContext.has_launch_app && thingContext.metadata) {\n    ThingType = LaunchAppType;\n  } else if (thingContext.type === 'giftcard') {\n    ThingType = GiftcardType;\n  } else if (thingContext.sales_available) {\n    if (thingContext.type === 'vanity_number') {\n      ThingType = VanityType;\n    } else {\n      ThingType = SaleItemType;\n    }\n  } else {\n    ThingType = PlainThingType;\n  }\n\n  return ThingType;\n}\nvar ThingTypes = [PlainThingType, SaleItemType, GiftcardType, HotelType, VanityType, LaunchAppType]; // TODO: immutable\n\nThingTypes.forEach(function (AttachingType) {\n  ThingTypes.forEach(function (ComparingType) {\n    AttachingType[ComparingType.type] = AttachingType === ComparingType;\n  });\n});","// Generate `key: String(key)` structure by given string key arguments\nfunction constantGen() {\n  var keys = [].slice.call(arguments);\n  return keys.reduce(function (prev, next) {\n    prev[next] = next;\n    return prev;\n  }, {});\n}\n\nvar C = constantGen('UPDATE_APP_CONTEXT', // Loading\n'REQUEST_THING', 'REQUEST_THING_FAILURE', 'LOAD_THING', // UI Actions\n'OPEN_THING', 'CLOSE_THING', // Comment form suggestion\n'SET_USERNAME_KEYWORD', 'LOAD_SUGGESTION', // Thumbnail\n'SET_THUMBNAIL_INDEX', // Follow\n'TOGGLE_FOLLOW', 'CANCEL_FOLLOW', 'COMPLETE_FOLLOW', // Fancy\n'TOGGLE_FANCY', 'CANCEL_FANCY', 'COMPLETE_FANCY', // Saleitem\n'UPDATE_SALE_CONTEXT');\nexport default C;","import _objectSpread from \"@babel/runtime/helpers/objectSpread\";\nimport { MP, getLocationArgPairs, isEmpty, isStaticPage, stripPathname } from \"fancyutils\";\nimport { history } from \"common-components\";\nimport { historyData } from \"../container/history\";\nimport store from \"../store/store\";\nimport { closeModal } from \"../container/routeutils\";\nimport { closeThing, openThing, loadThing, requestThing, requestThingFail, toggleFollow as toggleFollowAction, cancelFollow, completeFollow, toggleFancy as toggleFancyAction, cancelFancy, completeFancy, setThumbnailIndex } from \"./actions\";\nimport C from \"./action-constants\";\nimport { formatPrice, isSalesOptionsAvailable, getCurrentSaleOption, getSaleImages } from \"../components/map\";\nimport { ThingCache, cache } from \"../cache\";\nimport { salesStatus } from \"../config\";\n\nfunction shouldOpenThing(state) {\n  return state.appContext.visible !== true;\n} // Blocks illegal requests\n\n\nfunction shouldFetchThing(state, thingID) {\n  if (state.thing.ID === thingID || state.thing.isFetching) {\n    return false;\n  } else {\n    return true;\n  }\n}\n\nexport function closeOverlay() {\n  return function (dispatch) {\n    if (isStaticPage()) {\n      return;\n    }\n\n    closeModal();\n    historyData.overlayIsOn = false;\n    history.push(stripPathname(historyData.preservedHref), null);\n    document.title = historyData.initialTitle;\n    dispatch(closeThing());\n    $(document).off(\"keydown.overlayThing\");\n    $(window).trigger(\"scroll\");\n  };\n}\n\nfunction onDataFetched(dispatch, thingID, thing, type) {\n  addAdditionalThingContext(thing);\n  cache.add(thingID, thing, type);\n  dispatch(loadThing(thingID, thing));\n  onLoadThing(thing);\n}\n\nvar fetchedThingsIds = {};\nexport function fetchThing(thingID) {\n  var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ThingCache.THINGS;\n  var killCache = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var override = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n  var queryString = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : \"\";\n  return function (dispatch, getState) {\n    if (thingID == null) {\n      console.warn(\"fetchThing(): thingID was null.\");\n      return;\n    }\n\n    var state = getState();\n\n    if (shouldOpenThing(state)) {\n      dispatch(openThing());\n    }\n\n    if (killCache) {\n      cache.remove(thingID, type);\n      delete state.thing;\n    }\n\n    var shouldFetch = override || shouldFetchThing(state, thingID);\n\n    if (killCache || shouldFetch) {\n      if (cache.exists(thingID, type)) {\n        var cac = cache.get(thingID, type);\n        dispatch(loadThing(thingID, cac));\n        onLoadThing(cac); // if cache is crawled one, request should continue\n\n        if (!cac.isCrawled) {\n          return;\n        }\n      } // static ot page prefetch\n\n\n      if (window.thingPageData) {\n        var thingPageData = window.thingPageData;\n        onDataFetched(dispatch, thingID, thingPageData, type);\n        delete window.thingPageData;\n        return;\n      }\n\n      dispatch(requestThing(thingID));\n      var options;\n      options = {\n        owner: true,\n        external_apps: true,\n        viewer: true\n      };\n\n      if (getLocationArgPairs(\"admin\")) {\n        options.admin = true;\n      }\n\n      if (type === ThingCache.SALES) {\n        options.sales = true; // /sales/(+d) URL\n      }\n\n      var successFn = function successFn(thing) {\n        if (thing.need_more_fetch) {\n          // Load main image as fast as possible.\n          if (thing.image_resized_max && thing.image_resized_max.src) {\n            var img = new Image();\n            img.src = thing.image.src;\n          }\n\n          fetchedThingsIds[thingID] = 1;\n          dispatch(loadThing(thingID, thing));\n          onLoadThing(thing);\n        } else {\n          fetchedThingsIds[thingID] = 2;\n          onDataFetched(dispatch, thingID, thing, type);\n        }\n      };\n\n      var failFn = function failFn(failureXHR) {\n        // FIXME: This error handling only happens when there's server-side error -\n        //        can't handle client-side ones\n        dispatch(requestThingFail());\n\n        if (failureXHR && failureXHR.status === 404) {\n          alertify.alert(\"This page is not available. Please try again later.\");\n        } else {\n          alertify.alert('There was an error while opening the page.<br> Please try again or contact <a mailto=\"cs@fancy.com\">cs@fancy.com</a>.');\n        }\n      };\n\n      if (window.requestPromise) {\n        var requestPromise = window.requestPromise;\n        delete window.requestPromise;\n        requestPromise.then(successFn)[\"catch\"](failFn);\n      } else {\n        if (__Config.design_v4) {\n          $.get(\"/rest-api/v1/things/\".concat(thingID, \"/details\").concat(queryString), options).then(successFn).fail(failFn);\n        } else {\n          $.get(\"/rest-api/v1/things/\".concat(thingID).concat(queryString), options).then(successFn).fail(failFn);\n        }\n      }\n    }\n  };\n}\nexport function getCordialProperties(thing) {\n  var prop = {\n    thingID: thing.id,\n    productID: thing.sales.id,\n    seller: thing.sales.seller.username,\n    url: \"https://fancy.com\" + thing.url,\n    name: thing.emojified_name,\n    category: thing.sales.cordial_category,\n    instock: thing.sales.available && !thing.sales.soldout,\n    image: thing.images[0].image_url,\n    price: parseFloat(thing.sales.min_price)\n  };\n\n  if (thing.recommended && thing.recommended.length) {\n    prop[\"recommended\"] = thing.recommended.map(function (item, i) {\n      return item.id;\n    });\n  }\n\n  return prop;\n}\n\nfunction onLoadThing(thing) {\n  var MPArgs = {\n    \"thing id\": thing.id\n  };\n  var currentLocationArgPair = getLocationArgPairs(\"utm\");\n\n  if (currentLocationArgPair) {\n    MPArgs.utm = currentLocationArgPair[1];\n  }\n\n  MP(\"View Thing Detail\", MPArgs);\n  if (typeof LogExposed != \"undefined\") window.LogExposed.addLog(thing.id + \"\", \"thing\");\n\n  try {\n    window.crdl(\"event\", \"browse\", getCordialProperties(thing));\n  } catch (e) {}\n\n  try {\n    var trackingItem;\n\n    if (thing.sales) {\n      trackingItem = {\n        id: thing.sales.id,\n        brand: thing.sales.seller.brand_name,\n        name: thing.sales.emojified_name || thing.emojified_name,\n        price: thing.sales.price\n      };\n      window.dataLayer.push({\n        product_id: thing.sales.id,\n        event: \"ProductPage\",\n        products: undefined,\n        products_info: undefined,\n        revenue: undefined,\n        option_id: thing.sales.options && thing.sales.options.length ? thing.sales.options[0].id : undefined\n      });\n    } else {\n      trackingItem = {\n        id: thing.id,\n        name: thing.emojified_name\n      };\n    }\n\n    window.TrackingEvents.viewItem(trackingItem);\n    ga(\"send\", {\n      hitType: \"pageview\",\n      page: location.href,\n      title: document.title\n    });\n  } catch (e) {}\n}\n\nfunction addAdditionalThingContext(thingData) {\n  thingData.fromServer = true;\n  thingData.sales_available = !isEmpty(thingData.sales) && !thingData.sales.show_anywhere_only && thingData.sales.status !== salesStatus.EXPIRED; // TODO: need to check exact condition.\n}\n\nexport function toggleFollow(_ref) {\n  var seller_id = _ref.seller_id,\n      user_id = _ref.user_id;\n  return function (dispatch, getState) {\n    var state = getState();\n    var followType;\n    var data;\n\n    if (seller_id) {\n      followType = \"followStore\";\n      data = {\n        seller_id: seller_id\n      };\n    } else if (user_id) {\n      followType = \"followUser\";\n      data = {\n        user_id: user_id\n      };\n    } else {\n      return;\n    }\n\n    if (state.followContext[followType].loading === false) {\n      var url = state.followContext[followType].following === true ? \"/delete_follow.xml\" : \"/add_follow.xml\";\n      dispatch(toggleFollowAction(followType));\n      $.ajax({\n        url: url,\n        data: data,\n        type: \"post\",\n        dataType: \"xml\"\n      }).done(function (xml) {\n        var $status = $(xml).find(\"status_code\");\n\n        if ($status.length && $status.text() !== 0) {\n          dispatch(completeFollow(followType));\n        } else {\n          dispatch(cancelFollow(followType));\n        }\n      }).fail(function () {\n        dispatch(cancelFollow(followType));\n      });\n    }\n  };\n}\nexport function toggleFancy(thingID) {\n  return function (dispatch, getState) {\n    var state = getState();\n    var _state$fancyContext = state.fancyContext,\n        fancyd = _state$fancyContext.fancyd,\n        fancyd_count = _state$fancyContext.fancyd_count,\n        loading = _state$fancyContext.loading;\n\n    if (!loading) {\n      dispatch(toggleFancyAction(thingID));\n      $.ajax({\n        type: \"PUT\",\n        url: \"/rest-api/v1/things/\".concat(thingID),\n        data: {\n          fancyd: !fancyd\n        }\n      }).done(function (json) {\n        var fc = 0;\n\n        if (json.id && json.fancyd === !fancyd) {\n          if (json.fancyd === true) {\n            fc = fancyd_count + 1;\n          } else if (json.fancyd === false) {\n            fc = fancyd_count - 1;\n          } // cache.update(thingID, undefined, \"fancyd\", json.fancyd);\n          // cache.update(thingID, undefined, \"fancyd_count\", fc);\n\n\n          dispatch(completeFancy(thingID, fc));\n        } else {\n          dispatch(cancelFancy(thingID));\n        }\n      }).fail(function () {\n        dispatch(cancelFancy(thingID));\n      });\n    }\n  };\n}\n\nfunction calculatePrice(thing, saleContext, newContext) {\n  var saleOptionID = newContext.saleOptionID || saleContext.saleOptionID;\n  var sales = thing && thing.sales; // Get object basis for retrieving price.\n\n  if (isSalesOptionsAvailable(sales)) {\n    var basis = _.find(sales.options, function (option) {\n      return option.id === saleOptionID;\n    });\n\n    if (basis != null) {\n      return basis.price;\n    } else {\n      console.warn(\"calculatePrice():\", \"Wrong saleOptionID supplied, please investigate. saleOptionID: \", saleOptionID);\n      return 0;\n    }\n  } else if (sales != null) {\n    return sales.price;\n  } else {\n    return 0;\n  }\n}\n\nexport function updateSaleContext(newContext) {\n  return function (dispatch, getState) {\n    var _getState = getState(),\n        thing = _getState.thing,\n        saleContext = _getState.saleContext,\n        slideContext = _getState.slideContext;\n\n    newContext.price = calculatePrice(thing.data, saleContext, newContext);\n    dispatch(_objectSpread({}, newContext, {\n      type: C.UPDATE_SALE_CONTEXT\n    }));\n\n    if (saleContext.saleOptionID !== newContext.saleOptionID) {\n      var option = getCurrentSaleOption(thing.data.sales, newContext, true);\n      var saleImages = getSaleImages(thing.data, option);\n      var firstOptionImageIdx;\n\n      if (option && saleImages.some(function (img, idx) {\n        if (img.option_id === option.id) {\n          firstOptionImageIdx = idx;\n          return true;\n        }\n      })) {// blank\n      } else {\n        if (slideContext.thumbnailIndex > saleImages.length - 1) {\n          firstOptionImageIdx = 0;\n        }\n      }\n\n      if (firstOptionImageIdx) {\n        dispatch(setThumbnailIndex(firstOptionImageIdx));\n      }\n    }\n  };\n}\n\nfunction requestCurrencyConversion(nextCode, nextPrice, callback) {\n  var shouldConvert = !(nextCode == null || callback == null);\n\n  if (shouldConvert) {\n    if (window.numberType === 2) {\n      nextPrice = nextPrice.replace(/,/g, \".\").replace(/ /g, \"\");\n    }\n\n    if (_.isString(nextPrice)) {\n      nextPrice = nextPrice.replace(/,/g, \"\");\n    }\n\n    $.ajax({\n      url: \"/convert_currency.json\",\n      type: \"GET\",\n      dataType: \"json\",\n      data: {\n        amount: nextPrice,\n        currency_code: nextCode\n      }\n    }).success(function () {\n      var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          amount = _ref2.amount,\n          currency = _ref2.currency;\n\n      if (amount == null) {\n        return;\n      }\n\n      callback(currency.code, formatPrice(amount, currency.code), currency.symbol);\n    });\n  }\n}\n\nfunction _convertCurrency(nextCode, nextPrice, force) {\n  return function (dispatch, getState) {\n    var _getState2 = getState(),\n        saleContext = _getState2.saleContext;\n\n    if (nextCode !== \"USD\") {\n      if (force || // FIXME: unable to comparison since price update comes first (SaleitemSidebarHead.componentWillReceiveProps())\n      saleContext.price !== nextPrice || // currency price changed\n      saleContext.currencyCode !== nextCode || // currency code changed\n      saleContext.currencyMoney == null || // currency symbol/money is not set (changed from usd)\n      saleContext.currencySymbol == null) {\n        nextPrice = nextPrice || saleContext.price || \"0.00\";\n        requestCurrencyConversion(nextCode, nextPrice, function (currencyCode, currencyMoney, currencySymbol) {\n          if (typeof currencyMoney === \"number\") {\n            currencyMoney = currencyMoney.toFixed(2);\n          }\n\n          currencyMoney = currencyMoney.replace(/[ \\.]00$/, \"\");\n          dispatch(updateSaleContext({\n            currencyCode: currencyCode,\n            currencyMoney: currencyMoney,\n            currencySymbol: currencySymbol\n          }));\n        });\n      } else {// NOOP\n      }\n    } else {\n      dispatch(updateSaleContext({\n        currencyCode: \"USD\",\n        currencyMoney: null,\n        currencySymbol: null\n      }));\n    }\n  };\n}\n\nexport function convertCurrency(nextCode, nextPrice) {\n  var force = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  store.dispatch(_convertCurrency(nextCode, nextPrice, force));\n}","import C from './action-constants'; // Action on requesting thing starts\n\nexport function requestThing(pendingID) {\n  return {\n    type: C.REQUEST_THING,\n    status: 'request',\n    pendingID: pendingID\n  };\n} // Action on requesting thing fails\n\nexport function requestThingFail() {\n  return {\n    type: C.REQUEST_THING_FAILURE,\n    status: 'failed'\n  };\n} // action on loading request result\n\nexport function loadThing(ID, data) {\n  return {\n    type: C.LOAD_THING,\n    status: 'idle',\n    ID: ID,\n    data: data\n  };\n} // Action on close overlay\n\nexport function openThing() {\n  return {\n    type: C.OPEN_THING\n  };\n} // Action on close overlay\n\nexport function closeThing() {\n  return {\n    type: C.CLOSE_THING,\n    ID: null,\n    pendingID: null,\n    thing: null\n  };\n}\nexport function setThumbnailIndex(thumbnailIndex) {\n  return {\n    type: C.SET_THUMBNAIL_INDEX,\n    thumbnailIndex: thumbnailIndex\n  };\n}\nexport function toggleFollow(followType) {\n  return {\n    type: C.TOGGLE_FOLLOW,\n    followType: followType\n  };\n}\nexport function cancelFollow(followType) {\n  return {\n    type: C.CANCEL_FOLLOW,\n    followType: followType\n  };\n}\nexport function completeFollow(followType) {\n  return {\n    type: C.COMPLETE_FOLLOW,\n    followType: followType\n  };\n}\nexport function toggleFancy(thingID) {\n  return {\n    type: C.TOGGLE_FANCY,\n    thingID: thingID\n  };\n}\nexport function cancelFancy(thingID) {\n  return {\n    type: C.CANCEL_FANCY,\n    thingID: thingID\n  };\n}\nexport function completeFancy(thingID, fancyd_count) {\n  return {\n    type: C.COMPLETE_FANCY,\n    thingID: thingID,\n    fancyd_count: fancyd_count\n  };\n}\nexport function updateAppContext(contextObject) {\n  return {\n    type: C.UPDATE_APP_CONTEXT,\n    context: contextObject\n  };\n}","// App state that does not usually change during app lifecycle. (i.e. Login state)\n// module-level login state object and setter\nvar state = {\n  viewer: {},\n  loggedIn: false\n};\nexport default state;\nexport function updateState(k, v) {\n  state[k] = v;\n}","import _typeof from \"@babel/runtime/helpers/typeof\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport { index } from 'fancyutils'; // Cache bucket\n\nexport var ThingCache = function ThingCache() {\n  var _this = this;\n\n  _classCallCheck(this, ThingCache);\n\n  _defineProperty(this, \"things\", {});\n\n  _defineProperty(this, \"sales\", {});\n\n  _defineProperty(this, \"count\", 0);\n\n  _defineProperty(this, \"exists\", function (id, type, ignoreCralwed) {\n    var cac = _this.get(id, type);\n\n    var existence = cac != null && _typeof(cac) === 'object';\n\n    if (ignoreCralwed) {\n      existence = existence && cac.isCrawled !== true;\n    }\n\n    return existence;\n  });\n\n  _defineProperty(this, \"_get\", function (id) {\n    return _this[ThingCache.THINGS][id] || _this[ThingCache.SALES][id] || null;\n  });\n\n  _defineProperty(this, \"get\", function (id) {\n    var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ThingCache.THINGS;\n\n    var cac = _this[type][id] || _this.getCrawled(id, type);\n\n    return cac;\n  });\n\n  _defineProperty(this, \"getCrawled\", function (id, type) {\n    var cac = _this[type][id];\n\n    if (cac && cac.isCrawled) {\n      return cac;\n    } else {\n      return null;\n    }\n  });\n\n  _defineProperty(this, \"add\", function (id, data, type) {\n    // to add, cache should not be exist or crawled one\n    var cac = _this[type][id];\n\n    if (cac == null || cac.isCrawled === true) {\n      _this[type][id] = data; // Store thing information as well\n\n      if (type === ThingCache.SALES && data.id) {\n        _this[ThingCache.THINGS][data.id] = data;\n      }\n\n      _this.count += 1;\n    } else {\n      console.warn('cache.add(): Cache overwrite');\n    }\n  });\n\n  _defineProperty(this, \"remove\", function (id, type) {\n    if (_this[type][id]) {\n      delete _this[type][id];\n      _this.count -= 1;\n    } else {\n      console.warn('cache.remove(): Non-existing cache removal');\n    }\n  });\n\n  _defineProperty(this, \"update\", function (id) {\n    var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ThingCache.THINGS;\n    var selector = arguments.length > 2 ? arguments[2] : undefined;\n    var value = arguments.length > 3 ? arguments[3] : undefined;\n\n    if (selector == null) {\n      console.warn('ThingCache#update(): selector is empty');\n      return;\n    }\n\n    var t = _this.get(id, type);\n\n    if (t) {\n      index(t, selector, value);\n    }\n  });\n} // sweep() {\n//     // TODO: should sweep cache if too many cache added by looking `cache.count`\n// }\n;\n\n_defineProperty(ThingCache, \"SALES\", 'sales');\n\n_defineProperty(ThingCache, \"THINGS\", 'things');\n\nexport var cache = new ThingCache();\nwindow.__THING_CACHE = cache;","export var Keys = {\n  Sidebar: {\n    Wrap: 'SIDEBAR_WRAP',\n    Body: 'SIDEBAR_BODY',\n    Title: 'SIDEBAR_TITLE',\n    Price: 'SIDEBAR_PRICE',\n    Form: 'SIDEBAR_FORM',\n    Desc: 'SIDEBAR_DESCRIPTION',\n    Owner: 'SIDEBAR_OWNER'\n  }\n};","import { alertify, isEmpty } from \"fancyutils\";\nvar _window = window,\n    gettext = _window.gettext,\n    _ = _window._;\nexport function mapStateToThingProps(state) {\n  var appContext = state.appContext,\n      _state$thing = state.thing,\n      data = _state$thing.data,\n      isFetching = _state$thing.isFetching,\n      status = _state$thing.status,\n      followContext = state.followContext,\n      fancyContext = state.fancyContext,\n      slideContext = state.slideContext,\n      saleContext = state.saleContext;\n  return {\n    appContext: appContext,\n    status: status,\n    thing: data,\n    isFetching: isFetching,\n    followContext: followContext,\n    fancyContext: fancyContext,\n    slideContext: slideContext,\n    saleContext: saleContext\n  };\n}\nexport function getSales(type, thing) {\n  return thing.sales;\n}\nexport function getDescription(type, thing) {\n  if (type === \"sales\") {\n    return thing.sales.description;\n  } else if (type === \"hotel\") {\n    return thing.hotel_search.details.propertyDescription;\n  }\n} // Get sale item id via permission / sales availability\n\nexport function getSaleItemId(thing, viewer) {\n  if (viewer && viewer.is_admin_any) {\n    if (thing.sales) {\n      return thing.sales.id;\n    } else if (thing.inactive_sales) {\n      return thing.inactive_sales.id;\n    }\n  }\n} // Get sale item id via permission / sales availability\n\nexport function getSeller(thing) {\n  if (thing.sales) {\n    return thing.sales.seller;\n  } else if (thing.inactive_sales) {\n    return thing.inactive_sales.seller;\n  }\n}\nexport function getDetailType(thing) {\n  if (thing.hotel_search) {\n    return \"hotel\";\n  } else if (thing.sales_available && thing.type !== \"vanity_number\") {\n    return \"sales\";\n  } else if (!thing.sales_available && !thing.has_launch_app && thing.type !== \"giftcard\") {\n    return \"urlOnly\";\n  }\n}\nexport function isSalesOptionsAvailable(sales) {\n  return sales != null && !isEmpty(sales.options);\n}\nexport function getFirstSaleOption(sales) {\n  var ignoreEmptySaleOption = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n  if (isSalesOptionsAvailable(sales)) {\n    return sales.options[0];\n  } else if (ignoreEmptySaleOption === false) {\n    return sales || null;\n  }\n}\nexport function getCurrentSaleOption(sales) {\n  var saleContext = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var ignoreEmptySaleOption = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var saleOptionID = saleContext.saleOptionID;\n\n  if (isSalesOptionsAvailable(sales)) {\n    if (saleOptionID) {\n      var opts = _(sales.options).filter(function (prop) {\n        return prop.id === saleOptionID;\n      });\n\n      if (opts[0] == null) {\n        console.warn(\"saleOption should not be null!\");\n      }\n\n      return opts[0] == null ? {\n        id: 0,\n        discount_percentage: \"0.0\",\n        quantity: 0,\n        soldout: true,\n        retail_price: 0,\n        name: ''\n      } : opts[0];\n    } else {\n      return sales.options[0];\n    }\n  } else if (ignoreEmptySaleOption === false) {\n    return sales;\n  }\n}\nexport function formatPrice(amount, currency) {\n  if (currency == \"BTC\") return amount + \"\";\n  var newPrice = amount.toFixed(2) + \"\";\n  var regex = /(\\d)(\\d{3})([,\\.]|$)/;\n\n  while (regex.test(newPrice)) {\n    newPrice = newPrice.replace(regex, \"$1,$2$3\");\n  }\n\n  if (window.numberType === 2) {\n    newPrice = newPrice.replace(/,/g, \" \").replace(/\\./g, \",\");\n  }\n\n  return newPrice;\n} // sales: thing.sales\n\nexport function getDomesticDeliveryDate(sales) {\n  var date = \"\";\n\n  if (sales.expected_delivery_day_1) {\n    date += sales.expected_delivery_day_1;\n  }\n\n  if (sales.expected_delivery_day_2) {\n    date += \" - \" + sales.expected_delivery_day_2;\n  }\n\n  return date;\n} // sales: thing.sales\n\nexport function getIntlDeliveryDate(sales) {\n  var date = \"\"; // TODO: use moment for locale string\n\n  if (sales.expected_delivery_day_intl_1) {\n    date += sales.expected_delivery_day_intl_1;\n  }\n\n  if (sales.expected_delivery_day_intl_2) {\n    date += \" - \" + sales.expected_delivery_day_intl_2;\n  }\n\n  return date;\n}\nexport function currencyIsUSD(_ref) {\n  var saleContext = _ref.saleContext;\n  return saleContext.currencyCode === \"USD\";\n} // [sale option id]: { true | false }\n\nvar saleOptionWaitingRegistry = {};\nwindow.saleOptionWaitingRegistry = saleOptionWaitingRegistry;\nexport function setWaiting(chosenSaleOptionID, setResult) {\n  saleOptionWaitingRegistry[chosenSaleOptionID] = setResult;\n}\nexport function getWaiting(sales, saleContext) {\n  if (sales == null) {\n    return null;\n  }\n\n  if (saleContext.waiting != null) {\n    return saleContext.waiting;\n  } // https://app.asana.com/0/86925821949642/160205241997173\n  // It could be a bit weird for future, but design-side decision\n\n\n  if (sales.waiting) {\n    return sales.waiting;\n  }\n\n  var chosenSaleOption = getCurrentSaleOption(sales, saleContext); // options is SaleItem\n\n  if (sales.id === chosenSaleOption.id) {\n    return sales.waiting; // option is SaleOption\n  } else {\n    if (saleOptionWaitingRegistry[chosenSaleOption.id] != null) {\n      return saleOptionWaitingRegistry[chosenSaleOption.id];\n    } else if (chosenSaleOption.waiting != null) {\n      return chosenSaleOption.waiting;\n    }\n  }\n}\n\nfunction fillArray(original,\n/*sparse?ArrayToFill*/\nfiller) {\n  var ol = original.length;\n  var fl = filler.length;\n  var sparseIdxs = []; // Find sparse indexes first.\n\n  for (var j = 0; j < ol; j++) {\n    if (!(j in original)) {\n      sparseIdxs.push(j);\n    }\n  }\n\n  for (var i = 0; i < fl; i++) {\n    // if sparse indexes are all in (or nonexist), push leftovers to tail\n    if (i > sparseIdxs.length - 1) {\n      original.push(filler[i]);\n    } else {\n      original[sparseIdxs[i]] = filler[i];\n    }\n  }\n\n  return original;\n}\n\nvar tid;\nvar optionId;\nvar hotelImages;\nvar salesImages;\nvar thingImages;\nexport function getSaleImages(thing, option, thumbnailsLimit) {\n  if (thing.hotel_search != null) {\n    if (tid !== thing.id) {\n      // Caching structure\n      if (thing.fromServer) {\n        tid = thing.id;\n      }\n\n      hotelImages = thing.hotel_search.images.map(function (img) {\n        return {\n          src: img.url,\n          thumbnail_src: img.thumbnailUrl,\n          width: img.width,\n          height: img.height\n        };\n      });\n      hotelImages.unshift(thing.image_resized_max);\n    }\n\n    return hotelImages;\n  } else if (thing.sales != null) {\n    if (__Config.design_v4) {\n      var images = [];\n      fillArray(images, thing.images);\n\n      if (option && option.images && option.images.length > 0) {\n        fillArray(images, option.images);\n      }\n\n      salesImages = images;\n\n      if (option) {\n        optionId = option.id;\n      }\n\n      if (thing && thing.sales && thing.sales.video) {\n        images.unshift(thing.sales.video);\n      }\n\n      return salesImages;\n    }\n\n    if (tid !== thing.id) {\n      // Caching structure\n      if (thing.fromServer) {\n        tid = thing.id;\n      } // optionId = option ? option.id : null;\n      // FIXME: do this somewhere else\n\n\n      if (thing.image_resized_max == null) {\n        if (thing.image.src) {\n          thing.image_resized_max = {\n            src: thing.image.src,\n            width: thing.image.width,\n            height: thing.image.height,\n            thumbType: \"thing\"\n          }; // FIXME: to prevent null referencing\n        } else {\n          thing.image_resized_max = {\n            src: \"/_ui/images/common/blank.gif\",\n            width: 1,\n            height: 1,\n            thumbType: \"thing\"\n          }; // FIXME: to prevent null referencing\n        }\n      }\n\n      var _images = [];\n\n      if (thing.image_resized_max) {\n        _images.push(thing.image_resized_max);\n      }\n\n      if (thing.images && thing.images[0]) {\n        _images.push(thing.images[0]);\n      } // set sale images\n\n\n      if (thing && thing.sales && thing.sales.video) {\n        var video = {\n          src: thing.sales.video.thumbnail_url,\n          thumbType: \"video\"\n        };\n\n        if (thing.sales.video.position > 0) {\n          _images[thing.sales.video.position] = video;\n        } else {\n          // set video to first unless the position is set\n          _images.unshift(video);\n        }\n      }\n\n      if (thing.sales.images) {\n        fillArray(_images, thing.sales.images);\n      }\n\n      salesImages = _images;\n    }\n\n    if (option && optionId !== option.id) {\n      optionId = option.id;\n\n      if (salesImages == null) {\n        salesImages = [];\n      }\n\n      if (option.images && option.images.length > 0) {\n        var _images2 = salesImages.filter(function (img) {\n          return img.option_id == null;\n        });\n\n        fillArray(_images2, option.images);\n        salesImages = _images2;\n      }\n    }\n\n    return _.isNumber(thumbnailsLimit) && thumbnailsLimit > 0 ? salesImages.filter(function (image, idx) {\n      return idx < thumbnailsLimit && image.src;\n    }) : salesImages;\n  } else {\n    if (tid !== thing.id) {\n      // Caching structure\n      if (thing.fromServer) {\n        tid = thing.id;\n      }\n\n      if (thing.image_resized_max) {\n        thingImages = [thing.image_resized_max];\n      } else if (thing.image) {\n        thingImages = [thing.image];\n      } else {\n        thingImages = []; // || (option && optionId !== option.id)\n      }\n    }\n\n    return thingImages;\n  }\n}\nexport function isVanityQueriable(props, suppress) {\n  var AC = props.AC,\n      minPrice = props.minPrice,\n      maxPrice = props.maxPrice,\n      keyword = props.keyword;\n  keyword = $.trim(keyword);\n  AC = $.trim(AC);\n  minPrice = minPrice != null ? minPrice : \"0\";\n  minPrice = $.trim(minPrice).replace(\",\", \"\").replace(\"$\", \"\");\n  maxPrice = $.trim(maxPrice).replace(\",\", \"\").replace(\"$\", \"\");\n  var original_labels = alertify.labels;\n\n  if (AC !== \"\") {\n    if (_.isNaN(parseInt(AC, 10)) || AC.length !== 3) {\n      alertify.set({\n        labels: {\n          ok: \"Close\"\n        }\n      });\n      !suppress && alertify.alert(\"Invalid area code. Area code should be 3 digits.\");\n      alertify.set({\n        labels: original_labels\n      });\n      return false;\n    }\n  }\n\n  if (minPrice !== \"\") {\n    if (_.isNaN(parseInt(minPrice, 10))) {\n      alertify.set({\n        labels: {\n          ok: \"Close\"\n        }\n      });\n      !suppress && alertify.alert(\"Please check min price. It should be number.\");\n      alertify.set({\n        labels: original_labels\n      });\n      return false;\n    }\n\n    if (parseInt(minPrice, 10) >= parseInt(maxPrice, 10)) {\n      alertify.set({\n        labels: {\n          ok: \"Close\"\n        }\n      });\n      !suppress && alertify.alert(\"The max price number should be bigger than min price number.\");\n      alertify.set({\n        labels: original_labels\n      });\n      return false;\n    }\n  }\n\n  if (maxPrice !== \"\") {\n    if (_.isNaN(parseInt(maxPrice, 10))) {\n      alertify.set({\n        labels: {\n          ok: \"Close\"\n        }\n      });\n      !suppress && alertify.alert(\"Please check max price. It should be number.\");\n      alertify.set({\n        labels: original_labels\n      });\n      return false;\n    }\n  }\n\n  if (keyword !== \"\") {\n    if (keyword.length < 4) {\n      alertify.set({\n        labels: {\n          ok: \"Close\"\n        }\n      });\n      !suppress && alertify.alert(\"Please enter 4 or more characters.\");\n      alertify.set({\n        labels: original_labels\n      });\n      return false;\n    }\n  }\n\n  return true;\n}\nexport function getSafeNameProp(_ref2) {\n  var emojified_name = _ref2.emojified_name,\n      name = _ref2.name;\n\n  if (emojified_name) {\n    return {\n      dangerouslySetInnerHTML: {\n        __html: emojified_name\n      }\n    };\n  } else {\n    return {\n      children: name\n    };\n  }\n}\nexport function isVideoUploadable(thing) {\n  if (thing && thing.hotel_search || thing.metadata) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nfunction salesAvailable(thing) {\n  if (!isEmpty(thing.sales)) {\n    return thing.sales_available;\n  }\n\n  return false;\n}\n\nexport function getThingName(thing) {\n  if (thing.type === \"giftcard\") {\n    return gettext(\"Fancy Gift Card\");\n  } else if (salesAvailable(thing)) {\n    return thing.sales.name;\n  } else {\n    return thing.name;\n  }\n}","import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from 'react';\nimport classnames from 'classnames';\nimport { closePopup, KEYS, MP, isEmpty, alertify } from 'fancyutils';\nimport { Display } from 'fancymixin';\n\nvar AddlistPopup = /*#__PURE__*/function (_Component) {\n  _inherits(AddlistPopup, _Component);\n\n  function AddlistPopup() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, AddlistPopup);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(AddlistPopup)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      lists: [],\n      listSearchQuery: '',\n      listCreationQuery: '',\n      listCreating: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDialogOpen\", function () {\n      _this.setState({\n        lists: [],\n        listSearchQuery: '',\n        listCreationQuery: ''\n      });\n\n      _this.drawUserList();\n\n      setTimeout(function () {\n        _this.listSearchInput.focus();\n      }, 0);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleListSearch\", function (event) {\n      var listSearchQuery = event.target.value;\n\n      _this.setState({\n        listSearchQuery: listSearchQuery\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleListCreation\", function (event) {\n      event.preventDefault();\n      if (_this.state.listCreating) return;\n\n      if (event.type === 'keyup' && event.which !== KEYS.ENTER) {\n        return;\n      }\n\n      var listCreationQuery = $.trim(_this.state.listCreationQuery);\n      var objectId = _this.props.objectId;\n\n      if (isEmpty(listCreationQuery)) {\n        return;\n      }\n\n      _this.setState({\n        listCreating: true\n      }); // save new list\n\n\n      updateList({\n        objectId: objectId,\n        createList: listCreationQuery,\n        callback: function callback(success, updated) {\n          if (success) {\n            var lists = _this.state.lists;\n            MP('Create New List', {\n              'thing id': objectId,\n              'list name': listCreationQuery,\n              'via': 'thing detail'\n            });\n\n            _this.setState({\n              listCreationQuery: '',\n              listCreating: false,\n              lists: [].concat(_toConsumableArray(updated), _toConsumableArray(lists))\n            });\n          }\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleListItemToggle\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n      var targ = event.currentTarget;\n      var objectId = _this.props.objectId;\n      var lists = _this.state.lists;\n      var selectedListId = Number(targ.getAttribute('data-listid'));\n      var theList = lists.filter(function (list) {\n        return list.id === selectedListId;\n      })[0];\n      var prevAdded = theList.added;\n      theList.added = !theList.added;\n      var eventName = theList.added ? \"Add to List\" : \"Remove from List\";\n\n      _this.setState({\n        lists: lists\n      });\n\n      var callback = function callback(success, updated) {\n        var lists = _this.state.lists;\n\n        if (success) {} else {\n          var _theList = lists.filter(function (list) {\n            return list.id === selectedListId;\n          })[0];\n          _theList.added = prevAdded;\n        }\n\n        _this.setState({\n          lists: lists\n        });\n\n        MP(eventName, {\n          'thing id': objectId,\n          'list name': theList.name,\n          'list id': theList.id,\n          'via': 'thing detail'\n        });\n      };\n\n      var update = {\n        objectId: objectId,\n        callback: callback\n      };\n      if (theList.added) update['checked'] = [theList.id];else update['unchecked'] = [theList.id];\n      updateList(update);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCreateListQueryChange\", function (event) {\n      _this.setState({\n        listCreationQuery: event.target.value\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(AddlistPopup, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      $.dialog(AddlistPopup.popupName).$obj.on('open', this.handleDialogOpen);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      $.dialog(AddlistPopup.popupName).center();\n    }\n  }, {\n    key: \"drawUserList\",\n    value: function drawUserList() {\n      var _this2 = this;\n\n      var objectId = this.props.objectId;\n      getListCheckbox({\n        objectId: objectId,\n        callback: function callback(res) {\n          _this2.setState(res);\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var objectId = this.props.objectId;\n      var _this$state = this.state,\n          lists = _this$state.lists,\n          listSearchQuery = _this$state.listSearchQuery,\n          listCreationQuery = _this$state.listCreationQuery,\n          listCreating = _this$state.listCreating;\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"p\", {\n        className: \"ltit\"\n      }, \"Add to lists\"), /*#__PURE__*/React.createElement(\"fieldset\", {\n        className: \"search\"\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        placeholder: \"Search\",\n        className: \"text\",\n        value: listSearchQuery,\n        ref: function ref(element) {\n          _this3.listSearchInput = element;\n        },\n        onChange: this.handleListSearch\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"list\"\n      }, /*#__PURE__*/React.createElement(\"ul\", {\n        ref: function ref(el) {\n          _this3.lists = el;\n        }\n      }, lists && lists.map(function (list, idx) {\n        var term = $.trim(listSearchQuery).toLowerCase();\n        var style;\n\n        if (_.isString(term) && term.length > 0) {\n          style = Display.NoneIf(list.name.toLowerCase().indexOf(term.toLowerCase()) === -1);\n        }\n\n        var ident = \"\".concat(objectId, \"-\").concat(list.id);\n        return /*#__PURE__*/React.createElement(\"li\", {\n          key: idx,\n          style: style,\n          className: classnames({\n            \"added\": list.added\n          })\n        }, /*#__PURE__*/React.createElement(\"label\", null, list.name), /*#__PURE__*/React.createElement(\"button\", {\n          \"data-listid\": list.id,\n          onClick: _this3.handleListItemToggle,\n          className: \"btns-blue-embo\"\n        }, list.added ? \"Remove\" : \"Add\"));\n      }))), /*#__PURE__*/React.createElement(\"fieldset\", {\n        className: \"create\"\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        placeholder: \"Create new list\",\n        ref: function ref(element) {\n          _this3.quickCreateList = element;\n        },\n        onKeyUp: this.handleListCreation,\n        onChange: this.handleCreateListQueryChange,\n        value: listCreationQuery\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        className: classnames(\"btn-create\", {\n          \"loading\": listCreating\n        }),\n        style: Display.NoneIf($.trim(listCreationQuery).length == 0),\n        onClick: this.handleListCreation\n      }, gettext(\"Create\"))), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"ly-close\",\n        title: \"Close\"\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"ic-del-black\"\n      })));\n    }\n  }]);\n\n  return AddlistPopup;\n}(Component);\n\n_defineProperty(AddlistPopup, \"popupName\", 'add-list');\n\nexport { AddlistPopup as default };\n\nfunction getListCheckbox(_ref) {\n  var objectId = _ref.objectId,\n      callback = _ref.callback;\n  $.get('/get_list_checkbox.json', {\n    tid: objectId\n  }).done(function (resp) {\n    if (resp.status_code == 0) {\n      alertify.alert(resp.message || \"Please try again later.\");\n      closePopup(AddlistPopup.popupName);\n    }\n\n    callback && callback({\n      lists: resp.lists\n    });\n  }).error(function (err) {\n    alertify.alert(\"Please try again later.\");\n    console.warn(err);\n    closePopup(AddlistPopup.popupName);\n  });\n}\n\nfunction updateList(_ref2) {\n  var objectId = _ref2.objectId,\n      checked = _ref2.checked,\n      unchecked = _ref2.unchecked,\n      createList = _ref2.createList,\n      callback = _ref2.callback;\n  var payload = {\n    tid: objectId\n  };\n  if (checked) payload['add_list_ids'] = checked.join(',');\n  if (unchecked) payload['remove_list_ids'] = unchecked.join(',');\n  if (createList) payload['new_list'] = createList;\n  $.post('/update_list_checkbox.json', payload).done(function (resp) {\n    if (resp.status_code == 0) {\n      alertify.alert(resp.message || \"Please try again later.\");\n      callback(false, null);\n    } else {\n      callback(true, resp.lists);\n    }\n  }).error(function (err) {\n    console.warn(err);\n    alertify.alert(\"Please try again later.\");\n    callback(false, []);\n  });\n}","import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React from 'react';\nimport { Display } from \"fancymixin\";\nimport classnames from 'classnames';\nimport { xmlUtil } from \"fancyutils\";\n\nvar AdminPopup = /*#__PURE__*/function (_React$Component) {\n  _inherits(AdminPopup, _React$Component);\n\n  function AdminPopup() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, AdminPopup);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(AdminPopup)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      show_on_homepage: null,\n      date_published: null,\n      exclude_from_popular: false,\n      show_in_search: true,\n      optionSaving: false,\n      ownerSaving: false,\n      mergeSaving: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSaveOptions\", function () {\n      var thing = _this.props.thing;\n      var _this$state = _this.state,\n          show_on_homepage = _this$state.show_on_homepage,\n          date_published = _this$state.date_published,\n          exclude_from_popular = _this$state.exclude_from_popular,\n          show_in_search = _this$state.show_in_search,\n          optionSaving = _this$state.optionSaving;\n      if (optionSaving) return false;\n      var payload = {\n        thing_id: thing.id,\n        show_on_homepage: show_on_homepage,\n        exclude_from_popular: exclude_from_popular,\n        show_in_search: show_in_search\n      };\n\n      if (show_on_homepage) {\n        var inputDate = new Date(date_published);\n\n        if (isNaN(inputDate)) {\n          alert(\"invalid date - must be in format of 2020-01-01 10:10:10\");\n          return false;\n        }\n\n        payload['date_published'] = inputDate.toISOString().replace(/T/, \" \").split(\".\")[0];\n      }\n\n      _this.setState({\n        optionSaving: true\n      });\n\n      $.post('/manage-newthing.json', payload).then(function (json) {\n        if (json.status_code == 1) {\n          Object.assign(thing, payload);\n          alert(\"Updated!\");\n        } else {\n          alert(json.message || \"Failed to save the changes\");\n        }\n\n        _this.setState({\n          optionSaving: false\n        });\n      }).fail(function () {\n        alert(\"Something went wrong!\");\n\n        _this.setState({\n          optionSaving: false\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleChangeOwner\", function () {\n      var thing = _this.props.thing;\n      if (_this.state.ownerSaving) return false;\n      if (_this.changeOwnerEl == null) return false;\n\n      var new_owner = _this.changeOwnerEl.value.trim();\n\n      if (new_owner.length == 0) {\n        alert(\"Please enter a username.\");\n        return false;\n      }\n\n      if (new_owner.toLowerCase() == thing.thing_owner.username.toLowerCase()) {\n        alert(\"The thing is already owned by the user.\");\n        return false;\n      }\n\n      if (window.confirm(\"Do you want to change the current thing's owner to \".concat(new_owner, \"?\"))) {\n        _this.setState({\n          ownerSaving: true\n        });\n\n        $.ajax({\n          type: \"post\",\n          url: \"/change_new_thing_owner.xml\",\n          data: {\n            new_owner_name: new_owner,\n            thing_id: thing.id,\n            new_thing_id: thing.ntid,\n            old_user_id: thing.thing_owner.id\n          },\n          dataType: \"xml\"\n        }).done(function (xml) {\n          if (xmlUtil.isSuccess(xml)) {\n            alert(\"Done!\");\n            location.reload();\n          } else if (xmlUtil.isFail(xml)) {\n            alert($(xml).find(\"message\").text());\n          }\n        }).fail(function () {\n          alert(\"There was an error.\");\n        }).always(function () {\n          _this.setState({\n            ownerSaving: false\n          });\n        });\n      }\n\n      return false;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleMergeThings\", function () {});\n\n    return _this;\n  }\n\n  _createClass(AdminPopup, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var that = this;\n      $.dialog(AdminPopup.popupName).$obj.on('open', function () {\n        var _that$props$thing = that.props.thing,\n            show_on_homepage = _that$props$thing.show_on_homepage,\n            date_published = _that$props$thing.date_published,\n            exclude_from_popular = _that$props$thing.exclude_from_popular,\n            show_in_search = _that$props$thing.show_in_search;\n        that.setState({\n          show_on_homepage: show_on_homepage,\n          date_published: date_published,\n          exclude_from_popular: exclude_from_popular,\n          show_in_search: show_in_search\n        });\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      $.dialog(AdminPopup.popupName).center();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          thing = _this$props.thing,\n          sales = _this$props.thing.sales;\n      var _this$state2 = this.state,\n          show_on_homepage = _this$state2.show_on_homepage,\n          date_published = _this$state2.date_published,\n          exclude_from_popular = _this$state2.exclude_from_popular,\n          show_in_search = _this$state2.show_in_search,\n          optionSaving = _this$state2.optionSaving,\n          ownerSaving = _this$state2.ownerSaving,\n          mergeSaving = _this$state2.mergeSaving;\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"p\", {\n        className: \"ltit\"\n      }, thing.name), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"thing-admin-body\"\n      }, /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"thing-info\"\n      }, /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"em\", null, \"Sale ID\"), \" \", sales.id), /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"em\", null, \"Thing ID\"), \" \", thing.id), /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"em\", null, \"Thing Owner\"), \" \", thing.thing_owner.username), /*#__PURE__*/React.createElement(\"li\", {\n        className: \"buttons\"\n      }, /*#__PURE__*/React.createElement(\"a\", {\n        className: \"btns-blue-embo\",\n        href: \"/merchant/products/\".concat(sales.id),\n        target: \"_blank\"\n      }, \"Edit Sale\"), /*#__PURE__*/React.createElement(\"a\", {\n        className: \"btns-gray-embo\",\n        href: \"/admin/view-sale-orders-by-thing-id?thing_id=\".concat(thing.id),\n        target: \"_blank\"\n      }, \"View Orders\"), /*#__PURE__*/React.createElement(\"a\", {\n        className: \"btns-gray-embo\",\n        href: \"/admin/view-users-by-cart-item?sale_id=\".concat(sales.id),\n        target: \"_blank\"\n      }, \"View Carts\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"thing-options\"\n      }, /*#__PURE__*/React.createElement(\"p\", null, /*#__PURE__*/React.createElement(\"label\", null, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        name: \"show-on-homepage\",\n        checked: !!show_on_homepage,\n        onChange: function onChange(event) {\n          return _this2.setState({\n            show_on_homepage: event.target.checked\n          });\n        }\n      }), \" Show on Homepage\"), /*#__PURE__*/React.createElement(\"input\", {\n        className: \"text\",\n        type: \"text\",\n        name: \"date-published\",\n        placeholder: \"2020-01-02 10:20:30\",\n        style: Display.NoneIf(!show_on_homepage),\n        value: date_published || '',\n        onChange: function onChange(event) {\n          _this2.setState({\n            date_published: event.target.value\n          });\n        }\n      })), /*#__PURE__*/React.createElement(\"p\", null, /*#__PURE__*/React.createElement(\"label\", null, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        name: \"exclude-from-popular\",\n        checked: !!exclude_from_popular,\n        onChange: function onChange(event) {\n          return _this2.setState({\n            exclude_from_popular: event.target.checked\n          });\n        }\n      }), \" Exclude from Popular\")), /*#__PURE__*/React.createElement(\"p\", null, /*#__PURE__*/React.createElement(\"label\", null, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        name: \"show-in-search\",\n        checked: !!show_in_search,\n        onChange: function onChange(event) {\n          return _this2.setState({\n            show_in_search: event.target.checked\n          });\n        }\n      }), \" Show in Search\")), /*#__PURE__*/React.createElement(\"p\", null, /*#__PURE__*/React.createElement(\"button\", {\n        className: classnames(\"btns-blue-embo\", {\n          \"loading\": optionSaving\n        }),\n        onClick: this.handleSaveOptions\n      }, \"Save Changes\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"thing-actions\"\n      }, /*#__PURE__*/React.createElement(\"p\", null, /*#__PURE__*/React.createElement(\"label\", null, \"Change Owner\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        name: \"change_owner\",\n        placeholder: \"Enter new username\",\n        ref: function ref(el) {\n          _this2.changeOwnerEl = el;\n        }\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        className: classnames(\"btns-blue-embo\", {\n          \"loading\": ownerSaving\n        }),\n        onClick: this.handleChangeOwner\n      }, \"Change\")))), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"ly-close\",\n        title: \"Close\"\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"ic-del-black\"\n      })));\n    }\n  }]);\n\n  return AdminPopup;\n}(React.Component);\n\n_defineProperty(AdminPopup, \"popupName\", 'thing-admin');\n\nexport { AdminPopup as default };","import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React from 'react';\nimport classnames from 'classnames';\nimport { closePopup, copyToClipboard } from 'fancyutils';\n\nvar SimpleSharePopup = /*#__PURE__*/function (_React$Component) {\n  _inherits(SimpleSharePopup, _React$Component);\n\n  function SimpleSharePopup(props) {\n    var _this;\n\n    _classCallCheck(this, SimpleSharePopup);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SimpleSharePopup).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCancelClick\", function (event) {\n      event.preventDefault();\n      closePopup(SimpleSharePopup.popupName);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCopyLink\", function (event) {\n      console.log('handleCopyLink');\n      var shareUrl = _this.state.shareUrl;\n      console.log('handleCopyLink ' + shareUrl);\n      copyToClipboard(shareUrl);\n\n      _this.setState({\n        urlCopied: true\n      });\n\n      setTimeout(function () {\n        _this.setState({\n          urlCopied: false\n        });\n      }, 2000);\n    });\n\n    var thing = props.thing,\n        viewer = props.viewer;\n    var url = \"https://fancy.com\".concat(thing.url);\n\n    if (viewer && viewer.username) {\n      var connector = ~url.indexOf('?') ? '&' : '?';\n      url = \"\".concat(url).concat(connector, \"ref=\").concat(viewer.username);\n    }\n\n    console.log(url);\n    _this.state = {\n      shareUrl: url,\n      urlCopied: false\n    };\n    return _this;\n  }\n\n  _createClass(SimpleSharePopup, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      $.dialog(SimpleSharePopup.popupName).center();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          thing = _this$props.thing,\n          viewer = _this$props.viewer;\n      var _this$state = this.state,\n          shareUrl = _this$state.shareUrl,\n          urlCopied = _this$state.urlCopied;\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"p\", {\n        className: \"ltit\"\n      }, \"Share\"), /*#__PURE__*/React.createElement(\"ul\", null, /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"a\", {\n        href: \"#\",\n        className: \"btn-copy-link link\",\n        onClick: this.handleCopyLink\n      }, urlCopied ? \"Copied to clipboard\" : \"Copy link\")), /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"a\", {\n        href: \"http://pinterest.com/pin/create/link/?url=\".concat(encodeURIComponent(shareUrl), \"&media=\").concat(thing.images ? encodeURIComponent(thing.images[0].image_url) : \"\", \"&description=\").concat(encodeURIComponent(thing.name)),\n        target: \"_blank\",\n        className: \"pin\"\n      }, \"Share to Pinterest\")), /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"a\", {\n        href: \"mailto:?body=Check%20out%20\".concat(encodeURIComponent(thing.name), \"%20on%20Fancy!%0A%0A\").concat(encodeURIComponent(shareUrl), \"&subject=\").concat(encodeURIComponent(thing.name), \"%20on%20Fancy\"),\n        target: \"_blank\",\n        className: \"email\"\n      }, \"Share via email\"))), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"ly-close\",\n        title: \"Close\"\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"ic-del-black\"\n      })));\n    }\n  }]);\n\n  return SimpleSharePopup;\n}(React.Component);\n\n_defineProperty(SimpleSharePopup, \"popupName\", 'minimum-share');\n\nexport { SimpleSharePopup as default };","import React from 'react';\nexport function getFancyContextDefaultValue() {\n  return {\n    appContext: {},\n    thing: {},\n    followContext: {},\n    fancyContext: {},\n    slideContext: {},\n    saleContext: {},\n    dispatch: function dispatch() {}\n  };\n} // @ts-ignore\n\nvar FancyContext = /*#__PURE__*/React.createContext(getFancyContextDefaultValue());\nexport var useFancy = function useFancy() {\n  return React.useContext(FancyContext);\n};\nexport default FancyContext;","import _extends from \"@babel/runtime/helpers/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useRef, useEffect } from \"react\";\nimport classnames from \"classnames\";\nimport { Swiper, SwiperSlide } from \"swiper/react\";\nimport ThingCard from \"./ThingCard\";\nimport { useFancy } from \"./FancyContext\";\n\nvar MerchantInfo = function MerchantInfo() {\n  var _useFancy = useFancy(),\n      thing = _useFancy.thing,\n      seller = _useFancy.thing.sales.seller;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      showMore = _useState2[0],\n      setShowMore = _useState2[1];\n\n  var descEl = useRef(null);\n  useEffect(function () {\n    setShowMore(descEl.current ? descEl.current.clientHeight <= 80 : false);\n  }, [thing.id]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"merchant-info\"\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"stit\"\n  }, \"More about \", seller.brand_name), /*#__PURE__*/React.createElement(\"div\", {\n    className: classnames(\"description\", {\n      collapsed: !showMore\n    })\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    dangerouslySetInnerHTML: {\n      __html: seller.description\n    },\n    ref: descEl\n  })), /*#__PURE__*/React.createElement(\"a\", {\n    className: \"more\",\n    style: {\n      display: showMore ? \"none\" : undefined\n    },\n    onClick: function onClick() {\n      return setShowMore(true);\n    }\n  }, \"Read more\"), /*#__PURE__*/React.createElement(\"a\", {\n    className: \"btns-blue-embo\",\n    href: seller.shop_url\n  }, \"Explore more\"), /*#__PURE__*/React.createElement(Swiper, {\n    className: \"swiper-no-swiping\"\n  }, seller.sale_items.map(function (item, i) {\n    return /*#__PURE__*/React.createElement(SwiperSlide, {\n      key: i,\n      tag: \"li\"\n    }, /*#__PURE__*/React.createElement(ThingCard, _extends({}, item, {\n      brand_name: seller.brand_name\n    })));\n  })));\n};\n\nexport default MerchantInfo;","import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState } from \"react\";\nimport { Swiper, SwiperSlide } from \"swiper/react\";\nimport ThingCard from \"./ThingCard\";\nimport { useFancy } from \"./FancyContext\";\n\nvar Recommendation = function Recommendation() {\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Likeable, null), /*#__PURE__*/React.createElement(RecentlyViewed, null));\n};\n\nvar convertThingsV1 = function convertThingsV1(things) {\n  return things.map(function (_ref) {\n    var html_url = _ref.url,\n        image_url = _ref.thumb_image_url_558,\n        sales = _ref.sales,\n        name = _ref.name;\n    return {\n      html_url: html_url,\n      image_url: image_url,\n      max_price: sales ? sales[0].max_price : 0,\n      min_price: sales ? sales[0].min_price : 0,\n      brand_name: sales ? sales[0].seller.brand_name : '',\n      title: sales ? sales[0].title : name\n    };\n  });\n};\n\nvar Likeable = function Likeable() {\n  var _useFancy = useFancy(),\n      recommended = _useFancy.thing.recommended;\n\n  return recommended && recommended.length > 0 && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"recommend similar\"\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"stit\"\n  }, \"You May Also Like\")), /*#__PURE__*/React.createElement(Swiper, {\n    className: \"recommend similar swiper-no-swiping\",\n    slidesPerColumn: 5\n  }, recommended?.map(function (thing, i) {\n    return /*#__PURE__*/React.createElement(SwiperSlide, {\n      key: i\n    }, /*#__PURE__*/React.createElement(ThingCard, thing));\n  })));\n};\n\nvar RecentlyViewed = function RecentlyViewed() {\n  var _useFancy2 = useFancy(),\n      thing = _useFancy2.thing;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      things = _useState2[0],\n      setThings = _useState2[1]; // const [offset, setOffset] = useState(4);\n\n\n  var offset = 4;\n  useEffect(function () {\n    $.ajax({\n      type: \"get\",\n      url: \"/recently_viewed_things_json?include_sale_item_option=True&rapi_compl=True&count=4&thing_id=\".concat(thing.id)\n    }).then(function (response) {\n      var recently = convertThingsV1(response);\n      setThings(recently);\n    });\n  }, []);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"recommend recently\"\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"stit\"\n  }, \"Recently Viewed\")), /*#__PURE__*/React.createElement(Swiper, {\n    className: \"recommend recently swiper-no-swiping\",\n    slidesPerColumn: 4\n  }, things ? things.filter(function (_, i) {\n    if (offset > 4) {\n      return i >= offset - 4 && i < offset;\n    }\n\n    return i < offset;\n  }).map(function (thing, i) {\n    return /*#__PURE__*/React.createElement(SwiperSlide, {\n      key: i\n    }, /*#__PURE__*/React.createElement(ThingCard, thing));\n  }) : null));\n};\n\nexport default Recommendation;","import _objectSpread from \"@babel/runtime/helpers/objectSpread\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport cx from \"classnames\";\nimport React, { useEffect, useState } from \"react\";\nimport SwiperCore, { Thumbs } from \"swiper\";\nimport Lightbox from \"react-image-lightbox\";\nimport { debounceEventUntilTimeout } from \"fancyutils\";\nimport { useFancy } from \"./FancyContext\";\nSwiperCore.use([Thumbs]);\n\nfunction useDefaultReviews(_ref) {\n  var page = _ref.page,\n      per_page = _ref.per_page,\n      q = _ref.q,\n      sort = _ref.sort,\n      setLoading = _ref.setLoading;\n\n  var _useFancy = useFancy(),\n      thing = _useFancy.thing;\n\n  var sid = thing.sales.id;\n  var skip = !sort && !per_page && (!page || page === 1) && !q;\n  var reviews = useReviews({\n    skip: skip,\n    sid: sid,\n    page: page,\n    per_page: per_page,\n    q: q,\n    sort: sort,\n    setLoading: setLoading\n  });\n\n  if (skip) {\n    return thing.reviews;\n  } else {\n    return reviews;\n  }\n}\n\nfunction useReviews(_ref2) {\n  var _ref2$skip = _ref2.skip,\n      skip = _ref2$skip === void 0 ? false : _ref2$skip,\n      sid = _ref2.sid,\n      page = _ref2.page,\n      per_page = _ref2.per_page,\n      q = _ref2.q,\n      sort = _ref2.sort,\n      setLoading = _ref2.setLoading;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      reviews = _useState2[0],\n      setReviews = _useState2[1];\n\n  var param = $.extend({}, {\n    q: q,\n    page: page,\n    per_page: per_page,\n    sort: sort\n  });\n  useEffect(function () {\n    if (skip) {\n      return;\n    }\n\n    setLoading?.(true);\n    $.get(\"/rest-api/v2/reviews/saleitem/\".concat(sid), param).then(function (res) {\n      setReviews(res);\n    }).always(function () {\n      setLoading?.(false);\n    });\n  }, [skip, sid, q, page, per_page, sort]);\n  return reviews;\n}\n\nvar Reviews = function Reviews() {\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var _useState5 = useState({\n    page: undefined,\n    per_page: undefined,\n    q: undefined,\n    sort: undefined\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      reviewOption = _useState6[0],\n      _setReviewOption = _useState6[1];\n\n  var reviews = useDefaultReviews(_objectSpread({}, reviewOption, {\n    setLoading: setLoading\n  }));\n\n  if (reviewOption.q === undefined && (!reviews || reviews.review_count === 0)) {\n    return null;\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(\"review-points review-section\", {\n      loading: loading\n    })\n  }, /*#__PURE__*/React.createElement(ReviewHead, {\n    reviews: reviews\n  }), /*#__PURE__*/React.createElement(ReviewList, {\n    reviews: reviews,\n    reviewOption: reviewOption,\n    setReviewOption: function setReviewOption(applying) {\n      _setReviewOption(_objectSpread({}, reviewOption, applying));\n    }\n  }));\n};\n\nvar ReviewHead = function ReviewHead(_ref3) {\n  var reviews = _ref3.reviews;\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"stit\"\n  }, reviews.summary.rating_avg, \" \", /*#__PURE__*/React.createElement(\"small\", {\n    className: \"count\"\n  }, \"(\", reviews.summary.total_ratings, \" rating\", reviews.summary.total_ratings != 1 ? \"s\" : \"\", \")\")), /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"optional\"\n  }, reviews.summary.attributes.map(function (a, i) {\n    return /*#__PURE__*/React.createElement(\"li\", {\n      key: i\n    }, /*#__PURE__*/React.createElement(\"label\", null, a.label), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"review-range\"\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"review-range-value\",\n      style: {\n        width: \"\".concat(Number(a.rating) * 20, \"%\")\n      }\n    })), /*#__PURE__*/React.createElement(\"b\", null, a.rating));\n  })));\n};\n\nvar ReviewEntry = function ReviewEntry(_ref4) {\n  var review = _ref4.review;\n\n  var _useState7 = useState(null),\n      _useState8 = _slicedToArray(_useState7, 2),\n      photoIndex = _useState8[0],\n      setPhotoIndex = _useState8[1];\n\n  return /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"small\", {\n    className: \"date\"\n  }, review.date), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"review-range \" + \"point\" + (review.rating | 0)\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"bg\"\n  }), /*#__PURE__*/React.createElement(\"i\", {\n    className: \"review-range-value\"\n  }, /*#__PURE__*/React.createElement(\"span\", null))), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"username\"\n  }, review.name), \" \", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"verified\"\n  }, /*#__PURE__*/React.createElement(\"em\", null, \"Verified User\")), /*#__PURE__*/React.createElement(\"b\", {\n    className: \"title\"\n  }, review.title), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"description\"\n  }, review.review), /*#__PURE__*/React.createElement(\"div\", null, review.images.map(function (image, i) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"photo\",\n      key: i\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      onClick: function onClick() {\n        setPhotoIndex(i);\n      },\n      alt: \"review image\",\n      src: \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\",\n      style: {\n        backgroundImage: \"url('\".concat(image.thumbnail_url, \"')\")\n      }\n    }));\n  }), photoIndex !== null && /*#__PURE__*/React.createElement(Lightbox, {\n    mainSrc: review.images[photoIndex].image_url,\n    nextSrc: review.images[(photoIndex + 1) % review.images.length].image_url,\n    prevSrc: review.images[(photoIndex + review.images.length - 1) % review.images.length].image_url,\n    onCloseRequest: function onCloseRequest() {\n      return setPhotoIndex(null);\n    },\n    onMovePrevRequest: function onMovePrevRequest() {\n      return setPhotoIndex((photoIndex + review.images.length - 1) % review.images.length);\n    },\n    onMoveNextRequest: function onMoveNextRequest() {\n      return setPhotoIndex((photoIndex + 1) % review.images.length);\n    }\n  })));\n};\n\nvar ReviewList = function ReviewList(_ref5) {\n  var reviews = _ref5.reviews,\n      reviewOption = _ref5.reviewOption,\n      setReviewOption = _ref5.setReviewOption;\n  var currentPage = reviewOption.page || 1;\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"fieldset\", {\n    className: \"search\"\n  }, /*#__PURE__*/React.createElement(\"label\", null, \"Filter reviews\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"Search topics and reviews\",\n    className: \"text\",\n    onChange: debounceEventUntilTimeout(function (e) {\n      setReviewOption({\n        q: e.target.value\n      });\n    }, 500)\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"sort\"\n  }, /*#__PURE__*/React.createElement(\"label\", null, \"Sort By:\"), /*#__PURE__*/React.createElement(\"select\", {\n    onChange: function onChange(_ref6) {\n      var target = _ref6.target;\n      setReviewOption({\n        sort: target.value\n      });\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    value: \"newest\"\n  }, \"Most Recent\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"rating_desc\"\n  }, \"Highest Rated\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"rating_asc\"\n  }, \"Lowest Rated\")))), /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"review-list\"\n  }, reviews.reviews.length > 0 ? reviews.reviews.map(function (review, i) {\n    return /*#__PURE__*/React.createElement(ReviewEntry, {\n      key: i,\n      review: review\n    });\n  }) : /*#__PURE__*/React.createElement(\"li\", {\n    className: \"no-review\"\n  }, \"There is no review matching your request. Please try another option.\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"review-pagination\"\n  }, currentPage > 1 && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"a\", {\n    href: \"#\",\n    className: \"more\"\n  }, \"See more reviews\"), /*#__PURE__*/React.createElement(\"a\", {\n    className: \"prev\",\n    onClick: function onClick() {\n      setReviewOption({\n        page: Math.max(1, currentPage - 1)\n      });\n    }\n  }, \"Prev\")), currentPage < reviews.total_pages && /*#__PURE__*/React.createElement(\"a\", {\n    className: \"next\",\n    onClick: function onClick() {\n      setReviewOption({\n        page: Math.min(currentPage + 1, reviews.total_pages)\n      });\n    }\n  }, \"Next\"), _.range(1, reviews.total_pages + 1).map(function (pageNum, i) {\n    return /*#__PURE__*/React.createElement(\"a\", {\n      key: i,\n      onClick: function onClick() {\n        setReviewOption({\n          page: pageNum\n        });\n      },\n      className: currentPage === pageNum ? \"current\" : undefined\n    }, pageNum);\n  })));\n};\n\nexport default Reviews;","import React from \"react\";\nimport classnames from \"classnames\";\nimport { MP, renderPopup } from \"fancyutils\";\nimport { useDispatch } from 'react-redux';\nimport { useFancy } from \"../FancyContext\";\nimport AdminPopup from \"../../popup/AdminPopup\";\nimport SimpleSharePopup from \"../../popup/SimpleSharePopup\";\nimport AddlistPopup from \"../../popup/AddlistPopup\";\nimport { toggleFancy, getCordialProperties } from \"../../../action/action-helpers\";\n\nfunction Favorite() {\n  var _useFancy = useFancy(),\n      appContext = _useFancy.appContext,\n      thing = _useFancy.thing,\n      fancyContext = _useFancy.fancyContext;\n\n  var dispatch = useDispatch();\n\n  var handleClick = function handleClick(event) {\n    event.preventDefault();\n    event.stopPropagation();\n    console.log('favortie');\n\n    if (!appContext.loggedIn) {\n      window.require_login(null, \"fancy_thing\", thing.id);\n      return;\n    }\n\n    if (fancyContext.loading) {\n      return;\n    }\n\n    dispatch(toggleFancy(thing.id));\n\n    if (!fancyContext.fancyd) {\n      MP(\"Fancy\", {\n        thing_id: thing.id\n      });\n\n      try {\n        window.crdl('event', 'favorite_item', getCordialProperties(thing));\n      } catch (e) {}\n    } else {\n      MP(\"Unfancy\", {\n        thing_id: thing.id\n      });\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"a\", {\n    className: classnames(\"button button-static fancy _count\", {\n      fancyd: fancyContext.fancyd\n    }),\n    onClick: handleClick\n  }, \"Favorite\");\n}\n\nexport default function ActionButtons() {\n  var _useFancy2 = useFancy(),\n      _useFancy2$appContext = _useFancy2.appContext,\n      viewer = _useFancy2$appContext.viewer,\n      loggedIn = _useFancy2$appContext.loggedIn,\n      thing = _useFancy2.thing,\n      fancyContext = _useFancy2.fancyContext;\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"_fancyd fancyd_user\"\n  }, fancyContext.fancyd_count, \" people favorited\"), /*#__PURE__*/React.createElement(\"a\", {\n    onClick: function onClick(event) {\n      event.preventDefault();\n\n      if (!loggedIn) {\n        window.require_login();\n        return;\n      }\n\n      renderPopup(AddlistPopup, {\n        objectId: thing.id\n      });\n    },\n    className: \"add-list\"\n  }, \"Add to List\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"figure-button action-button-v2\"\n  }, viewer.is_admin_any && /*#__PURE__*/React.createElement(\"a\", {\n    className: \"edit\",\n    onClick: function onClick(event) {\n      event.preventDefault();\n      renderPopup(AdminPopup, {\n        viewer: viewer,\n        thing: thing\n      });\n    }\n  }, \"Edit\"), /*#__PURE__*/React.createElement(Favorite, null), /*#__PURE__*/React.createElement(\"a\", {\n    className: \"btn-share\",\n    onClick: function onClick(event) {\n      event.preventDefault();\n      renderPopup(SimpleSharePopup, {\n        viewer: viewer,\n        thing: thing\n      });\n    }\n  }, \"Share\")));\n}","import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState, useRef } from \"react\";\nimport cx from \"classnames\";\nimport { useFancy } from \"../FancyContext\";\n\nvar Overview = function Overview() {\n  var _useFancy = useFancy(),\n      thing = _useFancy.thing;\n\n  var sales = thing.sales;\n  var bv = sales.seller.brand_values;\n  var shippingInfo = sales.shipping_info || {};\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"overview\"\n  }, /*#__PURE__*/React.createElement(\"dl\", {\n    className: \"shipping optional\"\n  }, /*#__PURE__*/React.createElement(\"dt\", null, \"Shipping Information\"), /*#__PURE__*/React.createElement(\"dd\", null, /*#__PURE__*/React.createElement(\"ul\", null, /*#__PURE__*/React.createElement(\"li\", {\n    className: \"from\"\n  }, /*#__PURE__*/React.createElement(\"span\", null, shippingInfo.origin)), shippingInfo.cost && /*#__PURE__*/React.createElement(\"li\", {\n    className: \"cost\"\n  }, /*#__PURE__*/React.createElement(\"span\", null, shippingInfo.cost)), shippingInfo.window && /*#__PURE__*/React.createElement(\"li\", {\n    className: \"days\"\n  }, /*#__PURE__*/React.createElement(\"span\", null, shippingInfo.window))))), bv.length > 0 ? /*#__PURE__*/React.createElement(\"dl\", {\n    className: \"brand-value optional\"\n  }, /*#__PURE__*/React.createElement(\"dt\", null, \"Buy with Confidence\"), /*#__PURE__*/React.createElement(\"dd\", null, bv.slice(0, 3).map(function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        className = _ref2[0],\n        text = _ref2[1];\n\n    return /*#__PURE__*/React.createElement(\"span\", {\n      key: className,\n      className: \"badge \".concat(className)\n    }, text);\n  }))) : null);\n};\n\nvar Description = function Description() {\n  var _useState = useState(\"features\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      menu = _useState2[0],\n      setMenu = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      showMore = _useState4[0],\n      setShowMore = _useState4[1];\n\n  var descEl = useRef(null);\n  var props = useFancy();\n  var thing = props.thing,\n      sales = props.thing.sales;\n  var showFeatures = !!(sales.features && sales.features.trim());\n  var showSpecs = !!(sales.specifications && sales.specifications.trim());\n  var showReturns = !!(sales.return_exchange_policy_title && sales.return_exchange_policy_title.trim()) || !!(sales.shipping_policy && sales.shipping_policy.trim());\n  useEffect(function () {\n    if (showFeatures) {\n      setMenu('features');\n    } else if (showSpecs) {\n      setMenu('specification');\n    } else if (showReturns) {\n      setMenu('returns');\n    }\n\n    setShowMore(descEl.current ? descEl.current.clientHeight <= 76 : false);\n  }, [thing.id]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"detail\"\n  }, /*#__PURE__*/React.createElement(\"dl\", {\n    className: cx(\"description optional\")\n  }, /*#__PURE__*/React.createElement(\"dt\", null, \"Description\"), /*#__PURE__*/React.createElement(\"dd\", {\n    className: cx({\n      collapsed: !showMore\n    })\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    dangerouslySetInnerHTML: {\n      __html: sales.description\n    },\n    ref: descEl\n  })), /*#__PURE__*/React.createElement(\"a\", {\n    className: \"more\",\n    onClick: function onClick() {\n      return setShowMore(true);\n    },\n    style: {\n      display: showMore ? 'none' : undefined\n    }\n  }, \"Read more\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"features-menu\"\n  }, showFeatures && /*#__PURE__*/React.createElement(\"a\", {\n    className: cx({\n      current: menu === \"features\"\n    }),\n    onClick: function onClick(e) {\n      e.preventDefault();\n      setMenu(\"features\");\n    }\n  }, \"Features\"), showSpecs && /*#__PURE__*/React.createElement(\"a\", {\n    className: cx({\n      current: menu === \"specification\"\n    }),\n    onClick: function onClick(e) {\n      e.preventDefault();\n      setMenu(\"specification\");\n    }\n  }, \"Specifications\"), showReturns && /*#__PURE__*/React.createElement(\"a\", {\n    className: cx({\n      current: menu === \"returns\"\n    }),\n    onClick: function onClick(e) {\n      e.preventDefault();\n      setMenu(\"returns\");\n    }\n  }, \"Returns\")), showFeatures && /*#__PURE__*/React.createElement(\"dl\", {\n    className: cx(\"features optional\", {\n      show: menu === \"features\"\n    }),\n    \"data-featuretype\": \"features\"\n  }, /*#__PURE__*/React.createElement(\"dt\", null, /*#__PURE__*/React.createElement(\"a\", {\n    onClick: function onClick(e) {\n      e.preventDefault();\n      setMenu(\"features\");\n    }\n  }, \"Features\")), /*#__PURE__*/React.createElement(\"dd\", {\n    dangerouslySetInnerHTML: {\n      __html: sales.features\n    }\n  })), showSpecs && /*#__PURE__*/React.createElement(\"dl\", {\n    className: cx(\"features optional\", {\n      show: menu === \"specification\"\n    }),\n    \"data-featuretype\": \"specifications\"\n  }, /*#__PURE__*/React.createElement(\"dt\", null, /*#__PURE__*/React.createElement(\"a\", {\n    onClick: function onClick(e) {\n      e.preventDefault();\n      setMenu(\"specification\");\n    }\n  }, \"Specifications\")), /*#__PURE__*/React.createElement(\"dt\", null), /*#__PURE__*/React.createElement(\"dd\", {\n    dangerouslySetInnerHTML: {\n      __html: sales.specifications\n    }\n  })), showReturns && /*#__PURE__*/React.createElement(\"dl\", {\n    className: cx(\"features optional\", {\n      show: menu === \"returns\"\n    }),\n    \"data-featuretype\": \"returns\"\n  }, /*#__PURE__*/React.createElement(\"dt\", null, /*#__PURE__*/React.createElement(\"a\", {\n    onClick: function onClick(e) {\n      e.preventDefault();\n      setMenu(\"returns\");\n    }\n  }, \"Returns\")), /*#__PURE__*/React.createElement(\"dd\", null, /*#__PURE__*/React.createElement(\"p\", null, sales.return_exchange_policy_title), /*#__PURE__*/React.createElement(\"p\", null, sales.shipping_policy))));\n};\n\nvar Detail = function Detail() {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"figure-detail\"\n  }, /*#__PURE__*/React.createElement(Overview, null), /*#__PURE__*/React.createElement(Description, null));\n};\n\nexport default Detail;","import _objectSpread from \"@babel/runtime/helpers/objectSpread\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { memo, useEffect, useState, useRef } from \"react\";\nimport classnames from \"classnames\";\nimport { Swiper, SwiperSlide } from \"swiper/react\";\nimport SwiperCore, { Thumbs, Zoom } from \"swiper\";\nimport { Video } from \"common-components\";\nimport { Display } from \"fancymixin\";\nimport { useFancy } from \"../../FancyContext\";\nimport ActionButtons from \"../ActionButtons\";\nimport { getCurrentSaleOption, getSaleImages } from \"../../../map\";\nimport { setThumbnailIndex } from \"../../../../action/actions\";\nimport { isZoomable, getZoomImageStyle, getNextZoomImageStyle } from \"./zoom\";\nvar isTouchDevice = \"ontouchstart\" in window || navigator.maxTouchPoints > 0 || navigator.msMaxTouchPoints > 0;\nvar SwiperAddons = [Thumbs];\n\nif (isTouchDevice) {\n  SwiperAddons.push(Zoom);\n}\n\nSwiperCore.use(SwiperAddons);\nvar placeholderImage = \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\";\nvar HEIGHT = 480;\nvar PER_PAGE = 5;\n\nvar preloadImage = function preloadImage(src) {\n  return new Promise(function (r) {\n    var image = new window.Image();\n    image.onload = r;\n    image.onerror = r;\n    image.src = src;\n  });\n};\n\nvar ImageSlide = /*#__PURE__*/memo(function (_ref) {\n  var image = _ref.image,\n      i = _ref.i,\n      setSlideLocked = _ref.setSlideLocked,\n      isActive = _ref.isActive;\n\n  var _useFancy = useFancy(),\n      thing = _useFancy.thing,\n      thumbnailIndex = _useFancy.slideContext.thumbnailIndex;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isZoomActive = _useState2[0],\n      setZoomActive = _useState2[1];\n\n  var _useState3 = useState(Display.None),\n      _useState4 = _slicedToArray(_useState3, 2),\n      zoomImageStyle = _useState4[0],\n      setZoomImageStyle = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      zoomImageCacheKey = _useState6[0],\n      setZoomImageCacheKey = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      zoomImageLoaded = _useState8[0],\n      setZoomImageLoaded = _useState8[1];\n\n  var isVideo = !!image.h264_1000k_url;\n  var isMagnifyingGlassZoomable = !isVideo && !isTouchDevice;\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      zoomable = _useState10[0],\n      setZoomable = _useState10[1];\n\n  useEffect(function () {\n    if (!zoomImageCacheKey && isZoomActive) {\n      preloadImage(image.large_image_url).then(function () {\n        setZoomImageCacheKey(image.large_image_url);\n        setZoomImageLoaded(true);\n      });\n    }\n\n    if (zoomImageCacheKey !== \"\" && image.large_image_url !== zoomImageCacheKey) {\n      setZoomImageCacheKey(\"\");\n      setZoomImageLoaded(false);\n    }\n  }, [image.large_image_url, isZoomActive, zoomImageCacheKey]);\n  return /*#__PURE__*/React.createElement(SwiperSlide, {\n    zoom: isMagnifyingGlassZoomable,\n    key: i,\n    className: classnames({\n      \"video-slide\": isVideo,\n      startZoom: isZoomActive,\n      zoomShow: zoomable,\n      'active-slide': isActive,\n      loading: thing.loading\n    }),\n    onClick: function onClick() {\n      if (isMagnifyingGlassZoomable && zoomable) {\n        setZoomActive(!isZoomActive);\n        setSlideLocked(!isZoomActive);\n      }\n    },\n    onMouseMove: function onMouseMove(_ref2) {\n      var pageX = _ref2.pageX,\n          pageY = _ref2.pageY;\n\n      if (!isMagnifyingGlassZoomable) {\n        return;\n      }\n\n      var newZoomable = isZoomable(image);\n\n      if (zoomable !== newZoomable) {\n        setZoomable(newZoomable);\n      }\n\n      if (isZoomActive) {\n        var nextZoomImageStyle = getNextZoomImageStyle(image, pageX, pageY);\n        setZoomImageStyle(nextZoomImageStyle);\n      }\n    }\n  }, isVideo ? /*#__PURE__*/React.createElement(Video, {\n    object: image,\n    display: true,\n    playing: thumbnailIndex == i,\n    lastFullyRenderedObjectID: thing.id,\n    allow: {\n      fullScreen: true\n    }\n  }) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"img\", {\n    className: \"swiper-lazy\",\n    src: image.image_url,\n    \"data-src\": image.image_url,\n    onLoad: function onLoad() {\n      setZoomable(isZoomable(image));\n    },\n    title: !isTouchDevice ? \"Double click to zoom-in\" : undefined,\n    alt: thing.name,\n    style: zoomable ? {\n      cursor: \"zoom-in\"\n    } : undefined\n  }), /*#__PURE__*/React.createElement(\"em\", {\n    className: \"zoomImage\",\n    onClick: function onClick() {\n      setZoomActive(false);\n      setSlideLocked(false);\n    },\n    style: _objectSpread({}, getZoomImageStyle(image, isZoomActive, zoomImageStyle), {\n      backgroundImage: \"url(\".concat(zoomImageLoaded ? image.large_image_url : image.image_url, \")\")\n    })\n  }), isTouchDevice && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"swiper-lazy-preloader\"\n  })));\n}, function (prevProps, nextProps) {\n  return prevProps.image.image_url === nextProps.image.image_url && prevProps.isActive === nextProps.isActive;\n});\nImageSlide.displayName = \"SwiperSlide\"; // This is important to make swiper to acknowledge it's actually slide, not some random components\n\nvar Image = function Image() {\n  var fancyProps = useFancy();\n  var thing = fancyProps.thing,\n      saleContext = fancyProps.saleContext,\n      thumbnailIndex = fancyProps.slideContext.thumbnailIndex;\n  var swiperRef = useRef(null);\n  var swipeThumbsRef = useRef(null);\n\n  var _useState11 = useState(0),\n      _useState12 = _slicedToArray(_useState11, 2),\n      thumbIndex = _useState12[0],\n      setThumbIndex = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      slideLocked = _useState14[0],\n      setSlideLocked = _useState14[1];\n\n  var _useState15 = useState(null),\n      _useState16 = _slicedToArray(_useState15, 2),\n      swiper = _useState16[0],\n      setSwiper = _useState16[1];\n\n  var option = getCurrentSaleOption(thing.sales, saleContext, true);\n  var images = getSaleImages(thing, option);\n  var lastThumbIndex = images.length - PER_PAGE;\n  useEffect(function () {\n    if (!swiper) {\n      return;\n    }\n\n    if (thumbnailIndex != swiper.activeIndex) {\n      swiper.slideTo(thumbnailIndex);\n    }\n\n    if (swipeThumbsRef.current) {\n      var thumbSwiper = swipeThumbsRef.current.swiper;\n      if (!thumbSwiper.slides[thumbnailIndex].classList.contains(\"swiper-slide-visible\")) thumbSwiper.slideTo(Math.min(thumbnailIndex, lastThumbIndex));\n    }\n  }, [thumbnailIndex, swiper]);\n  useEffect(function () {\n    if (!swipeThumbsRef.current) {\n      return;\n    }\n\n    var swiper = swipeThumbsRef.current.swiper;\n\n    if (thumbIndex != swiper.activeIndex) {\n      swiper.slideTo(thumbIndex);\n    }\n  }, [thumbIndex]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"figure-section\"\n  }, /*#__PURE__*/React.createElement(Swiper, {\n    ref: swiperRef,\n    onSlideChange: function onSlideChange() {\n      if (swiper) {\n        fancyProps.dispatch(setThumbnailIndex(swiper.activeIndex));\n      }\n    },\n    preloadImages: false,\n    lazy: {\n      loadPrevNext: true,\n      loadPrevNextAmount: 0\n    },\n    zoom: isTouchDevice ? {\n      maxRatio: 2\n    } : undefined,\n    allowSlidePrev: !slideLocked,\n    allowSlideNext: !slideLocked,\n    onZoomChange: function onZoomChange(_, scale) {\n      if (scale > 1) {\n        setSlideLocked(true);\n      } else {\n        setSlideLocked(false);\n      }\n    },\n    onSwiper: function onSwiper(swiper) {\n      setSwiper(swiper);\n    },\n    className: \"gallery-top\"\n  }, images.map(function (image, i) {\n    return /*#__PURE__*/React.createElement(ImageSlide, {\n      key: i,\n      image: image,\n      i: i,\n      setSlideLocked: setSlideLocked,\n      isActive: swiper?.activeIndex === i\n    });\n  }), /*#__PURE__*/React.createElement(ActionButtons, null)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"prev\",\n    style: {\n      opacity: thumbIndex > 0 ? undefined : 0.3,\n      display: lastThumbIndex <= 0 ? \"none\" : undefined\n    },\n    onClick: function onClick() {\n      return setThumbIndex(Math.max(0, thumbIndex - 5));\n    }\n  }), /*#__PURE__*/React.createElement(Swiper, {\n    className: \"gallery-thumbs\",\n    ref: swipeThumbsRef,\n    onSlideChange: function onSlideChange() {\n      swipeThumbsRef.current && setThumbIndex(swipeThumbsRef.current.swiper.activeIndex);\n    },\n    onClick: function onClick() {\n      return swipeThumbsRef.current && fancyProps.dispatch(setThumbnailIndex(swipeThumbsRef.current.swiper.clickedIndex));\n    },\n    direction: \"vertical\",\n    spaceBetween: 16,\n    slidesPerView: PER_PAGE,\n    watchSlidesVisibility: true,\n    height: HEIGHT\n  }, images.map(function (image, i) {\n    return /*#__PURE__*/React.createElement(SwiperSlide, {\n      key: i,\n      className: classnames({\n        \"video-thumbnail\": image.h264_1000k_url,\n        selected: i == thumbnailIndex\n      })\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      height: \"80\",\n      src: placeholderImage,\n      style: {\n        backgroundImage: \"url(\".concat(image.thumbnail_url, \")\")\n      }\n    }));\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"next\",\n    style: {\n      opacity: thumbIndex < lastThumbIndex ? undefined : 0.3,\n      display: lastThumbIndex <= 0 ? \"none\" : undefined\n    },\n    onClick: function onClick() {\n      setThumbIndex(Math.min(thumbIndex + 5, lastThumbIndex));\n    }\n  }));\n};\n\nexport default Image;","import _objectSpread from \"@babel/runtime/helpers/objectSpread\";\nimport { minmax } from \"fancyutils\";\nimport { Display } from \"fancymixin\";\n// TODO: cache per (thing id + image index)\nvar zoomBoxMaximumSize = 240;\nvar zoomScale = 1.5;\n\nvar getBoundarySize = function getBoundarySize() {\n  var $el = $(\".thing-detail-container .figure-section .swiper-container.gallery-top .active-slide\").eq(0);\n\n  if ($el.length !== 1) {\n    console.warn('getBoundarySize(): warning: $el.length is ', $el.length);\n  }\n\n  return {\n    $el: $el,\n    width: $el.width(),\n    height: $el.height()\n  };\n};\n\nvar getZoomBoxSize = function getZoomBoxSize(bs) {\n  return Math.min(bs.width / 3, zoomBoxMaximumSize);\n};\n\nvar getZoomMargin = function getZoomMargin(bs) {\n  return (getZoomBoxSize(bs) - 4) / 2;\n};\n\nvar zidCac = {};\n\nvar getZoomImageDimension = function getZoomImageDimension(img) {\n  var bs = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : getBoundarySize();\n\n  if (zidCac[img.image_url]) {\n    return zidCac[img.image_url];\n  }\n\n  var zoomMargin = getZoomMargin(bs); // const imageSize = calculateImageSize(img);\n\n  var ret = {\n    width: bs.width * zoomScale\n    /* * (imageSize.larger === \"height\" ? imageSize.proportion : 1) */\n    + zoomMargin,\n    height: bs.height * zoomScale + zoomMargin\n    /* ((b.height * imageSize.height) / imageSize.width) *\n            (imageSize.larger === \"width\" ? imageSize.proportion : 1) *\n            zoomScale +\n        zoomMargin ,*/\n\n  };\n  zidCac[img.image_url] = ret;\n  return ret;\n};\n\nvar getImageMeta = function getImageMeta(bs) {\n  var width, height, marginHoriz, marginVert;\n  var $fig = $(\".thing-detail-container .figure-section .swiper-container.gallery-top img:eq(0)\");\n  width = $fig.width();\n  height = $fig.height();\n  marginHoriz = 0;\n\n  if (width > height) {\n    marginHoriz = 0;\n    marginVert = (bs.height - height) / 2;\n  } else {\n    marginHoriz = (bs.width - width) / 2;\n    marginVert = 0;\n  }\n\n  return {\n    width: width,\n    height: height,\n    marginHoriz: marginHoriz,\n    marginVert: marginVert\n  };\n};\n\nexport var getNextZoomImageStyle = function getNextZoomImageStyle(img, pageX, pageY) {\n  var bs = getBoundarySize();\n  var $wrapper = bs.$el;\n\n  if (!$wrapper.length) {\n    return Display.None;\n  }\n\n  var boundaryWidth = bs.width;\n  var boundaryHeight = bs.height;\n  var meta = getImageMeta(bs);\n  var offset = $wrapper.offset();\n  var left = pageX - offset.left;\n  var top = pageY - offset.top;\n  var topPosition = top - (boundaryHeight - meta.height) / 2;\n  var showZoomImage = left > 0 && topPosition > 0 && topPosition < meta.height;\n  var zoomBoxSize = getZoomBoxSize(bs);\n  var zoomMargin = getZoomMargin(bs);\n\n  if (showZoomImage) {\n    var zd = getZoomImageDimension(img, bs);\n    var zoomImageContainerX = minmax(left - zoomMargin, meta.marginHoriz, meta.marginHoriz + meta.width - zoomBoxSize);\n    var zoomImageContainerY = minmax(top - zoomMargin, meta.marginVert, meta.marginVert + meta.height - zoomBoxSize);\n    var backgroundLeft = zd.width * left / boundaryWidth - zoomMargin;\n    var backgroundTop = zd.height * top / boundaryHeight - zoomMargin;\n    var bgPosX = -minmax(backgroundLeft, 0, zd.width - zoomBoxSize);\n    var bgPosY = -minmax(backgroundTop, 0, zd.height - zoomBoxSize);\n    return {\n      left: 0,\n      top: 0,\n      width: \"\".concat(zoomBoxSize, \"px\"),\n      height: \"\".concat(zoomBoxSize, \"px\"),\n      transform: \"translate(\".concat(zoomImageContainerX, \"px, \").concat(zoomImageContainerY, \"px)\"),\n      backgroundPosition: \"\".concat(bgPosX, \"px \").concat(bgPosY, \"px\"),\n      display: \"inline\"\n    };\n  } else {\n    return Display.None;\n  }\n};\nvar RESIZED_SIZE = 1280;\n\nvar calculateImageSize = function calculateImageSize(img) {\n  var size = Math.max(img.width, img.height);\n\n  if (size < RESIZED_SIZE) {\n    var smallerSize = Math.min(img.width, img.height);\n    return {\n      width: img.width,\n      height: img.height,\n      proportion: size / smallerSize,\n      larger: img.width > img.height ? \"width\" : \"height\"\n    };\n  } else {\n    if (img.width > img.height) {\n      var proportion = RESIZED_SIZE / img.width;\n      return {\n        width: RESIZED_SIZE,\n        height: img.height / proportion,\n        proportion: proportion,\n        larger: \"width\"\n      };\n    } else {\n      var _proportion = RESIZED_SIZE / img.height;\n\n      return {\n        width: img.width / _proportion,\n        height: RESIZED_SIZE,\n        proportion: _proportion,\n        larger: \"height\"\n      };\n    }\n  }\n};\n\nexport var isZoomable = function isZoomable(img) {\n  var imageSize = calculateImageSize(img);\n  var boundarySize = getBoundarySize();\n  return imageSize.width > boundarySize.width * zoomScale || imageSize.height > boundarySize.height * zoomScale;\n};\nexport var getZoomImageStyle = function getZoomImageStyle(img, isZoomActive, currentZoomImageStyle) {\n  if (isZoomable(img) && isZoomActive) {\n    var zd = getZoomImageDimension(img);\n\n    var ret = _objectSpread({}, currentZoomImageStyle, {\n      backgroundSize: \"\".concat(zd.width, \"px \").concat(zd.height, \"px\")\n    });\n\n    return ret;\n  } else {\n    return Display.None;\n  }\n};","import React from \"react\";\nimport SaleItem from \"./SaleItem\";\nimport { useFancy } from \"../FancyContext\";\n\nvar Info = function Info() {\n  var fancyProps = useFancy();\n  var thing = fancyProps.thing,\n      _fancyProps$thing = fancyProps.thing,\n      reviews = _fancyProps$thing.reviews,\n      sales = _fancyProps$thing.sales,\n      fancyContext = fancyProps.fancyContext;\n  var r = reviews.summary;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"figure-info\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vendor\"\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    href: sales.seller.shop_url\n  }, sales.seller.brand_name)), r.total_ratings > 0 && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"review-points\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      cursor: r.total_reviews > 0 ? \"pointer\" : undefined\n    },\n    onClick: function onClick() {\n      if (r.total_reviews > 0) {\n        var $el = $(\".review-section\");\n        var headerSize = parseInt($(\".container\").css(\"padding-top\")) || 0;\n\n        if ($el.length) {\n          $(window).scrollTop($el[0].offsetTop - headerSize);\n        }\n      }\n    }\n  }, r.rating_avg, \" \", /*#__PURE__*/React.createElement(\"small\", {\n    className: \"count\"\n  }, \"(\", r.total_ratings, \" rating\", r.total_ratings != 1 ? 's' : '', \")\"), \" \")), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"_fancyd fancyd_user\"\n  }, fancyContext.fancyd_count, \" people favorited\"), /*#__PURE__*/React.createElement(SaleItem, fancyProps));\n};\n\nexport default Info;","import _extends from \"@babel/runtime/helpers/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from \"react\";\nimport classnames from \"classnames\";\nimport { floatFormatMinusTwo, numberFormat, renderPopup, escapeSelector, getLocationArgPairs } from \"fancyutils\";\nimport appState from \"../../../appstate\";\nimport { convertCurrency, updateSaleContext } from \"../../../action/action-helpers\";\nimport { updateAppContext } from \"../../../action/actions\";\nimport { currencyIsUSD, getCurrentSaleOption, getSafeNameProp, getWaiting, isSalesOptionsAvailable } from \"../../map\";\nimport { Keys } from \"../../Perf\";\nimport { CartButton, SelectBox, handlePurchase, MultiOption, MultiOptionState } from \"./SaleItemForm\";\n\nfunction optionValueFunction(opt) {\n  return opt.id;\n}\n\nvar saleNamePrinter = function saleNamePrinter(opt) {\n  return \"\".concat(opt.name, \" - $\").concat(opt.price);\n};\n\nvar SaleItemSidebarHead = /*#__PURE__*/function (_Component) {\n  _inherits(SaleItemSidebarHead, _Component);\n\n  function SaleItemSidebarHead(props) {\n    var _this;\n\n    _classCallCheck(this, SaleItemSidebarHead);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SaleItemSidebarHead).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      loading: false,\n      selected: {},\n      disabled: [],\n      multiOptionState: null\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handlePurchase\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"renderCurrencyPopup\", function () {\n      import(\n      /* webpackChunkName: \"OverlayThing.popup\" */\n      \"../../popup/index\").then(function (_ref) {\n        var CurrencyPopup = _ref.CurrencyPopup;\n        renderPopup(CurrencyPopup, {\n          currentCurrency: _this.props.saleContext.currencyCode\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCurrencyPopup\", function (event) {\n      event.preventDefault();\n\n      _this.renderCurrencyPopup();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCurrencyPopupUSD\", function (event) {\n      event.preventDefault();\n\n      if (!currencyIsUSD(_this.props)) {\n        return false;\n      }\n\n      _this.renderCurrencyPopup();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getApproxText\", function () {\n      var _this$props$saleConte = _this.props.saleContext,\n          currencySymbol = _this$props$saleConte.currencySymbol,\n          currencyMoney = _this$props$saleConte.currencyMoney;\n      var approxText = gettext(\"Approximately\");\n      return \"\".concat(approxText, \" \").concat(currencySymbol).concat(currencyMoney, \" \");\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleOptionChange\", function (event) {\n      var dispatch = _this.props.dispatch;\n      var saleOptionID = parseInt(event.currentTarget.value, 10);\n      dispatch(updateSaleContext({\n        saleOptionID: saleOptionID\n      }));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleQuantityChange\", function (event) {\n      var dispatch = _this.props.dispatch;\n      var selectedQuantity = parseInt(event.currentTarget.value, 10);\n      dispatch(updateSaleContext({\n        selectedQuantity: selectedQuantity\n      }));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handlePersonalizationChange\", function (event) {\n      var dispatch = _this.props.dispatch;\n      var personalization = event.currentTarget.value;\n      dispatch(updateSaleContext({\n        personalization: personalization\n      }));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleNotifyLater\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      if (!appState.loggedIn) {\n        return window.require_login();\n      }\n\n      var _this$props = _this.props,\n          sales = _this$props.thing.sales,\n          saleContext = _this$props.saleContext;\n      var opt = getCurrentSaleOption(sales, saleContext, true);\n      var params = {\n        sale_item_id: sales.id\n      };\n\n      if (opt != null) {\n        params.option_id = opt.id;\n      }\n\n      var waiting = getWaiting(sales, saleContext);\n\n      if (waiting) {\n        params.remove = 1;\n      }\n\n      $.ajax({\n        type: \"post\",\n        url: \"/wait_for_product.json\",\n        data: params,\n        dataType: \"json\"\n      }).done(function (json) {\n        if (!json || json.status_code == null) {\n          return;\n        }\n\n        if (json.status_code == 0 && json.message) {\n          alertify.alert(json.message);\n          return;\n        }\n\n        var waiting = params.remove ? false : true;\n\n        _this.props.dispatch(updateSaleContext({\n          waiting: waiting\n        }));\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"checkApplePay\", function () {\n      if (window.FancyApplePay) {\n        var _this$props2 = _this.props,\n            dispatch = _this$props2.dispatch,\n            thing = _this$props2.thing,\n            sales = _this$props2.thing.sales;\n        var os = sales.options.filter(function (o) {\n          return !o.soldout;\n        });\n        var data = {\n          total: {\n            label: thing.name,\n            amount: sales.price * 100 | 0\n          }\n        };\n\n        if (os.length > 0) {\n          data.displayItems = os.map(function (o) {\n            return {\n              label: o.name,\n              amount: Number(o.price) * 100 | 0\n            };\n          });\n        }\n\n        window.FancyApplePay.checkAvailability(function (available, testmode) {\n          if (available) {\n            dispatch(updateAppContext({\n              applePayDisplay: true,\n              applePayTest: testmode\n            }));\n          }\n        }, data);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"initializeMultiOption\", function () {\n      var _this$props3 = _this.props,\n          _this$props3$thing$sa = _this$props3.thing.sales,\n          options = _this$props3$thing$sa.options,\n          option_meta = _this$props3$thing$sa.option_meta,\n          saleContext = _this$props3.saleContext,\n          dispatch = _this$props3.dispatch;\n\n      _this.setState(_this.getInitialMultiOptionState(options, option_meta), function () {\n        // don't block selecting cheapest item\n        if (!(options && options.length > 1)) {\n          _this.updateSaleOptionIDFromMultiOptionState();\n        } // ?option={number} support\n\n\n        var presetOptionId = getLocationArgPairs(\"option\");\n\n        if (presetOptionId && presetOptionId[1] && String(saleContext.saleOptionID) !== presetOptionId[1]) {\n          dispatch(updateSaleContext({\n            saleOptionID: parseInt(presetOptionId[1], 10)\n          }));\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"extractSaleOptionIDFromMultiOptionState\", function (selected) {\n      var sales = _this.props.thing.sales;\n\n      if (selected == null) {\n        selected = _this.state.selected;\n      }\n\n      var multiOptionState = _this.state.multiOptionState;\n      var selectedOptionName = multiOptionState.option_meta.map(function (m) {\n        var order = multiOptionState.orderMap[m.type][m.name];\n\n        if (selected[m.type][order]) {\n          return selected[m.type][order].replace(\" / \", \"/\");\n        } else {\n          return selected[m.type][0];\n        }\n      }).join(\" / \");\n\n      var selectedOption = _.find(sales.options, function (opt) {\n        return opt.name === selectedOptionName;\n      });\n\n      if (selectedOption) {\n        return selectedOption.id;\n      } else {\n        window.DEBUG && console.warn(\"no option found for \", selectedOptionName, \"meta:\", sales.options, _this.state.selected);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"updateSaleOptionIDFromMultiOptionState\", function () {\n      var dispatch = _this.props.dispatch;\n\n      var saleOptionID = _this.extractSaleOptionIDFromMultiOptionState();\n\n      if (saleOptionID === undefined) {\n        var amendedID = _this.amendSaleOptionFromMultiOptionState();\n\n        if (amendedID) {\n          saleOptionID = amendedID;\n        } else {\n          window.DEBUG && console.warn(\"Couldn't recover option\");\n        }\n      }\n\n      dispatch(updateSaleContext({\n        saleOptionID: saleOptionID\n      }));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"amendSaleOptionFromMultiOptionState\", function () {\n      var _this$state = _this.state,\n          selected = _this$state.selected,\n          multiOptionState = _this$state.multiOptionState;\n      var nextSelected = {\n        swatch: [],\n        button: [],\n        thumbnail: [],\n        dropdown: []\n      };\n      multiOptionState.option_meta.forEach(function (_ref2, index) {\n        var type = _ref2.type,\n            name = _ref2.name;\n        var order = multiOptionState.orderMap[type][name];\n        var selectedValue = selected[type][order];\n\n        if (index === 0) {\n          nextSelected[type][order] = selectedValue;\n          return;\n        }\n\n        var values = multiOptionState.getPossibleValuesForIndex(selected, index);\n        var value;\n\n        if (values.some(function (v) {\n          return v === selectedValue;\n        })) {\n          value = selectedValue;\n        } else {\n          value = values[0];\n        }\n\n        selected[type][order] = value; // even though it will be flushed out, it will affect next options so fix it as well\n\n        nextSelected[type][order] = value;\n      });\n\n      _this.setState({\n        selected: nextSelected\n      });\n\n      return _this.extractSaleOptionIDFromMultiOptionState(nextSelected);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickMultiOptionGen\", function (type) {\n      return function (e) {\n        var el = e.currentTarget;\n        var value;\n        var indexOfType;\n\n        if (el.tagName === \"SELECT\") {\n          value = el.value;\n          indexOfType = Number($(el).find(\":selected\").attr(\"data-index-typeof\"));\n        } else {\n          value = $(el).attr(\"data-value\");\n          indexOfType = Number($(el).attr(\"data-index-typeof\"));\n        }\n\n        if (e.currentTarget.className === \"disabled\") {\n          return;\n        }\n\n        _this.state.selected[type][indexOfType] = value; // forceful trigger even though no differences in value.\n\n        _this.setState({\n          selected: _.extend({}, _this.state.selected)\n        }, _this.updateSaleOptionIDFromMultiOptionState);\n      };\n    });\n\n    _this.handlePurchase = handlePurchase.bind(_assertThisInitialized(_this)); // for multi options\n\n    _this.onClickThumbnail = _this.onClickMultiOptionGen(\"thumbnail\");\n    _this.onClickSwatch = _this.onClickMultiOptionGen(\"swatch\");\n    _this.onMultiSelectBoxChange = _this.onClickMultiOptionGen(\"dropdown\");\n    _this.onClickMutliButton = _this.onClickMultiOptionGen(\"button\");\n    return _this;\n  }\n\n  _createClass(SaleItemSidebarHead, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (!currencyIsUSD(this.props)) {\n        var saleContext = this.props.saleContext;\n        convertCurrency(saleContext.currencyCode, saleContext.price);\n      }\n\n      this.initializeMultiOption();\n      this.checkApplePay();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.thing.id !== this.props.thing.id) {\n        this.initializeMultiOption();\n        this.checkApplePay();\n        return;\n      }\n\n      var saleContext = prevProps.saleContext,\n          sales = prevProps.thing.sales;\n      var nsc = this.props.saleContext;\n      var nextSaleOptionID = nsc.saleOptionID;\n\n      if (saleContext.saleOptionID !== nextSaleOptionID) {\n        var o = _.find(sales.options, function (_o) {\n          return _o.id === nextSaleOptionID;\n        }); // option sync\n\n\n        if (o) {\n          var mos = $(\".sale-item-input .multi-option\");\n          o.values.forEach(function (v, i) {\n            var $so = mos.eq(i).find(\"[data-value=\\\"\".concat(escapeSelector(v), \"\\\"]:not(.selected)\")).eq(0);\n\n            if ($so.length) {\n              if ($so.is(\"option\")) $so.prop(\"selected\", true);else $so.get(0).click();\n            }\n          });\n\n          if (window.FancyApplePay && window.FancyApplePay.paymentRequest) {\n            window.FancyApplePay.paymentRequest.update({\n              total: {\n                label: o.name,\n                amount: Number(o.price) * 100 | 0\n              }\n            });\n          }\n        }\n      }\n    }\n  }, {\n    key: \"getInitialMultiOptionState\",\n    value: function getInitialMultiOptionState(options, option_meta) {\n      var selected = {\n        swatch: [],\n        button: [],\n        thumbnail: [],\n        dropdown: []\n      };\n\n      if (option_meta.length > 0) {\n        var nonSoldout = options.filter(function (o) {\n          return o.quantity !== 0;\n        });\n\n        if (nonSoldout.length !== 0) {\n          var selectedNonSoldoutOption = nonSoldout[0]; // temporary - FIXME\n\n          option_meta.forEach(function (opt, i) {\n            var type = opt.type;\n            var nextValue = selectedNonSoldoutOption.values[i];\n            selected[type].push(nextValue);\n          });\n        } else {\n          // set first available multi option\n          option_meta.forEach(function (opt) {\n            var type = opt.type;\n            var nextValue = opt.values[0];\n            selected[type].push(nextValue);\n          });\n        }\n      }\n\n      var multiOptionState = new MultiOptionState(options, option_meta);\n      return {\n        selected: selected,\n        multiOptionState: multiOptionState\n      };\n    }\n  }, {\n    key: \"UNSAFE_componentWillReceiveProps\",\n    value: function UNSAFE_componentWillReceiveProps(nextProps) {\n      var saleContext = this.props.saleContext;\n      var nsc = nextProps.saleContext;\n      var priceChanges = saleContext.price !== nsc.price;\n      var currencyChanges = saleContext.currencyCode !== nsc.currencyCode;\n\n      if (priceChanges || currencyChanges) {\n        if (!currencyIsUSD(nextProps)) {\n          var _saleContext = nextProps.saleContext;\n          convertCurrency(_saleContext.currencyCode, _saleContext.price, true); // FIXME: unable to comparison since price update comes first (SaleItemSidebarHead.componentWillReceiveProps())\n        }\n      }\n    }\n  }, {\n    key: \"isOptionMulti\",\n    value: function isOptionMulti() {\n      var sales = this.props.thing.sales; // sales.\n\n      if (sales.option_meta.length > 1) {\n        return true;\n      } else if (sales.option_meta.length === 1) {\n        return sales.option_meta[0].type !== \"dropdown\";\n      } else {\n        return false;\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props4 = this.props,\n          thing = _this$props4.thing,\n          sales = _this$props4.thing.sales,\n          applePayDisplay = _this$props4.appContext.applePayDisplay,\n          saleContext = _this$props4.saleContext,\n          _this$props4$saleCont = _this$props4.saleContext,\n          currencyCode = _this$props4$saleCont.currencyCode,\n          currencySymbol = _this$props4$saleCont.currencySymbol,\n          currencyMoney = _this$props4$saleCont.currencyMoney,\n          selectedQuantity = _this$props4$saleCont.selectedQuantity,\n          price = _this$props4$saleCont.price;\n      var opt = getCurrentSaleOption(sales, saleContext);\n      var discountPercentage = parseFloat(opt.discount_percentage); // TODO: use decimal?\n\n      var retailPrice = opt.retail_price;\n      var soldout = opt.soldout,\n          quantity = opt.quantity;\n      var option_meta = sales.option_meta,\n          available = sales.available;\n      var optionIsMulti = this.isOptionMulti();\n      var salesOptionsAvailable = isSalesOptionsAvailable(sales);\n      var discounting = discountPercentage > 0;\n      var converted = currencySymbol != null && currencyMoney != null;\n      var currencyCodeStyle = {\n        display: converted && !currencyIsUSD(this.props) ? \"block\" : \"none\"\n      };\n      var quantitySelectRange = soldout ? [\"1\"] : _.range(1, Math.min(10, (quantity || 0) + 1));\n      var showSelectbox = sales.options.length !== 0;\n      var cartButtonStyle;\n\n      if (!soldout) {\n        cartButtonStyle = {\n          display: \"none\"\n        };\n      }\n\n      var waiting = getWaiting(sales, saleContext);\n      var applePayButton;\n\n      if (applePayDisplay && !soldout) {\n        applePayButton = /*#__PURE__*/React.createElement(ApplePayButton, this.props);\n      }\n\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h1\", _extends({\n        key: Keys.Sidebar.Title,\n        className: \"title\"\n      }, getSafeNameProp(thing))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"price\",\n        key: Keys.Sidebar.Price\n      }, /*#__PURE__*/React.createElement(\"big\", {\n        className: classnames({\n          sale: discounting\n        })\n      }, \"$\", floatFormatMinusTwo(price)), discounting && /*#__PURE__*/React.createElement(\"span\", {\n        className: \"sales\"\n      }, /*#__PURE__*/React.createElement(\"em\", null, \"$\", floatFormatMinusTwo(retailPrice)), \" (Save \", numberFormat(discountPercentage, 0), \"%)\"), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"currency_price\",\n        style: currencyCodeStyle\n      }, this.getApproxText(), /*#__PURE__*/React.createElement(\"a\", {\n        className: \"code\",\n        onClick: this.handleCurrencyPopup\n      }, currencyCode))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"frm\",\n        key: Keys.Sidebar.Form\n      }, /*#__PURE__*/React.createElement(\"fieldset\", {\n        className: \"sale-item-input\"\n      }, showSelectbox && !optionIsMulti && /*#__PURE__*/React.createElement(SelectBox, {\n        className: \"multi-option\",\n        id: \"option\",\n        label: gettext(\"Option\"),\n        currentValue: opt,\n        value: optionValueFunction,\n        printer: saleNamePrinter,\n        options: sales.options,\n        expander: SaleItemOptionsExpander,\n        disabled: !salesOptionsAvailable,\n        onChange: this.handleOptionChange,\n        SizeGuide: function SizeGuide() {\n          var hasSizeGuide = sales.size_guide_id != null;\n          return hasSizeGuide ? /*#__PURE__*/React.createElement(\"a\", {\n            className: \"size-guide\",\n            onClick: function onClick(e) {\n              e.preventDefault();\n              import(\n              /* webpackChunkName: \"OverlayThing.popup\" */\n              \"../../popup/index\").then(function (_ref3) {\n                var SizeGuidePopup = _ref3.SizeGuidePopup;\n                renderPopup(SizeGuidePopup, _this2.props);\n              });\n            }\n          }, \"Size guide\") : null;\n        }\n      }), optionIsMulti && /*#__PURE__*/React.createElement(MultiOption, {\n        sid: sales.id,\n        onClickThumbnail: this.onClickThumbnail,\n        onClickSwatch: this.onClickSwatch,\n        onMultiSelectBoxChange: this.onMultiSelectBoxChange,\n        onClickMutliButton: this.onClickMutliButton,\n        selected: this.state.selected,\n        disabled: this.state.disabled,\n        soldout: !!soldout,\n        option_meta: option_meta,\n        SizeGuide: function SizeGuide() {\n          var hasSizeGuide = sales.size_guide_id != null;\n          return hasSizeGuide ? /*#__PURE__*/React.createElement(\"a\", {\n            className: \"size-guide\",\n            onClick: function onClick(e) {\n              e.preventDefault();\n              import(\n              /* webpackChunkName: \"OverlayThing.popup\" */\n              \"../../popup/index\").then(function (_ref4) {\n                var SizeGuidePopup = _ref4.SizeGuidePopup;\n                renderPopup(SizeGuidePopup, _this2.props);\n              });\n            }\n          }, \"Size guide\") : null;\n        },\n        multiOptionState: this.state.multiOptionState\n      }), sales.personalizable && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"personalization\"\n      }, /*#__PURE__*/React.createElement(\"label\", null, \"This item can be personalized:\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"text\",\n        name: \"personalization\",\n        placeholder: \"Personalization details\",\n        onChange: this.handlePersonalizationChange\n      })), /*#__PURE__*/React.createElement(SelectBox, {\n        id: \"quantity\",\n        className: \"multi-option\",\n        label: gettext(\"Quantity\"),\n        defaultValue: \"1\",\n        currentValue: selectedQuantity,\n        options: quantitySelectRange,\n        disabled: !!soldout,\n        onChange: this.handleQuantityChange\n      }), applePayButton, available ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(CartButton, {\n        onClick: this.handlePurchase,\n        className: classnames(\"add_to_cart btn-cart\", {\n          \"btn-create\": soldout,\n          \"btns-blue-embo\": !soldout\n        }),\n        disabled: !!soldout,\n        label: soldout ? gettext(\"Sold out\") : gettext(\"Add to cart\")\n      }), /*#__PURE__*/React.createElement(CartButton, {\n        className: classnames(\"btn-create notify-available\", {\n          subscribed: waiting\n        }),\n        label: waiting ? gettext(\"Subscribed\") : gettext(\"Notify me when available\"),\n        style: cartButtonStyle,\n        onClick: this.handleNotifyLater\n      })) : /*#__PURE__*/React.createElement(CartButton, {\n        className: classnames(\"btn-create not-available\"),\n        label: gettext(\"Not Available\"),\n        disabled: true\n      }))));\n    }\n  }]);\n\n  return SaleItemSidebarHead;\n}(Component);\n\nexport { SaleItemSidebarHead as default };\n\nfunction SaleItemOptionsExpander(sio, idx) {\n  return /*#__PURE__*/React.createElement(\"option\", {\n    value: sio.id,\n    key: \"sale_options-\".concat(idx)\n  }, sio.soldout === true || !(sio.quantity > 0) ? \"\".concat(sio.name, \" - \").concat(gettext(\"Sold out\")) : sio.name);\n}\n\nvar ApplePayButton = /*#__PURE__*/function (_Component2) {\n  _inherits(ApplePayButton, _Component2);\n\n  function ApplePayButton() {\n    var _getPrototypeOf2;\n\n    var _this3;\n\n    _classCallCheck(this, ApplePayButton);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this3 = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ApplePayButton)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this3), \"handleApplePayCheckout\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      if (window.FancyApplePay.clicked) {\n        return;\n      }\n\n      window.FancyApplePay.clicked = true;\n      var applePayTest = _this3.props.appContext.applePayTest;\n      var _this3$props = _this3.props,\n          thing = _this3$props.thing,\n          sales = _this3$props.thing.sales,\n          _this3$props$saleCont = _this3$props.saleContext,\n          saleOptionID = _this3$props$saleCont.saleOptionID,\n          selectedQuantity = _this3$props$saleCont.selectedQuantity,\n          price = _this3$props$saleCont.price;\n      var salesOptionsAvailable = isSalesOptionsAvailable(sales);\n      var title = thing.name;\n      var country = sales.seller.country;\n      var sale_item_id = sales.id;\n      var seller_id = sales.seller.id;\n      var quantity = selectedQuantity;\n      var option_id = null;\n      var option = null;\n\n      if (salesOptionsAvailable) {\n        option_id = parseInt(saleOptionID, 10) || null; // ? should be same value with option except get casted\n\n        option = saleOptionID;\n      }\n\n      try {\n        window.FancyApplePay.requestPurchase(\"Dynamic\", {\n          sale_item_id: sale_item_id,\n          seller_id: seller_id,\n          option_id: option_id,\n          quantity: quantity,\n          price: price,\n          title: title,\n          option: option,\n          country: country,\n          testmode: applePayTest\n        });\n      } catch (err) {\n        window.DEBUG && console.trace(err);\n        alert(err);\n        window.FancyApplePay.clicked = false;\n      }\n    });\n\n    return _this3;\n  }\n\n  _createClass(ApplePayButton, [{\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"applePayButton\",\n        style: {\n          WebkitAppearance: \"-apple-pay-button\",\n          ApplePayButtonType: \"plain\",\n          ApplePayButtonStyle: \"black\"\n        },\n        onClick: this.handleApplePayCheckout\n      });\n    }\n  }]);\n\n  return ApplePayButton;\n}(Component);","import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _extends from \"@babel/runtime/helpers/extends\";\nimport React from \"react\";\nimport classnames from \"classnames\";\nimport { getCurrentSaleOption } from \"../../map\";\n// Generic purchase handler, needs to be bound to insatnce on initialization.\n\n/*\n    data-sii={sales.id}\n    data-sisi={sales.seller_id}\n    data-tid={thing.id}\n*/\nexport function handlePurchase(event) {\n  var _this = this;\n\n  event.preventDefault();\n  var _this$props = this.props,\n      thing = _this$props.thing,\n      sales = _this$props.thing.sales,\n      saleContext = _this$props.saleContext;\n  var saleOption = getCurrentSaleOption(sales, saleContext, true);\n  var soldout = saleOption == null ? sales.soldout : saleOption.soldout;\n\n  if (soldout || this.state.loading) {\n    return;\n  }\n\n  var saleOptionID = saleOption != null ? saleOption.id : null;\n  this.setState({\n    loading: true\n  }, function () {\n    var payload = {\n      sale_id: sales.id,\n      quantity: saleContext.selectedQuantity,\n      personalization: saleContext.personalization\n    };\n\n    if (saleOptionID != null) {\n      payload.option_id = saleOptionID;\n    }\n\n    Fancy.CartAPI.addItem(payload, function (success, json) {\n      if (success) {\n        Fancy.Cart.openPopup();\n      } else {\n        alertify.alert(json && json.error || \"Failed to add the item to cart. Please contact us at cs@fancy.com if the problem persists.\");\n      }\n\n      _this.setState({\n        loading: false\n      });\n    });\n  });\n}\n\nvar SaleOptions = function SaleOptions(_ref) {\n  var _ref$options = _ref.options,\n      options = _ref$options === void 0 ? [\"1\"] : _ref$options,\n      _ref$currentValue = _ref.currentValue,\n      currentValue = _ref$currentValue === void 0 ? \"1\" : _ref$currentValue,\n      _ref$id = _ref.id,\n      id = _ref$id === void 0 ? \"\" : _ref$id,\n      _ref$value = _ref.value,\n      value = _ref$value === void 0 ? function (v) {\n    return v;\n  } : _ref$value,\n      expander = _ref.expander,\n      defaultValue = _ref.defaultValue,\n      printer = _ref.printer,\n      disabled = _ref.disabled,\n      onChange = _ref.onChange,\n      onClick = _ref.onClick,\n      onFocus = _ref.onFocus,\n      unselectedLabel = _ref.unselectedLabel;\n\n  expander = expander || function (option, idx) {\n    return /*#__PURE__*/React.createElement(\"option\", {\n      key: \"sale_options-\".concat(idx),\n      value: value(option)\n    }, printer(option));\n  };\n\n  return /*#__PURE__*/React.createElement(\"select\", {\n    id: id,\n    className: classnames(\"select-boxes2\", {\n      \"one-option\": options.length <= 1\n    }),\n    value: value(currentValue) || defaultValue,\n    disabled: disabled,\n    onChange: onChange,\n    onClick: onClick,\n    onFocus: onFocus\n  }, unselectedLabel && /*#__PURE__*/React.createElement(\"option\", {\n    value: \"\"\n  }, unselectedLabel), options.map(expander));\n};\n\nexport var CartButton = function CartButton(props) {\n  return /*#__PURE__*/React.createElement(\"button\", _extends({}, props, {\n    label: null\n  }), props.label);\n};\nexport var SelectBox = function SelectBox(props) {\n  var className = props.className,\n      disabled = props.disabled,\n      label = props.label,\n      currentValue = props.currentValue,\n      defaultValue = props.defaultValue,\n      id = props.id,\n      printer = props.printer,\n      tabIndex = props.tabIndex,\n      unselectedLabel = props.unselectedLabel,\n      _props$options = props.options,\n      options = _props$options === void 0 ? [\"1\"] : _props$options,\n      SizeGuide = props.SizeGuide;\n  printer = printer != null ? printer : function (s) {\n    return s;\n  };\n  defaultValue = defaultValue != null ? defaultValue : \"1\";\n  className = className != null ? className : null;\n  var labelValue;\n\n  if (unselectedLabel != null && currentValue === \"\") {\n    labelValue = unselectedLabel;\n  } else {\n    labelValue = printer(currentValue != null ? currentValue : defaultValue);\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: className\n  }, /*#__PURE__*/React.createElement(\"label\", null, label), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"trick-select \".concat(id)\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    className: classnames(\"selectBox\", {\n      disabled: disabled,\n      \"one-option\": options.length <= 1\n    }),\n    tabIndex: tabIndex || \"1\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"selectBox-label\"\n  }, labelValue), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"selectBox-arrow\"\n  })), /*#__PURE__*/React.createElement(SaleOptions, _extends({}, props, {\n    printer: printer,\n    defaultValue: defaultValue\n  }))), SizeGuide && /*#__PURE__*/React.createElement(SizeGuide, {\n    key: \"size-guide\"\n  }));\n};\nexport var MultiOptionState = /*#__PURE__*/function () {\n  function MultiOptionState(options, option_meta) {\n    _classCallCheck(this, MultiOptionState);\n\n    this.options = options;\n    this.option_meta = option_meta;\n    var orderMap = {};\n    option_meta.forEach(function (m) {\n      if (orderMap[m.type] == null) {\n        orderMap[m.type] = {\n          length: 1\n        };\n        orderMap[m.type][m.name] = 0;\n      } else {\n        orderMap[m.type][m.name] = orderMap[m.type].length;\n        orderMap[m.type].length += 1;\n      }\n    });\n    this.orderMap = orderMap;\n  } // i.e.) getPossibleValues(['a', '1', '가'], 1) => ['1', '3', '6']\n  // output: get possible options for 2nd option dependent on ('a' / 1st option)\n\n\n  _createClass(MultiOptionState, [{\n    key: \"getPossibleValuesForIndex\",\n    value: function getPossibleValuesForIndex(selected, targetIndex) {\n      var options = this.options,\n          option_meta = this.option_meta,\n          orderMap = this.orderMap;\n\n      if (targetIndex === 0) {\n        return option_meta[0].values;\n      }\n\n      var filteredOptions = options;\n      option_meta.map(function (m) {\n        var order = orderMap[m.type][m.name];\n\n        if (selected[m.type][order]) {\n          return selected[m.type][order];\n        } else {\n          return selected[m.type][0];\n        }\n      }).forEach(function (sel, idx) {\n        if (idx < targetIndex) {\n          filteredOptions = filteredOptions.filter(function (option) {\n            return option.values[idx] === sel;\n          });\n        }\n      });\n      return _.uniq(filteredOptions.map(function (o) {\n        return o.values[targetIndex];\n      })); // FIXME\n    }\n  }, {\n    key: \"getMultiOptions\",\n    value: function getMultiOptions(selected) {\n      var _this2 = this;\n\n      return this.option_meta.map(function (meta, idx) {\n        return [meta, _this2.getPossibleValuesForIndex(selected, idx)];\n      });\n      /*\n      returns [\n          [type, ['a', 'b', 'c']],\n          [type, ['1', '2']],\n          [tyep, ['red', 'white', 'black']]\n      ]\n      */\n    }\n  }]);\n\n  return MultiOptionState;\n}();\nexport var MultiOption = function MultiOption(props) {\n  var selected = props.selected,\n      multiOptionState = props.multiOptionState,\n      sid = props.sid,\n      SizeGuide = props.SizeGuide;\n\n  if (multiOptionState == null) {\n    return null;\n  }\n\n  var multiOptions = multiOptionState.getMultiOptions(selected);\n  var sizeGuidePos = -1;\n\n  if (SizeGuide) {\n    multiOptions.map(function (_ref2, idx) {\n      var _ref3 = _slicedToArray(_ref2, 2),\n          meta = _ref3[0],\n          values = _ref3[1];\n\n      if (meta.name && meta.name.trim().toLowerCase() === \"size\") sizeGuidePos = idx;\n    });\n    if (sizeGuidePos < 0) sizeGuidePos = multiOptions.length - 1;\n  }\n\n  return multiOptions.map(function (_ref4, idx) {\n    var _ref5 = _slicedToArray(_ref4, 2),\n        meta = _ref5[0],\n        values = _ref5[1];\n\n    var type = meta.type,\n        name = meta.name;\n    var indexTypeOf = multiOptionState.orderMap[type] && multiOptionState.orderMap[type][name];\n    var additional = {\n      name: name,\n      values: values,\n      indexTypeOf: indexTypeOf,\n      selectedArray: selected && selected[type],\n      selectedValue: selected && selected[type] && selected[type][indexTypeOf],\n      key: \"\".concat(sid, \"-\").concat(idx),\n      showSizeGuide: idx == sizeGuidePos\n    };\n\n    if (type === \"dropdown\") {\n      return /*#__PURE__*/React.createElement(MultiSelectBox, _extends({}, props, additional));\n    } else if (type === \"swatch\") {\n      additional.swatch = meta.swatch;\n      return /*#__PURE__*/React.createElement(MultiSwatch, _extends({}, props, additional));\n    } else if (type === \"thumbnail\") {\n      additional.thumbnail = meta.thumbnail;\n      return /*#__PURE__*/React.createElement(MultiThumbnail, _extends({}, props, additional));\n    } else if (type === \"button\") {\n      return /*#__PURE__*/React.createElement(MultiButton, _extends({}, props, additional));\n    }\n  });\n};\nexport var MultiSelectBox = function MultiSelectBox(props) {\n  var values = props.values,\n      name = props.name,\n      onMultiSelectBoxChange = props.onMultiSelectBoxChange,\n      indexTypeOf = props.indexTypeOf,\n      selectedValue = props.selectedValue,\n      showSizeGuide = props.showSizeGuide,\n      SizeGuide = props.SizeGuide;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"multi-option\"\n  }, /*#__PURE__*/React.createElement(\"label\", null, name), /*#__PURE__*/React.createElement(\"select\", {\n    onChange: onMultiSelectBoxChange,\n    selected: selectedValue,\n    className: values.length <= 1 ? \"one-option\" : undefined\n  }, values.map(function (value, i) {\n    return /*#__PURE__*/React.createElement(MultiSelectBoxOption, {\n      key: i,\n      value: value,\n      indexTypeOf: indexTypeOf\n    });\n  })), showSizeGuide ? /*#__PURE__*/React.createElement(SizeGuide, {\n    key: \"size-guide\"\n  }) : null);\n};\n\nvar MultiSelectBoxOption = function MultiSelectBoxOption(props) {\n  var value = props.value,\n      indexTypeOf = props.indexTypeOf;\n  return /*#__PURE__*/React.createElement(\"option\", {\n    \"data-value\": value,\n    \"data-index-typeof\": indexTypeOf,\n    value: value\n  }, value);\n};\n\nexport var MultiSwatch = function MultiSwatch(props) {\n  var name = props.name,\n      values = props.values,\n      swatch = props.swatch,\n      indexTypeOf = props.indexTypeOf,\n      selectedValue = props.selectedValue,\n      onClickSwatch = props.onClickSwatch,\n      showSizeGuide = props.showSizeGuide,\n      SizeGuide = props.SizeGuide;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"multi-option swatch\"\n  }, /*#__PURE__*/React.createElement(\"label\", null, name), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"select-option\"\n  }, values.map(function (value, i) {\n    return /*#__PURE__*/React.createElement(MultiSwatchOption, {\n      key: i,\n      value: value,\n      swatch: swatch,\n      indexTypeOf: indexTypeOf,\n      selectedValue: selectedValue,\n      onClick: onClickSwatch\n    });\n  })), showSizeGuide ? /*#__PURE__*/React.createElement(SizeGuide, {\n    key: \"size-guide\"\n  }) : null);\n};\n\nvar MultiSwatchOption = function MultiSwatchOption(props) {\n  var value = props.value,\n      swatch = props.swatch,\n      indexTypeOf = props.indexTypeOf,\n      selectedValue = props.selectedValue,\n      onClick = props.onClick;\n  return /*#__PURE__*/React.createElement(\"a\", {\n    href: \"#\",\n    style: {\n      backgroundColor: swatch[value]\n    },\n    onClick: onClick,\n    \"data-value\": value,\n    \"data-label\": value,\n    \"data-index-typeof\": indexTypeOf,\n    className: selectedValue === value ? \"selected\" : \"\"\n  });\n};\n\nexport var MultiThumbnail = function MultiThumbnail(props) {\n  var values = props.values,\n      name = props.name,\n      thumbnail = props.thumbnail,\n      onClickThumbnail = props.onClickThumbnail,\n      indexTypeOf = props.indexTypeOf,\n      selectedValue = props.selectedValue,\n      showSizeGuide = props.showSizeGuide,\n      SizeGuide = props.SizeGuide;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"multi-option thumbnail\"\n  }, /*#__PURE__*/React.createElement(\"label\", null, name), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"value\"\n  }, selectedValue), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"select-option\"\n  }, values.map(function (value, i) {\n    return /*#__PURE__*/React.createElement(MultiThumbnailOption, {\n      key: i,\n      onClick: onClickThumbnail,\n      value: value,\n      indexTypeOf: indexTypeOf,\n      selectedValue: selectedValue,\n      thumbnail: thumbnail\n    });\n  })), showSizeGuide ? /*#__PURE__*/React.createElement(SizeGuide, {\n    key: \"size-guide\"\n  }) : null);\n};\n\nvar MultiThumbnailOption = function MultiThumbnailOption(_ref6) {\n  var onClick = _ref6.onClick,\n      value = _ref6.value,\n      indexTypeOf = _ref6.indexTypeOf,\n      selectedValue = _ref6.selectedValue,\n      thumbnail = _ref6.thumbnail;\n  return /*#__PURE__*/React.createElement(\"a\", {\n    href: \"#\",\n    onClick: onClick,\n    \"data-value\": value,\n    \"data-index-typeof\": indexTypeOf,\n    className: selectedValue === value ? \"selected\" : \"\"\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: \"/_ui/images/common/blank.gif\",\n    style: {\n      backgroundImage: \"url(\\\"\".concat(thumbnail[value], \"\\\")\"),\n      backgroundSize: \"cover\"\n    },\n    alt: value\n  }));\n};\n\nexport var MultiButton = function MultiButton(props) {\n  var values = props.values,\n      name = props.name,\n      onClickMutliButton = props.onClickMutliButton,\n      indexTypeOf = props.indexTypeOf,\n      selectedValue = props.selectedValue,\n      showSizeGuide = props.showSizeGuide,\n      SizeGuide = props.SizeGuide;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"multi-option button\"\n  }, /*#__PURE__*/React.createElement(\"label\", null, name), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"select-option\"\n  }, values.map(function (value, i) {\n    return /*#__PURE__*/React.createElement(MultiButtonOption, {\n      key: i,\n      onClick: onClickMutliButton,\n      indexTypeOf: indexTypeOf,\n      selectedValue: selectedValue,\n      value: value\n    });\n  })), showSizeGuide ? /*#__PURE__*/React.createElement(SizeGuide, {\n    key: \"size-guide\"\n  }) : null);\n};\n\nvar MultiButtonOption = function MultiButtonOption(props) {\n  var value = props.value,\n      onClick = props.onClick,\n      indexTypeOf = props.indexTypeOf,\n      selectedValue = props.selectedValue;\n  return /*#__PURE__*/React.createElement(\"button\", {\n    onClick: onClick,\n    className: selectedValue === value ? \"selected\" : \"\",\n    \"data-value\": value,\n    \"data-index-typeof\": indexTypeOf\n  }, value);\n};","import React from \"react\";\nimport Image from \"./Image\";\nimport Info from \"./Info\";\nimport Detail from \"./Detail\";\n\nvar Thing = function Thing() {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"wrapper-content\"\n  }, /*#__PURE__*/React.createElement(Image, null), /*#__PURE__*/React.createElement(Info, null), /*#__PURE__*/React.createElement(Detail, null));\n};\n\nexport default Thing;","import React from \"react\";\nimport { numberFormat } from \"fancyutils\";\nexport default function ThingCard(_ref) {\n  var brand_name = _ref.brand_name,\n      title = _ref.title,\n      html_url = _ref.html_url,\n      image_url = _ref.image_url,\n      max_price = _ref.max_price,\n      min_price = _ref.min_price;\n  var p = /*#__PURE__*/React.createElement(React.Fragment, null, \"$\", numberFormat(min_price, 0));\n\n  if (max_price !== min_price) {\n    p = /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"em\", {\n      className: \"from\"\n    }, \"from \"), \" $\", numberFormat(min_price, 0));\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"figure-item new\"\n  }, /*#__PURE__*/React.createElement(\"figure\", null, /*#__PURE__*/React.createElement(\"a\", {\n    href: html_url\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"figure\",\n    style: {\n      backgroundImage: \"url(\".concat(image_url, \")\")\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\",\n    style: {\n      backgroundImage: \"url(\".concat(image_url, \")\")\n    }\n  })))), /*#__PURE__*/React.createElement(\"figcaption\", null, /*#__PURE__*/React.createElement(\"a\", {\n    href: html_url\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"category\"\n  }, brand_name), /*#__PURE__*/React.createElement(\"b\", {\n    className: \"title\"\n  }, title), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"price\"\n  }, p))));\n}","import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _extends from \"@babel/runtime/helpers/extends\";\nimport React, { Component, Suspense } from \"react\";\nimport { connect } from \"react-redux\";\nimport { isStaticPage } from \"fancyutils\";\nimport Thing from \"./Thing\";\nimport MerchantInfo from \"./MerchantInfo\";\nimport Recommendation from \"./Recommendation\";\nimport Reviews from \"./Reviews\";\nimport { historyData } from \"../../container/history\";\nimport { updateSaleContext } from \"../../action/action-helpers\";\nimport store from \"../../store/store\";\nimport FancyContext, { getFancyContextDefaultValue, useFancy } from \"./FancyContext\";\nimport { mapStateToThingProps } from \"../map\";\n\nfunction AdminMessages() {\n  var _useFancy = useFancy(),\n      thing = _useFancy.thing;\n\n  if (!thing.messages) {\n    return null;\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"warning\"\n  }, /*#__PURE__*/React.createElement(\"span\", null, \"This item is not visible to customers because:\"), /*#__PURE__*/React.createElement(\"ul\", null, thing.messages.map(function (m, i) {\n    return /*#__PURE__*/React.createElement(\"li\", {\n      key: i\n    }, m);\n  })));\n}\n\nfunction BreadCrumb() {\n  var _useFancy2 = useFancy(),\n      thing = _useFancy2.thing;\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"breadcrumb\"\n  }, thing.breadcrumbs.map(function (_ref, i) {\n    var label = _ref.label,\n        href = _ref.href;\n    return /*#__PURE__*/React.createElement(React.Fragment, {\n      key: i\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      href: href\n    }, label), \" \", i !== thing.breadcrumbs.length - 1 ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"arrow\"\n    }, \">\"), \" \") : null);\n  }));\n}\n\nfunction AdminSidebar(props) {\n  var viewer = props.appContext.viewer,\n      thing = props.thing;\n  var admin = null;\n  var AdminComponent = null; //if (viewer.is_admin_any) {\n  //    AdminComponent = lazy(() => import(/* webpackChunkName: \"OverlayThing.admin\" */ \"../Admin\"));\n  //}\n\n  if (AdminComponent) {\n    admin = /*#__PURE__*/React.createElement(Suspense, {\n      fallback: /*#__PURE__*/React.createElement(\"div\", null)\n    }, /*#__PURE__*/React.createElement(AdminComponent, _extends({}, props, {\n      fallback: /*#__PURE__*/React.createElement(\"div\", null)\n    })));\n  }\n\n  return admin;\n}\n\nvar AppV2 = /*#__PURE__*/function (_Component) {\n  _inherits(AppV2, _Component);\n\n  function AppV2() {\n    _classCallCheck(this, AppV2);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(AppV2).apply(this, arguments));\n  }\n\n  _createClass(AppV2, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var pt = prevProps.thing;\n      var ct = this.props.thing;\n\n      if (ct != null) {\n        if (!pt || pt.id !== ct.id) {\n          if (isStaticPage()) {\n            $(window).scrollTop(0);\n          } else {\n            $(\"#overlay-thing > .popup\").attr(\"tabindex\", -1).focus();\n          }\n\n          if (ct.sales && ct.sales.options && ct.sales.options.length > 1) {\n            var nonSoldoutOptions = ct.sales.options.filter(function (o) {\n              return !o.soldout;\n            });\n            var minimumOption;\n\n            if (nonSoldoutOptions.length > 0) {\n              minimumOption = _.min(nonSoldoutOptions, function (o) {\n                return Number(o.price);\n              });\n            } else {\n              minimumOption = _.min(ct.sales.options, function (o) {\n                return Number(o.price);\n              });\n            }\n\n            if (ct.sales.options[0].id !== minimumOption.id) {\n              store.dispatch(updateSaleContext({\n                saleOptionID: minimumOption.id\n              }));\n            }\n          }\n        }\n      }\n    }\n  }, {\n    key: \"getFancyContext\",\n    value: function getFancyContext() {\n      return this.props.thing ? this.props : getFancyContextDefaultValue();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var thing = this.props.thing;\n\n      if (historyData.locationIsThingPage && thing != null) {\n        return /*#__PURE__*/React.createElement(FancyContext.Provider, {\n          value: this.getFancyContext()\n        }, /*#__PURE__*/React.createElement(AdminMessages, null), /*#__PURE__*/React.createElement(BreadCrumb, null), /*#__PURE__*/React.createElement(Thing, null), /*#__PURE__*/React.createElement(Reviews, null), /*#__PURE__*/React.createElement(MerchantInfo, null), /*#__PURE__*/React.createElement(Recommendation, null), /*#__PURE__*/React.createElement(AdminSidebar, this.props));\n      } else {\n        return /*#__PURE__*/React.createElement(\"div\", null);\n      }\n    }\n  }]);\n\n  return AppV2;\n}(Component);\n\nvar ReduxComponentEnhancer = connect(mapStateToThingProps);\nvar Overlay = ReduxComponentEnhancer(AppV2);\nexport default Overlay;","// SaleItem#get_status\nexport var salesStatus = {\n  EXPIRED: 'Expired',\n  REMOVED: 'Deleted',\n  PENDING: 'Pending',\n  COMING_SOON: 'Coming soon',\n  ACTIVE: 'Active',\n  SOLD_OUT: 'Sold out'\n};\nexport var FancyStatus = {\n  Addition: 'Addition',\n  Removal: 'Removal',\n  AfterAddition: 'AfterAddition',\n  AfterRemoval: 'AfterRemoval',\n  Idle: 'Idle'\n};\nexport var textareaHeight = {\n  collapsed: 20,\n  expanded: 40\n};\nvar commonWrapperSelector = '#container-wrapper .wrapper-content #content';\nexport var Selectors = {\n  HomepageWrapper: commonWrapperSelector\n};\nvar zoomMargin = 125;\nexport var ThingViewConfig = {\n  boundarySize: 640,\n  zoomMargin: zoomMargin,\n  // zoom box size 250 (246 + 2 + 2) / 2\n  zoomBoxSize: zoomMargin * 2,\n  // zoom box size 250 (246 + 2 + 2) / 2\n  zoomScale: 1.5\n};\nexport var StaticThingViewConfig = {\n  ThumbnailsLimit: {\n    Basic: 18,\n    More: 200\n  }\n};","import { KEYS, didClickOn, eitherFancy, getObjectTypeFromUrl, getPathname, isPlainLeftClick, isStream } from 'fancyutils';\nimport store from '../store/store';\nimport { Selectors } from '../config';\nimport { LinkTypes, transition, pagingContext } from './routeutils';\nimport { closeOverlay } from '../action/action-helpers';\n\nfunction handleOverlayThingKeyEvents(event) {\n  if (event.target.tagName === 'TEXTAREA' || event.target.tagName === 'INPUT') {\n    return;\n  }\n\n  switch (event.which) {\n    case KEYS.LEFT:\n      pagingContext.movePrev();\n      break;\n\n    case KEYS.RIGHT:\n      pagingContext.moveNext();\n      break;\n\n    case KEYS.ESC:\n      // If popup is not on\n      if ($('#popup_container:visible').length === 0) {\n        store.dispatch(closeOverlay());\n      }\n\n      break;\n  }\n}\n\nfunction conditionalTransition(aElement) {\n  // Turn off video\n  $('#container-wrapper .btn-pause').attr('scroll', true).click(); // Ensure anchor is static (sticked to homepage timeline) or not.\n\n  if (isStream() && $(Selectors.HomepageWrapper).has(aElement)) {\n    transition(aElement.getAttribute('href'), LinkTypes.Static);\n  } else {\n    transition(aElement.getAttribute('href'));\n  }\n}\n\nvar oneshotEventAttached = false;\nexport function attachEntryEvents() {\n  if (oneshotEventAttached) {\n    return;\n  }\n\n  oneshotEventAttached = true; // Remove pre-existing url event and start transition first\n\n  $(document.body).off('click.overlayThingInit');\n\n  if (window.__INIT_THING_ANCHOR != null) {\n    conditionalTransition(window.__INIT_THING_ANCHOR);\n    delete window.__INIT_THING_ANCHOR;\n  } // TODO: replace to class-based event binding\n\n\n  $(document.body).on('click', 'a', function (event) {\n    if (isPlainLeftClick(event) && this.getAttribute('data-prevent-overlay') == null && getObjectTypeFromUrl(getPathname(this)) === 'Thing') {\n      event.preventDefault(); // note: key event will be detached inside `closeOverlay()` call\n\n      $(document).on('keydown.overlayThing', handleOverlayThingKeyEvents);\n      conditionalTransition(this);\n    }\n  });\n  $('#overlay-thing').on('click', '.popup.overlay-thing', function (event) {\n    var $targ = $(event.target); // Center container\n\n    if (didClickOn($targ, '.sidebar') || didClickOn($targ, '.thing-detail-container .content') || didClickOn($targ, '.thing-detail-container .timeline') || eitherFancy('Admin', function (_ref) {\n      var sharedState = _ref.sharedState;\n      return sharedState.draggingAdmin;\n    })) {// pass\n      // prev button\n    } else if (didClickOn($targ, '.popup_prev')) {\n      pagingContext.movePrev();\n      return false; // next button\n    } else if (didClickOn($targ, '.popup_next')) {\n      pagingContext.moveNext();\n      return false;\n    } else {\n      store.dispatch(closeOverlay());\n    }\n  });\n}\nexport var OtContainer = {\n  isStaticCache: undefined,\n  isStatic: function isStatic() {\n    if (this.isStaticCache === undefined) {\n      this.isStaticCache = $(document.body).is('.static-ot');\n    }\n\n    return this.isStaticCache;\n  },\n  getDynamic: function getDynamic() {\n    return $('#overlay-thing .thing-detail');\n  },\n  getStatic: function getStatic() {\n    return $(document);\n  },\n  get: function get() {\n    return this.isStatic() ? this.getStatic() : this.getDynamic();\n  },\n  scrollToTop: function scrollToTop() {\n    if (this.isStatic()) {\n      $(document.body.parentElement).scrollTop(0);\n    } else {\n      $('#overlay-thing').scrollTop(0);\n    }\n  }\n};\nwindow.OtContainer = OtContainer; // Only one event is allowed\n\nexport var scrollEvent = {\n  handleScroll: null,\n  attach: function attach(func, prepare) {\n    if (scrollEvent.handleScroll != null) {\n      scrollEvent.detach();\n    }\n\n    var _prepare = prepare != null ? prepare : 10;\n\n    var handleScroll = _.throttle(function () {\n      if (OtContainer.isStatic()) {\n        var viewportHeight = document.documentElement.clientHeight;\n\n        if (scrollEvent.visible === true) {\n          // console.debug('$(window).height() - $(window).scrollTop() - _prepare <= viewportHeight', $(window).height(), $(window).scrollTop(), _prepare, viewportHeight, $(window).height() - $(window).scrollTop() - _prepare <= viewportHeight)\n          if (document.documentElement.scrollHeight - $(window).scrollTop() - _prepare <= viewportHeight) {\n            func(true);\n          }\n        }\n      } else {\n        var el = this;\n        var _viewportHeight = el.clientHeight;\n\n        if (scrollEvent.visible === true) {\n          if (el.scrollHeight - el.scrollTop - _prepare <= _viewportHeight) {\n            func(true);\n          }\n        }\n      }\n    }, 50);\n\n    this.handleScroll = handleScroll;\n    var containerEl = OtContainer.isStatic() ? OtContainer.get().get(0) : $('#overlay-thing').get(0);\n    containerEl.addEventListener('scroll', handleScroll, {\n      passive: true\n    });\n    handleScroll();\n  },\n  detach: function detach() {\n    var containerEl = OtContainer.get().get(0);\n    containerEl.removeEventListener('scroll', this.handleScroll);\n  },\n  visible: false // copied variable on `state.appContext.visible` change\n\n};","import { extractMetaFromURL } from 'fancyutils';\nimport { history } from 'common-components';\nimport store from '../store/store';\nimport { closeOverlay, fetchThing } from '../action/action-helpers';\nvar initialThingPageID = extractMetaFromURL(location.pathname).id;\nvar initialPageIsThingPage = initialThingPageID != null; // This stores initial static page history info that needs to be restored when modal get closed.\n\nexport var historyData = {\n  initialPath: location.pathname,\n\n  /* mut */\n  preservedHref: location.href,\n  // Preserved Href just before open, and to be returned when closed.\n  initialThingPageID: initialThingPageID,\n  initialPageIsThingPage: initialPageIsThingPage,\n  initialTitle: document.title,\n  // This prop indicates current location is (static) thing page. Mutable.\n  locationIsThingPage: initialPageIsThingPage,\n  overlayIsOn: false\n};\n/*\nfunction isInitialPath() {\n    return historyData.initialPath === location.pathname;\n}\n*/\n\nfunction runOverlay(thingID, thingURLType) {\n  var killCache = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var queryString = arguments.length > 3 ? arguments[3] : undefined;\n\n  // Context needs to be isolated from hook: https://github.com/rackt/redux-router/issues/157\n  if (!$(document.body).hasClass('error-page')) {\n    requestIdleCallback(function () {\n      $(document.body).addClass('thing-overlay-on');\n      store.dispatch(fetchThing(thingID, thingURLType, killCache, false, queryString));\n      historyData.overlayIsOn = true; //EE.emit('overlay-on');\n    });\n  }\n}\n\nfunction stopOverlay() {\n  historyData.overlayIsOn = false;\n  store.dispatch(closeOverlay());\n}\n\nexport function reloadCurrentThing() {\n  var meta = extractMetaFromURL(location.href);\n  var thingID = meta && meta.id;\n\n  if (thingID != null && historyData.overlayIsOn) {\n    runOverlay(thingID, meta.type, true);\n  }\n}\nexport function historyHook(_ref) {\n  var pathname = _ref.pathname,\n      search = _ref.search;\n  var meta = extractMetaFromURL(pathname);\n  var thingID = meta && meta.id; // When initially (statically) renderred page is thing page\n  // Moving to new thing page\n\n  historyData.locationIsThingPage = thingID != null;\n\n  if (historyData.locationIsThingPage) {\n    runOverlay(thingID, meta.type, false, search);\n  } else if (historyData.overlayIsOn) {\n    stopOverlay();\n  }\n}\nhistory.listen(historyHook);","import { extractMetaFromURL, getObjectTypeFromUrl, isStaticPage, stripPathname } from \"fancyutils\";\nimport { historyData } from \"./history\";\nimport { history } from 'common-components';\nexport var LinkTypes = {\n  Dynamic: 0,\n  Static: 1,\n  Timeline: 2,\n  Internal: 3 // no update needed\n\n}; // `staticLink`: transition from statically attached links\n\nexport function transition(href) {\n  var linkType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : LinkTypes.Dynamic;\n\n  // ID-only\n  if (!_.isNaN(Number(href))) {\n    href = \"/things/\".concat(href);\n  }\n\n  if (getObjectTypeFromUrl(href) === \"Thing\") {\n    var meta = extractMetaFromURL(href); // Update URL to go back when overlay is closed\n\n    if (!historyData.overlayIsOn) {\n      historyData.preservedHref = location.href;\n    }\n\n    history.push(stripPathname(meta.href), null);\n  } else {\n    redirect(href);\n  }\n}\nexport function closeModal() {\n  if (isStaticPage()) {\n    return;\n  }\n\n  $(document.body).removeClass(\"thing-overlay-on\"); // FIXME: isolate modal logic\n} // NOOP\n\nexport var pagingContext = {\n  init: function init() {},\n  movePrev: function movePrev() {},\n  moveNext: function moveNext() {}\n};\nexport function redirect(destination) {\n  if (destination == null) {\n    return false;\n  } else {\n    location.href = destination;\n    return true;\n  }\n}\n\nfunction getUtm() {\n  var $nav = $('.navigation');\n\n  if ($nav.length > 0) {\n    if ($nav.find('a.current[data-feed=\"featured\"]').length > 0) {\n      return \"timeline_featured\";\n    } else if ($nav.find('a.current[data-feed=\"recommended\"]').length > 0) {\n      return \"timeline_recommended\";\n    } else {\n      var $shopLink = $nav.find('.shop li a');\n\n      if ($shopLink.eq(0).is('.current')) {\n        return \"shop\";\n      } else if ($shopLink.eq(1).is('.current')) {\n        return \"\";\n      } else if ($shopLink.eq(2).is('.current')) {\n        return \"popular\";\n      } else if ($shopLink.eq(3).is('.current')) {\n        return \"newest\";\n      } else if ($shopLink.eq(4).is('.current')) {\n        return \"editors_picks\";\n      } else if ($shopLink.eq(5).is('.current')) {\n        return \"sales\";\n      }\n    }\n  } else {\n    if ($('.wrapper-content.profile-section').length > 0) {\n      return \"userprofile\";\n    } else if ($('.wrapper-content.merchant').length > 0) {\n      return \"seller_shop\";\n    }\n  }\n}\n\nexport function getUtmString() {\n  var utm = getUtm();\n\n  if (utm) {\n    return \"?utm=\".concat(utm);\n  } else {\n    return '';\n  }\n}","// This is entrypoint, which `React.render` takes place after DOM is ready.\nimport React, { Suspense, lazy } from \"react\";\nimport classnames from \"classnames\";\nimport { Route, Router, Switch } from \"react-router-dom\";\nimport { render } from \"react-dom\";\nimport { Provider } from \"react-redux\";\nimport { selectOrCreate } from \"fancyutils\";\nimport { history } from \"common-components\";\nimport Bugsnag from \"@bugsnag/js\";\nimport BugsnagPluginReact from \"@bugsnag/plugin-react\";\n\nif (__Config.bugsnag) {\n  Bugsnag.start({\n    apiKey: \"a54d48e98cb0410b7bdf0e60a905b00e\",\n    plugins: [new BugsnagPluginReact()]\n  });\n}\n\nimport { attachEntryEvents } from \"./container/entry-events\";\nimport { pagingContext } from \"./container/routeutils\";\nimport store from \"./store/store\";\nimport { historyHook } from \"./container/history\";\nimport { closeOverlay } from \"./action/action-helpers\";\n\nvar App = function App(_ref) {\n  var children = _ref.children;\n\n  if (__Config.design_v4) {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, children);\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classnames(\"popup overlay-thing thing-detail\", {\n      \"new\": !!window.__Config.heart_icon\n    })\n  }, children, /*#__PURE__*/React.createElement(\"a\", {\n    className: \"ly-close\",\n    onClick: function onClick(event) {\n      event.preventDefault();\n      event.stopPropagation();\n      store.dispatch(closeOverlay());\n    }\n  }, \"Close\"));\n};\n\n$(document).ready(function () {\n  require(\"./Shared\");\n\n  var overlayContainer = __Config.design_v4 ? document.querySelector(\"#container-wrapper .container\") : selectOrCreate(\"#overlay-thing\");\n  var Overlay = __Config.design_v4 ? /*#__PURE__*/lazy(function () {\n    return import(\n    /* webpackChunkName: \"OverlayThing.main\" */\n    \"./components/v2\");\n  }) : /*#__PURE__*/lazy(function () {\n    return import(\n    /* webpackChunkName: \"OverlayThing.main.old\" */\n    \"./components/Overlay\");\n  });\n  var ErrorBoundary = __Config.bugsnag ? Bugsnag.getPlugin(\"react\").createErrorBoundary(React) : React.Fragment;\n  var tree = /*#__PURE__*/React.createElement(ErrorBoundary, null, /*#__PURE__*/React.createElement(Provider, {\n    store: store\n  }, /*#__PURE__*/React.createElement(Router, {\n    history: history\n  }, /*#__PURE__*/React.createElement(App, null, /*#__PURE__*/React.createElement(Switch, null, /*#__PURE__*/React.createElement(Route, {\n    path: \"/things/*\"\n  }, /*#__PURE__*/React.createElement(Suspense, {\n    fallback: /*#__PURE__*/React.createElement(\"div\", null)\n  }, /*#__PURE__*/React.createElement(Overlay, null))), /*#__PURE__*/React.createElement(Route, {\n    path: \"/sales/*\"\n  }, /*#__PURE__*/React.createElement(Suspense, {\n    fallback: /*#__PURE__*/React.createElement(\"div\", null)\n  }, /*#__PURE__*/React.createElement(Overlay, null))), /*#__PURE__*/React.createElement(Route, {\n    path: \"*\",\n    component: function component() {\n      return null;\n    }\n  }))))));\n  render(tree, overlayContainer, function () {\n    history.listen(historyHook);\n    historyHook({\n      pathname: location.pathname,\n      search: location.search\n    }); // should init once\n\n    attachEntryEvents();\n    pagingContext.init();\n  });\n});","import _objectSpread from \"@babel/runtime/helpers/objectSpread\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport { combineReducers } from \"@reduxjs/toolkit\";\nimport { extractMetaFromURL\n/*getConciseNumberString,*/\n, update, updateShallow } from \"fancyutils\";\nimport C from \"./action/action-constants\";\nimport { getInitialStoreState } from \"./store/initial-store\";\nimport { getFirstSaleOption, setWaiting } from \"./components/map\";\nimport { updateState } from \"./appstate\";\nimport { scrollEvent } from \"./container/entry-events\";\nimport { getThingType } from \"./ThingTypes\";\nimport { cache } from \"./cache\";\nvar loaded = false;\nvar lastFullyRenderedThingID = 0;\n\nfunction appContext() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getInitialStoreState(\"appContext\");\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case C.OPEN_THING:\n      scrollEvent.visible = true;\n      return updateShallow(state, {\n        visible: true\n      });\n\n    case C.CLOSE_THING:\n      scrollEvent.visible = false;\n      lastFullyRenderedThingID = 0;\n      loaded = false;\n      return updateShallow(state, {\n        visible: false,\n        lastFullyRenderedThingID: lastFullyRenderedThingID\n      });\n\n    case C.UPDATE_APP_CONTEXT:\n      return updateShallow(state, action.context);\n\n    case C.LOAD_THING:\n      {\n        // Due to multi-stage rendering (cache -> from-server-data -> ...)\n        // it is unable to check state change correctly just by comparing ID;\n        // Therefore, we set internal state per every update cycle and check\n        // if state is fully updated.\n        // FIXME: when cached response exist, it marks as rendered before\n        if (loaded === true && lastFullyRenderedThingID !== action.data.id && action.data.fromServer) {\n          lastFullyRenderedThingID = action.data.id;\n        }\n\n        var loggedIn = window.__FancyUser.loggedIn;\n        var viewer = action.data.viewer || {};\n        var userCountry = $.cookie.get(\"shipping_country_code\") || action.data.current_country_code || state.userCountry;\n        updateState(\"loggedIn\", loggedIn);\n        updateState(\"viewer\", viewer);\n        loaded = true;\n        return update(state, {\n          lastFullyRenderedThingID: lastFullyRenderedThingID,\n          loggedIn: loggedIn,\n          viewer: viewer,\n          userCountry: userCountry\n        });\n      }\n\n    default:\n      return state;\n  }\n}\n\nfunction populateThingContext(thingData) {\n  thingData.loading = thingData.fromServer !== true;\n  thingData.META = getThingType(thingData);\n  thingData.URLMeta = extractMetaFromURL(location.href); // FIXME: provide current pathname\n\n  thingData.owner = thingData.user;\n} // Thing context\n\n\nfunction thing() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getInitialStoreState(\"thing\");\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case C.LOAD_THING:\n      populateThingContext(action.data);\n      return updateShallow(state, {\n        data: action.data,\n        status: action.status,\n        ID: action.ID,\n        pendingID: null,\n        isFetching: false\n      });\n\n    case C.REQUEST_THING:\n      return update(state, {\n        pendingID: action.pendingID,\n        status: action.status,\n        isFetching: true\n      });\n\n    case C.REQUEST_THING_FAILURE:\n      return update(state, {\n        status: action.status,\n        isFetching: false\n      });\n    // Reset state\n\n    case C.CLOSE_THING:\n      return updateShallow(getInitialStoreState(\"thing\"));\n\n    default:\n      return state;\n  }\n} // Follow contexts\n\n\nfunction followContext() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getInitialStoreState(\"followContext\");\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    // reset thing context on new thing loading / closing.\n    case C.LOAD_THING:\n      return updateShallow(getInitialStoreState(\"followContext\"), {\n        id: action.data.id,\n        followStore: {\n          following: action.data.sales ? Boolean(action.data.sales.seller && action.data.sales.seller.seller_follow) : false,\n          loading: false\n        },\n        followUser: {\n          following: action.data ? Boolean(action.data.following) : false,\n          loading: false\n        }\n      });\n    // Sidebar\n    // Follow seller/user\n\n    case C.TOGGLE_FOLLOW:\n      return update(state, _defineProperty({}, action.followType, {\n        loading: true,\n        following: !state[action.followType].following\n      }));\n\n    case C.CANCEL_FOLLOW:\n      return update(state, _defineProperty({}, action.followType, {\n        loading: false,\n        following: !state[action.followType].following\n      }));\n\n    case C.COMPLETE_FOLLOW:\n      if (action.followType === \"followStore\") {\n        cache.update(state.id, undefined, \"sales.seller.seller_follow\", state[action.followType].following);\n      }\n\n      return update(state, _defineProperty({}, action.followType, {\n        loading: false,\n        following: state[action.followType].following\n      }));\n\n    case C.CLOSE_THING:\n      return updateShallow(getInitialStoreState(\"followContext\"));\n\n    default:\n      return state;\n  }\n}\n/*\nfunction getFancyStatus(nextFancydState) {\n    return nextFancydState ? FancyStatus.Addition : FancyStatus.Removal;\n}\nfunction getCompletionIdleStatus(currentFancyState) {\n    const prevFancyState = !currentFancyState;\n    return prevFancyState ? FancyStatus.AfterRemoval : FancyStatus.AfterAddition;\n}*/\n\n\nfunction fancyContext() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getInitialStoreState(\"fancyContext\");\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    // reset thing context on new thing loading / closing.\n    case C.LOAD_THING:\n      // Extract thing data for initial thing context data reset.\n      // onFancyButtonUpdate(action.data.id, action.data.fancyd, getConciseNumberString(action.data.fancyd_count));\n      return updateShallow(getInitialStoreState(\"fancyContext\"), {\n        id: action.data.id,\n        fancyd: action.data.fancyd,\n        fancyd_count: action.data.fancyd_count,\n        loading: false //status: FancyStatus.Idle,\n\n      });\n\n    case C.TOGGLE_FANCY:\n      var nextFancydState = !state.fancyd; // return update(state, {\n      //     fancyd: nextFancydState,\n      //     loading: true,\n      //     //status: getFancyStatus(nextFancydState)\n      // });\n\n      return _objectSpread({}, state, {\n        fancyd: nextFancydState,\n        loading: true //status: getFancyStatus(nextFancydState)\n\n      });\n\n    case C.CANCEL_FANCY:\n      {\n        var _nextFancydState = !state.fancyd; // return update(state, {\n        //     fancyd: nextFancydState,\n        //     loading: false,\n        //     //status: getFancyStatus(nextFancydState)\n        // });\n\n\n        return _objectSpread({}, state, {\n          fancyd: _nextFancydState,\n          loading: false //status: getFancyStatus(nextFancydState)\n\n        });\n      }\n    // Update data\n\n    case C.COMPLETE_FANCY:\n      // cache.update(state.id, undefined, \"fancyd\", state.fancyd);\n      // cache.update(state.id, undefined, \"fancyd_count\", action.fancyd_count);\n      // onFancyButtonUpdate(state.id, state.fancyd, getConciseNumberString(action.fancyd_count));\n      // return update(state, {\n      //     loading: false,\n      //     fancyd_count: action.fancyd_count,\n      //     //status: getCompletionIdleStatus(state.fancyd)\n      // });\n      return _objectSpread({}, state, {\n        loading: false,\n        fancyd_count: action.fancyd_count //status: getCompletionIdleStatus(state.fancyd)\n\n      });\n\n    case C.CLOSE_THING:\n      return updateShallow(getInitialStoreState(\"fancyContext\"));\n\n    default:\n      return state;\n  }\n}\n\nfunction slideContext() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getInitialStoreState(\"slideContext\");\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    // reset thing context on new thing loading / closing.\n    case C.LOAD_THING:\n      return updateShallow(getInitialStoreState(\"slideContext\"), {\n        id: action.data.id\n      });\n\n    case C.SET_THUMBNAIL_INDEX:\n      return update(state, {\n        thumbnailIndex: action.thumbnailIndex\n      });\n\n    case C.CLOSE_THING:\n      return updateShallow(getInitialStoreState(\"slideContext\"));\n\n    default:\n      return state;\n  }\n}\n\nfunction saleContext() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getInitialStoreState(\"saleContext\");\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    // reset thing context on new thing loading / closing.\n    case C.LOAD_THING:\n      {\n        // Extract thing data for initial thing context data reset.\n        var _thing = action.data;\n        var sales = _thing && _thing.sales;\n        var saleOptionInclSales = getFirstSaleOption(sales);\n        var nextContext = {\n          selectedQuantity: 1,\n          saleOptionID: saleOptionInclSales && saleOptionInclSales.id || null,\n          currencyCode: action.data.currency_code,\n          price: saleOptionInclSales && saleOptionInclSales.price || null,\n          waiting: null\n        };\n        return updateShallow(getInitialStoreState(\"saleContext\"), nextContext);\n      }\n\n    case C.CLOSE_THING:\n      return updateShallow(getInitialStoreState(\"saleContext\"));\n\n    case C.UPDATE_SALE_CONTEXT:\n      {\n        // Setting waiting\n        if (action.waiting != null) {\n          setWaiting(state.saleOptionID, action.waiting);\n        }\n\n        var waiting = action.waiting; // Reset quantity / Change waiting if option is changed.\n\n        if (action.saleOptionID != null && action.saleOptionID !== state.saleOptionID) {\n          action.selectedQuantity = 1;\n          waiting = null;\n        }\n\n        var _nextContext = {\n          selectedQuantity: action.selectedQuantity,\n          saleOptionID: action.saleOptionID,\n          // `thing.id`? | `sio.id`?\n          price: action.price,\n          // (props.thing.sales_available && props.thing.sales.price) || null,\n          // UI\n          currencyCode: action.currencyCode,\n          // props.thing.currency_code\n          currencyMoney: action.currencyMoney,\n          //\n          currencySymbol: action.currencySymbol,\n          //\n          personalization: action.personalization,\n          waiting: waiting\n        };\n        return update(state, _nextContext);\n      }\n\n    default:\n      return state;\n  }\n}\n/*\nfunction checkNotImplementedWithURLExceptionRule(META) {\n    if (['Fancybox', 'Hermes'].some(type => META[type])) {\n        window.location.reload()\n    }\n}*/\n\n\nvar rootReducer = combineReducers({\n  appContext: appContext,\n  // Thing contexts\n  followContext: followContext,\n  fancyContext: fancyContext,\n  slideContext: slideContext,\n  saleContext: saleContext,\n  // etc.\n  thing: thing\n});\nexport default rootReducer;","// Warning: objects has to be flat in each context\nexport function getInitialStoreState(contextName) {\n  switch (contextName) {\n    case 'appContext':\n      return {\n        visible: false,\n        viewer: {},\n        loggedIn: null,\n        userCountry: 'US',\n        applePayDisplay: false,\n        applePayTest: false\n      };\n\n    case 'thing':\n      return {\n        data: null,\n        ID: null,\n        pendingID: null,\n        isFetching: null,\n        status: 'idle' // { idle | request | failed }\n\n      };\n\n    case 'followContext':\n      return {\n        id: null,\n        followStore: {\n          following: undefined,\n          loading: false\n        },\n        followUser: {\n          following: undefined,\n          loading: false\n        }\n      };\n\n    case 'fancyContext':\n      return {\n        id: null,\n        fancyd_count: 0,\n        fancyd: false,\n        loading: false,\n        status: 'Idle' // { Idle | Addition | Removal | After- } - Fancy'd status for animation control \n\n      };\n\n    case 'saleContext':\n      return {\n        selectedQuantity: 1,\n        saleOptionID: null,\n        // `thing.id`? | `sio.id`?\n        currencyCode: null,\n        // props.thing.currency_code\n        currencyMoney: null,\n        //\n        currencySymbol: null,\n        //\n        price: null,\n        // (props.thing.sales_available && props.thing.sales.price) || null,\n        personalization: null\n      };\n\n    case 'slideContext':\n      return {\n        id: null,\n        thumbnailIndex: 0\n      };\n\n    default:\n      console.warn('`getInitialStoreState()`: Unknown context name ', contextName);\n  }\n}\n;\nvar contexts = ['slideContext', 'saleContext', 'fancyContext', 'followContext', 'thing', 'appContext'];\nexport function getAllInitialStoreState() {\n  return contexts.reduce(function (state, contextKey) {\n    state[contextKey] = getInitialStoreState(contextKey);\n    return state;\n  }, {});\n}","import { configureStore } from \"@reduxjs/toolkit\";\nimport thunk from \"redux-thunk\";\nimport logger from 'redux-logger';\nimport { getAllInitialStoreState } from \"./initial-store\";\nimport rootReducer from \"../reducers\"; // import type { RootState } from '../reducers';\n\nvar middlewares = [thunk];\n\nif (process.env.NODE_ENV !== 'production') {\n  middlewares.push(logger);\n}\n\nvar store = configureStore({\n  reducer: rootReducer,\n  preloadedState: getAllInitialStoreState(),\n  middleware: function middleware(getDefaultMiddleware) {\n    return getDefaultMiddleware({\n      serializableCheck: false\n    }).prepend(middlewares);\n  }\n});\nexport default store;"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;ACjOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5bA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;ACzFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACleA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;AC3DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;ACxSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;AC3KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACntBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;ACjcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;AC7JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxFA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;AC/VA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;AChFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;A","sourceRoot":""}