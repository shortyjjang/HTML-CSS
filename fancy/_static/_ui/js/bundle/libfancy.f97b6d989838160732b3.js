(self.webpackChunkfancy=self.webpackChunkfancy||[]).push([[130],{6071:(e,t,n)=>{"use strict";n.d(t,{sS:()=>a,j6:()=>i});n(7294),n(7198);var a={None:{display:"none"},Block:{display:"block"},Inline:{display:"inline"},InlineBlock:{display:"inline-block"},NoneIf:function(e){return e?a.None:void 0},BlockIf:function(e){return e?a.Block:void 0},InlineIf:function(e){return e?a.Inline:void 0},InlineBlockIf:function(e){return e?a.InlineBlock:void 0}};function i(e){var t=$("#header .header-featured"),n=$("#header").height();return"true"===t.attr("data-expanded")&&(n+=t.height()),1+~(document.body.scrollTop-$(e).offset().top+n)}},7198:(e,t,n)=>{"use strict";n.d(t,{Lp:()=>oe,Yy:()=>ue,tW:()=>F,MP:()=>ae,Kf:()=>pe,j4:()=>p,Dm:()=>le,vQ:()=>b,xD:()=>W,Qh:()=>K,Y4:()=>J,mU:()=>te,e$:()=>ee,KN:()=>fe,b1:()=>I,YQ:()=>E,uS:()=>U,au:()=>Y,nI:()=>O,Bs:()=>X,aE:()=>ie,tU:()=>L,RO:()=>x,Kz:()=>Z,YT:()=>ce,xb:()=>M,GH:()=>H,p_:()=>B,N9:()=>V,sG:()=>z,ee:()=>Q,ph:()=>se,WF:()=>re,i8:()=>q,M6:()=>g,_7:()=>v,dG:()=>_,ZW:()=>me,qe:()=>A,Vx:()=>R,nG:()=>P,uC:()=>ne});var a=n(4575),i=n.n(a),r=n(3913),s=n.n(r),o=n(9713),l=n.n(o),c=n(8),d=n.n(c),u=n(3935),h=n(7294);function m(e){return $("#popup_container .".concat(e)).length>0&&e?$.dialog(e):null}function p(e){var t=m(e);t&&(t.$obj.data("via-overlay",!1),t.close())}var f=document.getElementById("popup_container");function g(e,t,n){return!1!==(t=t||{}).openOnMount&&null==n&&(n=function(){!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=m(e);n&&(t&&(n.$obj.data("via-overlay",!0),n.$obj.one("close",(function(){$(this).data("via-overlay",!1)}))),n.open())}(e.popupName)}),e.popupName||console.warn("renderPopup: Please set `popupName` property of ".concat(e.name)),u.render(h.createElement(e,t),_(".popup.".concat(e.popupName||""),f),n)}function v(e){var t="string"==typeof e&&e.match(/[http|https]\:(\/\/.*)/);return null==t?e:t[1]}new(function(){function e(){i()(this,e),l()(this,"HOSTS",{}),this.makeServer("THINGD_MEDIA","thingd-media-ec.thefancy.com"),this.makeServer("THEFANCY_MEDIA","thefancy-media-ec.thefancy.com"),this.makeServer("RESIZE_IMAGE","resize-ec.thefancy.com"),this.makeServer("STATICFILES","static-ec.thefancy.com"),this.makeServer("FANCY_WEB","site-ec.thefancy.com")}return s()(e,[{key:"makeServer",value:function(e,t){var n=this.HOSTS;n[e]||(n[e]=[]),n[e].push(t)}},{key:"getResizeURL",value:function(e,t,n,a,i){var r,s=window.parseURL(e),o=/test_default/.test(s.pathname)?"thingd":"thefancy",l="/resize/".concat(n?n+"/":"").concat(t,"/").concat(o).concat(s.pathname);return r=i?this.getCDNURL(l):"".concat(s.protocol,"//").concat(s.hostname).concat(l),a&&(r=v(r)),r}},{key:"getCDNURL",value:function(e){var t,n=this.HOSTS,a=window.parseURL?window.parseURL(e):{},i=a.pathname;return"s3.amazonaws.com"==a.hostname?/\/media\.thefancy\.com/.test(a.pathname)?(i=a.pathname.replace(/^\/media\.thefancy\.com/,""),t=n.THEFANCY_MEDIA):/\/media\.thingd\.com/.test(a.pathname)&&(i=a.pathname.replace(/^\/media\.thingd\.com/,""),t=n.THINGD_MEDIA):t=/^\/(test_)?default/.test(i)?n.THINGD_MEDIA:/^\/_ui/.test(i)?n.FANCY_WEB:/^\/(resize|mark)/.test(i)?n.RESIZE_IMAGE:/^\/_static_gen/.test(i)?n.STATICFILES:n.THEFANCY_MEDIA,"//"+t[function(e){var t,n,a=0;for(t=0,n=e.length;t<n;t++)a+=e.charCodeAt(t);return a}(i.replace(/[^a-zA-Z0-9_]+/g,""))%t.length]+i}},{key:"resizedSchemelessImage",value:function(e,t,n){return e.match(/^(CoverImages\/|UserImages\/)/)&&(e="/".concat(e)),this.getResizeURL(e,t,n,!0,!0)}}]),e}());var y=n(1742),w=n.n(y);function b(e,t){var n,a,i,r,s;t||(t={}),n=t.cb||Function.prototype;try{a=w()(),i=document.createRange(),r=document.getSelection(),(s=document.createElement("mark")).textContent=e,s.style.whiteSpace="pre",document.body.appendChild(s),i.selectNode(s),r.addRange(i),document.execCommand("copy")||(console.warn("unable to copy via execCommand"),window.clipboardData.setData("text",e))}catch(e){console.warn(e)}finally{n(null),r&&("function"==typeof r.removeRange?r.removeRange(i):r.removeAllRanges()),s&&document.body.removeChild(s),a()}}var S=window._;function _(e){var t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"div";if("."===e[0]){t="class";var r=e.split(".").filter((function(e){return e}));n=r.length>1?r.join(" "):e.substr(1)}else{if("#"!==e[0])throw new Error("non-recognized selector:"+e);t="id",n=e.substr(1)}var s=$(a).find(e).get(0);return null==s&&(s=$("<".concat(i," ").concat(t,'="').concat(n,'" />')).appendTo(a).get(0)),s}window.requestIdleCallback=window.requestIdleCallback||function(e){for(var t,n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];(t=window).setTimeout.apply(t,[e,0].concat(a))},Number.isNaN=Number.isNaN||function(e){return e!=e},Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};var k=/^\/(sales|things)\/(\d+)/;function E(e){var t=(e=N(e)).match(k),n={};return null!=t&&(n.href=j(e),n.type=t[1],n.id=t[2]),n}var C=/^\/(articles)\/([^\?]+)/;function I(e){var t=(e=N(e)).match(C),n={};return null!=t&&(n.href=j(e),n.type=t[1],n.id=t[2]),n}function N(e){if(e){var t=function(e){var t=document.createElement("a");return t.setAttribute("href",e),t}(e),n=t.pathname+t.search+t.hash;return 0!==n.indexOf("/")&&(n="/"+n),n}return"/"}function L(e){var t=N(e);return k.test(t)?"Thing":C.test(t)?"Article":null}function x(e){return e.pathname===location.pathname?"":e.pathname}function j(e){var t=N(e);return t||null}function U(e){var t=q(e,2),n=q(e,2).split(".");return"00"===n[1]?n[0]:t}function M(e){return null==e||""===e||e instanceof Array&&0===e.length||"object"===d()(e)&&0===Object.getOwnPropertyNames(e).length}var T,D,F={TAB:9,ENTER:13,SPACE:32,ESC:27,UP:38,DOWN:40,LEFT:37,RIGHT:39,SEMICOLON:186,COMMA:188};function A(e,t,n){var a;return a=n?new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n}):new Event(t,{bubbles:!0,cancelable:!0}),e.dispatchEvent(a)}function R(e,t){var n=[!0,{},e];return t&&n.push(t),$.extend.apply(null,n)}function P(e,t){var n=[{},e];return t&&n.push(t),S.extend.apply(null,n)}function O(e){return{display:e?"block":"none"}}function B(e){return!(0!==e.button||e.altKey||e.metaKey||e.ctrlKey||e.shiftKey)}function H(){return null==T&&(T="/"===location.pathname),T}function Q(){return null==D?D=function(){try{if("/"===location.pathname&&$("#container-wrapper .timeline").length>0)return!0;if(/\/search\?q\=/.test(location.href))return!0;if($("#container-wrapper .wrapper-content.profile-section").length>0&&/^\/((?!\/).)*$/.test(location.pathname))return!0;if("/shop"===location.pathname||/^\/shop\/.*/.test(location.pathname))return!0;if(/.*\/list\/\d+/.test(location.pathname)||/.*\/collection\/\d+/.test(location.pathname))return!0}catch(e){}return!1}():D}function K(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(){clearTimeout(n);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];r.unshift(a),n=setTimeout(e.bind.apply(e,r),t)}}function W(e,t){var n;return function(a){a.persist(),clearTimeout(n),n=setTimeout((function(){return e(a)}),t)}}var G=["","K","M","B","T"];function Y(e){var t=Number(e);if(S.isNaN(t)||!S.isNumber(t))return"";for(var n=0;t>1e3;)t/=1e3,n+=1;return t%1!=0?t.toFixed(1)+G[n]:String(t)+G[n]}function q(e,t,n,a){t=isNaN(t)?2:Math.abs(t),n=void 0===n?".":n,a=void 0===a?",":a;var i=e<0?"-":"";e=Math.abs(+e||0);var r=parseInt(e.toFixed(t),10),s=r+"",o=s.length>3?s.length%3:0;return i+(o?s.substr(0,o)+a:"")+s.substr(o).replace(/(\d{3})(?=\d)/g,"$1"+a)+(t?n+Math.abs(e-r).toFixed(t).slice(2):"")}function z(){return-1!==document.body.className.indexOf("static-ot")}function V(){return-1!==document.body.className.indexOf("static-article")}function Z(e,t,n){return"string"==typeof t?Z(e,t.split("."),n):1===t.length&&void 0!==n?(e[t[0]]=n,n):0===t.length?e:void 0!==e[t[0]]?Z(e[t[0]],t.slice(1),n):void 0}function J(e){return e?e.sort().reduce((function(e,t){return t!==e[0]&&e.unshift(t),e}),[]):null}function X(){return window.__F=window.__F||{},window.__F}function ee(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};if(window.__F){if(window.__F[e])return t(window.__F[e])}else X();return null}function te(e,t){return e.parents(t).length>0||e.is(t)}var ne={isSuccess:function(e){var t=$(e).find("status_code");return t.length>0&&"1"===t.text()},isFail:function(e){var t=$(e).find("status_code");return t.length>0&&"0"===t.text()}};function ae(){var e;window.track_event&&(e=window).track_event.apply(e,arguments)}function ie(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.search,n=t.substr(1,t.length);if(n){var a,i=n.split("&").map((function(e){return e.split("=")}));if(!e)return i;if(i.some((function(t){t[0]===e&&(a=t)})),a)return a}}function re(e,t,n){return Math.max(Math.min(e,n),t)}function se(e){return e.reduce((function(e,t){return $.extend(!0,e,t)}),null)}var oe=function(){function e(t){var n=this,a=t.component,r=t.popupElementRefKey,s=void 0===r?"popupElement":r;i()(this,e),l()(this,"eventKey",""),l()(this,"component",void 0),l()(this,"popupElementRefKey",""),l()(this,"attached",!1),l()(this,"handleAttach",(function(e){if(!n.attached&&null!=e){var t=n.component,a=n.eventKey,i=n.handleDetach,r=n.popupElementRefKey;$(document.body).on(a,(function(n){!n.isTrigger&&$.contains(document.body,n.target)&&null===function(e,t){for(var n=e;null!=n;){if(n===t)return t;if(n===document.body||n===document.documentElement)return null;n=n.parentElement}return null}(n.target,t[r])&&(e(t),i())})),n.attached=!0}})),l()(this,"handleDetach",(function(){$(document.body).off(n.eventKey),n.attached=!1}));var o=Math.random().toString().substr(2,8);this.eventKey="click.attachClickOutside"+o,this.component=a,this.popupElementRefKey=s}return s()(e,[{key:"destroy",value:function(){delete this.component,this.handleDetach()}}]),e}();function le(e){return e.map((function(e){var t=Object.assign({sales_available:!1,id:e.id_str,name:e.name,fancyd:e["fancy'd"],thumb_image_url_310:e.thumb_image_url_310,thumb_image_url_558:e.thumb_image_url_558,fancyd_count:e.fancys,image:{src:e.image_url,width:e.image_url_width,height:e.image_url_height},owner:e.user,html_url:window.parseURL(e.url).pathname,fancyd_users:e.fancyd_users,sales:e.sales},e);if(function(e){return null!=e&&null!=e[0]}(e.sales)){var n=e.sales[0];null==n.id&&null!=n.sale_id&&(n.id=n.sale_id),t.sales=n,t.sales.quantity=n.remaining_quantity,t.sales.price=n.fancy_price,t.sales_available=n.available_for_sale}else t.sales=null;return t.isCrawled=!0,t}))}function ce(e,t){var n=e.getBoundingClientRect(),a=0,i=0;if(t){var r=t.element,s=t.type;if(r){var o=r.getBoundingClientRect();"top"===s?a=o.bottom:"left"===s&&(i=o.right)}}var l=document.documentElement,c=window.innerHeight||l.clientHeight,d=window.innerWidth||l.clientWidth,u=n.bottom,h=n.top,m=n.left,p=n.right;return h<=a&&u<=a||h>=c&&u>=a||m<=i&&p<=i||m>=d&&p>=d}var de={loggedIn:!1,merchant:!1,id:null};window.__FancyUser&&Object.assign(de,window.__FancyUser);var ue=de,he="".concat(location.protocol,"//").concat(location.hostname);function me(e){var t=e.split(he);return t.length>1?t[1]:t[0]}var pe=window.alertify||{alert:function(){var e;(e=window).alert.apply(e,arguments)},prompt:function(e,t,n,a){var i;t&&(null===(i=n?window.prompt(e,n):window.prompt(e))?t(!1):t(!0,i))},confirm:function(e,t,n){t&&t(window.confirm(e))},set:function(){},labels:{ok:"OK",cancel:"Cancel"}};function fe(e){return(e+"").replace(/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,(function(e,t){return t?"\0"===e?"ï¿½":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}))}},2292:(e,t,n)=>{"use strict";n.d(t,{_t:()=>se,wK:()=>ue,ah:()=>pe,nk:()=>b,f2:()=>ye,m8:()=>ve});var a=n(4575),i=n.n(a),r=n(3913),s=n.n(r),o=n(8585),l=n.n(o),c=n(9754),d=n.n(c),u=n(1506),h=n.n(u),m=n(2205),p=n.n(m),f=n(9713),g=n.n(f),v=n(7294),y=n(6071);function w(e){if(e.h264_1000k_url)return e;var t=e&&e.sales&&e.sales.video,n=e&&e.video_cover||e&&e.cover_video;if(t)return t;if(n){try{!n.h264_1000k_url&&e.cover_video.outputs.h264_1000k&&(n.h264_1000k_url=e.cover_video.outputs.h264_1000k.url)}catch(e){}return n}return e.metadata&&e.metadata.video_url?{thumbnail_url:e.image.src,original_url:e.metadata.video_url}:(console.warn("<Video /> component is mounted but with unknown type"),{})}var b=function(e){function t(e){var n;return i()(this,t),n=l()(this,d()(t).call(this,e)),g()(h()(n),"el",null),g()(h()(n),"videoEl",null),n.id=+new Date,n}return p()(t,e),s()(t,[{key:"getSrc",value:function(){var e=w(this.props.object);return e.h264_1000k_url||e.original_url||e.original}},{key:"getThumbnail",value:function(){return w(this.props.object).thumbnail_url}},{key:"getLoop",value:function(){return w(this.props.object).loop}},{key:"shouldComponentUpdate",value:function(e){return e.lastFullyRenderedObjectID!==this.props.lastFullyRenderedObjectID||e.display!==this.props.display||e.playing!==this.props.playing||e.object!==this.props.object}},{key:"prepare",value:function(){var e="video-".concat(this.id),t=$(".".concat(e));t.length?t[0].src!==this.getSrc()&&(t[0].src=this.getSrc(),t[0].loop=!!this.getLoop(),t[0].currentTime=0):(t=$('<video id="myVideo" class="'.concat(e,'" preload="auto" playsInline disablePictureInPicture autoplay muted controls controlslist="nodownload nofullscreen noremoteplayback" src="').concat(this.getSrc(),'" loop="').concat(!!this.getLoop(),'" poster="').concat(this.getThumbnail(),'"/>')).on("ended",(function(){this.currentTime=0})),this.videoEl=t.get(0),$(this.el).empty().append(this.videoEl))}},{key:"componentDidUpdate",value:function(e){var t=this.props;t.display!==e.display&&(!1===t.display?this.videoEl&&this.videoEl.pause():this.videoEl&&this.videoEl.play()),t.display&&t.playing!=e.playing&&(!1===t.playing?this.videoEl&&this.videoEl.pause():this.videoEl&&this.videoEl.play()),this.prepare()}},{key:"render",value:function(){var e=this,t=this.props,n=t.display,a=t.style,i=void 0===a?{}:a;t.playing;return v.createElement("div",{style:_.extend(i,y.sS.NoneIf(!n)),className:"video_player nozoom",ref:function(t){e.el=t,e.videoEl||e.prepare()}})}}],[{key:"isVideoAvailableForThing",value:function(e){var t=!1;return e&&(e.video_cover?t=!0:e.metadata?e.metadata.video_url&&(t=!0):e.sales&&e.sales.video&&(t=!0)),t}},{key:"isVideoAvailableForArticle",value:function(e){return!(!e||!e.cover_video||"ready"!=e.cover_video.status)}}]),t}(v.Component),S=n(4184),k=n.n(S),E=n(7198),C="thing",I="list",N="store",L="user",x="article";function j(e,t){if(e.loading||e.state.referrerURL||e.props.referrerURL)t&&t(!0);else{e.loading=!0;var n=null;t&&(n=function(){t(!1),e.loading=!1});var a=e.props,i=function(e,t,n,a){var i;if(i=n===C?"https://".concat(location.hostname,"/things/").concat(t):n===x&&a?"https://".concat(location.hostname,"/articles/").concat(a.slug):location.href.replace(/(#.*)/,""),e){var r=~i.indexOf("?")?"&":"?";i="".concat(i).concat(r,"ref=").concat(e)}return i}(a.viewerUsername,a.objectId,a.objectType,a.objectMeta);$.post("/get_short_url.json",{url:i}).done((function(t){e.setState({referrerURL:t.short_url},n)})).fail((function(){e.setState({referrerURL:i},n),console.warn("/get_short_url failed")}))}}var U={fb:"Facebook",tw:"Twitter",tb:"Tumblr"},M=[],T=!1,D="empty success",F="empty default",A="empty searching",R="empty no-result",P=v.createElement("i",{className:"circle bg-share2"}),O=v.createElement("a",{href:"/find-friends",className:"fb",target:"_blank"},v.createElement("em",null," Facebook")),B=v.createElement("a",{href:"/find-friends?type=twitter",className:"tw",target:"_blank"},v.createElement("em",null," Twitter")),H=v.createElement("a",{href:"/find-friends?type=gmail",className:"gm",target:"_blank"},v.createElement("em",null," Gmail")),Q=function(e){function t(e){var n;return i()(this,t),n=l()(this,d()(t).call(this,e)),g()(h()(n),"state",{friendSearchQuery:"",searchedFriends:[],selectedUserID:null,sentUser:null,sendNote:"",sendSuccess:!1,searching:!1,isContact:!1}),g()(h()(n),"mailUser",{id:"EMAIL",type:"email",profile_image_url:"/_ui/images/common/blank.gif",fullname:"Email",username:null}),g()(h()(n),"handleContinue",(function(e){e.preventDefault(),n.clearFriendList(),n.props.handleHide&&n.props.handleHide()})),g()(h()(n),"handleFriendSearch",(function(e){var t=e.target.value,a=n.state.friendSearchQuery;n.setState({friendSearchQuery:t,sendSuccess:!1,searching:!0},(function(){n.searchFriends(a,t)}))})),g()(h()(n),"handleSend",(function(){var e=n.state,t=e.sendNote,a=e.selectedUserID,i=e.searchedFriends,r=n.props,s=r.title,o=r.referrerURL;if(!n.sending)if(a===n.mailUser.id)n.handleSendMail();else if(0!==i.length&&null!=a){var l,c=n.props.objectType;l=c===C?{things:n.props.objectId,user_id:a}:{user_id:a,message:"".concat(s," ").concat(o)},n.sending=!0,$.trim(t)&&(l.message+=" "+$.trim(t)),$.post("/messages/send-message.json",l).done((function(e){1===e.status_code?(n.clearFriendList({sendSuccess:!0,sentUserID:a,selectedUserID:null},["searchedFriends"]),(0,E.MP)("Complete Share",{"thing id":l.things,type:"FancyMessage"})):e.message?E.Kf.alert(e.message):E.Kf.alert("There was an error while sending message. Please try again.")})).fail((function(e){console.warn(e)})).always((function(){n.sending=!1}))}})),g()(h()(n),"handleSendMail",(function(){if(!n.sending){null==n.props.objectType&&console.warn("objectType should be provided.");var e=n.props.objectType||"thing",t=n.mailUser.username.trim(),a=n.props.objectId;n.sending=!0;var i={email_address:t,object_type:e,object_id:a},r=$.trim(n.state.sendNote);r&&(i.message=r),n.props.objectMeta&&"shoplist"===n.props.objectMeta.type&&(i.object_meta=n.props.objectMeta.type),$.post("/messages/send-email.json",i).done((function(e){1===e.status_code?(n.clearFriendList({sendSuccess:!0,sentUserID:i.email_address,selectedUserID:null}),(0,E.MP)("Complete Share",{"object id":i.object_id,"object type":i.object_type,type:"Email"})):e.message?E.Kf.alert(e.message):E.Kf.alert("There was an error while sending message. Please try again.")})).fail((function(e){var t=null;try{t=JSON.parse(e.responseText)}catch(e){}t&&t.message?E.Kf.alert(t.message):E.Kf.alert("Error occured. please try again.\n"+e.status+" "+e.statusText),console.warn(e)})).always((function(){n.sending=!1}))}})),g()(h()(n),"clearFriendList",(function(e,t){var a=_.extend({friendSearchQuery:"",searchedFriends:[],sendNote:"",sendSuccess:!1,sentUserID:null},e);t&&t.forEach((function(e){delete a[e],a[e]=n.state[e]})),n.setState(a)})),g()(h()(n),"handleSendNoteInput",(function(e){var t=e.target.value;n.setState({sendNote:t})})),g()(h()(n),"handleUserSelect",(function(e){e.preventDefault();var t=n.state.selectedUserID,a=$(e.currentTarget).attr("data-userid");String(t)===$(e.currentTarget).attr("data-userid")?n.setState({selectedUserID:null}):n.setState({selectedUserID:a})})),g()(h()(n),"getSelectedUser",(function(){var e=n.state.selectedUserID;return _.find(n.getSearchedFriends(),(function(t){return String(t.id)===e}))})),g()(h()(n),"getSentUser",(function(){var e=n.state.sentUserID;return _.find(n.getSearchedFriends(),(function(t){return String(t.id)===e}))})),g()(h()(n),"getDisplayUsers",(function(){T||(n.loadingDisplayUsers=!0,T=!0,$.get("/get-share-display-users.json").done((function(e){1===e.status_code&&e.users.length>0&&M.push.apply(M,e.users)})).fail((function(){console.warn("failed to fetch display users")})).always((function(){n.loadingDisplayUsers=!1,n.forceUpdate()})))})),g()(h()(n),"handleClickBackFromContact",(function(){n.setState({isContact:!1})})),g()(h()(n),"handleClickContactImport",(function(e){e.preventDefault(),n.setState({isContact:!0})})),g()(h()(n),"getSharedMailUser",(function(){var e=n.state.friendSearchQuery;return n.mailUser.username=e,[n.mailUser]})),g()(h()(n),"getSearchedFriends",(function(){return 0!==n.state.friendSearchQuery.length||n.state.sendSuccess?n.isInputEmail()?n.getSharedMailUser():n.state.searchedFriends:M})),g()(h()(n),"isInputEmail",(function(){var e=n.state.friendSearchQuery;return e.length>1&&e.indexOf("@")>0})),g()(h()(n),"isEmailOnlyMode",(function(){return!(n.props.objectType===C||n.props.objectType===x)||!E.Yy.loggedIn})),n.searchFriends=(0,E.Qh)((function(e,t){var n=this;if(this.isEmailOnlyMode())this.setState({searching:!1});else{var a=$.trim(t);$.trim(e)!==a&&(""!==a?this.setState({searching:!0},(function(){$.get("/search-users.json",{term:a,filter_messages_permission:!0}).done((function(e){var a={searching:!1};n.state.friendSearchQuery===t&&(a.searchedFriends=e,a.selectedUserID=null),n.setState(a)}))})):this.setState({searchedFriends:[],selectedUserID:null}))}}),200,h()(n)),n}return p()(t,e),s()(t,[{key:"getPrefix",value:function(e){return"email"===e.type?"":"@"}},{key:"componentDidUpdate",value:function(e){var t=this.props.showShare;this.state.isContact&&!t&&e.showShare!==t&&this.setState({isContact:!1})}},{key:"componentDidMount",value:function(){this.isEmailOnlyMode()||this.getDisplayUsers()}},{key:"render",value:function(){var e=this,n=this.props,a=n.showShare,i=n.title,r=n.headerGap,s=n.objectType,o=n.objectId,l=n.objectMeta,c=n.viewerUsername,d=n.referrerURL;var u,h,m=this.state,p=m.friendSearchQuery,f=m.sendNote,g=m.sendSuccess,w=m.sentUserID,b=m.searching,S=m.isContact,_=this.getSearchedFriends(),C=this.getSelectedUser(),I=this.getSentUser(),N=y.sS.Block,L=this.isInputEmail(),x=this.isEmailOnlyMode();g?u=D:x&&!L?u=F:_.length>0?!L&&b&&(u=A):0===_.length&&(u=0===p.length?this.loadingDisplayUsers?A:F:b?A:R),u?h=y.sS.None:N=y.sS.None,C&&(h=y.sS.None);var j=!this.sending&&_.length>0&&!!C,U=!(C||g),M="";g&&(M+=gettext("Sent to "),M+=I?I.fullname||I.username:w);var T=!1;return r<290&&(T=!0),v.createElement("div",{id:"show-share",className:k()("more-share-popup more-share-popup-2 has-arrow",{bot:T}),style:(0,E.nI)(a)},v.createElement("h3",{className:"tit",style:y.sS.NoneIf(S||C)},t.getShareMessage(s,"Share")),v.createElement("a",{className:"btn-back",style:y.sS.NoneIf(!C||I),onClick:function(){return e.setState({selectedUserID:null}),!1}},"Back"),v.createElement("div",{className:"frm",style:y.sS.NoneIf(S)},E.Yy.loggedIn&&v.createElement("div",{id:"more-share-send"},v.createElement("span",{className:"textbox before-bg-share2",style:y.sS.NoneIf(C||g)},v.createElement("input",{id:"more-share-email",className:"text",type:"text",placeholder:x?gettext("Enter email address"):gettext("Username or email address"),autoComplete:"off",onChange:this.handleFriendSearch,value:p})),v.createElement("ul",{className:"lists",style:h},_.map((function(t,n){var a,i,r,s=$.trim(p).toLowerCase(),o=e.getPrefix(t);return s&&-1==="".concat(t.fullname," ").concat(o).concat(t.username).toLowerCase().indexOf(s)&&(a=y.sS.None),"email"===t.type?(i=t.username,r="email"):i="".concat(o).concat(t.username),v.createElement("li",{key:n,style:a},v.createElement("a",{className:"before-bg-share2",onClick:e.handleUserSelect,"data-userid":t.id},v.createElement("img",{alt:"",className:r,src:t.profile_image_url}),v.createElement("b",null,t.fullname),v.createElement("small",null,i)))}))),v.createElement("div",{className:u,style:N},P,x?v.createElement("span",{className:"default"},gettext("Share this via Email")):v.createElement("span",{className:"default"},v.createElement("b",null,gettext("Find people to share with")),v.createElement("a",{onClick:this.handleClickContactImport},gettext("Import from contacts"))),v.createElement("span",{className:"searching"},gettext("Searching...")),v.createElement("span",{className:"no-result"},gettext("No users found")),v.createElement("span",{className:"success"},v.createElement("b",null,gettext("Success!")),M,v.createElement("a",{className:"close",onClick:this.handleContinue},gettext("Continue")))),v.createElement("div",{className:"send",style:y.sS.NoneIf(null==C)},C&&v.createElement("span",{className:"recipient"},v.createElement("img",{alt:"user image",className:"email"===C.type&&"email",src:C.profile_image_url}),v.createElement("b",null,C.fullname),v.createElement("small",null,this.getPrefix(C),C.username)),v.createElement("fieldset",null,v.createElement("textarea",{placeholder:"Add a message",value:f,onChange:this.handleSendNoteInput}),v.createElement("button",{className:"btn-send",disabled:!j,onClick:this.handleSend},"Send")))),v.createElement(q,{showShareBox:U,title:i,referrerURL:d,objectId:o,objectType:s,objectMeta:l,viewerUsername:c})),v.createElement("div",{className:"contact-sns",style:y.sS.NoneIf(!S)},v.createElement("a",{onClick:this.handleClickBackFromContact,className:"back"},"Back"),O,B,H))}}],[{key:"getShareMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=t;return e===I?n="Share collection":e===N?n="Share store":e===L?n="Share profile":e===x&&(n="Share article"),n}}]),t}(v.Component),K=v.createElement("span",{className:"ic-fb"}),W=v.createElement("span",{className:"ic-tw"}),G=v.createElement("span",{className:"ic-tb"}),Y=v.createElement("span",{className:"ic-em"}),q=function(e){function t(){var e,n;i()(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(r))),g()(h()(n),"state",{copied:!1,referrerURL:"",textboxDisplay:!1}),g()(h()(n),"loading",!1),g()(h()(n),"snsShareWindow",null),g()(h()(n),"handleEmbed",(function(){var e=h()(n),t=e.updateEmbedOption,a=e.props,i=a.objectType,r=a.objectId,s=a.viewerUsername;if(i===C){var o=$("#embed_popup");o.off("click.fancyembed").off("keyup.fancyembed").on("click.fancyembed",'input[name="embed-info"]',(function(){t($("#embed_popup"),s)})).on("keyup.fancyembed",'input[name="embed-width"]',(function(){t($("#embed_popup"),s)})),o.find(".customize").removeClass("opened"),o.find('input[name="embed-info"]').prop("checked",!0),o.find('input[name="embed-width"]').val(450),o.attr("tid",r),t($("#embed_popup"),s),$.dialog("embed_item").open(!0)}return!1})),g()(h()(n),"handleShare",(function(e){var t=h()(n).props,a=t.objectId,i=t.objectType,r=e.currentTarget;if(e.detail&&e.detail.faintClick){try{n.snsShareWindow.location.assign(r.getAttribute("href"))}catch(e){}n.snsShareWindow=null}else if(n.getRefURL()||(n.snsShareWindow=window.open("about:blank","_fancy_sns_share")),e.preventDefault(),j(h()(n),(function(e){e?window.open(r.getAttribute("href"),"_fancy_sns_share"):(0,E.qe)(r,"click",{faintClick:!0})})),i===C){var s=U[r.className];(0,E.MP)("Complete Share",{"thing id":a,type:s})}})),n}return p()(t,e),s()(t,[{key:"getRefURL",value:function(){return this.state.referrerURL||this.props.referrerURL}},{key:"updateEmbedOption",value:function(e,t){var n=e.find(".embed-thum"),a=e.find('input[name="embed-info"]'),i=[];a.each((function(){var e=this.value;this.checked?(n.addClass(e),i.push(e)):n.removeClass(e)}));var r=parseInt(e.find('input[name="embed-width"]').val(),10)||void 0,s=$("<script />",{src:"//".concat(location.hostname,"/embed.js?v=150608"),async:!0,class:"fancy-embed","data-id":e.attr("tid")||e.attr("objectId")||"","data-ref":t,"data-type":i.length>0?i.join(","):"","data-width":r}).prop("outerHTML");e.find('textarea[name="embed-code"]').val(s)}},{key:"render",value:function(){var e=this.props,t=e.title,n=e.showShareBox,a=e.objectType,i=this.state.textboxDisplay,r=this.getRefURL();return v.createElement("div",{id:"more-share-sns",className:"more-share-sns",style:n?y.sS.Block:y.sS.None},v.createElement("span",{className:"via after",style:y.sS.NoneIf(i)},v.createElement("a",{href:"https://www.facebook.com/sharer.php?u=".concat(r),onClick:this.handleShare,className:"fb",target:"_blank"},K," ",v.createElement("em",null,gettext("Share with Facebook"))),v.createElement("a",{href:"https://twitter.com/share?text=".concat(encodeURI(t),"&url=").concat(r,"&via=fancy"),onClick:this.handleShare,className:"tw",target:"_blank"},W," ",v.createElement("em",null,gettext("Share with Twitter"))),v.createElement("a",{href:"https://www.tumblr.com/share/link?url=".concat(r,"&name=").concat(encodeURI(t),"&description=").concat(encodeURI(t)),onClick:this.handleShare,className:"tb",target:"_blank"},G," ",v.createElement("em",null,gettext("Share with Tumblr"))),a===C&&v.createElement("a",{onClick:this.handleEmbed,className:"embed"},Y," ",v.createElement("em",null,gettext("Embed this item")))))}}]),t}(v.Component),z=n(3038),V=n.n(z),Z=v.createElement("i",{className:"icon"}),J=function(e){function t(){var e,n;i()(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(r))),g()(h()(n),"state",{lists:[],wanted:!1,listSearchQuery:"",listCreationQuery:"",createListFocused:!1}),g()(h()(n),"handleListSearch",(function(e){var t=e.target.value;n.setStateSafe({listSearchQuery:t})})),g()(h()(n),"handleListCreation",(function(e){if(e.preventDefault(),"keyup"!==e.type||e.which===E.tW.ENTER){var t=$.trim(n.state.listCreationQuery),a=n.props,i=a.objectId,r=a.objectType,s=a.merchantId;(0,E.xb)(t)||X({merchantId:s,listCreationQuery:t,callback:function(){n.setStateSafe({listCreationQuery:""},(function(){n.drawUserList(i),n.quickCreateList.focus(),"thing"===r&&(0,E.MP)("Create New List",{"thing id":i,"list name":t,via:"thing detail"})}))}})}})),g()(h()(n),"handleWishlistCheckboxChange",(function(e){e.preventDefault(),e.stopPropagation();var t=e.currentTarget,a=n.props,i=a.objectType,r=a.objectId,s=a.handleHide,o={owned:!1,wanted:t.checked},l=t.checked?"Add to List":"Remove from List";"thing"===i?(o.wanted&&window.dataLayer&&window.dataLayer.push({event:"Add_to_Wishlist_Check",product_id:void 0,products_info:void 0,products:void 0,revenue:void 0,option_id:void 0}),$.ajax("/rest-api/v1/things/".concat(r),{type:"PUT",data:o}).done((function(){n.drawUserList(r),n.setStateSafe({wanted:o.wanted}),o.wanted&&s&&s()})).error((function(e){console.warn(e)})),(0,E.MP)(l,{"thing id":r,"list name":"wanted","list id":-1,via:"thing detail"})):console.warn("Add to list does not work with non-thing type")})),g()(h()(n),"handleListCheckboxChange",(function(e){e.preventDefault(),e.stopPropagation();var t=e.currentTarget,a=t.checked,i=n.props,r=i.objectId,s=i.objectType,o=i.handleHide,l=i.merchantId,c=n.state.lists,d=t.getAttribute("data-listid"),u=[Number(d),t.checked];if("thing"===s){var h=a?"Add to List":"Remove from List",m=c.filter((function(e){return e.id===d}))[0],p=function(){n.drawUserList(r),a&&o&&o(),(0,E.MP)(h,{"thing id":r,"list name":m.name,"list id":m.id,via:"thing detail"})};if(l)ee({merchantId:l,objectId:r,collectionAction:u,callback:p});else{var f=[],g=[];$(n.lists).find('input[type="checkbox"]:not(.tag)').each((function(){var e=this.getAttribute("data-listid");this.checked?f.push(e):g.push(e)})),ee({checked:f,unchecked:g,objectId:r,callback:p})}}else console.warn("Add to list does not work with non-thing type")})),g()(h()(n),"handleCreateListLabelClick",(function(e){e.preventDefault(),e.stopPropagation(),n.setStateSafe({createListFocused:!0},(function(){n.quickCreateList.focus()}))})),g()(h()(n),"handleCreateListBlur",(function(){n.setStateSafe({createListFocused:!1})})),g()(h()(n),"handleCreateListQueryChange",(function(e){n.setStateSafe({listCreationQuery:e.target.value})})),n}return p()(t,e),s()(t,[{key:"setStateSafe",value:function(){this.mounted&&this.setState.apply(this,arguments)}},{key:"drawUserList",value:function(e){var t=this;e=e||this.props.objectId,function(e){var t=e.merchantId,n=e.objectId,a=e.callback;t?$.get("/rest-api/v1/seller/".concat(t,"/collections"),{selected_object_id:n}).done((function(){var e,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).collections;e=t.length>0?t.sort((function(e,t){return $.trim(e).toLowerCase()<$.trim(t).toLowerCase()?-1:1})).map((function(e){return{id:e.id,name:e.name,selected:e.selected}})):[],a&&a({lists:e,wanted:null})})).error((function(e){console.warn(e)})):$.get("/_get_list_checkbox.html",{tid:n}).done((function(e){var t,n=$(e),i=n.filter("li").find("img").remove().end();t=i.length>0?i.sort((function(e,t){return $.trim($(e).text()).toLowerCase()<$.trim($(t).text()).toLowerCase()?-1:1})).map((function(e,t){var n=$(t);return{id:n.find("label").attr("for"),name:$.trim(n.find("label").text()),selected:n.find("input").prop("checked")}})).get():[];var r="true"===n.filter('input[name="wanted"]').val();a&&a({lists:t,wanted:r})})).error((function(e){console.warn(e)}))}({merchantId:this.props.merchantId,objectId:e,callback:function(e){t.setStateSafe(e)}})}},{key:"isWishlistQuery",value:function(e){return-1!=="wishlist".indexOf($.trim(e).toLowerCase())}},{key:"componentDidMount",value:function(){this.mounted=!0,this.listDrawn=!1}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"componentDidUpdate",value:function(e){var t=this;e.showList===this.props.showList&&!1!==this.listDrawn||!0!==this.props.showList||(!1===this.listDrawn&&(this.listDrawn=!0),this.drawUserList(this.props.objectId),setTimeout((function(){t.listSearchInput.focus()}),0))}},{key:"render",value:function(){var e=this,t=this.props,n=t.objectId,a=t.showList,i=t.headerGap,r=t.merchantId,s=this.state,o=s.lists,l=s.wanted,c=s.listSearchQuery,d=s.listCreationQuery,u=s.createListFocused;return v.createElement("div",{id:"show-addlist",className:k()("has-arrow more-share-popup",{bot:i&&i<285}),style:(0,E.nI)(a)},v.createElement("span",{className:"tit"},r?gettext("Add to Collection"):gettext("Add to List")),v.createElement("span",{className:"search before-bg-share2"},v.createElement("input",{ref:function(t){e.listSearchInput=t},type:"text",className:"text",placeholder:r?gettext("Search your collections"):gettext("Search your lists"),value:c,onChange:this.handleListSearch})),v.createElement("ul",{className:"lists",ref:function(t){e.lists=t}},!r&&v.createElement("li",null,v.createElement("label",{htmlFor:"wanted-".concat(n)},v.createElement("input",{type:"checkbox",name:"wanted",checked:l,id:"wanted-".concat(n),className:"tag ".concat(l?"checked":""),style:{display:this.isWishlistQuery(c)?null:"none"},onChange:this.handleWishlistCheckboxChange})," ",gettext("Wish List"))),o&&o.map((function(t,a){var i,r=$.trim(c).toLowerCase();_.isString(r)&&r.length>0&&(i=y.sS.NoneIf(-1===t.name.toLowerCase().indexOf(r.toLowerCase())));var s=t.selected?"selected":null,o="".concat(n,"-").concat(t.id);return v.createElement("li",{key:a,style:i},v.createElement("label",{htmlFor:o},v.createElement("input",{className:s,type:"checkbox",name:o,id:o,checked:t.selected,"data-listid":t.id,onChange:e.handleListCheckboxChange})," ",t.name))}))),v.createElement("div",{className:"new-list"},v.createElement("label",{htmlFor:"quick-create-list",style:{display:u?"none":"block"},onClick:this.handleCreateListLabelClick},Z,r?gettext("Create New Collection"):gettext("Create New List")),v.createElement("input",{type:"text",id:"quick-create-list",ref:function(t){e.quickCreateList=t},onBlur:this.handleCreateListBlur,onKeyUp:this.handleListCreation,onChange:this.handleCreateListQueryChange,value:d,placeholder:r?gettext("Create New Collection"):gettext("Create New List")}),v.createElement("button",{className:"btn-create",onClick:this.handleListCreation},gettext("Create"))))}}]),t}(v.Component);function X(e){var t=e.merchantId,n=e.listCreationQuery,a=e.callback;t?$.post("/rest-api/v1/seller/".concat(t,"/collections"),{list_name:n}).done((function(e){a&&a()})).error((function(e){console.warn(e)})):$.post("/create_list.xml",{list_name:n,reaction:0}).done((function(e){"False"==$(e).find("created").text()?E.Kf.alert("<b>List Title Not Available</b><br><br>There is already a list named ".concat(n,". Try again with a different name.")):a&&a()})).error((function(e){console.warn(e)}))}function ee(e){var t=e.merchantId,n=e.collectionAction,a=e.objectId,i=e.checked,r=e.unchecked,s=e.callback;if(t){var o=V()(n,2),l=o[0],c=o[1];$.ajax({url:"/rest-api/v1/seller/".concat(t,"/collections/").concat(l),type:"POST",data:{object_id:a,action:c?"add":"remove"}}).done(s).error((function(e){console.warn(e)}))}else $.post("/save_list_items",{tid:a,checked_list_ids:i.join(","),unchecked_list_ids:r.join(",")}).done(s).error((function(e){console.warn(e)}))}var te=function(e){function t(e){var n;return i()(this,t),n=l()(this,d()(t).call(this,e)),g()(h()(n),"handleFollow",(function(e){e.preventDefault(),e.stopPropagation();var t=n.props.user,a=n.state,i=a.following,r=a.loading;if(!0===n.props.loggedIn){if(!r){var s=i?"/delete_follow.xml":"/add_follow.xml";n.setState({loading:!0},(function(){$.ajax({type:"post",url:s,data:{user_id:t.id},dataType:"xml"}).done((function(e){var t=!i,a=$(e).find("status_code");a.length&&0!==a.text()&&n.setState({following:t})})).always((function(){n.setState({loading:!1})}))}))}}else window.require_login()})),g()(h()(n),"handleTransition",(function(e){if((0,E.p_)(e)){var t=e.currentTarget.getAttribute("href");t&&(location.href=t)}})),n.state={loading:!1,following:!1},n}return p()(t,e),s()(t,[{key:"componentDidMount",value:function(){var e=this.props.following||this.props.user.following;e&&this.setState({following:e})}},{key:"render",value:function(){var e=this.props,t=e.user,n=e.isAddedUser,a=e.viewerId,i=this.state.following;return v.createElement("li",null,v.createElement("a",{href:"/".concat(t.username),className:"username",onClick:this.handleTransition},v.createElement("img",{src:"/_ui/images/common/blank.gif",style:{backgroundImage:"url(".concat(t.image_url||t.user_square_image_small,")")}}),n?"Added by ":"",v.createElement("b",null,t.fullname||t.full_name),n?"":"@".concat(t.username)),a!==t.id&&v.createElement("button",{className:k()("btns-gray-embo",i?"following":"follow"),onClick:this.handleFollow}))}}]),t}(v.Component),ne=v.createElement("button",{className:"ly-close",title:"Close"},v.createElement("i",{className:"ic-del-black"})),ae=function(e){function t(e){var n;return i()(this,t),n=l()(this,d()(t).call(this,e)),g()(h()(n),"handleMore",(function(e){e.preventDefault(),n.getFollowList()})),n.state=n._getInitialState(),n}return p()(t,e),s()(t,[{key:"_getInitialState",value:function(){return{loading:!1,nextPage:1,ended:null,added_user:null,users:[],owner:null}}},{key:"getFollowList",value:function(e,t){var n,a=this,i=e||this.props,r=i.objectId,s=i.objectType,o=this.state.nextPage;t?(n=this._getInitialState()).loading=!0:n={loading:!0},(t||!0!==this.state.loading&&!0!==this.state.ended)&&this.setState(n,(function(){s===C?$.get("/thing_follower_list.json",{thing_id:r,page:o},(function(e){var t=e.has_next,n=e.users,i=e.owner,r={loading:!1,users:a.state.users.concat(n),owner:i};t?(r.nextPage=a.state.nextPage+1,r.ended=!1):r.ended=!0,a.setState(r)})).fail((function(){a.setState({loading:!1})})):s===x&&$.get("/rest-api/v1/articles/".concat(r,"/saved_users"),{page:o},(function(e){var t=e.max_page,n=e.current_page,i=e.saved_users,r=t>n,s={loading:!1,users:a.state.users.concat(i),owner:null};r?(s.nextPage=a.state.nextPage+1,s.ended=!1):s.ended=!0,a.setState(s)})).fail((function(){a.setState({loading:!1})}))}))}},{key:"componentDidMount",value:function(){this.getFollowList(),this.__last_tid=this.props.objectId}},{key:"componentDidUpdate",value:function(e){this.__last_tid!==e.objectId&&(this.__last_tid=e.objectId,this.getFollowList(e,!0))}},{key:"render",value:function(){var e=this.state,t=e.ended,n=e.users,a=e.owner,i=this.props,r=i.loggedIn,s=i.viewerId;return v.createElement("div",null,v.createElement("p",{className:"ltit"},gettext("Fancy'd by")),v.createElement("ul",null,a?v.createElement(te,{user:a,isAddedUser:!0,viewerId:s,loggedIn:r}):null,n.map((function(e,t){return v.createElement(te,{key:"FancydBy-".concat(t),user:e,viewerId:s,loggedIn:r})})),!1===t&&v.createElement("li",{className:"more"},v.createElement("a",{onClick:this.handleMore},gettext("View More")))),ne)}}]),t}(v.Component);g()(ae,"popupName","fancyd_list");var ie=v.createElement("div",{id:"infscr-loading"},v.createElement("img",{alt:"Loading...",src:"/_ui/images/common/loading.gif"}),v.createElement("div",null)),re=v.createElement("button",{className:"ly-close",title:"Close"},v.createElement("i",{className:"ic-del-black"})),se=function(e){function t(e){var n;return i()(this,t),n=l()(this,d()(t).call(this,e)),g()(h()(n),"handleMore",(function(e){e.preventDefault(),n.getFollowList()})),g()(h()(n),"handleScroll",(function(e){var t=e.target;n.state.ended||t.scrollHeight-50<=t.clientHeight+t.scrollTop&&n.getFollowList()})),n.state=n._getInitialState(),n}return p()(t,e),s()(t,[{key:"_getInitialState",value:function(){return{loading:!1,nextPage:1,next_cursor:null,ended:null,added_user:null,users:[],owner:null}}},{key:"getFollowList",value:function(e,t){var n,a=this,i=e||this.props,r=i.objectId,s=i.objectType,o=i.next_cursor,l=this.state.nextPage;t?(n=this._getInitialState()).loading=!0:n={loading:!0},(t||!0!==this.state.loading&&!0!==this.state.ended)&&this.setState(n,(function(){if(s===C){var e={};o&&(e.cursor=o),$.get("/rest-api/v1/things/".concat(r,"/fancyd-users"),e,(function(e){var t=e.next_cursor,n=e.fancyd_users,i={loading:!1,users:a.state.users.concat(n),owner:null};t?(i.next_cursor=t,i.ended=!1):i.ended=!0,a.setState(i)})).fail((function(){a.setState({loading:!1})}))}else s===x&&$.get("/rest-api/v1/articles/".concat(r,"/saved_users"),{page:l},(function(e){var t=e.max_page,n=e.current_page,i=e.saved_users,r=t>n,s={loading:!1,users:a.state.users.concat(i),owner:null};r?(s.nextPage=a.state.nextPage+1,s.ended=!1):s.ended=!0,a.setState(s)})).fail((function(){a.setState({loading:!1})}))}))}},{key:"componentDidMount",value:function(){this.getFollowList(),this.__last_tid=this.props.objectId}},{key:"componentDidUpdate",value:function(e){this.__last_tid!==e.objectId&&(this.__last_tid=e.objectId,this.getFollowList(e,!0))}},{key:"render",value:function(){var e=this.state,t=e.users,n=e.owner,a=this.props,i=a.loggedIn,r=a.loading,s=a.viewerId;return v.createElement("div",null,v.createElement("p",{className:"ltit"},gettext("Liked by")),v.createElement("ul",{onScroll:this.handleScroll},n?v.createElement(te,{user:n,isAddedUser:!0,viewerId:s,loggedIn:i}):null,t.map((function(e,t){return v.createElement(te,{key:"FancydBy-".concat(t),user:e,viewerId:s,loggedIn:i})})),r&&ie),re)}}]),t}(v.Component);g()(se,"popupName","fancyd_list");var oe,le,ce=(oe=["showShare","showList","showSellerList","showMenu"],le={},function(){oe.forEach((function(e){le[e]=!1}));for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t&&t.forEach((function(e){le[e]=!0})),le}),de=v.createElement("small",null,"Copy link to clipboard"),ue=function(e){function t(){var e,n;i()(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(r))),g()(h()(n),"state",{showShare:!1,showList:!1,showMenu:!1,headerGap:null,referrerURL:null,linkCopied:!1}),g()(h()(n),"handleShareDisplay",(function(){n.setStateSafe({showShare:!n.state.showShare,showList:!1,showMenu:!1,headerGap:(0,y.j6)(n.moreMenuButton)},n.handleHook),n.props.objectType===C&&(0,E.MP)("Share",{"thing id":n.props.objectId})})),g()(h()(n),"handleListDisplay",(function(){if(!E.Yy.loggedIn)return n.closePopup(),void window.require_login();var e=!n.state.showList;n.setStateSafe(ce(e?"showList":null),n.handleHook)})),g()(h()(n),"handleMerchantListDisplay",(function(){if(!E.Yy.loggedIn)return n.closePopup(),void window.require_login();var e=!n.state.showSellerList;n.setStateSafe(ce(e?"showSellerList":null),n.handleHook)})),g()(h()(n),"closePopup",(function(){n.removeViewportCheck(),n.setStateSafe(ce(),n.handleHook)})),g()(h()(n),"viewPortChecking",!1),g()(h()(n),"evtName","scrollstop.MoreShare"),g()(h()(n),"checkViewport",(function(){n.viewPortChecking||(n.viewPortChecking=!0,$(window).on(n.evtName,(function(){var e,t=$(n.MoreShareEl),a=$("#header .header-featured").get(0),i=n.state,r=i.showMenu,s=i.showShare,o=i.showList,l=i.showSellerList;r?e="#more-menu":s?e="#show-share":(o||l)&&(e="#show-addlist");var c=t.find(e).get(0);c&&((0,E.YT)(c,{element:a,type:"top"})&&n.closePopup())})))})),g()(h()(n),"removeViewportCheck",(function(){n.viewPortChecking=!1,$(window).off(n.evtName)})),g()(h()(n),"handleMoreShareToggle",(function(){var e=n.props.objectType,t=n.state,a=t.showMenu,i=t.showShare,r=t.showList,s=t.showSellerList;return e===C||e===x?a||i||r||s?n.closePopup():n.setStateSafe({showMenu:!0,headerGap:(0,y.j6)(n.moreMenuButton)},n.handleHook):n.handleShareDisplay(),!1})),g()(h()(n),"handleHook",(function(){if(n.props.onShowSomething){var e=n.state,t=e.showList,a=e.showShare,i=e.showMenu,r=e.showSellerList;n.props.onShowSomething(t||a||i||r,h()(n))}})),g()(h()(n),"handleHideList",(function(){n.setStateSafe({showList:!1})})),g()(h()(n),"handleHideShare",(function(){n.setStateSafe({showShare:!1})})),g()(h()(n),"linkCopiedRemovalTimer",null),g()(h()(n),"handleCopyLink",(function(){null==n.linkCopiedRemovalTimer&&(0,E.vQ)(n.state.referrerURL,{cb:function(){n.setState({linkCopied:!0}),n.linkCopiedRemovalTimer=setTimeout((function(){n.setState({linkCopied:!1})}),5e3)}})})),g()(h()(n),"handleFancydByDisplay",(function(){event.preventDefault(),event.stopPropagation();var e=n.props,t=e.viewerUsername,a=e.objectId,i=e.objectType;(0,E.M6)(ae,{objectId:a,objectType:i,loggedIn:E.Yy.loggedIn,viewerId:t})})),n}return p()(t,e),s()(t,[{key:"setStateSafe",value:function(){this.mounted&&this.setState.apply(this,arguments)}},{key:"componentDidMount",value:function(){this.mounted=!0,this.clickOutside=new E.Lp({component:this,popupElementRefKey:"MoreShareEl"}),this.props.facadeShowShare&&this.handleShareDisplay(),this.props.facadeShowList&&this.handleMoreShareToggle()}},{key:"componentWillUnmount",value:function(){this.mounted=!1,this.clickOutside.destroy()}},{key:"componentDidUpdate",value:function(e,t){var n=this.state,a=n.showList,i=n.showShare,r=n.showMenu;(a||i||r)&&(this.clickOutside.handleAttach(this.closePopup),this.checkViewport(),(i||r)&&j(this)),n.showMenu!==t.showMenu&&!1===n.showMenu&&(this.setState({linkCopied:!1}),clearTimeout(this.linkCopiedRemovalTimer),this.linkCopiedRemovalTimer=null)}},{key:"shouldShowMerchantCollection",value:function(){return E.Yy.merchant&&E.Yy.active_merchant}},{key:"render",value:function(){var e=this,t=this.props,n=t.title,a=t.viewerUsername,i=t.componentClass,r=void 0===i?"menu-container":i,s=t.btnClass,o=void 0===s?"btn-more":s,l=t.objectType,c=t.objectMeta,d=t.objectId,u=t.showShortcuts,h=void 0===u||u,m=t.fromThingSidebar,p=void 0!==m&&m;null==l&&console.warn("objectType is not defined");var f=this.state,g=f.showShare,y=f.showList,w=f.showMenu,b=f.headerGap,S=f.referrerURL,_=f.linkCopied,I=f.showSellerList,N=l===C,L=l===x,j=this.shouldShowMerchantCollection(),U=j&&I?E.Yy.id:null,M=p;return v.createElement("em",{className:k()(r,"on-home ignore-ext",{open:g||y||w}),ref:function(t){e.MoreShareEl=t},"data-rendered":"true"},M&&v.createElement("button",{className:"btn-share",onClick:this.handleShareDisplay}),v.createElement("small",{className:o,onClick:this.handleMoreShareToggle,ref:function(t){e.moreMenuButton=t}},v.createElement("em",null,Q.getShareMessage(l,"Share & Lists"))),(N||L)&&v.createElement("small",{id:"more-menu",className:k()("has-arrow menu-content react new",{opened:w,bot:b&&b<125})},!M&&v.createElement("button",{className:"share before-bg-share2",onClick:this.handleShareDisplay},v.createElement("b",null,gettext("Share item")),v.createElement("small",null,gettext("Share this with friends"))),M&&v.createElement("button",{className:"fancyd-by before-bg-share2",onClick:this.handleFancydByDisplay},v.createElement("b",null,gettext("Fancy'd By")),v.createElement("small",null,gettext("People who fancy'd this"))),N&&v.createElement("button",{className:"add-list before-bg-share2",onClick:this.handleListDisplay},v.createElement("b",null,gettext("Lists")),v.createElement("small",null,gettext("Add this to your saved lists"))),j&&v.createElement("button",{className:"add-list before-bg-share2",onClick:this.handleMerchantListDisplay},v.createElement("b",null,gettext("Add to Collection")),v.createElement("small",null,gettext("Save this to your collections"))),h&&v.createElement("span",null,v.createElement("button",{style:S?null:{opacity:.7},className:k()("copy-link"),onClick:this.handleCopyLink},v.createElement("b",null,_?"Copied to clipboard":"Item link"),de))),N&&v.createElement(J,{key:"".concat(d,"-").concat(U)||"".concat(d,"-addlist"),objectType:l,objectId:d,showList:y||I,merchantId:U,viewerUsername:a,handleHide:this.handleHideList,headerGap:b}),v.createElement(Q,{objectType:l,objectId:d,objectMeta:c,showShare:g,title:n,referrerURL:this.state.referrerURL,viewerUsername:a,headerGap:b,handleHide:this.handleHideShare}))}}]),t}(v.Component),he=n(7154),me=n.n(he),pe=function(e){function t(){var e,n;i()(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(r))),g()(h()(n),"state",{share:!1,list:!1}),g()(h()(n),"handleClickShare",(function(){n.setState({share:!0})})),g()(h()(n),"handleClickList",(function(){n.setState({list:!0})})),n}return p()(t,e),s()(t,[{key:"render",value:function(){var e=this.state,t=e.share,n=e.list;return v.createElement(v.Fragment,null,!(t||n)&&v.createElement(ge,{onClickShare:this.handleClickShare,onClickAddlist:this.handleClickList}),(t||n)&&v.createElement(ue,me()({},this.props,{facadeShowShare:t,facadeShowList:n})))}}]),t}(v.Component),fe=v.createElement("em",null,"Share & Lists"),ge=function(e){function t(){return i()(this,t),l()(this,d()(t).apply(this,arguments))}return p()(t,e),s()(t,[{key:"render",value:function(){return v.createElement("em",{className:"menu-container on-home ignore-ext","data-rendered":"true"},v.createElement("button",{className:"btn-share",onClick:this.props.onClickShare}),v.createElement("small",{className:"btn-more",onClick:this.props.onClickAddlist},fe))}}]),t}(v.Component);var ve=(0,n(2827).Z)();function ye(){$((function(){function e(e,t){var n;(n=e.is(".itemSlide, .slideshow")?e:e.find(".itemSlide, .slideshow")).data("slideInit",!0);var a=e.find("ul"),i=a.find("li"),r=i.width()+20,s=e.find("a.prev"),o=e.find("a.next"),l=null;function c(e){!function(){var e=a.find("li"),t=Math.abs(parseInt(a.css("left"))),i=n.width(),r=e.width()+20;l&&(i=l);if(t<i){for(var s=Math.ceil(Math.abs(i-t)/r),o=0;o<s;o++){var c=a.find("li:not([_prev])").last();c.clone().insertBefore(a.find("li").first()),c.attr("_prev",!0)}a.css("left",0-t-s*r+"px")}}();var t=Math.abs(parseInt(a.css("left"))),i=n.width();return l&&(i=l),t-i}function d(e){!function(){var e=a.find("li"),t=Math.abs(parseInt(a.css("left"))),i=n.width(),r=e.length*(e.width()+20),s=e.width()+20,o=r-(t+i);l&&(i=l);if(o-i<i)for(var c=Math.ceil(Math.abs(i-(r-(t+i)))/s),d=0;d<c;d++){var u=a.find("li:not([_next])").first();u.clone().insertAfter(a.find("li").last()),u.attr("_next",!0)}}();var t=Math.abs(parseInt(a.css("left"))),i=n.width();return l&&(i=l),t+i}function u(){var e=a.find("li"),t=Math.abs(parseInt(a.css("left"))),n=e.width()+20,i=a.find("li[_next]:not(:in-viewport)"),r=i.length;a.find("li[_prev]:not(:in-viewport)").remove(),i.remove(),a.css("left",0-t+r*n+"px")}t.itemPerSlide&&(l=r*t.itemPerSlide),n&&i?(l&&l>r*i.length||($(window).width()<920?(t.center&&n.find(".itemList").scrollLeft((147*i.length-$(window).width()+20)/2),s.removeClass("disabled"),o.removeClass("disabled")):n.width()>r*i.length?(s.addClass("disabled"),o.addClass("disabled"),t.center&&n.find(".itemList").css("left","0px")):(t.center&&n.find(".itemList").css("left",-parseInt((285*i.length-$(window).width()+20)/2)+"px"),s.removeClass("disabled"),o.removeClass("disabled"))),e.css("visibility","visible")):e.css("visibility","visible"),l&&l>r*i.length&&(s.hide(),o.hide()),e.on("click","a.prev",(function(e){e.preventDefault();var t=$(this);if(!t.hasClass("_disabled")){var n=c();t.addClass("_disabled"),a.animate({left:0-n+"px"},300,"easeInOutExpo",(function(){u(),t.removeClass("_disabled")}))}})).on("click","a.next",(function(e){e.preventDefault();var t=$(this);if(!t.hasClass("_disabled")){var n=d();t.addClass("_disabled"),a.animate({left:0-n+"px"},300,"easeInOutExpo",(function(){u(),t.removeClass("_disabled")}))}}))}$.fn.productSlide=function(t){t=t||{center:!0};return this.each((function(){e($(this),t)}))}}))}}}]);
//# sourceMappingURL=libfancy.f97b6d989838160732b3.js.map