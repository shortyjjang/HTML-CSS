{"version":3,"sources":["webpack://fancy/./_static/_ui/js/ajaxfileupload.js"],"names":["$","xhr","plugin","getCookie","name","RegExp","test","document","cookie","unescape","$2","window","jQuery","XMLHttpRequest","upload","FileReader","FormData","ajaxFileUpload","s","$file","file","reader","extend","ajaxSettings","fileElementId","files","onload","event","data","append","attr","settings","url","type","async","cache","processData","contentType","success","noop","error","complete","onprogress","percent","pos","loaded","position","total","lengthComputable","Math","ceil","progress","dataType","ajax","onerror","readAsArrayBuffer","createUploadIframe","id","uri","$io","frameId","ActiveXObject","src","css","top","left","appendTo","createUploadForm","formId","fileId","csrfId","$form","$oldFile","$newFile","clone","before","$inputHidden","length","val","Date","getTime","secureuri","global","active","trigger","requestDone","xml","uploadCallback","isTimeout","io","getElementById","contentWindow","responseText","body","innerHTML","responseXML","XMLDocument","contentDocument","e","handleError","status","uploadHttpData","off","setTimeout","remove","timeout","action","method","target","enctype","submit","attachEvent","addEventListener","abort","r","globalEval","parseJSON","text","html","evalScripts","call","context"],"mappings":"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","file":"OverlayThing.admin.b03b17dc17efe4aa8666.js","sourcesContent":["// Support HTML5 file upload by taegon kim\n\n;(function($){\n\nvar xhr, plugin;\n\nif (window.XMLHttpRequest) xhr = new window.XMLHttpRequest();\nif (xhr && ('upload' in xhr) && ('onprogress' in xhr.upload) && window.FileReader && window.FormData) {\n\t// yeap! this browser supports HTML5 ajax file upload!\n\tplugin = {\n\t\tajaxFileUpload : function(s) {\n\t\t\tvar xhr = new window.XMLHttpRequest(), reader = new FileReader(), $file, file, xml={};\n\n\t\t\t// import global settings\n\t\t\ts = $.extend({}, $.ajaxSettings, s);\n\n\t\t\t// get a file object\n\t\t\t$file = $('#' + s.fileElementId);\n\t\t\tfile  = $file[0].files[0];\n\n\t\t\treader.onload = function(event){\n\t\t\t\tvar data = new FormData();\n\n\t\t\t\tdata.append('csrfmiddlewaretoken', getCookie('csrftoken'));\n\t\t\t\tdata.append($file.attr('name'), file);\n\n\t\t\t\tvar settings = {\n\t\t\t\t\turl   : s.url,\n\t\t\t\t\ttype  : 'POST',\n\t\t\t\t\tdata  : data,\n\t\t\t\t\tasync : true,\n\t\t\t\t\tcache : false,\n\t\t\t\t\tprocessData : false,\n\t\t\t\t\tcontentType : false,\n\t\t\t\t\tsuccess  : s.success || $.noop,\n\t\t\t\t\terror    : s.error || $.noop,\n\t\t\t\t\tcomplete : s.complete || $.noop,\n\t\t\t\t\txhr : function(){\n\t\t\t\t\t\tvar xhr = $.ajaxSettings.xhr();\n\t\t\t\t\t\txhr.upload.onprogress = function(event){\n\t\t\t\t\t\t\tvar percent = 0, pos = event.loaded || event.position, total = event.total;\n\t\t\t\t\t\t\tif (event.lengthComputable) {\n\t\t\t\t\t\t\t\tpercent = Math.ceil(pos / total * 100);\n\t\t\t\t\t\t\t\t(s.progress || $.noop)(percent);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn xhr;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tif (s.dataType) settings.dataType = s.dataType;\n\n\t\t\t\t$.ajax(settings);\n\t\t\t};\n\t\t\treader.onerror = function(){\n\t\t\t\tif (s.error) s.error();\n\t\t\t\tif (s.complete) s.complete();\n\t\t\t};\n\t\t\treader.readAsArrayBuffer(file);\n\t\t}\n\t};\n} else {\n\t// for old browser\n\tplugin = {\n\t\tcreateUploadIframe: function(id, uri) {\n\t\t\t//create frame\n\t\t\tvar frameId = 'jUploadFrame' + id, $io;\n\n\t\t\t$io = $('<iframe id=\"' + frameId + '\" name=\"' + frameId + '\" />');\n\n\t\t\tif(window.ActiveXObject) {\n\t\t\t\tif(typeof uri== 'boolean'){\n\t\t\t\t\t$io[0].src = 'javascript:false';\n\t\t\t\t} else if(typeof uri == 'string'){\n\t\t\t\t\t$io[0].src = uri;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t$io.css({position:'absolute',top:-1000,left:-1000}).appendTo('body');\n\n\t\t\treturn $io;\n\t\t},\n\t\tcreateUploadForm: function(id, fileElementId) {\n\t\t\t//create form\n\t\t\tvar formId = 'jUploadForm' + id, fileId = 'jUploadFile' + id, csrfId = 'jUploadCSRF' + id;\n\t\t\tvar $form = $('<form  action=\"\" method=\"POST\" name=\"' + formId + '\" id=\"' + formId + '\" enctype=\"multipart/form-data\"></form>');\n\t\t\tvar $oldFile = $('#' + fileElementId), $newFile = $oldFile.clone(true);\n\n\t\t\t$oldFile.attr('id', fileId).before($newFile).appendTo($form);\n\n\t\t\t// CSRF \n\t\t\tvar $inputHidden = $('#'+csrfId);\n\t\t\tif (!$inputHidden.length) {\n\t\t\t\t$inputHidden = $('<input type=\"hidden\" id=\"'+csrfId+'\" name=\"csrfmiddlewaretoken\">').appendTo($form);\n\t\t\t}\n\t\t\t$inputHidden.val( getCookie('csrftoken') );\n\n\t\t\t// remove the previous form and add new form\n\t\t\t$form.css({position:'absolute',top:-1000,left:-1000}).appendTo('body');\n\n\t\t\treturn $form;\n\t\t},\n\n\t\tajaxFileUpload: function(s) {\n\t\t\t// TODO introduce global settings, allowing the client to modify them for all requests, not only timeout\n\t\t\ts = $.extend({}, $.ajaxSettings, s);\n\n\t\t\tvar id = new Date().getTime();\n\t\t\tvar frameId = 'jUploadFrame' + id, formId = 'jUploadForm' + id;\n\t\t\tvar $form = $.createUploadForm(id, s.fileElementId);\n\t\t\tvar $io = $.createUploadIframe(id, s.secureuri);\n\n\t\t\t// Watch for a new set of requests\n\t\t\tif ( s.global && ! $.active++ ) {\n\t\t\t\t$.event.trigger( \"ajaxStart\" );\n\t\t\t}\n\n\t\t\tvar requestDone = false, xml = {};\n\t\t\t// Create the request object\n\t\t\tif ( s.global ) $.event.trigger(\"ajaxSend\", [xml, s]);\n\n\t\t\t// Wait for a response to come back\n\t\t\tvar uploadCallback = function(isTimeout) {\n\t\t\t\tvar io = document.getElementById(frameId);\n\t\t\t\ttry {\n\t\t\t\t\tif(io.contentWindow) {\n\t\t\t\t\t\t xml.responseText = io.contentWindow.document.body?io.contentWindow.document.body.innerHTML:null;\n\t\t\t\t\t\t xml.responseXML = io.contentWindow.document.XMLDocument?io.contentWindow.document.XMLDocument:io.contentWindow.document;\n\n\t\t\t\t\t} else if(io.contentDocument) {\n\t\t\t\t\t\t xml.responseText = io.contentDocument.document.body?io.contentDocument.document.body.innerHTML:null;\n\t\t\t\t\t\txml.responseXML = io.contentDocument.document.XMLDocument?io.contentDocument.document.XMLDocument:io.contentDocument.document;\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t\t$.handleError(s, xml, null, e);\n\t\t\t\t}\n\n\t\t\t\tif ( xml || isTimeout == \"timeout\")\n\t\t\t\t{\n\t\t\t\t\trequestDone = true;\n\n\t\t\t\t\tvar status;\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tstatus = isTimeout != \"timeout\" ? \"success\" : \"error\";\n\n\t\t\t\t\t\t// Make sure that the request was successful or notmodified\n\t\t\t\t\t\tif ( status != \"error\" ) {\n\t\t\t\t\t\t\t// process the data (runs the xml through httpData regardless of callback)\n\t\t\t\t\t\t\tvar data = $.uploadHttpData( xml, s.dataType );\n\n\t\t\t\t\t\t\t// If a local callback was specified, fire it and pass it the data\n\t\t\t\t\t\t\tif ( s.success ) s.success( data, status );\n\n\t\t\t\t\t\t\t// Fire the global callback\n\t\t\t\t\t\t\tif( s.global ) $.event.trigger( \"ajaxSuccess\", [xml, s] );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$.handleError(s, xml, status);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tstatus = \"error\";\n\t\t\t\t\t\t$.handleError(s, xml, status, e);\n\t\t\t\t\t}\n\n\t\t\t\t\t// The request was completed\n\t\t\t\t\tif( s.global ) $.event.trigger( \"ajaxComplete\", [xml, s] );\n\n\t\t\t\t\t// Handle the global AJAX counter\n\t\t\t\t\tif ( s.global && ! --jQuery.active ) $.event.trigger( \"ajaxStop\" );\n\n\t\t\t\t\t// Process result\n\t\t\t\t\tif ( s.complete ) s.complete(xml, status);\n\n\t\t\t\t\t$io.off();\n\n\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t$io.remove();\n\t\t\t\t\t\t\t$form.remove();\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t$.handleError(s, xml, null, e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 100);\n\n\t\t\t\t\txml = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Timeout checker\n\t\t\tif ( s.timeout > 0 ) {\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t// Check to see if the request is still happening\n\t\t\t\t\tif( !requestDone ) uploadCallback( \"timeout\" );\n\t\t\t\t}, s.timeout);\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tvar enctype = 'multipart/form-data';\n\t\t\t\t$form.attr({action:s.url, method:'POST', target : frameId, enctype : enctype}).submit();\n\t\t\t} catch(e) {\n\t\t\t\t$.handleError(s, xml, null, e);\n\t\t\t}\n\n\t\t\tif (window.attachEvent) {\n\t\t\t\tdocument.getElementById(frameId).attachEvent('onload', uploadCallback);\n\t\t\t} else {\n\t\t\t\tdocument.getElementById(frameId).addEventListener('load', uploadCallback, false);\n\t\t\t}\n\n\t\t\treturn {abort: function () {}};\n\t\t},\n\t\tuploadHttpData: function( r, type ) {\n\t\t\tvar data = (!type || type == \"xml\") ? r.responseXML : r.responseText;\n\n\t\t\t// If the type is \"script\", eval it in global context\n\t\t\tif ( type == \"script\" ) $.globalEval( data );\n\t\t\t// Get the JavaScript object, if JSON is used.\n\t\t\tif ( type == \"json\" ) data = $.parseJSON($(r.responseText).text());\n\t\t\t// evaluate scripts within html\n\t\t\tif ( type == \"html\" ) $(\"<div>\").html(data).evalScripts();\n\n\t\t\treturn data;\n\t\t}\n\t};\n}\n\njQuery.extend(plugin);\n\nif (!jQuery.handleError) {\n\tjQuery.extend({\n\t\thandleError : function(s, xhr, status, e) {\n\t\t\tif (s.error) {\n\t\t\t\ts.error.call(s.context || window, xhr, status, e);\n\t\t\t}\n\n\t\t\tif (s.global) {\n\t\t\t\t(s.context ? $(s.context) : $.event).trigger('ajaxError', [xhr, s, e]);\n\t\t\t}\n\t\t}\n\t});\n}\n\n})(window.jQuery);\n\nfunction getCookie(name) {\n    var regex = new RegExp('(^|[ ;])'+name+'\\\\s*=\\\\s*([^\\\\s;]+)');\n    return regex.test(document.cookie)?unescape(RegExp.$2):null;\n}\n"],"sourceRoot":""}