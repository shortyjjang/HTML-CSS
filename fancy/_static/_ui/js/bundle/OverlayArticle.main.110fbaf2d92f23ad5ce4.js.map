{"version":3,"sources":["webpack://fancy/./_static/modules/ui/overlay-article/Shortcode.js","webpack://fancy/./_static/modules/ui/overlay-article/action/action-constants.js","webpack://fancy/./_static/modules/ui/overlay-article/action/action-helpers.js","webpack://fancy/./_static/modules/ui/overlay-article/action/actions.js","webpack://fancy/./_static/modules/ui/overlay-article/appstate.js","webpack://fancy/./_static/modules/ui/overlay-article/cache.js","webpack://fancy/./_static/modules/ui/overlay-article/components/map.js","webpack://fancy/./_static/modules/ui/overlay-article/components/ThingFancydUsers.js","webpack://fancy/./_static/modules/ui/overlay-article/components/ThingCard.js","webpack://fancy/./_static/modules/ui/overlay-article/components/ArticleCard.js","webpack://fancy/./_static/modules/ui/overlay-article/components/ArticleWidgets.js","webpack://fancy/./_static/modules/ui/overlay-article/config.js","webpack://fancy/./_static/modules/ui/overlay-article/container/entry-events.js","webpack://fancy/./_static/modules/ui/overlay-article/container/history.js","webpack://fancy/./_static/modules/ui/overlay-article/container/routeutils.js","webpack://fancy/./_static/modules/ui/overlay-article/container/app.js","webpack://fancy/./_static/modules/ui/overlay-article/SyncedContext.js","webpack://fancy/./_static/modules/ui/overlay-article/components/ArticleFancydUsers.js","webpack://fancy/./_static/modules/ui/overlay-article/components/article.js","webpack://fancy/./_static/modules/ui/overlay-article/index.js","webpack://fancy/./_static/modules/ui/overlay-article/shared.js","webpack://fancy/./_static/modules/ui/overlay-article/store/initial-store.js","webpack://fancy/./_static/modules/ui/overlay-article/reducers.js","webpack://fancy/./_static/modules/ui/overlay-article/store/configure-store.js","webpack://fancy/./_static/modules/ui/overlay-article/store/store.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/map.cart.ts"],"names":["ImageModes","getJumper","$element","_id","String","Math","random","substr","attr","$","getProductContext","products","callback","arrayOfPromises","length","filter","e","map","sid","dfd","Deferred","get","then","thing","resolve","fail","xhr","status","alertify","alert","console","warn","promise","jQuery","when","apply","Array","prototype","slice","call","arguments","done","things","ctx","items","image_fit_to_bounds","image","src","sales","images","fit_to_bounds","title","emojified_name","price","retail_price","id","ShortCodeTransformers","options","$shortcode","tagline","markup","window","isWhitelabelV2","$next","_","template","find","wrap","append","replaceWith","prop","html","reduce","prev","imageMode","getTemplateByImageMode","mode","getIsolatedShortcodeElement","next","convertArticleShortcode","content","$wrapped","$disposable","unmountedDOM","document","body","eq","empty","style","appendTo","mountToDisposable","each","i","shortcode","$sc","data","JSON","parse","name","remove","keys","constantGen","shouldOpenArticle","state","appContext","visible","shouldFetchArticle","articleID","article","ID","isFetching","closeOverlay","dispatch","isStaticPage","closeModal","historyData","history","stripPathname","closeArticle","off","trigger","fetchArticle","type","ArticleCache","killCache","queryString","getState","openArticle","cache","cac","loadArticle","onLoadArticle","isCrawled","requestArticle","saved_users_top","raw_content","include_viewer","getLocationArgPairs","preview","failureXHR","requestArticleFail","location","href","MPArgs","article_id","currentLocationArgPair","utm","MP","___D","store","pendingID","C","viewer","updateState","k","v","ignoreCralwed","existence","ARTICLES","getCrawled","count","selector","value","t","index","getSafeNameProp","dangerouslySetInnerHTML","__html","children","getThingName","gettext","isEmpty","sales_available","salesAvailable","handleProfileMouseOver","event","$profile","currentTarget","css","width","FancydUser","user","display","isViewer","html_url","className","classnames","_viewer","onMouseOver","backgroundImage","user_square_image_small","image_url","full_name","fullname","isUserEqual","a","b","bgXPosSequence","getFancyStatus","nextFancydState","FancyStatus","getCompletionIdleStatus","currentFancyState","getNextFancydCount","nextFancyd","currentFancydCount","bigContainerStyle","FancydUsers","props","fancyd_count","getConciseNumberString","frame","undefined","animateFancyBG","xPos","fancyBGAnimation","setTimeout","setState","fancyAnimation","totalLength","bigContainer","fancyd","fancyStatus","first","last","Display","indexLimit","thingID","currentState","stateSetter","loading","nextFancydCount","ajax","url","json","toggleFancy","ns","_handleFancydStateOnLoadThing","preventDefault","stopPropagation","loggedIn","thing_id","require_login","_getInitialState","fancyBGAnimationRef","element","this","handleFancydStateOnLoadThing","fancydUserAnimClass","fancyd_users","fancydUsers","concat","fancydUser","userCountSufficiency","onClick","handleFancyClick","ref","getFancydCountString","key","getFancyduserDisplay","Component","itemTraits","section","via","similar","recently","ThingCard","fancydCount","quantity","optionID","showCart","popupOpened","addToCart","saleAvailable","isSaleAvailable","saleOptionExists","isSaleOptionExists","getSales","option","has_options","getSaleOption","available_for_sale","isNumber","diff","max","isSaleOptionAvailable","range","min","parseInt","target","post","status_code","onDelete","isPlainLeftClick","isWhitelabel","OaContainer","transition","LinkTypes","appState","params","sale_item_id","sale_id","getWaiting","dataType","message","waiting","itemType","handleLinkClick","throttle","unmounted","isNaN","param","seller_id","seller","option_id","traits","log","salesID","saleOptionID","logAddCartMixpanel","discounting","discount_percentage","meta","deal_price","brand_name","addItemToCart","thumb_image_url_310","thumb_image_url_558","itemIdx","showDelete","saleOptionAvailable","showFrom","max_price","min_price","__Config","new_card","active","toggled","rel","data-prevent-overlay","displayCount","showFancydUser","MoreShareFacade","objectType","objectId","viewerUsername","username","onShowSomething","handleShowSomething","opened","handleCartAddition","disabled","handleTrickClick","onChange","handleOptionChange","numberFormat","handleOptionQuantityChange","getQuantityRange","subscribed","handleNotifySoldout","handleRecentlyDelete","handleQuickCartToggle","MoreShare","ArticleCard","cover_image","ThingList","showShare","LogExposed","forEach","addLog","response","convertThingsV1ToRest","article_items","logExposed","updateThingList","lastarticleID","nextProps","idCopy","hasPagination","thingsHeader","item_header","MaybePaginationWindow","idx","handleDelete","page","maxPage","floor","transform","stream","handlePrevClick","handleNextClick","ArticleList","articles","hasClass","left","lastPageNum","CardContainerPadding","updateArticleList","prevDisabled","nextDisabled","ceil","getLeftOffset","AdminHeader","self","$this","original_labels","labels","set","ok","cancel","confirm","yes","is_active","error","slug","open","handleEditArticleClick","handleLiveClick","initGallery","container","c","d","j","f","isArray","g","hasOwnProperty","h","Error","stack","replace","Object","create","constructor","_super","la","oa","l","m","q","addEventListener","n","removeEventListener","o","parentNode","p","indexOf","trim","split","r","s","push","sort","u","toUpperCase","ma","w","ownerDocument","defaultView","parentWindow","x","manager","inputTarget","domHandler","enable","handler","init","z","pointers","changedPointers","Ea","Ga","Ha","isFirst","isFinal","session","eventType","firstInput","D","firstMultiple","center","E","timeStamp","ra","deltaTime","angle","I","distance","H","offsetDelta","prevDelta","prevInput","deltaX","y","deltaY","B","offsetDirection","G","F","overallVelocityX","overallVelocityY","overallVelocity","qa","scale","Ra","K","rotation","J","maxPointers","srcEvent","A","emit","recognize","lastInterval","Da","velocity","velocityX","velocityY","direction","clientX","pa","clientY","Ia","Ja","Ka","La","Ma","Qa","sqrt","atan2","PI","L","evEl","Ta","evWin","Ua","pressed","M","Xa","Ya","pointerEvents","N","evTarget","$a","_a","started","O","touches","changedTouches","P","bb","targetIds","Q","Fa","identifier","R","touch","mouse","primaryTouch","lastTouches","S","T","splice","cb","U","abs","db","V","Y","defaults","ua","nb","simultaneous","requireFail","Z","sb","qb","pb","ob","aa","ba","pX","pY","ca","da","_timer","_input","ea","fa","ga","pTime","pCenter","ha","recognizers","preset","ia","handlers","oldCssProps","input","inputClass","xa","ya","wa","touchAction","ja","add","recognizeWith","requireFailure","cssProps","ka","createEvent","initEvent","gesture","dispatchEvent","na","createElement","round","Date","now","assign","TypeError","sa","ta","test","navigator","userAgent","za","Ba","Na","Oa","Pa","destroy","Sa","mousedown","mousemove","mouseup","button","which","pointerType","Va","pointerdown","pointermove","pointerup","pointercancel","pointerout","Wa","2","3","4","5","MSPointerEvent","PointerEvent","toLowerCase","pointerId","Za","touchstart","touchmove","touchend","touchcancel","ab","sourceCapabilities","firesTouchEvents","eb","fb","gb","hb","ib","jb","kb","lb","mb","CSS","supports","X","compute","actions","update","getTouchAction","W","join","preventDefaults","prevented","preventSrc","rb","tb","dropRecognizeWith","dropRequireFailure","hasRequireFailures","canRecognizeWith","additionalEvent","tryEmit","canEmit","process","reset","attrTest","threshold","directionTest","time","clearTimeout","taps","interval","posThreshold","failTimeout","tapCount","VERSION","domEvents","userSelect","touchSelect","touchCallout","contentZooming","userDrag","tapHighlightColor","stop","stopped","curRecognizer","on","INPUT_START","INPUT_MOVE","INPUT_END","INPUT_CANCEL","STATE_POSSIBLE","STATE_BEGAN","STATE_CHANGED","STATE_ENDED","STATE_RECOGNIZED","STATE_CANCELLED","STATE_FAILED","DIRECTION_NONE","DIRECTION_LEFT","DIRECTION_RIGHT","DIRECTION_UP","DIRECTION_DOWN","DIRECTION_HORIZONTAL","DIRECTION_VERTICAL","DIRECTION_ALL","Manager","Input","TouchAction","TouchInput","MouseInput","PointerEventInput","TouchMouseInput","SingleTouchInput","Recognizer","AttrRecognizer","Tap","Pan","Swipe","Pinch","Rotate","Press","merge","extend","inherit","bindFn","prefixed","Hammer","define","module","exports","addClass","totalW","click","Addition","Removal","AfterAddition","AfterRemoval","Idle","Selectors","HomepageWrapper","handleOverlayArticleKeyEvents","tagName","KEYS","conditionalTransition","aElement","isHomepage","has","getAttribute","oneshotEventAttached","attachEntryEvents","__INIT_ARTICLE_ANCHOR","getObjectTypeFromUrl","getPathname","$targ","didClickOn","isStatic","is","getDynamic","getStatic","scrollToTop","parentElement","scrollTop","initialArticlePageID","extractMetaFromArticleURL","pathname","initialPageIsArticlePage","initialPath","preservedHref","initialTitle","locationIsArticlePage","overlayIsOn","historyHook","search","articleURLType","requestIdleCallback","runOverlay","Dynamic","Static","Timeline","Internal","Number","destination","removeClass","handleCloseArticle","thingsDomCache","toggleFancyButton","$btn","replaceFancyCount","fc","text","onArticleFancyButtonUpdate","domCache","$query","containers","dedupeArray","closest","toArray","findArticleFancyButton","profile_image_url","save_count","action","saved","_handleFancydStateOnLoadArticle","handleFancydStateOnLoadArticle","prevProps","np","saved_users","Lightbox","lazy","OverlayArticle","applyProductSlide","Zepto","fn","fitVids","customSelector","ignore","getElementById","head","getElementsByTagName","innerHTML","appendChild","childNodes","not","parents","parent","height","_count","removeAttr","pt","ct","isStaticArticlePage","focus","is_admin_senior","Article","connect","lightboxImages","lightboxOpen","$gallery","$paging","len","galleryNth","indexSelector","incdec","end","position","$slide","productSlide","itemPerSlide","handleGalleryClick","prepareLightboxOpen","prepareProductSlide","lightboxCurrentImage","hide","ReactDOM","video","lastFullyRenderedArticleID","coverImgUrl","Video","videoProps","object","autoplay","cover_video","lastFullyRenderedObjectID","poster","coverImage","author","authors","date_created","dateFormat","showShortcuts","fromThingSidebar","action_button","isString","link","handleContentClick","Suspense","fallback","isOpen","preventScroll","showThumbnails","currentImage","onClickPrev","handleClickPrev","onClickNext","handleClickNext","onClose","handleClose","onClickThumbnail","handleClickThumbnail","Route","path","component","loaded","timer","setInterval","readyState","clearInterval","require","overlayArticleContainer","selectOrCreate","$overlayArticleContainer","render","Router","Switch","onLoad","getFancyDepsRoot","Shared","getStore","getInitialStoreState","contextName","userCountry","contexts","isLoggedIn","populateArticleContext","articleData","fromServer","URLMeta","extractMetaFromURL","owner","combineReducers","updateShallow","context","current_country_code","initialState","middleware","thunk","contextKey","createStore","rootReducer","applyMiddleware","Fancy","track_event","from_sds_page","dataLayer","TrackingEvents","product_id","products_info","revenue","brand","variant","args","itemcode","itemname","cart_id","fancy_price","FANCY_PRICE","Cart","addItem","openPopup","always"],"mappings":"0EACA,IAAIA,EACM,OADNA,EAEQ,SAFRA,EAGQ,SAHRA,EAIM,OAOV,SAASC,EAAUC,GACf,IAAIC,EAJG,aAAeC,OAAOC,KAAKC,UAAUC,OAAO,GAMnD,OADAL,EAASM,KAAK,KAAML,GACb,WACH,OAAOM,EAAE,IAAMN,IASvB,SAASO,EAAkBC,EAAUC,GALrC,IAA0BC,EAMlBF,EAASG,OAAS,GANAD,EAODF,EAASI,QAAO,SAASC,GAAI,OAAOA,KAAKC,KAAI,SAASC,GACnE,IAAIC,EAAMV,EAAEW,WAaZ,OAZAX,EAAEY,IAAI,uBAAyBH,EAAM,wCAChCI,MAAK,SAASC,GACXJ,EAAIK,QAAQD,MAEfE,MAAK,SAASC,GACQ,MAAfA,EAAIC,OACJC,SAASC,MAAM,cAAgBX,EAAM,cAErCY,QAAQC,KAAK,yCAA0Cb,EAAKQ,GAEhEP,EAAIK,QAAQ,SAEbL,EAAIa,aApBZC,OAAOC,KAAKC,MAAMF,OAAQpB,GAAiBS,MAAK,WACnD,OAAOc,MAAMC,UAAUC,MAAMC,KAAKC,UAAW,OAqB5CC,MAAK,SAASC,GACX,IAAIC,EAAM,CACNC,MAAOF,EAAOzB,KAAI,SAASM,GACvB,IAAIsB,GAAsB,EACtBC,EAAQvB,EAAMuB,MAAMC,IACxB,IACIF,EAAsBtB,EAAMyB,MAAMC,OAAO,GAAGC,cAC5CJ,EAAQvB,EAAMyB,MAAMC,OAAO,GAAGF,IAChC,MAAM/B,IACR,OAAOO,EAAMyB,OAAS,CAAEG,MAAO5B,EAAMyB,MAAMI,eAAgBC,MAAO9B,EAAMyB,MAAMK,MAAOC,aAAc/B,EAAMyB,MAAMM,aAAcR,MAAOA,EAAOD,oBAAqBA,EAAqBU,GAAIhC,EAAMyB,MAAMO,OACtMxC,QAAO,SAASC,GAAI,OAAOA,MAElCJ,EAAS+B,MAGbb,QAAQC,KAAK,2DA0BrB,IAAIyB,EAAwB,GAO5BA,EAAsB,yBAA2B,SAASC,EAASC,GAC/D,IAAIT,EAAUQ,EAAQR,OAClBE,EAAUM,EAAQN,MAClBQ,EAAUF,EAAQE,QAClBC,EAAS,GACTA,GAAU,wBACVA,GAAY,+FACZA,GAAY,0BACZA,GAAc,8CACdA,GAAgB,4PAChBA,GAAc,WACdA,GAAY,QACZA,GAAY,uBACZC,OAAOC,iBACPF,GAAc,mEAEdA,GAAc,2CACdA,GAAgB,qFAChBA,GAAc,WACdA,GAAY,SACZA,GAAU,SAEd,IAAIG,EAAQtD,EAAEuD,EAAEC,SAASL,EAAXI,CAAmB,CAAEf,OAAQA,EAAQE,MAAOA,EAAOQ,QAASA,KACtEE,OAAOC,iBACPC,EAAMG,KAAK,OAAOC,KAAK,2BACvBJ,EAAQtD,EAAE,qCAAqC2D,OAAOL,IAE1DL,EAAWW,YAAYN,EAAMO,KAAK,eAWtCd,EAAsB,qBAAuB,SAASC,EAASC,GAC3D,IAAIT,EAASQ,EAAQR,OACjBsB,EAAOtB,EAAOuB,QAAO,SAASC,EAAM3B,GACpC,OAAO2B,EAAOT,EAAEC,SAtExB,SAAgCS,GAC5B,OAAQA,GACJ,KAAK1E,EACD,MACI,+RAER,KAAKA,EACD,MACI,6FAER,KAAKA,EACD,MACI,kJAER,KAAKA,EACL,QACI,MACI,gGAqDiB2E,CAAuB7B,EAAM8B,MAAxCZ,CAA+C,CAAElB,MAAOA,MACvE,IACCG,EAAO,IAAMA,EAAO,GAAG2B,OAAS5E,IAChCuE,EAAQ,6BAA+BA,EAAO,aAElDb,EAAWW,YAAYE,IAG3Bf,EAAsB,yBAA2B,SAASC,EAASC,GAC/D,IAAId,EAASa,EAAQ9C,SACfkE,EAA8B5E,EAAUyD,GAC9ChD,EAAkBkC,GAAO,SAAUD,GAgB/B,IAAImC,EAAOd,EAAEC,SADbL,8mBACWI,CAAmBrB,GAC9BkC,IAA8BR,YAAYS,OAIlDtB,EAAsB,mCAAqC,SAASC,EAASC,GACzE,IAAId,EAASa,EAAQ9C,SACfkE,EAA8B5E,EAAUyD,GAC9ChD,EAAkBkC,GAAO,SAASD,GA8B9B,IAAImC,EAAOd,EAAEC,SAFbL,g+BAEWI,CAAmBrB,GAC9BkC,IAA8BR,YAAYS,OAuBlDjB,OAAOkB,wBAfP,SAA0BC,GACtB,IAAIC,EAJGxE,EAAE,mCAI2BuE,EAJmB,UAKnDE,EAeR,SAA2BC,GAEvB,IAAID,EAAczE,EAAE2E,SAASC,MAAMnB,KAAK,eAEpCgB,EADAA,EAAYpE,OAAS,EACPoE,EAAYI,GAAG,GAAGC,QAElB9E,EAAE,UAAW,CAAE8C,GAAI,aAAciC,MAAO,kBAAkBC,SAASL,SAASC,MAG1FF,GAEAD,EAAYd,OAAOe,GAGvB,OAAOD,EA7BWQ,CAAkBT,GAWpC,OATAA,EAASf,KAAK,eAAeyB,MAAK,SAASC,EAAGC,GAC1C,IAAIC,EAAMrF,EAAEoF,GACZ,IACI,IAAIE,EAAOC,KAAKC,MAAMH,EAAItF,KAAK,kBAC/BgD,EAAsBuC,EAAKG,MAAMH,EAAMD,GACzC,MAAM9E,GAAKc,QAAQC,KAAKf,OAG9BkE,EAAYiB,SACLlB,EAASV,S,6CCrMpB,QArBA,WACI,IAAI6B,EAAO,GAAG9D,MAAMC,KAAKC,WACzB,OAAO4D,EAAK5B,QAAO,SAACC,EAAMK,GAEtB,OADAL,EAAKK,GAAQA,EACNL,IACR,IAGC4B,CACN,qBAEA,kBACA,0BACA,eAGA,eACA,kB,+HCFF,SAASC,EAAkBC,GACvB,OAAoC,IAA7BA,EAAMC,WAAWC,QAI5B,SAASC,EAAmBH,EAAOI,GAC/B,OAAIJ,EAAMK,QAAQC,KAAOF,IAAaJ,EAAMK,QAAQE,WAOjD,SAASC,IACZ,OAAO,SAAAC,IACCC,uBAGJC,UACAC,kBAA0B,EAC1BC,gBAAaC,mBAAcF,oBAA4B,MACvD/B,SAASjC,MAAQgE,kBAEjBH,GAASM,WACT7G,EAAE2E,UAAUmC,IAAI,0BAChB9G,EAAEoD,QAAQ2D,QAAQ,YAInB,SAASC,EAAad,GAA8E,IAAnEe,EAAmE,uDAA5DC,aAAuBC,EAAqC,wDAAlBC,EAAkB,uDAAJ,GACnG,OAAO,SAACb,EAAUc,GACd,GAAiB,MAAbnB,EAAJ,CAIA,IAAIJ,EAAQuB,IASZ,GARIxB,EAAkBC,IAClBS,GAASe,WAETH,IACAI,WAAarB,EAAWe,UACjBnB,EAAMK,SAGbgB,GAAalB,EAAmBH,EAAOI,GAAY,CACnD,GAAIqB,WAAarB,EAAWe,GAAO,CAC/B,IAAMO,EAAMD,QAAUrB,EAAWe,GAIjC,GAHAV,GAASkB,QAAYvB,EAAWsB,IAChCE,EAAcF,IAERA,EAAIG,UACN,OAGRpB,GAASqB,QAAe1B,IACxB,IAAMlD,EAAU,CAAE6E,gBAAgB,GAAIC,YAAa,OAAQC,eAAgB,SACvEC,yBAAoB,aACpBhF,EAAQiF,SAAU,GAEtBjI,EAAEY,IAAF,gCAA+BsF,GAA/B,OAA2CkB,GAAepE,GACrDnC,MAAK,SAAAsF,GACFoB,QAAUrB,EAAWC,EAASc,GAC9BV,GAASkB,QAAYvB,EAAWC,IAChCuB,EAAcvB,MAEjBnF,MAAK,SAAAkH,GAGF3B,GAAS4B,QAAmBjC,IACF,MAAtBgC,EAAWhH,OACXC,SAASC,MAAM,uDAGfD,SAASC,MAAM,yHAGfsF,8BACA0B,SAASC,KAAO,IAEhB9B,EAASD,cA/CrBjF,QAAQC,KAAK,wCAuDzB,SAASoG,EAAcvB,GACnB,IAAMmC,EAAS,CAAEC,WAAYpC,EAAQrD,IAC/B0F,GAAyBR,yBAAoB,OAC/CQ,IACAF,EAAOG,IAAMD,EAAuB,KAExCE,QAAG,sBAAuBJ,GAG9BlF,OAAOuF,KAAO,WACV,OAAOC,iB,gGC7GJ,SAAShB,EAAeiB,GAC3B,MAAO,CACH5B,KAAM6B,oBACN5H,OAAQ,UACR2H,aAKD,SAASV,IACZ,MAAO,CACHlB,KAAM6B,4BACN5H,OAAQ,UAKT,SAASuG,EAAYrB,EAAId,GAE5B,IAAM5C,EAAQ4C,EAAKG,KAKnB,OAJI/C,IACAiC,SAASjC,MAAT,kBAA4BA,IAGzB,CACHuE,KAAM6B,iBACN5H,OAAQ,OACRkF,KACAd,QAKD,SAASgC,IACZ,MAAO,CACHL,KAAM6B,kBAKP,SAASjC,IACZ,MAAO,CACHI,KAAM6B,kBACN1C,GAAI,KACJyC,UAAW,KACX1C,QAAS,Q,qDC7CjB,IAAML,EAAQ,CAAEiD,OAAQ,IACxB,UASO,SAASC,EAAYC,EAAGC,GAC3BpD,EAAMmD,GAAKC,I,4ICZFhC,EAAb,mEACe,IADf,iBAEY,GAFZ,mBAKa,SAACpE,EAAImE,EAAMkC,GAChB,IAAM3B,EAAM,EAAK5G,IAAIkC,EAAImE,GACrBmC,EAAmB,MAAP5B,GAA8B,WAAf,IAAOA,GAItC,OAHI2B,IACAC,EAAYA,IAA+B,IAAlB5B,EAAIG,WAE1ByB,KAXf,iBAeW,SAACtG,GACJ,OAAO,EAAKoE,EAAamC,UAAUvG,IAAO,QAhBlD,gBAmBU,SAACA,GAAqC,IAAjCmE,EAAiC,uDAA1BC,EAAamC,SACrB7B,EAAM,EAAKP,GAAMnE,IAAO,EAAKwG,WAAWxG,EAAImE,GAClD,OAAOO,KArBf,uBAwBiB,SAAC1E,EAAImE,GACd,IAAMO,EAAM,EAAKP,GAAMnE,GACvB,OAAI0E,GAAOA,EAAIG,UACJH,EAEA,QA7BnB,gBAiCU,SAAC1E,EAAIwC,EAAM2B,GAEb,IAAMO,EAAM,EAAKP,GAAMnE,GAEZ,MAAP0E,IACkB,IAAlBA,EAAIG,WAEJ,EAAKV,GAAMnE,GAAMwC,EACjB,EAAKiE,OAAS,GAEdlI,QAAQC,KAAK,mCA3CzB,mBA+Ca,SAACwB,EAAImE,GACN,EAAKA,GAAMnE,WACJ,EAAKmE,GAAMnE,GAClB,EAAKyG,OAAS,GAEdlI,QAAQC,KAAK,iDApDzB,mBAyDa,SAACwB,GAAsD,IAAlDmE,EAAkD,uDAA3CC,EAAamC,SAAUG,EAAoB,uCAAVC,EAAU,uCAC5D,GAAgB,MAAZD,EAAJ,CAIA,IAAME,EAAI,EAAK9I,IAAIkC,EAAImE,GACnByC,IACAC,WAAMD,EAAGF,EAAUC,QALnBpI,QAAQC,KAAK,+CA3DzB,sD,IAAa4F,E,WAGS,YAsEf,IAAMK,EAAQ,IAAIL,G,8TCzDlB,SAAS0C,EAAT,GAAmD,IAAxBjH,EAAwB,EAAxBA,eAAgB8C,EAAQ,EAARA,KAC9C,OAAI9C,EACO,CAAEkH,wBAAyB,CAAEC,OAAQnH,IAErC,CAAEoH,SAAUtE,GAWpB,SAASuE,EAAalJ,GACzB,MAAmB,aAAfA,EAAMmG,KACCgD,QAAQ,mBATvB,SAAwBnJ,GACpB,QAAKoJ,aAAQpJ,EAAMyB,QACRzB,EAAMqJ,gBAQNC,CAAetJ,GACfA,EAAMyB,MAAMkD,KAEZ3E,EAAM2E,K,4CC/Bd,SAAS4E,EAAuBC,GACnC,IAAMC,EAAWvK,EAAEsK,EAAME,eAAe/G,KAAK,MAC7C8G,EAASE,IAAI,cAAb,WAAiCF,EAASG,QAAU,EAAK,GAAzD,OAGJ,IAAMC,EAAa,SAAC,GAAD,QAAGC,YAAH,MAAU,GAAV,EAAcC,EAAd,EAAcA,QAASC,EAAvB,EAAuBA,SAAvB,OACf,qBAAGzC,KAAMuC,EAAKG,SACXC,UAAWC,IAAW,OAAQ,CAAEC,QAASJ,IACzCK,YAAad,EACbtF,MAAO8F,GACN,uBAAKvI,IAAI,+BACJyC,MAAO,CAAEqG,gBAAiB,OAAF,OAASR,EAAKS,yBAA2BT,EAAKU,UAA9C,QAC7B,0BAAKV,EAAKW,WAAaX,EAAKY,YAIpC,SAASC,EAAYC,EAAGC,GACpB,OAAS,MAALD,GAAkB,MAALC,GAGVD,EAAE5I,KAAO6I,EAAE7I,GAGtB,IAAM8I,EAAiB,CAAC,GAAI,IAAK,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAY3K,SAASC,EAAeC,GACpB,OAAOA,EAAkBC,aAAuBA,YAEpD,SAASC,EAAwBC,GAE7B,OADwBA,EACAF,iBAA2BA,kBAEvD,SAASG,EAAmBC,EAAYC,GACpC,OAAmB,IAAfD,EACOC,EAAqB,EAErBA,EAAqB,EA6CpC,IAAMC,EAAoB,CAAE3B,MAAO,S,EAoLP,0B,EAGR,wBAAMM,UAAU,YArLvBsB,EAAb,YAYI,WAAYC,GAAO,yBACf,4BAAMA,IADS,mCAQI,WAAM,IACjBC,EAAiB,EAAK1G,MAAtB0G,aACR,OAAuB,MAAhBA,GAAuBC,4BAAuBD,EAAc,GAAK,OAVzD,6BAaF,SAACE,GACd,QAAcC,IAAVD,EACA,EAAKE,eAAe,QACjB,GAAIF,EAAQd,EAAevL,OAAQ,CAEtC,IAAIwM,EAAOjB,EAAec,GAC1B1M,EAAE,EAAK8M,kBAAkBrC,IAAI,wBAA7B,UAAyDoC,EAAzD,OACAE,YAAW,WAAQ,EAAKH,eAAeF,EAAQ,KAAM,SAC9CA,GAASd,EAAevL,QAC/B,EAAK2M,SAAS,CAAEC,gBAAgB,OAtBrB,mCA0BI,SAACrC,EAAMjB,EAAOuD,GAAgB,IAa7CrC,EAb6C,EAI7C,EAAK0B,MAFSxD,EAF+B,EAE7ChD,WAAcgD,OACdoE,EAH6C,EAG7CA,aAH6C,EAQ7C,EAAKrH,MAFLsH,EAN6C,EAM7CA,OACAC,EAP6C,EAO7CA,YAGEC,EAAkB,IAAV3D,EACR4D,EAAO5D,IAAUuD,EAAc,EAGjCG,IAAgBtB,mBAA6BsB,IAAgBtB,cAEzDmB,GAAe,GAGXI,KAFJzC,EAAU2C,aAMPH,IAAgBtB,kBAA4BsB,IAAgBtB,cAC/DuB,EACAzC,EAAU2C,UACHD,IACP1C,EAAU2C,cAIlB,IAAMC,EAAaN,EAAe,EAAI,EAmBtC,OAjBKE,IAAgBtB,mBAChBsB,IAAgBtB,cAChBsB,IAAgBtB,aACfqB,GAAUC,IAAgBtB,WAE5BpC,EAAQ8D,IAER5C,EAAU2C,WAGVH,IAAgBtB,WACfqB,GACD3B,EAAYb,EAAM7B,KAElB8B,EAAU2C,WAGP3C,KA5EQ,0BA+EL,YAvIlB,SAAqB6C,EAASC,GAAoC,IAAtBC,EAAsB,uDAAR,SAAArK,GAAC,OAAIA,GACnD6J,EAAkCO,EAAlCP,OAAQZ,EAA0BmB,EAA1BnB,aAAcqB,EAAYF,EAAZE,QACxB1B,GAAciB,EACdU,EAAkB5B,EAAmBC,EAAYK,GAElDqB,IACDD,EAAY,CACRR,OAAQjB,EAAY0B,SAAS,EAAMrB,aAAcsB,EAAiBT,YAAaxB,EAAeM,KAGlGnM,EAAE+N,KAAK,CACH9G,KAAM,MACN+G,IAAK,uBAAF,OAAyBN,GAC5BpI,KAAM,CACF8H,OAAQjB,KAGfnK,MAAK,SAASiM,GACX,GAAIA,EAAKnL,IAAMmL,EAAKb,UAAYA,EAAQ,CAEpC,IAAMU,GAAmC,IAAhBG,EAAKb,QAAoBZ,GAAc,GAAK,GAAKA,GAAc,GAAK,EAE7FjF,WAAamG,OAASf,EAAW,SAAUR,GAC3C5E,WAAamG,OAASf,EAAW,eAAgBmB,GAGjDF,EAAY,CACRC,SAAS,EAAOT,OAAQjB,EAAYK,aAAcsB,EAAiBT,YAAarB,EAAwBG,UAI5GyB,EAAY,CAAEC,SAAS,EAAOT,SAAQZ,eAAca,YAAaxB,EAAeuB,QAGvFpM,MAAK,WAEF4M,EAAY,CAAEC,SAAS,EAAOT,SAAQZ,eAAca,YAAaxB,EAAeuB,SAoGpFc,CAAY,EAAK3B,MAAMzL,MAAMgC,GAAI,EAAKgD,OAAO,SAAAqI,GAAQ,EAAKnB,SAASmB,SAhFpD,2CAmFY,SAACrN,GACf,MAATA,IACAA,EAAQ,EAAKyL,MAAMzL,OArK/B,SAAuC4M,EAAvC,GAAgG,IAA9CN,EAA8C,EAA9CA,OAAQZ,EAAsC,EAAtCA,cAAsC,uDAAR,SAAAjJ,GAAC,OAAIA,IAE7E,CACR6J,SACAZ,eACAqB,SAAS,EACTR,YAAatB,WAiKbqC,CAA8BtN,EAAMgC,GAAI,CAAEsK,OAAQtM,EAAMsM,OAAQZ,aAAc1L,EAAM0L,eAAgB,SAAA2B,GAAQ,EAAKnB,SAASmB,SAvF3G,+BA0FA,SAAC7D,GAGhB,GAFAA,EAAM+D,iBACN/D,EAAMgE,kBACD,EAAK/B,MAAMxG,WAAWwI,SAA3B,CAH0B,IAOlBzN,EAAU,EAAKyL,MAAfzL,MAPkB,EAQkB,EAAKgF,MAAzCmH,EARkB,EAQlBA,eAAgBG,EARE,EAQFA,OARE,EAQMS,UAI3BT,GAAWH,GACZ,EAAKD,SAAS,CAAEC,gBAAgB,IAAQ,SAAA1J,GAAO,EAAKqJ,oBAGnDQ,GAGD1E,QAAG,UAAW,CAAE8F,SAAU1N,EAAMgC,MAFhC4F,QAAG,QAAS,CAAE8F,SAAU1N,EAAMgC,KAKlC,EAAKoL,oBAlBD9K,OAAOqL,eAAiBrL,OAAOqL,mBA5FnC,EAAK3I,MAAQ,EAAK4I,mBAClB,EAAKC,oBAAsB,SAAAC,GACvB,EAAK9B,iBAAmB8B,GAJb,EAZvB,gEAEQ,MAAO,CACH3B,gBAAgB,EAEhBG,OAAQ,KACRS,SAAS,EACTrB,aAAc,KACda,YAAatB,cARzB,iDAgIQ8C,KAAKC,iCAhIb,4CAmIkC,IAAThO,EAAS,EAATA,MAEbA,EAAMgC,KAAO+L,KAAKtC,MAAMzL,MAAMgC,IAAMhC,EAAM6G,YAAckH,KAAKtC,MAAMzL,MAAM6G,WACzEkH,KAAKC,6BAA6BhO,KAtI9C,+BA0Ia,IAuBDiO,EAvBC,SAKDF,KAAKtC,MALJ,IAEDxG,WAAcwI,EAFb,EAEaA,SAAUxF,EAFvB,EAEuBA,OAFvB,IAGDjI,MAASkO,EAHR,EAGQA,aAAcpE,EAHtB,EAGsBA,KACvBuC,EAJC,EAIDA,aAJC,EAUD0B,KAAK/I,MAHLsH,EAPC,EAODA,OACAH,EARC,EAQDA,eACAI,EATC,EASDA,YAGE4B,EAAc,CAChBV,GAAYxF,EACZwF,IAAa9C,EAAY1C,EAAQ6B,IAASA,GAE7CsE,OACGF,GACAA,EAAa1O,QAAO,SAAA6O,GAAU,OAAK1D,EAAY0D,EAAYvE,KACxBa,EAAY0D,EAAYpG,OAE9DzI,QAAO,SAAAC,GAAC,OAAIA,KAGT8M,IAAgBtB,aAChBgD,EAAsB,MACf1B,IAAgBtB,cACvBgD,EAAsB,UAK1B,IAAMK,EAAuBH,EAAY5O,QAAU,EAAI,UAAY,QAEnE,OACI,wBAAM0E,MAAOoI,GAAgBd,EAAmBrB,UAAU,qBACtD,wBAAMA,UAAU,SACZ,qBAAGqE,QAASR,KAAKS,iBACdtE,UAAWC,IAAW,oCAAqC,CAAEmC,SAAQS,QAASZ,KAC7E,wBAAMsC,IAAKV,KAAKF,qBAAhB,GAEQE,KAAKW,wBALrB,GASA,wBAAMxE,UAAWC,IAAW,cAAe8D,EAAqBK,IAC3DH,EAAYzO,KAAI,SAACoK,EAAMjB,GACpB,IAAMmB,EAAWW,EAAYb,EAAM7B,GACnC,OACI,gBAAC4B,EAAD,CAAY8E,IAAK9F,EACLiB,KAAMA,EACNC,QAAS,EAAK6E,qBAAqB9E,EAAMjB,EAAOsF,EAAY5O,QAC5DyK,SAAUA,aA9LlD,GAAiC6E,a,UC1F3BC,EAAa,CACfzJ,QAAS,CACLsC,IAAK,UACLoH,QAAS,QACTC,IAAK,WAETC,QAAS,CACLF,QAAS,cACTpH,IAAK,MACLqH,IAAK,cAETE,SAAU,CACNH,QAAS,kBACTpH,IAAK,KACLqH,IAAK,e,EAmVuB,yC,EAiDI,wBAAM9E,UAAU,kBAAhB,iC,EA+BI,sBAAIA,UAAU,QAAd,S,EAkBhB,wBAAMA,UAAU,S,EA4EJ,wBAAMA,UAAU,kBAAhB,iCA7fnBiF,G,YAajB,WAAY1D,GAAO,yBACf,4BAAMA,IADS,mBARX,CACJ2D,YAAa,EACbC,SAAU,EACVC,SAAU,KACVC,UAAU,EACVC,aAAa,IAGE,iCAaE,SAAChG,GAClBA,EAAM+D,iBACN/D,EAAMgE,kBACN,EAAKiC,eAhBU,oCAkFK,SAACjG,GACrBA,EAAM+D,iBACN/D,EAAMgE,kBACN,IAAMkC,EAAgB,EAAKC,kBACrBC,EAAmB,EAAKC,qBAC1BH,EACIE,EACA,EAAK1D,SAAS,CAAEqD,UAAW,EAAKvK,MAAMuK,WAEtC,EAAKE,YAGT,EAAKvD,SAAS,CAAEqD,UAAW,EAAKvK,MAAMuK,cA9F3B,8BAkGD,WAAM,IACZlG,EAAoB,EAAKoC,MAAzBpC,gBACF5H,EAAQ,EAAKqO,WACnB,QAAIrO,IACO4H,GAAsC,IAAnB5H,EAAM4N,aAtGrB,4BA4GH,WACZ,IAAMO,EAAmB,EAAKC,qBACxBpO,EAAQ,EAAKqO,WACnB,GAAIrO,GAASmO,EAAkB,CAC3B,IAAMN,EAAW,EAAKtK,MAAMsK,UAAY7N,EAAMS,QAAQ,GAAGF,GAEzD,OADeP,EAAMS,QAAQ1C,QAAO,SAACuQ,GAAD,OAAYA,EAAO/N,KAAOsN,KAAU,IAAM,KAG9E,OAAO,QApHI,iCAwHE,WACjB,IAAM7N,EAAQ,EAAKqO,WACnB,QAAIrO,IAC6B,IAAtBA,EAAMuO,eA3HF,oCAiIK,WACpB,IAAMD,EAAS,EAAKE,gBACpB,QAAIF,KACqC,IAA9BA,EAAOG,oBAAmD,IAApBH,EAAOV,aApIzC,uBA0IR,WACP,OAAO,EAAK5D,MAAMhK,SA3IH,6BA8IF,WACb,OAAOgB,EAAE0N,SAAS,EAAKnL,MAAMoK,aAAe,EAAKpK,MAAMoK,YAAc,EAAK3D,MAAMC,gBA/IjE,gCAkJC,SAAC0E,GACjB,EAAKlE,SAAS,CACVkD,YAAa,EAAKpK,MAAMoK,YAAcgB,OApJ3B,+BAwJA,WACf,IACIC,EAMJ,OAPyB,EAAKR,sBAEN,EAAKS,wBACzBD,EAAM,EAAKJ,gBAAgBZ,SACpB,EAAKM,oBACZU,EAAM,EAAKP,WAAWT,UAEZ,MAAPgB,EAAc,CAAC,KAAO5N,EAAE8N,MAAM,EAAGzR,KAAK0R,IAAI,GAAIH,EAAM,OAhK5C,iCAmKE,SAAC7G,GAClBA,EAAM+D,iBACN/D,EAAMgE,kBACN,EAAKtB,SAAS,CAAEoD,SAAUmB,SAASjH,EAAMkH,OAAO/H,MAAO,IAAK0G,SAAU,OAtKvD,yCAyKU,SAAC7F,GAC1BA,EAAM+D,iBACN/D,EAAMgE,kBACN,EAAKtB,SAAS,CAAEmD,SAAUoB,SAASjH,EAAMkH,OAAO/H,MAAO,SA5KxC,+BA+KA,SAACa,GAChBA,EAAM+D,iBACN/D,EAAMgE,kBACN,EAAKtB,SAAS,CAAEqD,UAAU,OAlLX,mCAqLI,WACnBrQ,EAAEyR,KAAK,gCAAiC,CAAEjD,SAAU,EAAKjC,MAAMzJ,KAAM,SAACmL,GAC7DA,GAA6B,IAArBA,EAAKyD,YAGd,EAAKnF,MAAMoF,SAAS,EAAKpF,OAFzBnJ,OAAOjC,SAASC,MAAhB,mCAAkD,EAAKmL,MAAM9G,KAA7D,wBAILzE,MAAK,WACJoC,OAAOjC,SAASC,MAAhB,mCAAkD,EAAKmL,MAAM9G,KAA7D,2BA7LW,8BAiMD,SAAC6E,GACfA,EAAMgE,mBACFsD,sBAAiBtH,KACjBA,EAAM+D,iBAEDjL,OAAOyO,cAAcC,mBAE1BC,QAAW,EAAKhH,WAAYiH,mBAxMjB,kCA4MG,SAAC1B,GACnB,EAAKtD,SAAS,CAAEsD,mBA7MD,kCAgNG,SAAChG,GAGnB,GAFAA,EAAM+D,iBACN/D,EAAMgE,kBACD2D,aAAL,CAIA,IAAM1P,EAAQ,EAAKqO,WACbsB,EAAS,CAAEC,aAAc5P,EAAM6P,SACrB,EAAKC,WAAW9P,KAE5B2P,EAAOxM,OAAS,GAGpB1F,EAAE+N,KAAK,CACH9G,KAAM,OACN+G,IAAK,yBACL1I,KAAM4M,EACNI,SAAU,SAETtQ,MAAK,SAACiM,GACH,GAAKA,GAA4B,MAApBA,EAAKyD,YAGlB,GAAwB,GAApBzD,EAAKyD,aAAoBzD,EAAKsE,QAC9BnP,OAAOjC,SAASC,MAAM6M,EAAKsE,aAD/B,CAIA,IAAMC,GAAUN,EAAOxM,OACvB,EAAKsH,SAAS,CAAEwF,gBAEnBxR,MAAK,SAAUiN,GACRA,GAAQA,EAAKsE,QACbnP,OAAOjC,SAASC,MAAM6M,EAAKsE,SAE3BnP,OAAOjC,SAASC,MAAM,qFA/B9BgC,OAAOqL,eAAiBrL,OAAOqL,mBApNpB,yBAwPN,WACT,IAAMlM,EAAQ,EAAKqO,WACnB,QAAIrO,IAC0B,MAAtB,EAAKuD,MAAM0M,QACJjQ,EAAMiQ,QAEN,EAAK1M,MAAM0M,YA9PX,uBAqQR,WAAM,IACL/J,GAAQmH,EAAW,EAAKrD,MAAMkG,WAAa,IAA3ChK,IACR,gBAAU,EAAK8D,MAAMxB,UAArB,OAAgCtC,EAAM,QAAUA,EAAM,OArQtD,EAAKiK,gBAAkBnP,EAAEoP,SAAS,EAAKD,gBAAiB,KAFzC,E,iEAMf7D,KAAK7B,SAAS,CAAEkD,YAAarB,KAAKtC,MAAMC,cAAgB,M,6CAIxDqC,KAAK+D,WAAY,I,kCAST,WACR,GAAKX,aAAL,CADQ,MAKiBpD,KAAKtC,MAAtBzJ,EALA,EAKAA,GAAI2P,EALJ,EAKIA,SACJtC,EAAatB,KAAK/I,MAAlBqK,SAEF5N,EAAQsM,KAAK+B,WACbJ,EAAgB3B,KAAK4B,kBACrBC,EAAmB7B,KAAK8B,qBACxBE,EAAShC,KAAKkC,gBAEpB,GAAKP,IAAiB3B,KAAK/I,MAAM+H,QAGjC,GAAIgF,MAAM1C,IAAaA,GAAY,EAC/B/O,MAAM6I,QAAQ,wCADlB,CAKA,IAAM6I,EAAQ,CACVC,UAAWxQ,EAAMyQ,OAAOlQ,GACxB0L,SAAU1L,EACVqP,aAAc5P,EAAM6P,QACpBjC,YAEAO,GAAoBG,IACpBiC,EAAMG,UAAYpC,EAAO/N,IAG7B,IAAMoQ,EAAStD,EAAW6C,GACpB/P,EAAQsH,EAAa6E,KAAKtC,OAChCsC,KAAK7B,SAAS,CAAEa,SAAS,IAAQ,WAC7B,IAAMsF,EAAM,CACRC,QAAS7Q,EAAM6P,QACf3J,IAAKyK,EAAOzK,IACZoH,QAASqD,EAAOrD,QAChBC,IAAKoD,EAAOpD,KAEZe,IACAsC,EAAIE,aAAexC,EAAO/N,KAE9BwQ,OAAmBH,GAEnB,IAAMI,EAAchR,GAAuC,MAA9BA,EAAMiR,oBAC7BC,EAAO,CACT/Q,QACAE,MAAO2Q,EAAchR,EAAMM,aAAeN,EAAMmR,WAChDC,WAAYpR,EAAMyQ,OAAOW,aAE7BC,OACId,GACA,WACS,EAAKF,WACN,EAAK5F,SAAS,CAAEa,SAAS,MAGjC4F,YAxDJrQ,OAAOqL,eAAiBrL,OAAOqL,kB,+BAqP9B,MAC2FI,KAAKtC,MAA7FzJ,EADH,EACGA,GAAI+Q,EADP,EACOA,oBAAqBC,EAD5B,EAC4BA,oBAAqBC,EADjD,EACiDA,QAASxF,EAD1D,EAC0DA,SAAUxF,EADpE,EACoEA,OAAQiL,EAD5E,EAC4EA,WAD5E,EAEsCnF,KAAK/I,MAAxCuK,EAFH,EAEGA,SAAUxC,EAFb,EAEaA,QAASyC,EAFtB,EAEsBA,YACrBvF,EAAW8D,KAAK9D,WAEhBxI,EAAQsM,KAAK+B,WACb2C,EAAchR,GAAuC,MAA9BA,EAAMiR,oBAC7BhB,EAAU3D,KAAKwD,aAEf7B,EAAgB3B,KAAK4B,kBACrBC,EAAmB7B,KAAK8B,qBACxBsD,EAAsBpF,KAAKuC,wBAE3B8C,EACF3R,GAA6B,OAApBA,EAAM4R,WAA0C,OAApB5R,EAAM6R,WAAsB7R,EAAM4R,UAAY5R,EAAM6R,UAE7F,OAAOC,SAASC,SACZ,sBAAItJ,UAAWC,IAAW,CAAE,aAAc4C,EAAS0G,OAAQjE,GAAeD,KACtE,uBAAKrF,UAAWC,IAAW,kBAAmB,CAAEuJ,QAASnE,KACrD,8BACI,qBACIhI,KAAM0C,EACN0J,IAAG,gBAAW3R,GACduM,QAASR,KAAK6D,gBACdgC,uBAAqB,QACrB,wBAAM1J,UAAU,UACZ,uBACI1I,IAAI,+BACJyC,MAAO,CAAEqG,gBAAiB,OAAF,OAAS0I,GAAuBD,EAAhC,UAIpC,uBAAK7I,UAAU,WACX,gBAACsB,EAAD,CACIxL,MAAO+N,KAAKtC,MACZxG,WAAY8I,KAAKtC,MAAMxG,WACvB4O,aAAc,EACdC,gBAAgB,IAEpB,gBAAC,EAAAC,gBAAD,CACIC,WAAW,QACXC,SAAUjS,EACVyL,SAAUA,EACV7L,MAAOsH,EAAa6E,KAAKtC,OACzByI,eAAgBjM,EAAOkM,SACvBC,gBAAiBrG,KAAKsG,uBAG9B,uBACInK,UAAWC,IAAW,YAAa,CAAEmK,OAAQ/E,IAC7CtL,MAAQxC,OAA8BoK,EAAtB,CAAE9B,QAAS,SAC1BtI,GACG,0BACIyI,UAAU,mBACVqE,QAASR,KAAKwG,mBACdC,UAAWrB,GAHf,GAOJ,sBAAIjJ,UAAU,mBACV,yBACIA,UAAU,QACVjG,MAAO,CAAE8F,QAASwF,EAAW,aAAU1D,GACvC0C,QAASR,KAAK0G,mBAEjB/E,EACG,wBAAMxF,UAAU,OACX0F,GACG,0BACIjL,KAAK,YACL3C,GAAE,UAAKA,EAAL,cACF0S,SAAU3G,KAAK4G,oBACdlT,EAAMS,QAAQxC,KAAI,SAACqQ,EAAQ1L,GAAT,OACf,0BACIsK,IAAG,qBAAgBsE,EAAhB,uBAAsC5O,GACzCsE,MAAOoH,EAAO/N,IACb+N,EAAOA,OAHZ,KAGsB,IAChBA,EAAOG,oBAA0C,IAApBH,EAAOV,SAArC,YAESuF,kBAAa7E,EAAO6C,WAAY,IADpCzJ,QAAQ,iBAM9B,0BACIe,UAAU,SACVlI,GAAE,UAAKA,EAAL,aACF2C,KAAK,WACL6P,UAAWrB,EACXuB,SAAU3G,KAAK8G,4BACd9G,KAAK+G,mBAAmBpV,KAAI,SAACD,EAAG4E,GAAJ,OACzB,0BAAQsK,IAAG,qBAAgBsE,EAAhB,2BAA0C5O,GAAKsE,MAAOlJ,GAC5DA,OAIb,0BACIyK,UAAU,8BACVqE,QAASR,KAAKwG,mBACdC,UAAWrB,GACVhK,QAAQ,iBAIjB,wBAAMe,UAAU,OAAhB,EAEI,0BACIA,UAAWC,IAAW,6BAA8B,CAChD4K,WAAYrD,IAEhBnD,QAASR,KAAKiH,qBACbtD,EAAU,aAAe,gCAOlD,kCACI,qBACInK,KAAM0C,EACNC,UAAU,QACVyJ,IAAG,gBAAW3R,GACduM,QAASR,KAAK6D,gBACdgC,uBAAqB,QACrB,yBAAG1J,UAAU,SAAYpB,EAAgBiF,KAAKtC,SAC7ChK,GACG,wBACIyI,UAAS,gBAAWuI,EAAc,QAAU,GAAnC,YAAyC/C,EAAgB,GAAK,YACtE+C,GACG,yBAAO9D,IAAI,yBAAX,KACMiG,kBAAanT,EAAMM,aAAc,IAG1CqR,EACG,gBAAC,WAAD,aACsCwB,kBAAanT,EAAM6R,UAAW,IAF/D,sDAMHsB,kBAAanT,EAAMmR,WAAY,OAMrD,qBAAG1I,UAAU,SAASqE,QAASR,KAAKkH,yBAI5C,sBAAI/K,UAAWC,IAAW,CAAE,aAAc4C,EAAS0G,OAAQjE,GAAeD,KACtE,uBAAKrF,UAAWC,IAAW,cAAe,CAAEuJ,QAASnE,KACjD,8BACI,qBAAGhI,KAAM0C,EAAU0J,IAAG,gBAAW3R,GAAMuM,QAASR,KAAK6D,iBAArD,EAEI,uBACI1H,UAAU,SACVjG,MAAO,CAAEqG,gBAAiB,OAAF,OAASyI,EAAT,MACxBvR,IAAI,mCAIhB,kCACI,wBACI0I,UAAWC,IAAW,YAAa,CAAEmK,OAAQ/E,IAC7CtL,MAAO,CAAE8F,QAAStI,EAAQ,KAAO,SAChCA,GACG,0BACIyI,UAAS,2BAAsBuI,EAAc,QAAU,GAA9C,YACL/C,EAAgB,GAAK,WAEzBnB,QAASR,KAAKmH,uBACd,0BACKzC,EACK,CACI,yBAAO9D,IAAI,yBAAX,KACMiG,kBAAanT,EAAMM,aAAc,IAF3C,YAIQ6S,kBAAanT,EAAMmR,WAAY,KALjC,YAOFgC,kBAAanT,EAAMmR,WAAY,MAIrD,sBAAI1I,UAAU,mBACV,yBACIA,UAAU,QACVjG,MAAO,CAAE8F,QAASwF,EAAW,QAAU,MACvChB,QAASR,KAAK0G,mBAEjB/E,EACG,wBAAMxF,UAAU,OACX0F,GACG,0BACIjL,KAAK,YACL3C,GAAE,UAAKA,EAAL,cACF0S,SAAU3G,KAAK4G,oBACdlT,EAAMS,QAAQxC,KAAI,SAACqQ,EAAQ1L,GAAT,OACf,0BACIsK,IAAG,qBAAgBsE,EAAhB,uBAAsC5O,GACzCsE,MAAOoH,EAAO/N,IACb+N,EAAOA,OAHZ,KAGsB,IAChBA,EAAOG,oBAA0C,IAApBH,EAAOV,SAArC,YAESuF,kBAAa7E,EAAO6C,WAAY,IADpCzJ,QAAQ,iBAM9B,0BACIe,UAAU,SACVlI,GAAE,UAAKA,EAAL,aACF2C,KAAK,WACL6P,UAAWrB,EACXuB,SAAU3G,KAAK8G,4BACd9G,KAAK+G,mBAAmBpV,KAAI,SAACD,EAAG4E,GAAJ,OACzB,0BAAQsK,IAAG,qBAAgBsE,EAAhB,2BAA0C5O,GAAKsE,MAAOlJ,GAC5DA,OAIb,0BACIyK,UAAU,8BACVqE,QAASR,KAAKwG,mBACdC,UAAWrB,GACVhK,QAAQ,iBAIjB,wBAAMe,UAAU,OAAhB,EAEI,0BACIA,UAAWC,IAAW,6BAA8B,CAChD4K,WAAYrD,IAEhBnD,QAASR,KAAKiH,qBACbtD,EAAU,aAAe,+BAM9C,yBACInK,KAAM0C,EACNC,UAAU,QACVyJ,IAAG,gBAAW3R,GACduM,QAASR,KAAK6D,iBACV9I,EAAgBiF,KAAKtC,SAE7B,wBAAMvB,UAAWC,IAAW,YACxB,gBAACqB,EAAD,CAAaxL,MAAO+N,KAAKtC,MAAOxG,WAAY8I,KAAKtC,MAAMxG,aACvD,gBAAC,EAAAkQ,UAAD,CACInB,WAAW,QACXC,SAAUjS,EACVyL,SAAUA,EACV7L,MAAOsH,EAAa6E,KAAKtC,OACzByI,eAAgBjM,EAAOkM,SACvBC,gBAAiBrG,KAAKsG,wBAIjCnB,GAAc,qBAAGhJ,UAAU,SAASqE,QAASR,KAAKkH,6B,GA5hBhCpG,a,IAAlBM,G,eACK,CAClB+D,YAAY,I,OCOA,uBAAK1R,IAAI,iCAjCR4T,G,YACjB,WAAY3J,GAAO,yBACf,4BAAMA,IADS,8BAOD,SAACjC,GAEf,GADAA,EAAMgE,mBACFsD,sBAAiBtH,GAAQ,CACzBA,EAAM+D,iBADmB,IAGjBtD,EAAa,EAAKwB,MAAlBxB,UACRgH,QAAWhH,EAAUiH,mBAXzB,EAAKlM,MAAQ,GAEb,EAAK4M,gBAAkBnP,EAAEoP,SAAS,EAAKD,gBAAiB,KAJzC,E,oEAkBf7D,KAAK+D,WAAY,I,+BAGZ,MAC4C/D,KAAKtC,MAA1C4J,GADP,EACGrT,GADH,EACOqT,aAAazT,EADpB,EACoBA,MAAOsL,EAD3B,EAC2BA,IAAK9K,EADhC,EACgCA,QAErC,OACI,uBAAK8H,UAAU,uBACb,qBAAG3C,KAAM2F,GACP,wBAAMhD,UAAU,SACZmL,GACF,uBAAK7T,IAAI,+BAA+ByC,MAAO,CAACqG,gBAAiB,OAAF,OAAS+K,EAAYnI,IAArB,SAE5DmI,GAAD,IAIJ,wBAAMnL,UAAU,SAAStI,GACzB,wBAAMsI,UAAU,eAAe9H,S,GArCNyM,a,WCElC,IAAMyG,GAAb,6MACoB,MADpB,mBAEY,CACJC,WAAW,EACXpU,OAAQ,KAJhB,yBAgCiB,SAACA,QACsB,IAArBmB,OAAOkT,YAClBrU,EAAOsU,SAAQ,SAAAzV,GACXsC,OAAOkT,WAAWE,OAAO1V,EAAMgC,GAAK,GAAI,iBAnCpD,8BAuCsB,SAACoD,GACE,MAAbA,GAGJlG,EAAE+N,KAAK,CACH9G,KAAM,MACN+G,IAAK,yBAAF,OAA2B9H,EAA3B,YAEFlE,MAAK,SAAAyU,GACF,IAAK,EAAK7D,UAAW,CACjB,IAAM3Q,GAASyU,2BAAsBD,EAASE,eAAenW,KAAI,SAAAkJ,GAC7D,GAAItG,OAAOyO,cAAgBnI,EAAEnH,MAAO,CAChC,IAAMyL,EAAM,GAAH,OAAMtE,EAAEqB,UACjBrB,EAAEsE,IAAMA,EACRtE,EAAEqB,SAAWiD,EAEjB,OAAOtE,KAEX,EAAKkN,WAAW3U,GAChB,EAAK+K,SAAS,CAAE/K,OAAQA,QAG/BjB,MAAK,SAASC,GACXI,QAAQC,KAAK,qBAAsBL,SA9DnD,mEASQ4N,KAAKgI,gBAAgBhI,KAAKtC,MAAMpG,QAAQrD,IAAI,GAC5C,IAAMb,GAASyU,2BAAsB7H,KAAKtC,MAAMpG,QAAQlE,QACxD4M,KAAK7B,SAAS,CAAE/K,OAAQA,IAExB4M,KAAKiI,cAAgBjI,KAAKtC,MAAMpG,QAAQrD,KAbhD,2CAiBQ,IAAMiU,EAAYlI,KAAKtC,MAEvB,GAAIsC,KAAKiI,gBAAkBC,EAAU5Q,QAAQrD,GAAI,CAC7C,IAAMkU,EAASD,EAAU5Q,QAAQrD,GACjC+L,KAAKiI,cAAgBE,EACrBnI,KAAKgI,gBAAgBE,EAAU5Q,QAAQrD,IAAI,GAC3C,IAAMb,GAASyU,2BAAsBK,EAAU5Q,QAAQlE,QACvD4M,KAAK7B,SAAS,CAAE/K,OAAQA,OAxBpC,6CA6BQ4M,KAAK+D,WAAY,IA7BzB,+BAkEa,aACoE/D,KAAKtC,MAAtEpG,EADH,EACGA,QAASJ,EADZ,EACYA,WAA0BwI,EADtC,EACwBxI,WAAcwI,SAAY0I,EADlD,EACkDA,cAC/ChV,EAAW4M,KAAK/I,MAAhB7D,OAEFiV,EAAgB/Q,EAAQnD,SAAWmD,EAAQnD,QAAQmU,aAAgB,KAEzE,OACI,uBAAKrU,GAAG,UAAUkI,UAAS,kBAA+B,IAAlB/I,EAAO5B,OAAe,SAAW,KACpE6W,GAAgB,0BAAKA,GACrBjV,EAAO5B,OAAS,EACb,gBAAC+W,GAAD,CAAuBH,cAAeA,EAAe5W,OAAQ4B,EAAO5B,QAC/D4B,GACGA,EAAOzB,KAAI,SAACM,EAAOuW,GAAR,OACP,gBAACpH,GAAD,KACI8D,QAASsD,EACT5E,SAAU,UACVlE,SAAUA,EACVkB,IAAG,4BAAuB4H,GAC1B1F,SAAU,EAAK2F,aACfvO,OAAQ,EAAKwD,MAAMxG,WAAWgD,OAC9BhD,WAAYA,EACZiO,YAAY,GACRlT,QAIpB,UA5FpB,GAA+B6O,aAkGlByH,GAAb,qMACY,CACJG,KAAM,IAFd,8BAKsB,SAAChX,GACfA,EAAE8N,iBAEF,EAAKrB,SAAS,CAAEuK,KAAM3X,KAAKuR,IAAI,EAAKrL,MAAMyR,KAAO,EADjC,QAPxB,8BAWsB,SAAChX,GACfA,EAAE8N,iBACF,IAAMmJ,EAAU5X,KAAK6X,MAAM,EAAKlL,MAAMlM,OAAS,GAAK,EACpD,EAAK2M,SAAS,CAAEuK,KAAM3X,KAAK0R,IAAI,EAAKxL,MAAMyR,KAAO,EAAGC,QAd5D,wDAiBa,MAC+B3I,KAAKtC,MAAjC0K,EADH,EACGA,cAAelN,EADlB,EACkBA,SACjBhF,EAAQ,GACVkS,IACAlS,EAAM2S,UAAN,sBAAkC,IAAM7I,KAAK/I,MAAMyR,KAAnD,OAEJ,IAAMI,EACF,sBAAI3M,UAAU,eAAejG,MAAOA,GAAQgF,GAGhD,OAAIkN,EAEI,uBAAKjM,UAAU,aACX,uBAAKA,UAAU,iBACV2M,GAEL,qBAAGtP,KAAK,IAAI2C,UAAU,OAAOqE,QAASR,KAAK+I,iBAA3C,QACA,qBAAGvP,KAAK,IAAI2C,UAAU,OAAOqE,QAASR,KAAKgJ,iBAA3C,SAIDF,MAtCnB,GAA2ChI,a,GAmIvB,sBAAI3E,UAAU,QAAd,iB,GASI,4BAhGX8M,GAAb,6MACoB,MADpB,mBAEY,CACJC,SAAU,GACVR,KAAM,IAJd,gCA2BwB,SAACrR,GACA,MAAbA,GAGJlG,EAAE+N,KAAK,CACH9G,KAAM,MACN+G,IAAK5K,OAAOyO,aAAe,6CAA+C,mCAEzE7P,MAAK,SAAAyU,GACF,IAAK,EAAK7D,UAAW,CACjB,IAAImF,EAAWtB,EAASsB,SAASzX,QAAO,SAAA6F,GAAO,OAAIA,EAAQrD,KAAOoD,KAClE,EAAK8G,SAAS,CAAE+K,SAAUA,QAGjC/W,MAAK,SAASC,GACXI,QAAQC,KAAK,uBAAwBL,SA1CrD,8BA8CsB,SAACqJ,GACfA,EAAM+D,iBACMrO,EAAEsK,EAAMkH,QACVwG,SAAS,aACnB,EAAKhL,SAAS,CAAEuK,KAAM,EAAKzR,MAAMyR,KAAO,OAlDhD,8BAqDsB,SAACjN,GACfA,EAAM+D,iBACMrO,EAAEsK,EAAMkH,QACVwG,SAAS,aACnB,EAAKhL,SAAS,CAAEuK,KAAM,EAAKzR,MAAMyR,KAAO,OAzDhD,4BA4DoB,WAAM,MACS,EAAKzR,MAAxBiS,EADU,EACVA,SAAUR,EADA,EACAA,KACZU,GAAqB,KAAbV,EAAO,IAAaA,EAAO,EAAI,EAAI,GAC3CW,GAAgBH,EAAS1X,OAAS,EAAK,IAAO0X,EAAS1X,OAAS,EAAK,EAAI,EAAI,GACnF,GAAI0X,EAAS1X,OAAS,GAAKkX,GAAQW,EAAa,CAC5C,IAIM/G,EAHa,IAGL4G,EAAS1X,OAAS,GAJd,IAIgC0X,EAAS1X,OAFhC,IAE4E8X,GAEvG,gBAAUvY,KAAKuR,IAAI8G,GAAO9G,GAA1B,MAEA,OAAO8G,KAzEnB,mEASQpJ,KAAKuJ,kBAAkBvJ,KAAKtC,MAAMpG,QAAQrD,IAC1C+L,KAAKiI,cAAgBjI,KAAKtC,MAAMpG,QAAQrD,KAVhD,2CAcQ,IAAMiU,EAAYlI,KAAKtC,MAEvB,GAAIsC,KAAKiI,gBAAkBC,EAAU5Q,QAAQrD,GAAI,CAC7C,IAAMkU,EAASD,EAAU5Q,QAAQrD,GACjC+L,KAAKiI,cAAgBE,EACrBnI,KAAKuJ,kBAAkBrB,EAAU5Q,QAAQrD,IAAI,MAnBzD,6CAwBQ+L,KAAK+D,WAAY,IAxBzB,+BA6Ea,IACG7M,EAAe8I,KAAKtC,MAApBxG,WADH,EAEsB8I,KAAK/I,MAAxBiS,EAFH,EAEGA,SAAUR,EAFb,EAEaA,KAEdc,EAAuB,GAARd,EACfe,EAAef,GAFL3X,KAAK2Y,KAAKR,EAAS1X,OAAS,GAI1C,OACI,uBAAKyC,GAAG,WACJ,uBAAKkI,UAAU,6BAAf,GAEK+M,EAAS1X,OACN,uBAAK2K,UAAU,eAAejG,MAAO,CAAEkT,KAAMpJ,KAAK2J,kBAC7CT,GACGA,EAASvX,KAAI,SAAC2F,EAASkR,GAAV,OACT,gBAACnB,GAAD,KAAazG,IAAKtJ,EAAQrD,GAAIiR,QAASsD,EAAKtR,WAAYA,GAAgBI,QAJvF,GAUA4R,EAAS1X,OAAS,GACf,uBAAK2K,UAAU,UACX,qBACI3C,KAAK,IACL2C,UAAS,UAAKqN,EAAe,WAAa,GAAjC,SACThJ,QAASR,KAAK+I,iBAHlB,QAMA,qBACIvP,KAAK,IACL2C,UAAS,UAAKsN,EAAe,WAAa,GAAjC,SACTjJ,QAASR,KAAKgJ,iBAHlB,eA1G5B,GAAiClI,a,GA+Kb,yC,GAIA,qCA3DP8I,GAAb,YACI,WAAYlM,GAAO,yBACf,4BAAMA,IADS,8BAOD,SAAAjC,GACdA,EAAM+D,iBACN,IAAMqK,EAAO,OACPC,EAAQ3Y,EAAEsK,EAAMkH,QACdrL,EAAY,EAAKoG,MAAjBpG,QAEJoM,EAAU,gCAAH,OAAmCpM,EAAQzD,MAA3C,oBACPU,OAAOyO,aAAe,OAAS,QADxB,KAGP8G,EAAMX,SAAS,QACfzF,EAAU,iCAAH,OAAoCpM,EAAQzD,MAA5C,iBAA0DU,OAAOyO,aAAe,OAAS,QAAzF,MACX,IAAM+G,EAAkBxV,OAAOjC,SAAS0X,OACxCzV,OAAOjC,SAAS2X,IAAI,CAAED,OAAQ,CAAEE,GAAIJ,EAAMX,SAAS,MAAQ,OAAS,WAAYgB,OAAQ,YACxF5V,OAAOjC,SAAS8X,QAAQ1G,GAAS,SAAS2G,GACtC,GAAIA,EAAK,CACL,IAAIC,GAAaR,EAAMX,SAAS,MAChChY,EAAEyR,KACE,sCACA,CAAElJ,WAAYpC,EAAQrD,GAAIqW,UAAWA,IACrC,SAASlL,GACDA,EAAKmL,MACLhW,OAAOjC,SAASC,MAAM6M,EAAKmL,QAE3BhW,OAAOjC,SAASC,MAAM+X,EAAY,YAAc,eAChDT,EAAK1L,SAAS,CAAEmM,UAAWA,IAC3B5R,WAAamR,EAAKnM,MAAMpG,QAAQkT,UAAM1M,EAAW,YAAawM,WAMlF/V,OAAOjC,SAAS2X,IAAI,CAAED,OAAQD,OAtCf,qCAyCM,SAACrY,GACtBA,EAAE8N,iBAD0B,IAEpBlI,EAAY,EAAKoG,MAAjBpG,QACR/C,OAAOkW,KAAP,mCAAwCnT,EAAQrD,QA1ChD,EAAKgD,MAAQ,CACTqT,UAAW5M,EAAMpG,QAAQgT,WAHd,EADvB,sDAiDa,IACGA,EAActK,KAAK/I,MAAnBqT,UAER,OACI,uBAAKnO,UAAU,gBACX,uBAAKA,UAAU,SAAf,GAEI,qBAAGqE,QAASR,KAAK0K,wBAAjB,gBAFJ,GAMI,0BAAQvO,UAAS,UAAKmO,EAAY,KAAO,GAAxB,eAAyC9J,QAASR,KAAK2K,wBA5D5F,GAAiC7J,aAoE1B,SAAS8J,GAAYC,IAO3B,SAAShO,EAAEC,EAAEgO,EAAEC,GAAgB,SAASrZ,EAAEmL,EAAEC,EAAEgO,GAAG,OAAO5M,WAAW8M,EAAEnO,EAAEiO,GAAGhO,GAAG,SAASmO,EAAEpO,EAAEC,EAAEgO,GAAG,QAAOhY,MAAMoY,QAAQrO,KAAIsO,EAAEtO,EAAEiO,EAAEhO,GAAGgO,IAAG,GAAO,SAASK,EAAEtO,EAAEC,EAAEgO,GAAG,IAAIpZ,EAAE,GAAGmL,EAAE,GAAGA,EAAE6K,QAAQ7K,EAAE6K,QAAQ5K,EAAEgO,QAAQ,GAAGjO,EAAErL,SAASuZ,EAAE,IAAIrZ,EAAE,EAAEA,EAAEmL,EAAErL,QAAQsL,EAAE7J,KAAK6X,EAAEjO,EAAEnL,GAAGA,EAAEmL,GAAGnL,SAAS,IAAIA,KAAKmL,EAAEA,EAAEuO,eAAe1Z,IAAIoL,EAAE7J,KAAK6X,EAAEjO,EAAEnL,GAAGA,EAAEmL,GAAG,SAASwO,EAAEvO,EAAEgO,EAAEC,GAAG,IAAIrZ,EAAE,sBAAsBoZ,EAAE,KAAKC,EAAE,SAAS,OAAO,WAAW,IAAID,EAAE,IAAIQ,MAAM,mBAAmBP,EAAED,GAAGA,EAAES,MAAMT,EAAES,MAAMC,QAAQ,kBAAkB,IAAIA,QAAQ,cAAc,IAAIA,QAAQ,6BAA6B,kBAAkB,sBAAsBP,EAAEpO,EAAErK,UAAUqK,EAAErK,QAAQC,MAAMoK,EAAErK,QAAQ8R,KAAK,OAAO2G,GAAGA,EAAEhY,KAAK4J,EAAErK,QAAQd,EAAEqZ,GAAGjO,EAAEjK,MAAMmN,KAAK9M,YAAY,SAASoD,EAAEuG,EAAEC,EAAEgO,GAAG,IAAIC,EAAErZ,EAAEoL,EAAE/J,WAAUgY,EAAElO,EAAE9J,UAAU0Y,OAAOC,OAAOha,IAAKia,YAAY9O,EAAEkO,EAAEa,OAAOla,EAAEoZ,GAAGe,GAAGd,EAAED,GAAG,SAASE,EAAEnO,EAAEC,GAAG,OAAO,WAAW,OAAOD,EAAEhK,MAAMiK,EAAE5J,YAAY,SAASkH,EAAEyC,EAAEC,GAAG,OAAO,IAAOD,IAAGiP,GAAGjP,EAAEhK,MAAMiK,GAAEA,EAAE,IAAMiO,EAAEjO,GAAGD,EAAE,SAASkP,EAAElP,EAAEC,GAAG,OAAOD,IAAIkO,EAAEjO,EAAED,EAAE,SAASmP,EAAEnP,EAAEC,EAAEgO,GAAGK,EAAEc,EAAEnP,IAAG,SAASA,GAAGD,EAAEqP,iBAAiBpP,EAAEgO,GAAE,MAAM,SAASqB,EAAEtP,EAAEC,EAAEgO,GAAGK,EAAEc,EAAEnP,IAAG,SAASA,GAAGD,EAAEuP,oBAAoBtP,EAAEgO,GAAE,MAAM,SAASuB,EAAExP,EAAEC,GAAG,KAAKD,GAAG,CAAC,GAAGA,GAAGC,EAAE,OAAM,EAAGD,EAAEA,EAAEyP,WAAW,OAAM,EAAG,SAASC,EAAE1P,EAAEC,GAAG,OAAOD,EAAE2P,QAAQ1P,IAAI,EAAE,SAASmP,EAAEpP,GAAG,OAAOA,EAAE4P,OAAOC,MAAM,QAAQ,SAASC,EAAE9P,EAAEC,EAAEgO,GAAG,GAAGjO,EAAE2P,UAAU1B,EAAE,OAAOjO,EAAE2P,QAAQ1P,GAAG,IAAI,IAAIiO,EAAE,EAAEA,EAAElO,EAAErL,QAAQ,CAAC,GAAGsZ,GAAGjO,EAAEkO,GAAGD,IAAIhO,IAAIgO,GAAGjO,EAAEkO,KAAKjO,EAAE,OAAOiO,EAAEA,IAAI,OAAO,EAAE,SAAS6B,EAAE/P,GAAG,OAAO/J,MAAMC,UAAUC,MAAMC,KAAK4J,EAAE,GAAG,SAAShC,EAAEgC,EAAEC,EAAEgO,GAAG,IAAI,IAAIC,EAAE,GAAGrZ,EAAE,GAAGuZ,EAAE,EAAEA,EAAEpO,EAAErL,QAAQ,CAAC,IAAI2Z,EAAErO,EAAED,EAAEoO,GAAGnO,GAAGD,EAAEoO,GAAG0B,EAAEjb,EAAEyZ,GAAG,GAAGJ,EAAE8B,KAAKhQ,EAAEoO,IAAIvZ,EAAEuZ,GAAGE,EAAEF,IAAI,OAAOH,IAAIC,EAAEjO,EAAEiO,EAAE+B,MAAK,SAASjQ,EAAEiO,GAAG,OAAOjO,EAAEC,GAAGgO,EAAEhO,MAAKiO,EAAE+B,QAAQ/B,EAAE,SAASgC,EAAElQ,EAAEC,GAAG,IAAI,IAAIgO,EAAEpZ,EAAEuZ,EAAEnO,EAAE,GAAGkQ,cAAclQ,EAAE9J,MAAM,GAAGmY,EAAE,EAAEA,EAAE8B,GAAGzb,QAAQ,CAAC,IAAWE,GAARoZ,EAAEmC,GAAG9B,IAAOL,EAAEG,EAAEnO,KAAOD,EAAE,OAAOnL,EAAEyZ,IAAI,OAAOJ,EAA2B,SAASmC,EAAEpQ,GAAG,IAAIgO,EAAEhO,EAAEqQ,eAAerQ,EAAE,OAAOgO,EAAEsC,aAAatC,EAAEuC,cAAcxQ,EAAE,SAASyQ,EAAEzQ,EAAEC,GAAG,IAAIgO,EAAE9K,KAAKA,KAAKuN,QAAQ1Q,EAAEmD,KAAK1O,SAASwL,EAAEkD,KAAKD,QAAQlD,EAAEkD,QAAQC,KAAK2C,OAAO9F,EAAE1I,QAAQqZ,YAAYxN,KAAKyN,WAAW,SAAS3Q,GAAG1C,EAAEyC,EAAE1I,QAAQuZ,OAAO,CAAC7Q,KAAKiO,EAAE6C,QAAQ7Q,IAAIkD,KAAK4N,OAA0F,SAASC,EAAEhR,EAAEC,EAAEgO,GAAG,IAAIC,EAAED,EAAEgD,SAAStc,OAAOE,EAAEoZ,EAAEiD,gBAAgBvc,OAAOyZ,EAAEnO,EAAEkR,IAAIjD,EAAErZ,GAAI,EAAEyZ,EAAErO,GAAGmR,GAAGC,KAAKnD,EAAErZ,GAAI,EAAEoZ,EAAEqD,UAAUlD,EAAEH,EAAEsD,UAAUjD,EAAEF,IAAIpO,EAAEwR,QAAQ,IAAIvD,EAAEwD,UAAUxR,EAAuE,SAAWD,EAAEC,GAAG,IAAIgO,EAAEjO,EAAEwR,QAAQtD,EAAEjO,EAAEgR,SAASpc,EAAEqZ,EAAEvZ,OAAOsZ,EAAEyD,aAAazD,EAAEyD,WAAWC,EAAE1R,IAAIpL,EAAE,IAAIoZ,EAAE2D,cAAc3D,EAAE2D,cAAcD,EAAE1R,GAAG,IAAIpL,IAAIoZ,EAAE2D,eAAc,GAAI,IAAIxD,EAAEH,EAAEyD,WAAWpD,EAAEL,EAAE2D,cAAcpD,EAAEF,EAAEA,EAAEuD,OAAOzD,EAAEyD,OAAOpY,EAAEwG,EAAE4R,OAAOC,EAAE5D,GAAGjO,EAAE8R,UAAUC,KAAK/R,EAAEgS,UAAUhS,EAAE8R,UAAU3D,EAAE2D,UAAU9R,EAAEiS,MAAMC,EAAE3D,EAAE/U,GAAGwG,EAAEmS,SAASC,EAAE7D,EAAE/U,GAA2b,SAAWuG,EAAEC,GAAG,IAAIgO,EAAEhO,EAAE4R,OAAO3D,EAAElO,EAAEsS,aAAa,GAAGzd,EAAEmL,EAAEuS,WAAW,GAAGnE,EAAEpO,EAAEwS,WAAW,GAAGvS,EAAEwR,YAAYN,IAAI/C,EAAEqD,YAAYL,KAAKvc,EAAEmL,EAAEuS,UAAU,CAAC9B,EAAErC,EAAEqE,QAAQ,EAAEC,EAAEtE,EAAEuE,QAAQ,GAAGzE,EAAElO,EAAEsS,YAAY,CAAC7B,EAAExC,EAAEwC,EAAEiC,EAAEzE,EAAEyE,IAAIzS,EAAEwS,OAAO5d,EAAE4b,GAAGxC,EAAEwC,EAAEvC,EAAEuC,GAAGxQ,EAAE0S,OAAO9d,EAAE6d,GAAGzE,EAAEyE,EAAExE,EAAEwE,GAA1qBE,CAAE3E,EAAEhO,GAAGA,EAAE4S,gBAAgBC,EAAE7S,EAAEwS,OAAOxS,EAAE0S,QAAQ,IAAIxE,EAAE4E,EAAE9S,EAAEgS,UAAUhS,EAAEwS,OAAOxS,EAAE0S,QAAQ1S,EAAE+S,iBAAiB7E,EAAEsC,EAAExQ,EAAEgT,iBAAiB9E,EAAEuE,EAAEzS,EAAEiT,gBAAgBC,GAAGhF,EAAEsC,GAAG0C,GAAGhF,EAAEuE,GAAGvE,EAAEsC,EAAEtC,EAAEuE,EAAEzS,EAAEmT,MAAM9E,EAA+jD,SAAWtO,EAAEC,GAAG,OAAOoS,EAAEpS,EAAE,GAAGA,EAAE,GAAGoT,IAAIhB,EAAErS,EAAE,GAAGA,EAAE,GAAGqT,IAAhnDC,CAAEhF,EAAE2C,SAAS/C,GAAG,EAAEjO,EAAEsT,SAASjF,EAAy+C,SAAWtO,EAAEC,GAAG,OAAOkS,EAAElS,EAAE,GAAGA,EAAE,GAAGoT,IAAIlB,EAAEnS,EAAE,GAAGA,EAAE,GAAGqT,IAA1hDG,CAAElF,EAAE2C,SAAS/C,GAAG,EAAEjO,EAAEwT,YAAYxF,EAAEuE,UAAUvS,EAAEgR,SAAStc,OAAOsZ,EAAEuE,UAAUiB,YAAYxT,EAAEgR,SAAStc,OAAOsZ,EAAEuE,UAAUiB,YAAYxT,EAAEgR,SAAStc,OAAOyI,EAAE6Q,EAAEhO,GAAG,IAAI1C,EAAEyC,EAAEkD,QAAQsM,EAAEvP,EAAEyT,SAAS5N,OAAOvI,KAAKA,EAAE0C,EAAEyT,SAAS5N,QAAQ7F,EAAE6F,OAAOvI,EAA7zBoW,CAAE3T,EAAEiO,GAAGjO,EAAE4T,KAAK,eAAe3F,GAAGjO,EAAE6T,UAAU5F,GAAGjO,EAAEwR,QAAQgB,UAAUvE,EAAi/B,SAAS7Q,EAAE4C,EAAEC,GAAG,IAAIgO,EAAEpZ,EAAEuZ,EAAEE,EAAEE,EAAExO,EAAE8T,cAAc7T,EAAExG,EAAEwG,EAAE8R,UAAUvD,EAAEuD,UAAU,GAAG9R,EAAEwR,WAAWJ,KAAK5X,EAAEsa,IAAIvF,EAAEwF,WAAW9F,GAAG,CAAC,IAAIC,EAAElO,EAAEwS,OAAOjE,EAAEiE,OAAOlV,EAAE0C,EAAE0S,OAAOnE,EAAEmE,OAAOzD,EAAE6D,EAAEtZ,EAAE0U,EAAE5Q,GAAG1I,EAAEqa,EAAEuB,EAAErC,EAAEc,EAAEwD,EAAEzE,EAAEkF,GAAGjE,EAAEuB,GAAG0C,GAAGjE,EAAEwD,GAAGxD,EAAEuB,EAAEvB,EAAEwD,EAAEpE,EAAEwE,EAAE3E,EAAE5Q,GAAGyC,EAAE8T,aAAa7T,OAAOgO,EAAEO,EAAEwF,SAASnf,EAAE2Z,EAAEyF,UAAU7F,EAAEI,EAAE0F,UAAU5F,EAAEE,EAAE2F,UAAUlU,EAAE+T,SAAS/F,EAAEhO,EAAEgU,UAAUpf,EAAEoL,EAAEiU,UAAU9F,EAAEnO,EAAEkU,UAAU7F,EAAE,SAASqD,EAAE3R,GAAG,IAAI,IAAIC,EAAE,GAAGgO,EAAE,EAAEA,EAAEjO,EAAEiR,SAAStc,QAAQsL,EAAEgO,GAAG,CAACmG,QAAQC,GAAGrU,EAAEiR,SAAShD,GAAGmG,SAASE,QAAQD,GAAGrU,EAAEiR,SAAShD,GAAGqG,UAAUrG,IAAI,MAAM,CAAC8D,UAAUC,KAAKf,SAAShR,EAAE4R,OAAOC,EAAE7R,GAAGwS,OAAOzS,EAAEyS,OAAOE,OAAO3S,EAAE2S,QAAQ,SAASb,EAAE9R,GAAG,IAAIC,EAAED,EAAErL,OAAO,GAAG,IAAIsL,EAAE,MAAM,CAACwQ,EAAE4D,GAAGrU,EAAE,GAAGoU,SAAS1B,EAAE2B,GAAGrU,EAAE,GAAGsU,UAAU,IAAI,IAAIrG,EAAE,EAAEC,EAAE,EAAErZ,EAAE,EAAEoL,EAAEpL,GAAGoZ,GAAGjO,EAAEnL,GAAGuf,QAAQlG,GAAGlO,EAAEnL,GAAGyf,QAAQzf,IAAI,MAAM,CAAC4b,EAAE4D,GAAGpG,EAAEhO,GAAGyS,EAAE2B,GAAGnG,EAAEjO,IAAI,SAAS8S,EAAE/S,EAAEC,EAAEgO,GAAG,MAAM,CAACwC,EAAExQ,EAAED,GAAG,EAAE0S,EAAEzE,EAAEjO,GAAG,GAAG,SAAS8S,EAAE9S,EAAEC,GAAG,OAAOD,IAAIC,EAAEsU,GAAGpB,GAAGnT,IAAImT,GAAGlT,GAAG,EAAED,EAAEwU,GAAGC,GAAG,EAAExU,EAAEyU,GAAGC,GAAG,SAAStC,EAAErS,EAAEC,EAAEgO,GAAGA,IAAIA,EAAE2G,IAAI,IAAI1G,EAAEjO,EAAEgO,EAAE,IAAIjO,EAAEiO,EAAE,IAAIpZ,EAAEoL,EAAEgO,EAAE,IAAIjO,EAAEiO,EAAE,IAAI,OAAO/Z,KAAK2gB,KAAK3G,EAAEA,EAAErZ,EAAEA,GAAG,SAASsd,EAAEnS,EAAEC,EAAEgO,GAAGA,IAAIA,EAAE2G,IAAI,IAAI1G,EAAEjO,EAAEgO,EAAE,IAAIjO,EAAEiO,EAAE,IAAIpZ,EAAEoL,EAAEgO,EAAE,IAAIjO,EAAEiO,EAAE,IAAI,OAAO,IAAI/Z,KAAK4gB,MAAMjgB,EAAEqZ,GAAGha,KAAK6gB,GAAiH,SAASC,IAAI7R,KAAK8R,KAAKC,GAAG/R,KAAKgS,MAAMC,GAAGjS,KAAKkS,SAAQ,EAAG5E,EAAEza,MAAMmN,KAAK9M,WAAW,SAASif,IAAInS,KAAK8R,KAAKM,GAAGpS,KAAKgS,MAAMK,GAAG/E,EAAEza,MAAMmN,KAAK9M,WAAW8M,KAAKjG,MAAMiG,KAAKuN,QAAQc,QAAQiE,cAAc,GAAG,SAASC,IAAIvS,KAAKwS,SAASC,GAAGzS,KAAKgS,MAAMU,GAAG1S,KAAK2S,SAAQ,EAAGrF,EAAEza,MAAMmN,KAAK9M,WAAW,SAAS0f,EAAE/V,EAAEC,GAAG,IAAIgO,EAAE8B,EAAE/P,EAAEgW,SAAS9H,EAAE6B,EAAE/P,EAAEiW,gBAAgB,OAAOhW,GAAGmR,GAAGC,MAAMpD,EAAEjQ,EAAEiQ,EAAEzK,OAAO0K,GAAG,cAAa,IAAK,CAACD,EAAEC,GAAG,SAASgI,IAAI/S,KAAKwS,SAASQ,GAAGhT,KAAKiT,UAAU,GAAG3F,EAAEza,MAAMmN,KAAK9M,WAAW,SAASggB,EAAErW,EAAEC,GAAG,IAAIgO,EAAE8B,EAAE/P,EAAEgW,SAAS9H,EAAE/K,KAAKiT,UAAU,GAAGnW,GAAGkR,GAAGmF,KAAK,IAAIrI,EAAEtZ,OAAO,OAAOuZ,EAAED,EAAE,GAAGsI,aAAY,EAAG,CAACtI,EAAEA,GAAG,IAAIpZ,EAAEuZ,EAAEE,EAAEyB,EAAE/P,EAAEiW,gBAAgBzH,EAAE,GAAG/U,EAAE0J,KAAK2C,OAAO,GAAGsI,EAAEH,EAAErZ,QAAO,SAASoL,GAAG,OAAOwP,EAAExP,EAAE8F,OAAOrM,MAAKwG,IAAIkR,GAAG,IAAItc,EAAE,EAAEA,EAAEuZ,EAAEzZ,QAAQuZ,EAAEE,EAAEvZ,GAAG0hB,aAAY,EAAG1hB,IAAI,IAAIA,EAAE,EAAEA,EAAEyZ,EAAE3Z,QAAQuZ,EAAEI,EAAEzZ,GAAG0hB,aAAa/H,EAAEwB,KAAK1B,EAAEzZ,IAAIoL,GAAGmR,GAAGC,YAAYnD,EAAEI,EAAEzZ,GAAG0hB,YAAY1hB,IAAI,OAAO2Z,EAAE7Z,OAAO,CAACqJ,EAAEoQ,EAAE5K,OAAOgL,GAAG,cAAa,GAAIA,QAAG,EAAO,SAASgI,IAAI/F,EAAEza,MAAMmN,KAAK9M,WAAW,IAAI2J,EAAEmO,EAAEhL,KAAK2N,QAAQ3N,MAAMA,KAAKsT,MAAM,IAAIP,EAAE/S,KAAKuN,QAAQ1Q,GAAGmD,KAAKuT,MAAM,IAAI1B,EAAE7R,KAAKuN,QAAQ1Q,GAAGmD,KAAKwT,aAAa,KAAKxT,KAAKyT,YAAY,GAAG,SAASC,EAAE7W,EAAEC,GAAGD,EAAEmR,IAAIhO,KAAKwT,aAAa1W,EAAEiR,gBAAgB,GAAGqF,WAAWO,EAAE1gB,KAAK+M,KAAKlD,IAAID,GAAGoR,GAAGC,KAAKyF,EAAE1gB,KAAK+M,KAAKlD,GAAG,SAAS6W,EAAE9W,GAAG,IAAIC,EAAED,EAAEkR,gBAAgB,GAAG,GAAGjR,EAAEsW,aAAapT,KAAKwT,aAAa,CAAC,IAAI1I,EAAE,CAACwC,EAAExQ,EAAEmU,QAAQ1B,EAAEzS,EAAEqU,SAASnR,KAAKyT,YAAY5G,KAAK/B,GAAG,IAAIC,EAAE/K,KAAKyT,YAAiEvV,YAAnD,WAAW,IAAIrB,EAAEkO,EAAEyB,QAAQ1B,GAAGjO,GAAG,GAAGkO,EAAE6I,OAAO/W,EAAE,KAAiBgX,KAAK,SAASC,EAAEjX,GAAG,IAAI,IAAIC,EAAED,EAAE0T,SAASU,QAAQnG,EAAEjO,EAAE0T,SAASY,QAAQpG,EAAE,EAAEA,EAAE/K,KAAKyT,YAAYjiB,OAAOuZ,IAAI,CAAC,IAAIrZ,EAAEsO,KAAKyT,YAAY1I,GAAGE,EAAEla,KAAKgjB,IAAIjX,EAAEpL,EAAE4b,GAAGnC,EAAEpa,KAAKgjB,IAAIjJ,EAAEpZ,EAAE6d,GAAG,GAAGyE,IAAI/I,GAAG+I,IAAI7I,EAAE,OAAM,EAAG,OAAM,EAAG,SAAS8I,EAAEpX,EAAEC,GAAGkD,KAAKuN,QAAQ1Q,EAAEmD,KAAKiK,IAAInN,GAA4S,SAASoX,EAAErX,GAAGmD,KAAK7L,QAAQ0X,GAAG,GAAG7L,KAAKmU,SAAStX,GAAG,IAAImD,KAAK/L,GAAzoJmgB,KAAgpJpU,KAAKuN,QAAQ,KAAKvN,KAAK7L,QAAQuZ,OAAO3B,EAAE/L,KAAK7L,QAAQuZ,QAAO,GAAI1N,KAAK/I,MAAMod,GAAGrU,KAAKsU,aAAa,GAAGtU,KAAKuU,YAAY,GAAG,SAASC,EAAE3X,GAAG,OAAOA,EAAE4X,GAAG,SAAS5X,EAAE6X,GAAG,MAAM7X,EAAE8X,GAAG,OAAO9X,EAAE+X,GAAG,QAAQ,GAAG,SAASzjB,EAAE0L,GAAG,OAAOA,GAAG2U,GAAG,OAAO3U,GAAG0U,GAAG,KAAK1U,GAAGwU,GAAG,OAAOxU,GAAGyU,GAAG,QAAQ,GAAG,SAAS5c,EAAEmI,EAAEC,GAAG,IAAIgO,EAAEhO,EAAEyQ,QAAQ,OAAOzC,EAAEA,EAAE/Y,IAAI8K,GAAGA,EAAE,SAASgY,IAAKX,EAAErhB,MAAMmN,KAAK9M,WAAW,SAAS4hB,IAAKD,EAAGhiB,MAAMmN,KAAK9M,WAAW8M,KAAK+U,GAAG,KAAK/U,KAAKgV,GAAG,KAAK,SAASC,IAAKJ,EAAGhiB,MAAMmN,KAAK9M,WAAW,SAASgiB,IAAKhB,EAAErhB,MAAMmN,KAAK9M,WAAW8M,KAAKmV,OAAO,KAAKnV,KAAKoV,OAAO,KAAK,SAASC,IAAKR,EAAGhiB,MAAMmN,KAAK9M,WAAW,SAASoiB,KAAKT,EAAGhiB,MAAMmN,KAAK9M,WAAW,SAASqiB,KAAKrB,EAAErhB,MAAMmN,KAAK9M,WAAW8M,KAAKwV,OAAM,EAAGxV,KAAKyV,SAAQ,EAAGzV,KAAKmV,OAAO,KAAKnV,KAAKoV,OAAO,KAAKpV,KAAKtF,MAAM,EAAE,SAASgb,GAAG7Y,EAAEC,GAAG,OAAOA,EAAEA,GAAG,IAAK6Y,YAAY5J,EAAEjP,EAAE6Y,YAAYD,GAAGvB,SAASyB,QAAQ,IAAIC,GAAGhZ,EAAEC,GAAG,SAAS+Y,GAAGhZ,EAAEC,GAAGkD,KAAK7L,QAAQ0X,GAAG,GAAG6J,GAAGvB,SAASrX,GAAG,IAAIkD,KAAK7L,QAAQqZ,YAAYxN,KAAK7L,QAAQqZ,aAAa3Q,EAAEmD,KAAK8V,SAAS,GAAG9V,KAAKqO,QAAQ,GAAGrO,KAAK2V,YAAY,GAAG3V,KAAK+V,YAAY,GAAG/V,KAAKD,QAAQlD,EAAEmD,KAAKgW,MAAx3K,SAAWnZ,GAAgC,OAAO,IAA5BA,EAAE1I,QAAQ8hB,aAA4BC,GAAG/D,EAAEgE,GAAGpD,EAAEqD,GAAG/C,EAAExB,IAAGhV,EAAEgR,GAA8yK0B,CAAEvP,MAAMA,KAAKqW,YAAY,IAAIpC,EAAEjU,KAAKA,KAAK7L,QAAQkiB,aAAaC,GAAGtW,MAAK,GAAImL,EAAEnL,KAAK7L,QAAQwhB,aAAY,SAAS9Y,GAAG,IAAIC,EAAEkD,KAAKuW,IAAI,IAAI1Z,EAAE,GAAGA,EAAE,KAAKA,EAAE,IAAIC,EAAE0Z,cAAc3Z,EAAE,IAAIA,EAAE,IAAIC,EAAE2Z,eAAe5Z,EAAE,MAAKmD,MAAM,SAASsW,GAAGzZ,EAAEC,GAAG,IAAgCiO,EAA5BD,EAAEjO,EAAEkD,QAAW+K,EAAE5U,QAAaiV,EAAEtO,EAAE1I,QAAQuiB,UAAS,SAAShlB,EAAEuZ,GAAGF,EAAEgC,EAAEjC,EAAE5U,MAAM+U,GAAGnO,GAAGD,EAAEkZ,YAAYhL,GAAGD,EAAE5U,MAAM6U,GAAGD,EAAE5U,MAAM6U,GAAGrZ,GAAGoZ,EAAE5U,MAAM6U,GAAGlO,EAAEkZ,YAAYhL,IAAI,MAAKjO,IAAID,EAAEkZ,YAAY,KAAK,SAASY,GAAG9Z,EAAEiO,GAAG,IAAIC,EAAEjO,EAAE8Z,YAAY,SAAS7L,EAAE8L,UAAUha,GAAE,GAAG,GAAIkO,EAAE+L,QAAQhM,EAAEA,EAAEnI,OAAOoU,cAAchM,GAAG,IAAIc,GAAGoB,GAAG,CAAC,GAAG,SAAS,MAAM,KAAK,KAAK,KAAK+J,GAAGla,EAAEma,cAAc,OAAOnL,GAAG,WAAWoF,GAAGngB,KAAKmmB,MAAMlH,GAAGjf,KAAKgjB,IAAIlF,GAAGsI,KAAKC,IAAIvL,GAAG,mBAAmBJ,OAAO4L,OAAO,SAASxa,GAAG,GAAGA,IAAIkO,GAAG,OAAOlO,EAAE,MAAM,IAAIya,UAAU,8CAA8C,IAAI,IAAIxa,EAAE2O,OAAO5O,GAAGiO,EAAE,EAAEA,EAAE5X,UAAU1B,OAAOsZ,IAAI,CAAC,IAAIpZ,EAAEwB,UAAU4X,GAAG,GAAGpZ,IAAIqZ,GAAG,OAAOrZ,EAAE,IAAI,IAAIuZ,KAAKvZ,EAAEA,EAAE0Z,eAAeH,KAAKnO,EAAEmO,GAAGvZ,EAAEuZ,IAAI,OAAOnO,GAAG2O,OAAO4L,OAAO,IAAIE,GAAGlM,GAAE,SAASxO,EAAEC,EAAEgO,GAAG,IAAI,IAAIpZ,EAAE+Z,OAAO3U,KAAKgG,GAAGmO,EAAE,EAAEA,EAAEvZ,EAAEF,UAAUsZ,GAAGA,GAAGjO,EAAEnL,EAAEuZ,MAAMF,KAAKlO,EAAEnL,EAAEuZ,IAAInO,EAAEpL,EAAEuZ,KAAKA,IAAI,OAAOpO,IAAG,SAAS,iBAAiB2a,GAAGnM,GAAE,SAASxO,EAAEC,GAAG,OAAOya,GAAG1a,EAAEC,GAAE,KAAK,QAAQ,iBAAiBsX,GAAG,EAA6CgC,GAAG,iBAAiBvZ,EAAEqZ,GAAGnJ,EAAElQ,EAAE,kBAAkBkO,EAAEoL,GAAGC,IAA5F,wCAAmGqB,KAAKC,UAAUC,WAAWC,GAAG,QAAiBC,GAAG,QAAoBjH,GAAG,GAAG5C,GAAG,EAAEmF,GAAG,EAAElF,GAAG,EAAEC,GAAG,EAAEkD,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAEC,GAAG,GAAGsG,GAAGzG,GAAGC,GAAGyG,GAAGxG,GAAGC,GAAGwG,GAAGF,GAAGC,GAAGtG,GAAG,CAAC,IAAI,KAAKvB,GAAG,CAAC,UAAU,WAAW5C,EAAEva,UAAU,CAAC4a,QAAQ,aAAaC,KAAK,WAAW5N,KAAK8R,MAAM9F,EAAEhM,KAAKD,QAAQC,KAAK8R,KAAK9R,KAAKyN,YAAYzN,KAAKwS,UAAUxG,EAAEhM,KAAK2C,OAAO3C,KAAKwS,SAASxS,KAAKyN,YAAYzN,KAAKgS,OAAOhG,EAAEkB,EAAElN,KAAKD,SAASC,KAAKgS,MAAMhS,KAAKyN,aAAawK,QAAQ,WAAWjY,KAAK8R,MAAM3F,EAAEnM,KAAKD,QAAQC,KAAK8R,KAAK9R,KAAKyN,YAAYzN,KAAKwS,UAAUrG,EAAEnM,KAAK2C,OAAO3C,KAAKwS,SAASxS,KAAKyN,YAAYzN,KAAKgS,OAAO7F,EAAEe,EAAElN,KAAKD,SAASC,KAAKgS,MAAMhS,KAAKyN,cAAc,IAAIyK,GAAG,CAACC,UAAUnK,GAAGoK,UAAUjF,GAAGkF,QAAQpK,IAAI8D,GAAG,YAAYE,GAAG,oBAAoB3b,EAAEub,EAAEvE,EAAE,CAACK,QAAQ,SAAS9Q,GAAG,IAAIC,EAAEob,GAAGrb,EAAEzE,MAAM0E,EAAEkR,IAAI,IAAInR,EAAEyb,SAAStY,KAAKkS,SAAQ,GAAIpV,EAAEqW,IAAI,IAAItW,EAAE0b,QAAQzb,EAAEmR,IAAIjO,KAAKkS,UAAUpV,EAAEmR,KAAKjO,KAAKkS,SAAQ,GAAIlS,KAAK1O,SAAS0O,KAAKuN,QAAQzQ,EAAE,CAACgR,SAAS,CAACjR,GAAGkR,gBAAgB,CAAClR,GAAG2b,YAAYX,GAAGtH,SAAS1T,QAAQ,IAAI4b,GAAG,CAACC,YAAY1K,GAAG2K,YAAYxF,GAAGyF,UAAU3K,GAAG4K,cAAc3K,GAAG4K,WAAW5K,IAAI6K,GAAG,CAACC,EAAEpB,GAAGqB,EAAl9B,MAAu9BC,EAAErB,GAAGsB,EAAx8B,UAA88B/G,GAAG,cAAcC,GAAG,sCAAsCxV,EAAEuc,iBAAiBvc,EAAEwc,eAAejH,GAAG,gBAAgBC,GAAG,6CAA6C/b,EAAE6b,EAAE7E,EAAE,CAACK,QAAQ,SAAS9Q,GAAG,IAAIC,EAAEkD,KAAKjG,MAAM+Q,GAAE,EAAGC,EAAElO,EAAEzE,KAAKkhB,cAAc9N,QAAQ,KAAK,IAAI9Z,EAAE+mB,GAAG1N,GAAGE,EAAE8N,GAAGlc,EAAE2b,cAAc3b,EAAE2b,YAAYrN,EAAEF,GAAG2M,GAAGvM,EAAEsB,EAAE7P,EAAED,EAAE0c,UAAU,aAAa7nB,EAAEsc,KAAK,IAAInR,EAAEyb,QAAQnN,GAAG,EAAEE,IAAIvO,EAAE+P,KAAKhQ,GAAGwO,EAAEvO,EAAEtL,OAAO,GAAGE,GAAGuc,GAAGC,MAAMpD,GAAE,GAAI,EAAEO,IAAIvO,EAAEuO,GAAGxO,EAAEmD,KAAK1O,SAAS0O,KAAKuN,QAAQ7b,EAAE,CAACoc,SAAShR,EAAEiR,gBAAgB,CAAClR,GAAG2b,YAAYvN,EAAEsF,SAAS1T,IAAIiO,GAAGhO,EAAE8W,OAAOvI,EAAE,OAAO,IAAImO,GAAG,CAACC,WAAWzL,GAAG0L,UAAUvG,GAAGwG,SAAS1L,GAAG2L,YAAY1L,IAAIuE,GAAG,aAAaC,GAAG,4CAA4Cpc,EAAEic,EAAEjF,EAAE,CAACK,QAAQ,SAAS9Q,GAAG,IAAIC,EAAE0c,GAAG3c,EAAEzE,MAAM,GAAG0E,IAAIkR,KAAKhO,KAAK2S,SAAQ,GAAI3S,KAAK2S,QAAQ,CAAC,IAAI7H,EAAE8H,EAAE3f,KAAK+M,KAAKnD,EAAEC,GAAGA,GAAGmR,GAAGC,KAAKpD,EAAE,GAAGtZ,OAAOsZ,EAAE,GAAGtZ,QAAS,IAAIwO,KAAK2S,SAAQ,GAAI3S,KAAK1O,SAAS0O,KAAKuN,QAAQzQ,EAAE,CAACgR,SAAShD,EAAE,GAAGiD,gBAAgBjD,EAAE,GAAG0N,YAAYZ,GAAGrH,SAAS1T,QAAQ,IAAIgd,GAAG,CAACJ,WAAWzL,GAAG0L,UAAUvG,GAAGwG,SAAS1L,GAAG2L,YAAY1L,IAAI8E,GAAG,4CAA4C1c,EAAEyc,EAAEzF,EAAE,CAACK,QAAQ,SAAS9Q,GAAG,IAAIC,EAAE+c,GAAGhd,EAAEzE,MAAM0S,EAAEoI,EAAEjgB,KAAK+M,KAAKnD,EAAEC,GAAGgO,GAAG9K,KAAK1O,SAAS0O,KAAKuN,QAAQzQ,EAAE,CAACgR,SAAShD,EAAE,GAAGiD,gBAAgBjD,EAAE,GAAG0N,YAAYZ,GAAGrH,SAAS1T,OAAO,IAAIgX,GAAG,KAAKG,GAAG,GAAG1d,EAAE+c,EAAE/F,EAAE,CAACK,QAAQ,SAAS9Q,EAAEC,EAAEgO,GAAG,IAAIC,EAAED,EAAE0N,aAAaZ,GAAGlmB,EAAEoZ,EAAE0N,aAAaX,GAAG,KAAKnmB,GAAGoZ,EAAEgP,oBAAoBhP,EAAEgP,mBAAmBC,kBAAkB,CAAC,GAAGhP,EAAE2I,EAAEzgB,KAAK+M,KAAKlD,EAAEgO,QAAQ,GAAGpZ,GAAGoiB,EAAE7gB,KAAK+M,KAAK8K,GAAG,OAAO9K,KAAK1O,SAASuL,EAAEC,EAAEgO,KAAKmN,QAAQ,WAAWjY,KAAKsT,MAAM2E,UAAUjY,KAAKuT,MAAM0E,aAAa,IAAI+B,GAAGjN,EAAEiK,GAAG9gB,MAAM,eAAe+jB,GAAGD,KAAKjP,EAAEmP,GAAG,UAAUC,GAAG,OAAOC,GAAG,eAAeC,GAAG,OAAOC,GAAG,QAAQC,GAAG,QAAQC,GAA3jK,WAAa,IAAIP,GAAG,OAAM,EAAG,IAAInd,EAAE,GAAGgO,EAAEjO,EAAE4d,KAAK5d,EAAE4d,IAAIC,SAAS,MAAM,CAAC,OAAO,eAAe,QAAQ,QAAQ,cAAc,QAAQhT,SAAQ,SAASqD,GAAGjO,EAAEiO,IAAGD,GAAEjO,EAAE4d,IAAIC,SAAS,eAAe3P,MAAQjO,EAA43J6d,GAAI1G,EAAElhB,UAAU,CAACkX,IAAI,SAASpN,GAAGA,GAAGqd,KAAKrd,EAAEmD,KAAK4a,WAAWX,IAAIja,KAAKuN,QAAQxN,QAAQ7J,OAAOskB,GAAG3d,KAAKmD,KAAKuN,QAAQxN,QAAQ7J,MAAM8jB,IAAInd,GAAGmD,KAAK6a,QAAQhe,EAAEyc,cAAc7M,QAAQqO,OAAO,WAAW9a,KAAKiK,IAAIjK,KAAKuN,QAAQpZ,QAAQkiB,cAAcuE,QAAQ,WAAW,IAAI/d,EAAE,GAAG,OAAOsO,EAAEnL,KAAKuN,QAAQoI,aAAY,SAAS7Y,GAAG1C,EAAE0C,EAAE3I,QAAQuZ,OAAO,CAAC5Q,MAAMD,EAAEA,EAAEwD,OAAOvD,EAAEie,sBAA5/K,SAAWle,GAAG,GAAG0P,EAAE1P,EAAEwd,IAAI,OAAOA,GAAG,IAAIvd,EAAEyP,EAAE1P,EAAEyd,IAAIxP,EAAEyB,EAAE1P,EAAE0d,IAAI,OAAOzd,GAAGgO,EAAEuP,GAAGvd,GAAGgO,EAAEhO,EAAEwd,GAAGC,GAAGhO,EAAE1P,EAAEud,IAAIA,GAAGD,GAA+6Ka,CAAEne,EAAEoe,KAAK,OAAOC,gBAAgB,SAASre,GAAG,IAAIC,EAAED,EAAE0T,SAASzF,EAAEjO,EAAE6S,gBAAgB,IAAG1P,KAAKuN,QAAQc,QAAQ8M,UAAxB,CAAiE,IAAIpQ,EAAE/K,KAAK6a,QAAQnpB,EAAE6a,EAAExB,EAAEsP,MAAMG,GAAGH,IAAIpP,EAAEsB,EAAExB,EAAEwP,MAAMC,GAAGD,IAAIpP,EAAEoB,EAAExB,EAAEuP,MAAME,GAAGF,IAAI,GAAG5oB,EAAE,CAAC,IAAI2Z,EAAE,IAAIxO,EAAEiR,SAAStc,OAAO8E,EAAEuG,EAAEoS,SAAS,EAAEjE,EAAEnO,EAAEiS,UAAU,IAAI,GAAGzD,GAAG/U,GAAG0U,EAAE,OAAO,OAAOG,GAAGF,OAAE,EAAOvZ,GAAGuZ,GAAGH,EAAEgN,IAAI3M,GAAGL,EAAEiN,GAAG/X,KAAKob,WAAWte,QAAG,EAA9OA,EAAE0C,kBAAoP4b,WAAW,SAASve,GAAGmD,KAAKuN,QAAQc,QAAQ8M,WAAU,EAAGte,EAAE2C,mBAAmB,IAAI6U,GAAG,EAAEO,GAAG,EAAED,GAAG,EAAED,GAAG,EAAE2G,GAAG3G,GAAGD,GAAG,GAAG6G,GAAG,GAAGpH,EAAEnhB,UAAU,CAACohB,SAAS,GAAGlK,IAAI,SAASpN,GAAG,OAAOgP,GAAG7L,KAAK7L,QAAQ0I,GAAGmD,KAAKuN,SAASvN,KAAKuN,QAAQ8I,YAAYyE,SAAS9a,MAAMwW,cAAc,SAAS3Z,GAAG,GAAGoO,EAAEpO,EAAE,gBAAgBmD,MAAM,OAAOA,KAAK,IAAIlD,EAAEkD,KAAKsU,aAAa,OAAmBxX,GAAZD,EAAEnI,EAAEmI,EAAEmD,OAAU/L,MAAM6I,EAAED,EAAE5I,IAAI4I,EAAEA,EAAE2Z,cAAcxW,OAAOA,MAAMub,kBAAkB,SAAS1e,GAAG,OAAOoO,EAAEpO,EAAE,oBAAoBmD,QAAYnD,EAAEnI,EAAEmI,EAAEmD,aAAaA,KAAKsU,aAAazX,EAAE5I,KAA7C+L,MAAwDyW,eAAe,SAAS5Z,GAAG,GAAGoO,EAAEpO,EAAE,iBAAiBmD,MAAM,OAAOA,KAAK,IAAIlD,EAAEkD,KAAKuU,YAAY,OAAoB,IAAI5H,EAAE7P,EAAnBD,EAAEnI,EAAEmI,EAAEmD,SAAoBlD,EAAE+P,KAAKhQ,GAAGA,EAAE4Z,eAAezW,OAAOA,MAAMwb,mBAAmB,SAAS3e,GAAG,GAAGoO,EAAEpO,EAAE,qBAAqBmD,MAAM,OAAOA,KAAKnD,EAAEnI,EAAEmI,EAAEmD,MAAM,IAAIlD,EAAE6P,EAAE3M,KAAKuU,YAAY1X,GAAG,OAAOC,GAAG,GAAGkD,KAAKuU,YAAYX,OAAO9W,EAAE,GAAGkD,MAAMyb,mBAAmB,WAAW,OAAOzb,KAAKuU,YAAY/iB,OAAO,GAAGkqB,iBAAiB,SAAS7e,GAAG,QAAQmD,KAAKsU,aAAazX,EAAE5I,KAAKwc,KAAK,SAAS5T,GAAG,SAASC,EAAEA,GAAGgO,EAAEyC,QAAQkD,KAAK3T,EAAED,GAAG,IAAIiO,EAAE9K,KAAK+K,EAAE/K,KAAK/I,MAAMyd,GAAG3J,GAAGjO,EAAEgO,EAAE3W,QAAQsH,MAAM+Y,EAAEzJ,IAAIjO,EAAEgO,EAAE3W,QAAQsH,OAAOoB,EAAE8e,iBAAiB7e,EAAED,EAAE8e,iBAAiB5Q,GAAG2J,IAAI5X,EAAEgO,EAAE3W,QAAQsH,MAAM+Y,EAAEzJ,KAAK6Q,QAAQ,SAAS/e,GAAG,OAAOmD,KAAK6b,UAAU7b,KAAKyQ,KAAK5T,QAAQmD,KAAK/I,MAAMqkB,KAAKO,QAAQ,WAAW,IAAI,IAAIhf,EAAE,EAAEA,EAAEmD,KAAKuU,YAAY/iB,QAAQ,CAAC,KAAKwO,KAAKuU,YAAY1X,GAAG5F,OAAOqkB,GAAGjH,KAAK,OAAM,EAAGxX,IAAI,OAAM,GAAI6T,UAAU,SAAS7T,GAAG,IAAIC,EAAE+O,GAAG,GAAGhP,GAAG,OAAOzC,EAAE4F,KAAK7L,QAAQuZ,OAAO,CAAC1N,KAAKlD,KAAKkD,KAAK/I,OAAOokB,GAAG5G,GAAG6G,MAAMtb,KAAK/I,MAAMod,IAAIrU,KAAK/I,MAAM+I,KAAK8b,QAAQhf,QAAQkD,KAAK/I,OAAO2d,GAAGD,GAAGD,GAAGD,KAAKzU,KAAK4b,QAAQ9e,MAAMkD,KAAK+b,aAAa/b,KAAK/I,MAAMqkB,MAAMQ,QAAQ,SAASjf,KAAKke,eAAe,aAAagB,MAAM,cAAczlB,EAAEue,EAAGX,EAAE,CAACC,SAAS,CAACrG,SAAS,GAAGkO,SAAS,SAASnf,GAAG,IAAIC,EAAEkD,KAAK7L,QAAQ2Z,SAAS,OAAO,IAAIhR,GAAGD,EAAEiR,SAAStc,SAASsL,GAAGgf,QAAQ,SAASjf,GAAG,IAAIC,EAAEkD,KAAK/I,MAAM6T,EAAEjO,EAAEyR,UAAUvD,EAAEjO,GAAG8X,GAAGD,IAAIjjB,EAAEsO,KAAKgc,SAASnf,GAAG,OAAOkO,IAAID,EAAEoD,KAAKxc,GAAGoL,EAAE2X,GAAG1J,GAAGrZ,EAAEoZ,EAAEmD,GAAGnR,EAAE4X,GAAG5X,EAAE8X,GAAG9X,EAAE6X,GAAGC,GAAG0G,MAAMhlB,EAAEwe,EAAGD,EAAG,CAACV,SAAS,CAAC1Y,MAAM,MAAMwgB,UAAU,GAAGnO,SAAS,EAAEkD,UAAUgH,IAAI+C,eAAe,WAAW,IAAIle,EAAEmD,KAAK7L,QAAQ6c,UAAUlU,EAAE,GAAG,OAAOD,EAAEib,IAAIhb,EAAE+P,KAAK0N,IAAI1d,EAAEkb,IAAIjb,EAAE+P,KAAKyN,IAAIxd,GAAGof,cAAc,SAASrf,GAAG,IAAIC,EAAEkD,KAAK7L,QAAQ2W,GAAE,EAAGC,EAAElO,EAAEoS,SAASvd,EAAEmL,EAAEmU,UAAU/F,EAAEpO,EAAEyS,OAAOnE,EAAEtO,EAAE2S,OAAO,OAAO9d,EAAEoL,EAAEkU,YAAYlU,EAAEkU,UAAU8G,IAAIpmB,EAAE,IAAIuZ,EAAEmG,GAAG,EAAEnG,EAAEoG,GAAGC,GAAGxG,EAAEG,GAAGjL,KAAK+U,GAAGhK,EAAEha,KAAKgjB,IAAIlX,EAAEyS,UAAU5d,EAAE,IAAIyZ,EAAEiG,GAAG,EAAEjG,EAAEoG,GAAGC,GAAG1G,EAAEK,GAAGnL,KAAKgV,GAAGjK,EAAEha,KAAKgjB,IAAIlX,EAAE2S,UAAU3S,EAAEmU,UAAUtf,EAAEoZ,GAAGC,EAAEjO,EAAEmf,WAAWvqB,EAAEoL,EAAEkU,WAAWgL,SAAS,SAASnf,GAAG,OAAOgY,EAAG9hB,UAAUipB,SAAS/oB,KAAK+M,KAAKnD,KAAKmD,KAAK/I,MAAM2d,MAAM5U,KAAK/I,MAAM2d,KAAK5U,KAAKkc,cAAcrf,KAAK4T,KAAK,SAAS5T,GAAGmD,KAAK+U,GAAGlY,EAAEyS,OAAOtP,KAAKgV,GAAGnY,EAAE2S,OAAO,IAAI1S,EAAE3L,EAAE0L,EAAEmU,WAAWlU,IAAID,EAAE8e,gBAAgB3b,KAAK7L,QAAQsH,MAAMqB,GAAGkD,KAAK4L,OAAO6E,KAAKxd,KAAK+M,KAAKnD,MAAMvG,EAAE2e,EAAGJ,EAAG,CAACV,SAAS,CAAC1Y,MAAM,QAAQwgB,UAAU,EAAEnO,SAAS,GAAGiN,eAAe,WAAW,MAAM,CAACV,KAAK2B,SAAS,SAASnf,GAAG,OAAOmD,KAAK4L,OAAOoQ,SAAS/oB,KAAK+M,KAAKnD,KAAK9L,KAAKgjB,IAAIlX,EAAEoT,MAAM,GAAGjQ,KAAK7L,QAAQ8nB,WAAWjc,KAAK/I,MAAM2d,KAAKnE,KAAK,SAAS5T,GAAG,GAAG,IAAIA,EAAEoT,MAAM,CAAC,IAAInT,EAAED,EAAEoT,MAAM,EAAE,KAAK,MAAMpT,EAAE8e,gBAAgB3b,KAAK7L,QAAQsH,MAAMqB,EAAEkD,KAAK4L,OAAO6E,KAAKxd,KAAK+M,KAAKnD,MAAMvG,EAAE4e,EAAGhB,EAAE,CAACC,SAAS,CAAC1Y,MAAM,QAAQqS,SAAS,EAAEqO,KAAK,IAAIF,UAAU,GAAGlB,eAAe,WAAW,MAAM,CAACZ,KAAK2B,QAAQ,SAASjf,GAAG,IAAIC,EAAEkD,KAAK7L,QAAQ2W,EAAEjO,EAAEiR,SAAStc,SAASsL,EAAEgR,SAAS/C,EAAElO,EAAEoS,SAASnS,EAAEmf,UAAUhR,EAAEpO,EAAEiS,UAAUhS,EAAEqf,KAAK,GAAGnc,KAAKoV,OAAOvY,GAAGkO,IAAID,GAAGjO,EAAEyR,WAAWL,GAAGC,MAAMjD,EAAEjL,KAAK+b,aAAa,GAAGlf,EAAEyR,UAAUN,GAAGhO,KAAK+b,QAAQ/b,KAAKmV,OAAOzjB,GAAE,WAAWsO,KAAK/I,MAAMokB,GAAGrb,KAAK4b,YAAW9e,EAAEqf,KAAKnc,WAAW,GAAGnD,EAAEyR,UAAUL,GAAG,OAAOoN,GAAG,OAAOC,IAAIS,MAAM,WAAWK,aAAapc,KAAKmV,SAAS1E,KAAK,SAAS5T,GAAGmD,KAAK/I,QAAQokB,KAAKxe,GAAGA,EAAEyR,UAAUL,GAAGjO,KAAKuN,QAAQkD,KAAKzQ,KAAK7L,QAAQsH,MAAM,KAAKoB,IAAImD,KAAKoV,OAAOxG,UAAUC,KAAK7O,KAAKuN,QAAQkD,KAAKzQ,KAAK7L,QAAQsH,MAAMuE,KAAKoV,aAAa9e,EAAE+e,EAAGR,EAAG,CAACV,SAAS,CAAC1Y,MAAM,SAASwgB,UAAU,EAAEnO,SAAS,GAAGiN,eAAe,WAAW,MAAM,CAACV,KAAK2B,SAAS,SAASnf,GAAG,OAAOmD,KAAK4L,OAAOoQ,SAAS/oB,KAAK+M,KAAKnD,KAAK9L,KAAKgjB,IAAIlX,EAAEuT,UAAUpQ,KAAK7L,QAAQ8nB,WAAWjc,KAAK/I,MAAM2d,OAAOte,EAAEgf,GAAGT,EAAG,CAACV,SAAS,CAAC1Y,MAAM,QAAQwgB,UAAU,GAAGpL,SAAS,GAAGG,UAAU8G,GAAGC,GAAGjK,SAAS,GAAGiN,eAAe,WAAW,OAAOjG,EAAG/hB,UAAUgoB,eAAe9nB,KAAK+M,OAAOgc,SAAS,SAASnf,GAAG,IAAIC,EAAEgO,EAAE9K,KAAK7L,QAAQ6c,UAAU,OAAOlG,GAAGgN,GAAGC,IAAIjb,EAAED,EAAEkT,gBAAgBjF,EAAEgN,GAAGhb,EAAED,EAAEgT,iBAAiB/E,EAAEiN,KAAKjb,EAAED,EAAEiT,kBAAkB9P,KAAK4L,OAAOoQ,SAAS/oB,KAAK+M,KAAKnD,IAAIiO,EAAEjO,EAAE6S,iBAAiB7S,EAAEoS,SAASjP,KAAK7L,QAAQ8nB,WAAWpf,EAAEyT,aAAatQ,KAAK7L,QAAQ2Z,UAAUkC,GAAGlT,GAAGkD,KAAK7L,QAAQ0c,UAAUhU,EAAEyR,UAAUL,IAAIwC,KAAK,SAAS5T,GAAG,IAAIC,EAAE3L,EAAE0L,EAAE6S,iBAAiB5S,GAAGkD,KAAKuN,QAAQkD,KAAKzQ,KAAK7L,QAAQsH,MAAMqB,EAAED,GAAGmD,KAAKuN,QAAQkD,KAAKzQ,KAAK7L,QAAQsH,MAAMoB,MAAMvG,EAAEif,GAAGrB,EAAE,CAACC,SAAS,CAAC1Y,MAAM,MAAMqS,SAAS,EAAEuO,KAAK,EAAEC,SAAS,IAAIH,KAAK,IAAIF,UAAU,EAAEM,aAAa,IAAIxB,eAAe,WAAW,MAAM,CAACX,KAAK0B,QAAQ,SAASjf,GAAG,IAAIC,EAAEkD,KAAK7L,QAAQ2W,EAAEjO,EAAEiR,SAAStc,SAASsL,EAAEgR,SAAS/C,EAAElO,EAAEoS,SAASnS,EAAEmf,UAAUhR,EAAEpO,EAAEiS,UAAUhS,EAAEqf,KAAK,GAAGnc,KAAK+b,QAAQlf,EAAEyR,UAAUN,IAAI,IAAIhO,KAAKtF,MAAM,OAAOsF,KAAKwc,cAAc,GAAGzR,GAAGE,GAAGH,EAAE,CAAC,GAAGjO,EAAEyR,WAAWL,GAAG,OAAOjO,KAAKwc,cAAc,IAAIrR,GAAEnL,KAAKwV,OAAM3Y,EAAE+R,UAAU5O,KAAKwV,MAAM1Y,EAAEwf,SAAYjR,GAAGrL,KAAKyV,SAASvG,EAAElP,KAAKyV,QAAQ5Y,EAAE6R,QAAQ5R,EAAEyf,aAAgI,GAAnHvc,KAAKwV,MAAM3Y,EAAE+R,UAAU5O,KAAKyV,QAAQ5Y,EAAE6R,OAAOrD,GAAGF,EAAEnL,KAAKtF,OAAO,EAAEsF,KAAKtF,MAAM,EAAEsF,KAAKoV,OAAOvY,EAA6B,IAArBmD,KAAKtF,MAAMoC,EAAEuf,KAAc,OAAOrc,KAAKyb,sBAAsBzb,KAAKmV,OAAOzjB,GAAE,WAAWsO,KAAK/I,MAAMokB,GAAGrb,KAAK4b,YAAW9e,EAAEwf,SAAStc,MAAM4U,IAAIyG,GAAG,OAAOC,IAAIkB,YAAY,WAAW,OAAOxc,KAAKmV,OAAOzjB,GAAE,WAAWsO,KAAK/I,MAAMqkB,KAAItb,KAAK7L,QAAQmoB,SAAStc,MAAMsb,IAAIS,MAAM,WAAWK,aAAapc,KAAKmV,SAAS1E,KAAK,WAAWzQ,KAAK/I,OAAOokB,KAAKrb,KAAKoV,OAAOqH,SAASzc,KAAKtF,MAAMsF,KAAKuN,QAAQkD,KAAKzQ,KAAK7L,QAAQsH,MAAMuE,KAAKoV,YAAYM,GAAGgH,QAAQ,QAAQhH,GAAGvB,SAAS,CAACwI,WAAU,EAAGtG,YAAY6D,GAAGxM,QAAO,EAAGF,YAAY,KAAKyI,WAAW,KAAKL,OAAO,CAAC,CAACP,EAAG,CAAC3H,QAAO,IAAK,CAACuH,EAAG,CAACvH,QAAO,GAAI,CAAC,WAAW,CAAC4H,GAAG,CAACtE,UAAU8G,KAAK,CAAChD,EAAG,CAAC9D,UAAU8G,IAAI,CAAC,UAAU,CAACvC,IAAI,CAACA,GAAG,CAAC9Z,MAAM,YAAY4gB,KAAK,GAAG,CAAC,QAAQ,CAACnH,IAAKwB,SAAS,CAACkG,WAAW,OAAOC,YAAY,OAAOC,aAAa,OAAOC,eAAe,OAAOC,SAAS,OAAOC,kBAAkB,kBAAgCpH,GAAG9iB,UAAU,CAACkX,IAAI,SAASpN,GAAG,OAAOgP,GAAG7L,KAAK7L,QAAQ0I,GAAGA,EAAEwZ,aAAarW,KAAKqW,YAAYyE,SAASje,EAAE2Q,cAAcxN,KAAKgW,MAAMiC,UAAUjY,KAAKgW,MAAMrT,OAAO9F,EAAE2Q,YAAYxN,KAAKgW,MAAMpI,QAAQ5N,MAAMkd,KAAK,SAASrgB,GAAGmD,KAAKqO,QAAQ8O,QAAQtgB,EAAvO,EAAL,GAAqP6T,UAAU,SAAS7T,GAAG,IAAIC,EAAEkD,KAAKqO,QAAQ,IAAIvR,EAAEqgB,QAAQ,CAACnd,KAAKqW,YAAY6E,gBAAgBre,GAAG,IAAIiO,EAAEC,EAAE/K,KAAK2V,YAAYjkB,EAAEoL,EAAEsgB,gBAAgB1rB,GAAGA,GAAGA,EAAEuF,MAAMokB,MAAM3pB,EAAEoL,EAAEsgB,cAAc,MAAM,IAAI,IAAInS,EAAE,EAAEA,EAAEF,EAAEvZ,QAAQsZ,EAAEC,EAAEE,GAAjc,IAAocnO,EAAEqgB,SAAczrB,GAAGoZ,GAAGpZ,IAAIoZ,EAAE4Q,iBAAiBhqB,GAAGoZ,EAAEiR,QAAQjR,EAAE4F,UAAU7T,IAAInL,GAAGoZ,EAAE7T,OAAO2d,GAAGD,GAAGD,MAAMhjB,EAAEoL,EAAEsgB,cAActS,GAAGG,MAAMlZ,IAAI,SAAS8K,GAAG,GAAGA,aAAaqX,EAAE,OAAOrX,EAAE,IAAI,IAAIC,EAAEkD,KAAK2V,YAAY7K,EAAE,EAAEA,EAAEhO,EAAEtL,OAAOsZ,IAAI,GAAGhO,EAAEgO,GAAG3W,QAAQsH,OAAOoB,EAAE,OAAOC,EAAEgO,GAAG,OAAO,MAAMyL,IAAI,SAAS1Z,GAAG,GAAGoO,EAAEpO,EAAE,MAAMmD,MAAM,OAAOA,KAAK,IAAIlD,EAAEkD,KAAKjO,IAAI8K,EAAE1I,QAAQsH,OAAO,OAAOqB,GAAGkD,KAAKnJ,OAAOiG,GAAGkD,KAAK2V,YAAY9I,KAAKhQ,GAAGA,EAAE0Q,QAAQvN,KAAKA,KAAKqW,YAAYyE,SAASje,GAAGhG,OAAO,SAASgG,GAAG,GAAGoO,EAAEpO,EAAE,SAASmD,MAAM,OAAOA,KAAK,GAAGnD,EAAEmD,KAAKjO,IAAI8K,GAAG,CAAC,IAAIC,EAAEkD,KAAK2V,YAAY7K,EAAE6B,EAAE7P,EAAED,IAAI,IAAIiO,IAAIhO,EAAE8W,OAAO9I,EAAE,GAAG9K,KAAKqW,YAAYyE,UAAU,OAAO9a,MAAMqd,GAAG,SAASxgB,EAAEC,GAAG,GAAGD,IAAIkO,GAAGjO,IAAIiO,EAAE,CAAC,IAAID,EAAE9K,KAAK8V,SAAS,OAAO3K,EAAEc,EAAEpP,IAAG,SAASA,GAAGiO,EAAEjO,GAAGiO,EAAEjO,IAAI,GAAGiO,EAAEjO,GAAGgQ,KAAK/P,MAAKkD,OAAO/H,IAAI,SAAS4E,EAAEC,GAAG,GAAGD,IAAIkO,EAAE,CAAC,IAAID,EAAE9K,KAAK8V,SAAS,OAAO3K,EAAEc,EAAEpP,IAAG,SAASA,GAAGC,EAAEgO,EAAEjO,IAAIiO,EAAEjO,GAAG+W,OAAOjH,EAAE7B,EAAEjO,GAAGC,GAAG,UAAUgO,EAAEjO,MAAKmD,OAAOyQ,KAAK,SAAS5T,EAAEC,GAAGkD,KAAK7L,QAAQwoB,WAAWhG,GAAG9Z,EAAEC,GAAG,IAAIgO,EAAE9K,KAAK8V,SAASjZ,IAAImD,KAAK8V,SAASjZ,GAAG7J,QAAQ,GAAG8X,GAAGA,EAAEtZ,OAAO,CAACsL,EAAE1E,KAAKyE,EAAEC,EAAE0C,eAAe,WAAW1C,EAAEyT,SAAS/Q,kBAAkB,IAAI,IAAIuL,EAAE,EAAEA,EAAED,EAAEtZ,QAAQsZ,EAAEC,GAAGjO,GAAGiO,MAAMkN,QAAQ,WAAWjY,KAAKD,SAASuW,GAAGtW,MAAK,GAAIA,KAAK8V,SAAS,GAAG9V,KAAKqO,QAAQ,GAAGrO,KAAKgW,MAAMiC,UAAUjY,KAAKD,QAAQ,OAAO8L,GAAG6J,GAAG,CAAC4H,YAAYtP,GAAGuP,WAAWpK,GAAGqK,UAAUvP,GAAGwP,aAAavP,GAAGwP,eAAerJ,GAAGsJ,YAAY/I,GAAGgJ,cAAcjJ,GAAGkJ,YAAYnJ,GAAGoJ,iBAAiBzC,GAAG0C,gBAAgBtJ,GAAGuJ,aAAa1C,GAAG2C,eAAe7M,GAAG8M,eAAe7M,GAAG8M,gBAAgB7M,GAAG8M,aAAa7M,GAAG8M,eAAe7M,GAAG8M,qBAAqBxG,GAAGyG,mBAAmBxG,GAAGyG,cAAcxG,GAAGyG,QAAQ5I,GAAG6I,MAAMpR,EAAEqR,YAAY1K,EAAE2K,WAAW7L,EAAE8L,WAAWhN,EAAEiN,kBAAkB3M,EAAE4M,gBAAgB1L,EAAE2L,iBAAiBzM,EAAE0M,WAAW/K,EAAEgL,eAAerK,EAAGsK,IAAI5J,GAAG6J,IAAItK,EAAGuK,MAAM/J,GAAGgK,MAAMrK,EAAGsK,OAAOlK,EAAGmK,MAAMtK,EAAGmI,GAAGrR,EAAE/T,IAAIkU,EAAE9V,KAAK8U,EAAEsU,MAAMjI,GAAGkI,OAAOnI,GAAGF,OAAOxL,GAAG8T,QAAQrpB,EAAEspB,OAAO5U,EAAE6U,SAAS9S,UAAW,IAAoBlQ,EAAEA,EAAE,oBAAoBgN,KAAKA,KAAK,IAAMiW,OAAOpK,GAAG,mBAAmBqK,QAAQA,OAAWA,QAAO,WAAW,OAAOrK,MAAiCsK,EAAOC,QAAQD,EAAOC,QAAQvK,GAAG7Y,EAAC,OAAI6Y,GAAtkoB,CAA0koBnhB,OAAOuB,UAE9koB,IAAMgU,EAAQ3Y,EAAE0Z,GAChBf,EAAMlV,KAAK,wCAAwCsrB,SAAS,UAC5DpW,EAAMlV,KAAK,+CAA+CsrB,SAAS,WACnEpW,EAAMlV,KAAK,6BAA6ByoB,GAAG,QAAQ,WAE/C,IADA,IAAI8C,EAAS,IACJ7pB,EAAI,EAAGA,EAAIwT,EAAMlV,KAAK,4BAA4BpD,OAAQ8E,IAC/D6pB,EAASA,EAASrW,EAAMlV,KAAK,+BAAiC0B,EAAI,SAASuF,QAAU,GACrFiO,EAAMlV,KAAK,qCAAqCiH,MAAMskB,MAG9DrW,EAAMlV,KAAK,yBAAyByB,MAAK,SAACC,EAAG5E,GAAM,IACvCouB,EAAWvrB,OAAXurB,OACP,IAAIA,EAAOpuB,GAAI2rB,GAAG,SAAS,YAA8B,IAAnBjlB,EAAmB,EAAnBA,KAAM4Y,EAAa,EAAbA,UACzCxe,QAAQ8R,IAAIpR,UAAU,IACT,UAATkF,IACI4Y,IAAc8O,EAAO5B,eACrB/sB,EAAEO,GAAGkD,KAAK,iBAAiB,GAAGwrB,QACvBpP,IAAc8O,EAAO3B,iBAC5BhtB,EAAEO,GAAGkD,KAAK,iBAAiB,GAAGwrB,iB,qDC5W3C,IAAMljB,EAAc,CACvBmjB,SAAU,WACVC,QAAS,UACTC,cAAe,gBACfC,aAAc,eACdC,KAAM,QAIGC,EAAY,CACrBC,gBAF0B,8B,qHCA9B,SAASC,EAA8BnlB,GACnC,GAA6B,aAAzBA,EAAMkH,OAAOke,SAAmD,UAAzBplB,EAAMkH,OAAOke,QAIxD,OAAQplB,EAAM8c,OACV,KAAKuI,WAE4C,IAAzC3vB,EAAE,4BAA4BK,QAC9BuI,cAAetC,WAM/B,SAASspB,EAAsBC,GAE3B7vB,EAAE,iCACGD,KAAK,UAAU,GACfkvB,SAEDa,mBAAgB9vB,EAAEuvB,qBAA2BQ,IAAIF,IACjD9d,QAAW8d,EAASG,aAAa,QAAShe,cAE1CD,QAAW8d,EAASG,aAAa,SAIzC,IAAIC,GAAuB,EACpB,SAASC,IACRD,IAGJA,GAAuB,EAEvBjwB,EAAE2E,SAASC,MAAMkC,IAAI,4BACe,MAAhC1D,OAAO+sB,wBACPP,EAAsBxsB,OAAO+sB,8BACtB/sB,OAAO+sB,uBAGlBnwB,EAAE2E,SAASC,MAAMsnB,GAAG,QAAS,KAAK,SAAS5hB,IAEnCsH,sBAAiBtH,IAC4B,MAA7CuE,KAAKmhB,aAAa,yBAC0B,aAA5CI,2BAAqBC,iBAAYxhB,SAEjCvE,EAAM+D,iBAENrO,EAAE2E,UAAUunB,GAAG,yBAA0BuD,GACzCG,EAAsB/gB,UAI9B7O,EAAE,oBAAoBksB,GAAG,SAAS,SAAS5hB,GACvC,IAAMgmB,EAAQtwB,EAAEsK,EAAMkH,SAClB+e,gBAAWD,EAAO,uBAAyB5pB,+BAG3CkC,cAAetC,cAKpB,IAAMwL,EAAc,CACvB0e,SADuB,WAEnB,OAAOxwB,EAAE2E,SAASC,MAAM6rB,GAAG,oBAE/BC,WAJuB,WAKnB,OAAO1wB,EAAE,uBAEb2wB,UAPuB,WAQnB,OAAO3wB,EAAE2E,WAEb/D,IAVuB,WAWnB,OAAOiO,KAAK2hB,WAAa3hB,KAAK8hB,YAAc9hB,KAAK6hB,cAErDE,YAbuB,WAcf/hB,KAAK2hB,WACLxwB,EAAE2E,SAASC,KAAKisB,eAAeC,UAAU,GAEzCjiB,KAAK6hB,aAAaI,UAAU,M,mGCjFlCC,G,SAAuBC,+BAA0B5oB,SAAS6oB,UAAUnuB,IACpEouB,EAAmD,MAAxBH,EAGpBrqB,EAAc,CACvByqB,YAAa/oB,SAAS6oB,SACbG,cAAehpB,SAASC,KACjC0oB,uBACAG,2BACAG,aAAc1sB,SAASjC,MAEvB4uB,sBAAuBJ,EACvBK,aAAa,GAmBV,SAASC,EAAT,GAAwD,IAAjCP,EAAiC,EAAjCA,SAAUQ,EAAuB,EAAvBA,OAC9Bhe,GAAOud,+BAA0BC,GACjC/qB,EAAYuN,GAAQA,EAAK3Q,GAG/B4D,EAAY4qB,sBAAqC,MAAbprB,EAChCQ,EAAY4qB,sBAtBb,SAAoBprB,EAAWwrB,GAAgD,IAAhCvqB,EAAgC,wDAAbC,EAAa,uCAC7EpH,EAAE2E,SAASC,MAAMoT,SAAS,eAE3B2Z,qBAAoB,WAChB3xB,EAAE2E,SAASC,MAAMmqB,SAAS,sBAC1BnmB,cAAe5B,OAAad,EAAWwrB,EAAgBvqB,EAAWC,IAClEV,EAAY6qB,aAAc,KAiB9BK,CAAW1rB,EAAWuN,EAAKxM,MAAM,EAAOwqB,GACjC/qB,EAAY6qB,cAZvB7qB,EAAY6qB,aAAc,EAC1B3oB,cAAetC,WAgBnBK,iBAAe6qB,I,kGC/CFxf,EAAY,CACrB6f,QAAS,EACTC,OAAQ,EACRC,SAAU,EACVC,SAAU,GAIP,SAASjgB,EAAW1J,GAMvB,GAJK9E,EAAEsP,MAAMof,OAAO5pB,MAChBA,EAAO,aAAH,OAAgBA,IAGW,aAA/B+nB,0BAAqB/nB,GAAqB,CAC1C,IAAMoL,GAAOud,+BAA0B3oB,GAElC3B,mBACDA,mBAA4B0B,SAASC,MAEzC1B,gBAAaC,mBAAc6M,EAAKpL,MAAO,WAexB,OADE6pB,EAXR7pB,KAeTD,SAASC,KAAO6pB,GAJjB,IAAkBA,EAPlB,SAASzrB,KACRD,qBAGJxG,EAAE2E,SAASC,MAAMutB,YAAY,wB,mPCbjC,Q,mJAhBuB7nB,GACfA,EAAM+D,iBACN/D,EAAMgE,kBACN1F,cAAetC,Y,+BAIf,OACI,uBAAK0E,UAAS,wBAAmB5H,OAAOyO,aAAe,qBAAuB,GAAhE,YAAsEzO,OAAOC,eAAiB,wBAA0B,IAAMP,GAAG,qBAC1I+L,KAAKtC,MAAMxC,SACZ,qBAAG1B,KAAK,IAAI2C,UAAU,WAAWqE,QAASR,KAAKujB,oBAA/C,c,GAXEziB,a,2JCkElB,IAAM0iB,EAAiB,GAEvB,SAASC,EAAkBC,EAAMnlB,GAC7BmlB,EAAKJ,YAAY,SAASA,YAAY,UACtCI,EAAKxD,SAAS3hB,EAAS,SAAW,SAGtC,SAASolB,EAAkBD,EAAMnlB,EAAQqlB,GAEjCF,EAAKG,OAAOvK,cAAc9M,QAAQ,UAAY,EAC9CkX,EAAKzuB,KAAL,+BAAkCsJ,EAAS,UAAa,UAGxDmlB,EAAKzuB,KAAL,+BAAkC2uB,IAYnC,SAASE,EAA2B7vB,EAAesK,EAAoBqlB,GAC1E,IAAMF,EAxDV,SAAgCzvB,GAC5B,GAAkB,iBAAPA,EAAiB,CACxB,IAAM8vB,EAAWP,EAAevvB,GAChC,GAAwB,WAApB,IAAO8vB,GACP,OAAO5yB,EAAE4yB,GACN,IAAiB,IAAbA,OAEJ,CACH,IAAMC,EAAS7yB,EAAE,yCAAD,OAA0C8C,EAA1C,eAChB,GAAI+vB,EAAOxyB,OAAS,EAAG,CACnB,IAAMyyB,GAAaC,iBACfF,EAAOryB,KAAI,SAAC2E,EAAG5E,GACX,OAAOP,EAAEO,GAAGyyB,QAAQ,oBAAoBpyB,IAAI,MAC7CqyB,WAEP,GAAIH,GAAcA,EAAWzyB,OAAS,EAAG,CACrC,IAAMkyB,EAAOvyB,EAAE8yB,EAAW,IAAIrvB,KAAK,kDACnC,GAAI8uB,EAAKlyB,OAAS,EAEd,OADAgyB,EAAevvB,GAAMyvB,EAAK,GACnBA,GAKnBF,EAAevvB,IAAM,IAgChBowB,CAAuBpwB,GAChCyvB,GAAQA,EAAKlyB,OAAS,IACtBiyB,EAAkBC,EAAMnlB,GACxBolB,EAAkBD,EAAMnlB,EAAQqlB,IC7FjC,SAASpoB,EAAuBC,GACnC,IAAMC,EAAWvK,EAAEsK,EAAME,eAAe/G,KAAK,MAC7C8G,EAASE,IAAI,cAAb,WAAiCF,EAASG,QAAU,EAAK,GAAzD,OAGJ,IAAMC,EAAa,SAAC,GAAD,QAAGC,YAAH,MAAU,GAAV,EAAcC,EAAd,EAAcA,QAASC,EAAvB,EAAuBA,SAAvB,OACf,qBAAGzC,KAAMuC,EAAKG,SACXC,UAAWC,IAAW,OAAQ,CAAEC,QAASJ,IACzCK,YAAad,EACbtF,MAAO8F,GACN,uBAAKvI,IAAI,+BACJyC,MAAO,CAAEqG,gBAAiB,OAAF,OAASR,EAAKU,WAAaV,EAAKuoB,kBAAhC,QAC7B,0BAAKvoB,EAAKY,UAAYZ,EAAKW,aAI7BK,EAAiB,CAAC,GAAI,IAAK,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAE3K,SAASH,EAAYC,EAAGC,GACpB,OAAS,MAALD,GAAkB,MAALC,GAGVD,EAAE5I,KAAO6I,EAAE7I,GAatB,SAAS+I,EAAeC,GACpB,OAAOA,EAAkBC,aAAuBA,YAEpD,SAASC,EAAwBC,GAE7B,OADwBA,EACAF,iBAA2BA,kBAEvD,SAASG,EAAmBC,EAAYC,GACpC,OAAmB,IAAfD,EACOC,EAAqB,EAErBA,EAAqB,E,OAoOR,0B,GAGR,wBAAMpB,UAAU,YA3LvBsB,GAAb,YAYI,WAAYC,GAAO,yBACf,4BAAMA,IADS,mCAQI,WAAM,IACjB6mB,EAAe,EAAKttB,MAApBstB,WACR,OAAqB,MAAdA,GAAqB3mB,4BAAuB2mB,EAAY,GAAK,OAVrD,6BAaF,SAAC1mB,GACd,QAAcC,IAAVD,EACA,EAAKE,eAAe,QACjB,GAAIF,EAAQd,EAAevL,OAAQ,CAEtC,IAAIwM,EAAOjB,EAAec,GAC1B1M,EAAE,EAAK8M,kBAAkBrC,IAAI,wBAA7B,UAAyDoC,EAAzD,OACAE,YAAW,WAAQ,EAAKH,eAAeF,EAAQ,KAAM,SAC9CA,GAASd,EAAevL,QAC/B,EAAK2M,SAAS,CAAEC,gBAAgB,OAtBrB,mCA0BI,SAACrC,EAAMjB,EAAOuD,GAAgB,IAY7CrC,EAVc9B,EACd,EAAKwD,MADLxG,WAAcgD,OAF+B,EAO7C,EAAKjD,MAFLsH,EAL6C,EAK7CA,OACAC,EAN6C,EAM7CA,YAGEC,EAAkB,IAAV3D,EACR4D,EAAO5D,IAAUuD,EAAc,EAGjCG,IAAgBtB,mBAA6BsB,IAAgBtB,cAEzDmB,GAAe,GAGXI,KAFJzC,EAAU2C,aAMPH,IAAgBtB,kBAA4BsB,IAAgBtB,cAC/DuB,EACAzC,EAAU2C,UACHD,IACP1C,EAAU2C,cA4BlB,QAtBKH,IAAgBtB,mBAChBsB,IAAgBtB,cACfqB,GAAUC,IAAgBtB,WAE5BpC,EANe,GAUf0D,IAAgBtB,aAEhBpC,GAZe,KAQfkB,EAAU2C,WASVH,IAAgBtB,WACfqB,GACD3B,EAAYb,EAAM7B,KAElB8B,EAAU2C,WAGP3C,KAhFQ,0BAmFL,YAxIlB,SAAqB1E,EAASwH,GAAoC,IAAtBC,EAAsB,uDAAR,SAAArK,GAAC,OAAIA,GACnD6J,EAAgCO,EAAhCP,OAAQgmB,EAAwBzlB,EAAxBylB,WAAYvlB,EAAYF,EAAZE,QACtB1B,GAAciB,EACdU,EAAkB5B,EAAmBC,EAAYinB,GAElDvlB,IACDD,EAAY,CACRR,OAAQjB,EAAY0B,SAAS,EAAMR,YAAaxB,EAAeM,KAGnEnM,EAAE+N,KAAK,CACH9G,KAAM,OACN+G,IAAK,sBACL1I,KAAM,CACFiD,WAAYpC,EAAQrD,GACpBuwB,OAAQlnB,EAAa,OAAO,YAGnCnK,MAAK,SAASiM,GACPA,EAAK1F,YAAc0F,EAAKqlB,SAAWlmB,GAGnC7F,WAAapB,EAAQkT,UAAM1M,EAAW,QAASR,GAC/C5E,WAAapB,EAAQkT,UAAM1M,EAAW,aAAcmB,GACpD6kB,EAA2BxsB,EAAQkT,KAAMlN,GAAYM,4BAAuBqB,IAE5EF,EAAY,CACRC,SAAS,EAAOT,OAAQjB,EAAYinB,WAAYtlB,EAAiBT,YAAarB,EAAwBG,MAI1GyB,EAAY,CAAEC,SAAS,EAAOT,SAAQgmB,aAAY/lB,YAAaxB,EAAeuB,QAGrFpM,MAAK,WAEF4M,EAAY,CAAEC,SAAS,EAAOT,SAAQgmB,aAAY/lB,YAAaxB,EAAeuB,SAqGlFc,CAAY,EAAK3B,MAAMpG,QAAS,EAAKL,OAAO,SAAAqI,GAAQ,EAAKnB,SAASmB,SApFnD,6CAuFc,SAAChI,GACf,MAAXA,IACAA,EAAU,EAAKoG,MAAMpG,SAtKjC,SAAyCkT,EAAzC,GAA6F,IAA5CjM,EAA4C,EAA5CA,OAAQgmB,EAAoC,EAApCA,WAAcxlB,EAAsB,uDAAR,SAAArK,GAAC,OAAIA,GACtFovB,EAA2BtZ,EAAMjM,GAAQX,4BAAuB2mB,IAChExlB,EAAY,CACRR,SACAgmB,aACAvlB,SAAS,EACTR,YAAatB,WAkKbwnB,CAAgCptB,EAAQkT,KAAM,CAAEjM,OAAQjH,EAAQmtB,MAAOF,WAAYjtB,EAAQitB,aAAe,SAAAjlB,GAAQ,EAAKnB,SAASmB,SA3FjH,+BA8FA,SAAC7D,GAChBA,EAAM+D,iBACN/D,EAAMgE,kBAFoB,IAGlBnI,EAAY,EAAKoG,MAAjBpG,QACR,GAAK,EAAKoG,MAAMxG,WAAWwI,SAA3B,CAJ0B,MAQkB,EAAKzI,MAAzCmH,EARkB,EAQlBA,eAAgBG,EARE,EAQFA,OARE,EAQMS,UAI3BT,GAAWH,GACZ,EAAKD,SAAS,CAAEC,gBAAgB,IAAQ,SAAA1J,GAAO,EAAKqJ,oBAGnDQ,GAGD1E,QAAG,UAAW,CAAEH,WAAYpC,EAAQrD,MAFpC4F,QAAG,QAAS,CAAEH,WAAYpC,EAAQrD,KAKtC,EAAKoL,oBAjBD9K,OAAOqL,eAAiBrL,OAAOqL,cAAc,KAAM,gBAAiBtI,EAAQrD,OAjGhF,EAAKgD,MAAQ,EAAK4I,mBAClB,EAAKC,oBAAsB,SAAAC,GACvB,EAAK9B,iBAAmB8B,GAJb,EAZvB,gEAEQ,MAAO,CACH3B,gBAAgB,EAEhBG,OAAQ,KACRS,SAAS,EACTulB,WAAY,KACZ/lB,YAAatB,cARzB,iDAoIQ8C,KAAK2kB,mCApIb,yCAuIuBC,GAAW,IAClBttB,EAAYstB,EAAZttB,QACFutB,EAAK7kB,KAAKtC,MAEZpG,EAAQrD,KAAO4wB,EAAGvtB,QAAQrD,IAAMqD,EAAQwB,YAAc+rB,EAAGvtB,QAAQwB,WACjEkH,KAAK2kB,+BAA+BrtB,KA5IhD,+BAgJa,IAsBD4I,EAtBC,SAIDF,KAAKtC,MAJJ,IAEDxG,WAAcwI,EAFb,EAEaA,SAAUxF,EAFvB,EAEuBA,OAFvB,IAGD5C,QAAWwtB,EAHV,EAGUA,YAAa/oB,EAHvB,EAGuBA,KAHvB,EASDiE,KAAK/I,MAHLsH,EANC,EAMDA,OACAH,EAPC,EAODA,eACAI,EARC,EAQDA,YAGE4B,EAAc,CAChBV,GAAYxF,EACZwF,IAAa9C,EAAY1C,EAAQ6B,IAASA,GAE7CsE,OACGykB,GACAA,EAAYrzB,QAAO,SAAA6O,GAAU,OAAK1D,EAAY0D,EAAYvE,KACvBa,EAAY0D,EAAYpG,OAE9DzI,QAAO,SAAAC,GAAC,OAAIA,KAGT8M,IAAgBtB,aAChBgD,EAAsB,MACf1B,IAAgBtB,cACvBgD,EAAsB,UAM1B,IAAMK,EAAuBH,EAAY5O,QAAU,EAAI,UAAY,QAEnE,OACI,uBAAK2K,UAAU,QACX,wBAAMA,UAAU,SACZ,qBAAGqE,QAASR,KAAKS,iBACdtE,UAAWC,IAAW,oCAAqC,CAAEmC,SAAQS,QAASZ,KAC7E,wBAAMsC,IAAKV,KAAKF,qBAAhB,IAEQE,KAAKW,wBALrB,IASA,wBAAMxE,UAAWC,IAAW,cAAe8D,EAAqBK,IAC3DH,EAAYzO,KAAI,SAACoK,EAAMjB,GACpB,IAAMmB,EAAWW,EAAYb,EAAM7B,GACnC,OACI,gBAAC4B,EAAD,CAAY8E,IAAK9F,EACLiB,KAAMA,EACNC,QAAS,EAAK6E,qBAAqB9E,EAAMjB,EAAOsF,EAAY5O,QAC5DyK,SAAUA,aApMlD,GAAiC6E,a,mBCtEjC,IAAMikB,IAAWC,WAAK,kBAAM,yD,GAmDF,4B,GAGJ,4BAnDTC,GAAb,oJAMS,IAASpqB,EAJVoI,mBACAiiB,0BAGUrqB,EAAisDtG,OAAO5B,QAAQ4B,OAAO4wB,OAAltDC,GAAGC,QAAQ,SAAS3zB,GAAG,IAAI4E,EAAE,CAACgvB,eAAe,KAAKC,OAAO,MAAM,IAAIzvB,SAAS0vB,eAAe,kBAAkB,CAAC,IAAI7Y,EAAE7W,SAAS2vB,MAAM3vB,SAAS4vB,qBAAqB,QAAQ,GAAwO3a,EAAEjV,SAASmhB,cAAc,OAAOlM,EAAE4a,UAAU,8QAAmDhZ,EAAEiZ,YAAY7a,EAAE8a,WAAW,IAAI,OAAOn0B,GAAGmJ,EAAE6kB,OAAOppB,EAAE5E,GAAGsO,KAAK3J,MAAK,WAAW,IAAI3E,EAAE,CAAC,kCAAkC,6BAA6B,sCAAsC,oDAAoD,SAAS,SAAS4E,EAAEgvB,gBAAgB5zB,EAAEmb,KAAKvW,EAAEgvB,gBAAgB,IAAI3Y,EAAE,iBAAiBrW,EAAEivB,SAAS5Y,EAAEA,EAAE,KAAKrW,EAAEivB,QAAQ,IAAI1oB,EAAEhC,EAAEmF,MAAMpL,KAAKlD,EAAEupB,KAAK,OAA+Bpe,GAAzBA,EAAEA,EAAEipB,IAAI,kBAAqBA,IAAInZ,IAAKtW,MAAK,WAAW,IAAI3E,EAAEmJ,EAAEmF,MAAM,KAAKtO,EAAEq0B,QAAQpZ,GAAGnb,OAAO,GAAG,UAAUwO,KAAK6gB,QAAQvH,eAAe5nB,EAAEs0B,OAAO,UAAUx0B,QAAQE,EAAEs0B,OAAO,8BAA8Bx0B,QAAQ,CAACE,EAAEkK,IAAI,WAAWlK,EAAEkK,IAAI,WAAWoI,MAAMtS,EAAER,KAAK,aAAa8S,MAAMtS,EAAER,KAAK,YAAYQ,EAAER,KAAK,SAAS,GAAGQ,EAAER,KAAK,QAAQ,KAAK,IAA2N6Z,GAArN,WAAW/K,KAAK6gB,QAAQvH,eAAe5nB,EAAER,KAAK,YAAY8S,MAAMtB,SAAShR,EAAER,KAAK,UAAU,KAAKwR,SAAShR,EAAER,KAAK,UAAU,IAAIQ,EAAEu0B,WAAWjiB,MAAMtB,SAAShR,EAAER,KAAK,SAAS,KAAKQ,EAAEmK,QAAQ6G,SAAShR,EAAER,KAAK,SAAS,KAAU,IAAIQ,EAAER,KAAK,QAAQ,CAAC,IAAImb,EAAE,SAASxR,EAAEuqB,GAAGC,QAAQa,OAAOx0B,EAAER,KAAK,OAAOmb,GAAGxR,EAAEuqB,GAAGC,QAAQa,SAASx0B,EAAEmD,KAAK,iDAAiDmxB,OAAO,8BAA8BpqB,IAAI,cAAc,IAAImP,EAAE,KAAKrZ,EAAEy0B,WAAW,UAAUA,WAAW,iBAAetrB,EAAEuqB,GAAGC,QAAQa,OAAO,EAExsD/0B,EAAE,kBAAkBk0B,YAR5B,yCAWuBT,GACf,IAAMwB,EAAKxB,EAAUttB,QACf+uB,EAAKrmB,KAAKtC,MAAMpG,QAEZ,MAAN+uB,IACKD,GAAMA,EAAGnyB,KAAOoyB,EAAGpyB,MACfqyB,4BACDn1B,EAAE,6BAA6BD,KAAK,YAAa,GAAGq1B,QAExDtjB,mBAGAjD,KAAKtC,MAAMxG,WAAWgD,OAAOssB,gBAC7Br1B,EAAE,QAAQ+uB,SAAS,SAEnB/uB,EAAE,QAAQmyB,YAAY,YA1BtC,+BA+Ba,MACuCtjB,KAAKtC,MAAzCpG,EADH,EACGA,QAAuB4C,EAD1B,EACYhD,WAAcgD,OAsB/B,OAnBIrC,2BACe,MAAXP,EAEI,2BACK4C,EAAOssB,iBAAmB,gBAAC,MAAgBxmB,KAAKtC,OACjD,gBAAC+oB,GAAYzmB,KAAKtC,OAClB,uBAAKvB,UAAW,aACZ,gBAAC,MAAD,OAAe6D,KAAKtC,MAApB,CAA2B0K,cAAe7T,OAAOyO,gBACjD,gBAAC,MAAgBhD,KAAKtC,SAKxB,GAGJ,OAnDtB,GAAoCoD,aA0DpC,UAAe4lB,SA3Ef,SAAyBzvB,GAAO,IACtBC,EAAsDD,EAAtDC,WADsB,EACgCD,EAA1CK,QAAWb,EADD,EACCA,KAAMe,EADP,EACOA,WAAYnF,EADnB,EACmBA,OAM/C,OAJIoE,GAAQA,EAAKf,SAAWnB,OAAOkB,0BAC/BgB,EAAKf,QAAUnB,OAAOkB,wBAAwBgB,EAAKf,UAGhD,CACHwB,aACA7E,SACAiF,QAASb,EACTe,gBAgER,CAAwCytB,I,OAsNA,4B,GAEF,4BAtNhCwB,G,YAKF,WAAY/oB,GAAO,yBACf,4BAAMA,IADS,mBAJX,CACJipB,eAAgB,GAChBC,cAAc,IAEC,iCAuBE,SAACnrB,GAClB,IAAIqO,EAAQ3Y,EAAEsK,EAAMkH,QACpB,GAAIpO,OAAOC,gBACP,GAAIsV,EAAM8X,GAAG,sBAAuB,CAChCnmB,EAAM+D,iBACN,IAMIgJ,EANEqe,EAAW/c,EAAMqa,QAAQ,YACzB2C,EAAUD,EAASjyB,KAAK,WACxBmyB,EAAMF,EAASjyB,KAAK,mBAAmBpD,OACvCw1B,EAAa71B,EAAE,YAAY2J,MAAMgP,EAAMqa,QAAQ,aAC/C8C,EAAgB,eAAH,OAAkBD,EAAlB,qBAGfE,EAAS,EACTpd,EAAM8X,GAAG,eACTpZ,EAAMqe,EAASjyB,KAAK,2BAA2BkG,MAAMmsB,GACrDC,GAAU,GACHpd,EAAM8X,GAAG,eAChBpZ,EAAMqe,EAASjyB,KAAK,2BAA2BkG,MAAMmsB,GACrDC,EAAS,GAET1e,EAAMsB,EAAMhP,MAAMmsB,IAEtBze,GAAO0e,GACG,EACN1e,EAAMue,EAAM,EACLve,GAAOue,EAAM,IACpBve,EAAM,GAEVse,EACKlyB,KAAK,aAAa0uB,YAAY,WAAW6D,MACzCvyB,KAFL,qBAEwB4T,EAFxB,MAEgC0X,SAAS,WACzC2G,EACKjyB,KAAK,aAAa0uB,YAAY,UAAU6D,MACxCvyB,KAFL,gBAEmB4T,EAFnB,MAE2B0X,SAAS,gBAGxC,GAAIpW,EAAM8X,GAAG,qCAAsC,CAC3C9X,EAAM8X,GAAG,uDACTnmB,EAAM+D,iBAENsK,EAAM8X,GAAG,mBACT9X,EAAQA,EAAMqa,QAAQ,OAG1B,IAAI0C,EAAW/c,EAAMqa,QAAQ,YACzB2C,EAAUD,EAASjyB,KAAK,WAExB4T,EAAMsB,EAAMhP,QAChBgsB,EAAQlyB,KAAK,aAAa0uB,YAAY,WAAW6D,MAAMvyB,KAAK,QAAU4T,EAAM,KAAK0X,SAAS,WAC1F2G,EAASjyB,KAAK,aAAa0uB,YAAY,UAAU6D,MAAMvyB,KAAK,SAAW4T,EAAM,KAAK0X,SAAS,UAC3F,IAAI9W,EAAO,EAEPA,EADO,GAAPZ,EACO,EACAA,GAAOqe,EAASjyB,KAAK,MAAMpD,OAAS,EACpCq1B,EAAShrB,QAAUgrB,EAASjyB,KAAK,eAAeiH,SAGlDgrB,EAAShrB,QAAUgrB,EAASjyB,KAAK,SAAW4T,EAAM,KAAK3M,SAAW,EACnEgrB,EAASjyB,KAAK,SAAW4T,EAAM,KAAK4e,WAAWhe,KAEvDyd,EAASjyB,KAAK,eAAegH,IAAI,OAAQwN,EAAO,UAnFzC,kCAwFG,SAAC3N,EAAOqO,GAC1B,IAAIud,EAASvd,EAAMqa,QAAQ,YACvBkD,EAAO5wB,KAAK,aACZgF,EAAM+D,kBAEN6nB,EAAOC,aAAa,CAAEC,aAAc,EAAG7Y,QAAQ,IAC/CxQ,YAAW,WACP4L,EAAMsW,UACP,SAhGQ,iCAoGE,SAAC3kB,GAClB,IAAIqO,EAAQ3Y,EAAEsK,EAAMkH,QAChBmH,EAAM8X,GAAG,cACT,EAAK4F,mBAAmB/rB,GACjBqO,EAAM8X,GAAG,sBAChB,EAAK6F,sBACE3d,EAAM8X,GAAG,uCAChB,EAAK8F,oBAAoBjsB,EAAOqO,MA3GrB,8BAwHD,WACd,EAAK3L,SAAS,CAAEwpB,qBAAsB52B,KAAKuR,IAAI,EAAKrL,MAAM0wB,qBAAuB,EAAG,QAzHrE,8BA4HD,WACd,EAAKxpB,SAAS,CAAEwpB,qBAAsB52B,KAAK0R,IAAI,EAAKxL,MAAM0wB,qBAAuB,EAAG,EAAK1wB,MAAM0vB,eAAen1B,OAAS,QA7HxG,0BAgIL,WACV,EAAK2M,SAAS,CAAEyoB,cAAc,OAjIf,mCAoII,SAACpe,GACpB,EAAKrK,SAAS,CAAEwpB,qBAAsBnf,OAnIH,IAA/BrX,EAAE,kBAAkBK,SACpBL,EAAE2E,SAAS2vB,MAAM3wB,OACb,mVAGA3D,EAAE,QAAQywB,GAAG,oBACbzwB,EAAE,qCAAqCy2B,QARhC,E,kEAefhd,SAAYid,cAAqB7nB,OAC7BzL,OAAOC,gBACP0J,YAAW,WACP/M,EAAE,sBAAsBm2B,aAAa,CAAEC,aAAc,EAAG7Y,QAAQ,MACjE,Q,4CA8FP1O,KAAK7B,SAAS,CACVyoB,cAAc,EACde,qBAAsB,EACtBhB,eAAgBx1B,EAAE,aAAaizB,UAAUzyB,KAAI,SAACD,GAAD,MAAQ,CAAE+B,IAAKtC,EAAEO,GAAG+E,KAAK,e,+BAoBrE,IAGDqxB,EAHC,EAC6E9nB,KAAKtC,MADlF,IACGxG,WAAc6wB,EADjB,EACiBA,2BAA4B7tB,EAD7C,EAC6CA,OAAQwF,EADrD,EACqDA,SAAYpI,EADjE,EACiEA,QAGlE0wB,EAAc,GAIlB,GAHI1wB,EAAQgQ,cACR0gB,EAAc1wB,EAAQgQ,YAAYnI,KAElC8oB,mCAAiC3wB,GAAU,CAC3C,IAAM4wB,EAAa,CACfC,OAAQ7wB,EACR0E,SAAS,EACTosB,SAAU9wB,EAAQ+wB,YAAYD,WAAY,EAC1CE,0BAA2BP,GAE3BC,IACAE,EAAWK,OAASP,GAExBF,EAAQ,gBAAC,EAAAG,MAAUC,GAGvB,IAAMM,EACF,uBAAKrsB,UAAU,iBACX,uBAAKlI,GAAG,aAAakI,UAAU,sBAC1B2rB,GACCA,GACE,uBAAK3rB,UAAU,SACX,uBAAKlI,GAAG,WAAWR,IAAKu0B,OAMtCS,EACFnxB,EAAQnD,SACRmD,EAAQnD,QAAQu0B,SAChB,uBAAKvsB,UAAU,SAASnB,wBAAyB,CAAEC,OAAQ3D,EAAQnD,QAAQu0B,WAG/E,OACI,uBAAKz0B,GAAG,UAAUkI,UAAU,4BACtB5H,OAAOC,gBAAkBg0B,EAE3B,uBAAKrsB,UAAU,QACX,sBAAIA,UAAU,SAAQ,yBAAI7E,EAAQzD,OAAlC,IAA6C,6BAAQyD,EAAQjD,UAC5DE,OAAOC,gBAAkBi0B,EACzBl0B,OAAOC,gBAAkB8C,EAAQqxB,cAC9B,uBAAKxsB,UAAU,yBACXysB,IAAWtxB,EAAQqxB,cAAgB,IAAIxR,KAAM,kBAGpD5iB,OAAOyO,aAAe,KAAO,gBAACvF,GAAgBuC,KAAKtC,OACpD,uBAAKvB,UAAU,eACX,gBAAC,EAAAiL,UAAD,CAAWnB,WAAW,UAAUC,SAAU5O,EAAQrD,GAAIyL,SAAUA,EAAU7L,MAAOyD,EAAQzD,MAC1EsS,eAAgBjM,EAAOkM,SAAUyiB,eAAe,EAAMC,kBAAkB,IACtFxxB,EAAQnD,SACLmD,EAAQnD,QAAQ40B,eACfr0B,EAAEs0B,SAAS1xB,EAAQnD,QAAQ40B,cAAclF,OACtCvsB,EAAQnD,QAAQ40B,cAAclF,KAAKpX,QACvC,qBAAGjT,KAAI,UAAKlC,EAAQnD,QAAQ40B,cAAcE,MAAQ9sB,UAAU,YACvD7E,EAAQnD,QAAQ40B,cAAclF,MAEtCtvB,OAAOyO,aAAe,gBAACvF,GAAgBuC,KAAKtC,OAAY,OAGhEnJ,OAAOC,gBAAkBg0B,EAC1B,uBAAKrsB,UAAU,qBACT5H,OAAOC,gBAAkBi0B,EAC3B,uBAAKztB,wBAAyB,CAAEC,OAAQ3D,EAAQ5B,SAAW8K,QAASR,KAAKkpB,sBAE5E30B,OAAOC,gBACJ,gBAAC,EAAA20B,SAAD,CAAUC,SAAQ,IACd,gBAACrE,GAAD,CACIqE,SAAQ,GACRz1B,OAAQqM,KAAK/I,MAAM0vB,eACnB0C,OAAQrpB,KAAK/I,MAAM2vB,aACnB0C,eAAe,EACfC,gBAAgB,EAChBC,aAAcxpB,KAAK/I,MAAM0wB,qBACzB8B,YAAazpB,KAAK0pB,gBAClBC,YAAa3pB,KAAK4pB,gBAClBC,QAAS7pB,KAAK8pB,YACdC,iBAAkB/pB,KAAKgqB,6B,GA/N7BlpB,a,GChEE,gBAACmpB,EAAA,EAAD,CAAOC,KAAK,cAAcC,UAAWlF,KAgBzDmF,IAAS,EACTC,GAAQC,aAAY,WAChBF,IAGA71B,OAAOpD,GAA6B,YAAxB2E,SAASy0B,aACrBH,IAAS,EACTI,cAAcH,IApCP,WACXI,EAAQ,MACR,IAAMC,GAA0BC,oBAAe,oBACzCC,EAA2Bz5B,EAAEu5B,GAC/BE,EAAyBzhB,SAAS,SAClCyhB,EAAyB30B,QACzB20B,EAAyBtH,YAAY,SAEzCuH,YACI,gBAAC,KAAD,CAAU9wB,MAAOA,KACb,gBAAC+wB,EAAA,EAAD,CAAQhzB,QAASA,WACb,gBAAC,EAAD,KACI,gBAACizB,EAAA,EAAD,QAEI,gBAACd,EAAA,EAAD,CAAOC,KAAK,IAAIC,UAAW,kBAAM,YAKjDO,GACA,WACI5yB,iBAAe6qB,OACfA,QAAY,CAAEP,SAAU7oB,SAAS6oB,SAAUQ,OAAQrpB,SAASqpB,UAC5DvB,YAcJ2J,MAEL,M,gFC9CHC,wBAAmBC,OAAS,CACxBC,SAAU,kBAAMpxB,gBAChBrB,UACAwK,kB,yFCVG,SAASkoB,EAAqBC,GACjC,OAAOA,GACP,IAAK,aACD,MAAO,CACHl0B,SAAS,EACT+C,OAAQ,GACRwF,SAAU,KACV4rB,YAAa,MAErB,IAAK,UACD,MAAO,CACH70B,KAAM,KACNc,GAAI,KACJyC,UAAW,KACXxC,WAAY,KACZnF,OAAQ,QAEhB,QACIG,QAAQC,KAAK,kDAAmD44B,IAIxE,IAAIE,EAAW,CACX,UACA,c,cCjBEC,EAAa,SAAAtxB,GAAM,QAAKmB,aAAQnB,IAAwB,MAAbA,EAAOjG,IAEpDm2B,GAAS,EACTrC,EAA6B,EA4CjC,SAAS0D,EAAuBC,GAC5BA,EAAY1sB,SAAqC,IAA3B0sB,EAAYC,WAClCD,EAAYE,SAAUC,wBAAmBtyB,SAASC,MAClDkyB,EAAYI,MAAQJ,EAAY3vB,KAwCpC,SALoBgwB,QAAgB,CAChC70B,WAlFJ,WAAwE,IAApDD,EAAoD,uDAA5Cm0B,EAAqB,cAAe5G,EAAQ,uCACpE,OAAQA,EAAOpsB,MACf,KAAK6B,iBACD,OAAO+xB,mBAAc/0B,EAAO,CACxBE,SAAS,IAEjB,KAAK8C,kBAGD,OAFA8tB,EAA6B,EAC7BqC,GAAS,GACF4B,mBAAc/0B,EAAO,CACxBE,SAAS,EACT4wB,+BAER,KAAK9tB,uBACD,OAAO+xB,mBAAc/0B,EAAOutB,EAAOyH,SACvC,KAAKhyB,kBAQc,IAAXmwB,GACArC,IAA+BvD,EAAO/tB,KAAKxC,KAE3C8zB,EAA6BvD,EAAO/tB,KAAKxC,IAE7C,IAAMiG,EAASsqB,EAAO/tB,KAAKyD,QAAU3F,OAAO2F,QAAU,GAChDwF,EAAW8rB,EAAWtxB,GACtBoxB,EAAc9G,EAAO/tB,KAAKy1B,sBAAwBj1B,EAAMq0B,YAM9D,OAJAnxB,OAAY,WAAYuF,IACxBvF,OAAY,SAAUD,GACtBkwB,GAAS,GAEFtP,YAAO7jB,EAAO,CAAE8wB,6BAA4BroB,WAAUxF,SAAQoxB,gBAEzE,QACI,OAAOr0B,IA4CXK,QAjCJ,WAAkE,IAAjDL,EAAiD,uDAAzCm0B,EAAqB,WAAY5G,EAAQ,uCAC9D,OAAQA,EAAOpsB,MACf,KAAK6B,iBAED,OADAwxB,EAAuBjH,EAAO/tB,OACvBu1B,mBAAc/0B,EAAO,CACxBR,KAAM+tB,EAAO/tB,KACbpE,OAAQmyB,EAAOnyB,OACfkF,GAAIitB,EAAOjtB,GACXyC,UAAW,KACXxC,YAAY,IAEpB,KAAKyC,oBACD,OAAO6gB,YAAO7jB,EAAO,CACjB+C,UAAWwqB,EAAOxqB,UAClB3H,OAAQmyB,EAAOnyB,OACfmF,YAAY,IAEpB,KAAKyC,4BACD,OAAO6gB,YAAO7jB,EAAO,CACjB5E,OAAQmyB,EAAOnyB,OACfmF,YAAY,IAIpB,KAAKyC,kBACD,OAAO+xB,mBAAcZ,EAAqB,YAC9C,QACI,OAAOn0B,MCnFf,IAE+Bk1B,EAFzBC,EAAa,CAACC,KCDpB,SDG+BF,EFqBpBZ,EAASr2B,QAAO,SAAC+B,EAAOq1B,GAE3B,OADAr1B,EAAMq1B,GAAclB,EAAqBkB,GAClCr1B,IACP,KEvBJs1B,QAAYC,EAAaL,EAAcM,gBAAA,EAAmBL,M,qEESW73B,OAAjEm4B,E,EAAAA,MAAOC,E,EAAAA,YAAwBC,G,EAAXC,U,EAAWD,eAAeE,E,EAAAA,eAE/C,SAASroB,EAAT,GAYJ,IAXCF,EAWD,EAXCA,QACAC,EAUD,EAVCA,aACA5K,EASD,EATCA,IACAoH,EAQD,EARCA,QACAC,EAOD,EAPCA,IAQA,GAAe,MAAXsD,EAAJ,CAGA,GAAW,MAAP3K,EAAa,CACb,IAAMD,GAAyBR,yBAAoB,OAC/CQ,IACAC,EAAMD,EAAuB,IAGrC,IAAM2K,EAAM,CACR,UAAWC,EACXtD,IAAKA,GAAO,aACZrH,IAAKA,GAELoH,IACAsD,EAAItD,QAAUA,GAEdwD,GAAgBD,IAAYC,IAC5BF,EAAI,aAAeE,GAEvB,IACIjQ,OAAOo4B,aAAeA,EAAY,cAAeroB,GACnD,MAAO5S,IACT,OAAO4S,GAGJ,SAASS,EAAcd,EAAO3S,EAAUsT,GAa3C,OAXAX,EAAM2oB,cAAgBA,EAClBr4B,OAAOs4B,WACPt4B,OAAOs4B,UAAUhgB,KAAK,CAClBpR,MAAO,qBACPsxB,WAAY9oB,EAAK,aACjBG,UAAWH,EAAK,UAChB5S,cAAUyM,EACVkvB,mBAAelvB,EACfmvB,aAASnvB,IAGV3M,EAAE+N,KAAK,CACV9G,KAAM,OACN+G,IAAK,yBACL1I,KAAMwN,IAET9Q,MAAK,SAAAiM,GACF,GAAKA,GAA4B,MAApBA,EAAKyD,YAGlB,GAAyB,IAArBzD,EAAKyD,YAAmB,CACpB+B,GACAkoB,EAAeprB,UAAU,CAAC,CACtBzN,GAAIgQ,EAAMX,aACV4pB,MAAOtoB,EAAKE,WACZlO,KAAMgO,EAAK/Q,MACXyN,SAAU2C,EAAM3C,SAChBvN,MAAO6Q,EAAK7Q,MACZo5B,QAAS/tB,EAAK4C,UAGtB,IAAIorB,EAAY,CACZ,SAAYnpB,EAAMtE,SAClB,SAAYP,EAAKiuB,SACjB,oBAAuBjuB,EAAK3C,UAC5B,SAAY2C,EAAKkuB,SACjB,SAAWluB,EAAKkC,SAChB,MAASlC,EAAKrL,MACd,QAAWqL,EAAK4C,OAChB,SAAY5C,EAAKlD,SACjB,QAAWkD,EAAKmuB,SAEhBnuB,EAAKouB,cACLJ,EAAKK,YAAcruB,EAAKouB,aAE5Bd,EAAMgB,KAAKC,QAAQP,GACnBV,EAAMgB,KAAKE,iBACgB,GAApBxuB,EAAKyD,aACTzD,EAAKsE,SACJnR,MAAM6M,EAAKsE,YAItBmqB,QAAO,WAAav8B,GAAYA","file":"OverlayArticle.main.110fbaf2d92f23ad5ce4.js","sourcesContent":["/* BEWARE: this code is directly imported via mobile article.new.html, use ES5 */\nvar ImageModes = {\n    Full: 'Full',\n    Normal: 'Normal',\n    Quoted: 'Quoted',\n    Grid: 'Grid',\n};\n\nfunction getRandomId() {\n    return 'shortcode-' + String(Math.random()).substr(2)\n}\n\nfunction getJumper($element) {\n    var _id = getRandomId();\n    $element.attr('id', _id);\n    return function () {\n        return $('#' + _id)\n    }\n}\n\nfunction jQueryPromiseAll(arrayOfPromises) {\n    return jQuery.when.apply(jQuery, arrayOfPromises).then(function() {\n        return Array.prototype.slice.call(arguments, 0);\n    });\n}\nfunction getProductContext(products, callback) {\n    if (products.length > 0) {\n        jQueryPromiseAll(products.filter(function(e){ return e }).map(function(sid) {\n            var dfd = $.Deferred()\n            $.get('/rest-api/v1/things/' + sid + '?sales=true&include_every_image=true')\n                .then(function(thing) {\n                    dfd.resolve(thing);\n                })\n                .fail(function(xhr) {\n                    if (xhr.status === 404) {\n                        alertify.alert('Product id ' + sid + 'not found.');\n                    } else {\n                        console.warn('There was an error whiel fetching sid:', sid, xhr)\n                    }\n                    dfd.resolve(null);\n                });\n            return dfd.promise()\n        }))\n        .done(function(things) {\n            var ctx = {\n                items: things.map(function(thing){\n                    var image_fit_to_bounds = false;\n                    var image = thing.image.src;\n                    try {\n                        image_fit_to_bounds = thing.sales.images[0].fit_to_bounds;\n                        image = thing.sales.images[0].src;\n                    } catch(e) {}\n                    return thing.sales && { title: thing.sales.emojified_name, price: thing.sales.price, retail_price: thing.sales.retail_price, image: image, image_fit_to_bounds: image_fit_to_bounds, id: thing.sales.id }\n                }).filter(function(e){ return e })\n            };\n            callback(ctx);\n        })\n    } else {\n        console.warn('[ShortCodeTransformers]: Error - product does not exist');\n    }\n}\n\nfunction getTemplateByImageMode(imageMode) {\n    switch (imageMode) {\n        case ImageModes.Grid:\n            return (\n                '<div class=\"grid\"><img src=\"/_ui/images/common/blank.gif\"  alt=\"<%= image.caption %>\" class=\"\" style=\"background-image:url(\\'<%= image.src %>\\');\" data-src=\"<%= image.src %>\"><% if (image.caption) { %><figcaption class=\"text-placeholder\"><%= image.caption %></figcaption><% } %></div>'\n            )\n        case ImageModes.Full:\n            return (\n                '<figure class=\"mode-full\"><img src=\"<%= image.src %>\" alt=\"<%= image.caption %>\"></figure>'\n            );\n        case ImageModes.Quoted:\n            return (\n                '<figure class=\"mode-quoted\"><p><img src=\"<%= image.src %>\" alt=\"<%= image.caption %>\"></p><p class=\"textarea\"><%= image.caption %></p></figure>'\n            );\n        case ImageModes.Normal:\n        default:\n            return (\n                '<figure class=\"mode-normal\"><img src=\"<%= image.src %>\" alt=\"<%= image.caption %>\"></figure>'\n            );\n    }\n}\n\nvar ShortCodeTransformers = {};\n/* \n<% {\"name\": fancy-article-gallery,\n    \"images\": [{ src: \"https://img-address-1\", caption: \"An image caption\", uiid: 1 }, ... ],\n    \"title\": \"a gallery title\",\n    \"tagline\": \"a gallery tagline\"} %>\n*/\nShortCodeTransformers['fancy-article-gallery'] = function(options, $shortcode) {\n    var images  = options.images;\n    var title   = options.title;\n    var tagline = options.tagline;\n    var markup = '';\n        markup += '<div class=\"gallery\">'\n        markup +=   '<h3><span><%= title %></span><small class=\"tagline\"><span><%= tagline %></span></small></h3>'\n        markup +=   '<ul class=\"photo-list\">'\n        markup +=     '<% _.each(images, function(image, idx) { %>'\n        markup +=       '<li class=\"<%= idx === 0 ? \\'active\\' : \\'\\' %>\"><a href=\"<%= image.link %>\" <%= image.link ? \"rel=\\'noopener\\' target=\\'_blank\\' class=\\'linked\\'\" : \"onclick=\\'return false;\\'\" %>><img src=\"<%= image.src %>\"></a><span><%= image.caption %></span></li>'\n        markup +=     '<% }) %>'\n        markup +=   '</ul>'\n        markup +=   '<div class=\"paging\">'\n    if (window.isWhitelabelV2) {\n        markup +=     '<div class=\"btn\"><a class=\"prev\"></a><a class=\"next\"></a></div>'\n    }\n        markup +=     '<% _.each(images, function(e, idx) { %> '\n        markup +=       '<a href=\"#\" class=\"<%= idx === 0 ? \\'current\\' : \\'\\' %> pager\"><%= idx + 1 %></a>'\n        markup +=     '<% }) %>'\n        markup +=   '</div>'\n        markup += '</div>'\n\n    var $next = $(_.template(markup)({ images: images, title: title, tagline: tagline }));\n    if (window.isWhitelabelV2) {\n        $next.find('img').wrap('<span class=\"figure\" />');\n        $next = $('<div class=\"gallery-container\" />').append($next);\n    }\n    $shortcode.replaceWith($next.prop('outerHTML'));\n};\n/*\n<% {\"name\": \"fancy-article-img\",\n    \"images\": [{\n        \"mode\": \"Quoted\",\n        \"src\": \"https://img-address\",\n        \"caption\": \"A image caption\",\n    }]\n   } %>\n*/\nShortCodeTransformers['fancy-article-img'] = function(options, $shortcode) {\n    var images = options.images;\n    var html = images.reduce(function(prev, image) {\n        return prev + _.template(getTemplateByImageMode(image.mode))({ image: image });\n    }, '');\n    if (images[0] && images[0].mode === ImageModes.Grid) {\n        html = ('<figure class=\"mode-grid\">' + html + '</figure>')\n    }\n    $shortcode.replaceWith(html);\n};\n\nShortCodeTransformers['fancy-article-product'] = function(options, $shortcode) {\n    var items  = options.products;\n    const getIsolatedShortcodeElement = getJumper($shortcode)\n    getProductContext(items, function (ctx) {\n    var markup = '';\n        markup += '<ul class=\"itemList product\">'\n        markup += '<% items.forEach(function(item) { %>'\n        markup +=   '<li class=\"itemListElement\" data-id=\"<%= item.id %>\">'\n        markup +=     '<a href=\"<%= item.html_url %>?utm=article\">'\n        markup +=     '<span class=\"figure <% if (item.image_fit_to_bounds) { %>fit<% } %>\">'\n        markup +=       '<img src=\"/_ui/images/common/blank.gif\" style=\"background-image:url(<%= item.image %>)\">'\n        markup +=     '</span>'\n        markup +=     '<span class=\"figcaption\">'\n        markup +=       '<span class=\"title\"><%= item.title %></span>'\n        markup +=       '<% if (item.retail_price != null) { %><b class=\"price sales\">$<%= item.price %> <small class=\"before\">$<%= item.retail_price %></small></b><% } else { %><b class=\"price\">$<%= item.price %></b><% } %>'\n        markup +=     '</span>'\n        markup +=   '</li>'\n        markup += '<% }); %>'\n        markup += '</ul>'\n        var next = _.template(markup)(ctx);\n        getIsolatedShortcodeElement().replaceWith(next);\n    });\n};\n\nShortCodeTransformers['fancy-article-product-slideshow'] = function(options, $shortcode) {\n    var items  = options.products;\n    const getIsolatedShortcodeElement = getJumper($shortcode)\n    getProductContext(items, function(ctx) {\n    var markup = '';\n        markup += '<div class=\"itemSlide product\">'\n        markup +=   '<div class=\"itemSlideWrap\">'\n        markup +=     '<ul class=\"stream after\">'\n        markup +=       '<% items.forEach(function(item) { %>'\n        markup +=       '<li class=\"itemSlideElement\">'\n        markup +=         '<div class=\"figure-item\">'\n        markup +=           '<figure <% if (item.image_fit_to_bounds) { %>class=\"fit\"<% } %>><a href=\"<% if (item.html_url) { %><%= item.html_url %><% } else { %>/sales/<%= item.id %>?utm=article<% } %>?utm=article\">'\n        markup +=             '<span class=\"back\"></span>'\n        markup +=             '<img class=\"figure\" src=\"/_ui/images/common/blank.gif\"'\n        markup +=                  'style=\"background-image: url(<%= item.image %>);\">'\n        markup +=           '</a></figure>'\n        markup +=           '<figcaption>'\n        markup +=             '<span class=\"show_cart\">'\n        markup +=               '<button class=\"btn-cart nopopup soldout\">'\n        markup +=                 '<% if (item.retail_price != null) { %><b class=\"price sales\">$<%= item.price %> <small class=\"before\">$<%= item.retail_price %></small></b><% } else { %><b class=\"price\">$<%= item.price %></b><% } %>'\n        markup +=               '</button>'\n        markup +=             '</span>'\n        markup +=             '<a href=\"<%= item.html_url %>?utm=article\" class=\"title\"><%= item.title %></a>'\n        markup +=           '</figcaption>'\n        markup +=         '</div>'\n        markup +=       '</li>'\n        markup +=       '<% }); %>'\n        markup +=     '</ul>'\n        markup +=   '</div>'\n        markup +=   '<a href=\"#\" class=\"prev\">Prev</a>'\n        markup +=   '<a href=\"#\" class=\"next\">Next</a>'\n        markup += '</div>'\n\n        var next = _.template(markup)(ctx);\n        getIsolatedShortcodeElement().replaceWith(next);\n    });\n};\n\nfunction getWrappedSingleNode(target) {\n    return $('<div class=\"singlenode-wrapper\">' + target + '</div>');\n}\n\nfunction convertShortcode(content) {\n    var $wrapped = getWrappedSingleNode(content);\n    var $disposable = mountToDisposable($wrapped);\n\n    $wrapped.find('p.shortcode').each(function(i, shortcode) {\n        var $sc = $(shortcode);\n        try {\n            var data = JSON.parse($sc.attr('data-internal'));\n            ShortCodeTransformers[data.name](data, $sc);\n        } catch(e) { console.warn(e) }\n    });\n\n    $disposable.remove();\n    return $wrapped.html();\n}\nwindow.convertArticleShortcode = convertShortcode;\n\nfunction mountToDisposable(unmountedDOM) {\n    // Create/Select disposable mounting DIV to correctly modify a element.\n    let $disposable = $(document.body).find('.disposable');\n    if ($disposable.length > 0) {\n        $disposable = $disposable.eq(0).empty();\n    } else {\n        $disposable = $('<div />', { id: 'disposable', style: 'display:none;'}).appendTo(document.body);\n    }\n\n    if (unmountedDOM) {\n        // Append unmounted DOM if exists\n        $disposable.append(unmountedDOM);\n    }\n    // return disposable DOM\n    return $disposable;\n}\n","// Generate `key: String(key)` structure by given string key arguments\nfunction constantGen() {\n    var keys = [].slice.call(arguments);\n    return keys.reduce((prev, next) => {\n        prev[next] = next;\n        return prev;\n    }, {});\n}\n\nvar C = constantGen(\n  'UPDATE_APP_CONTEXT',\n  // Loading\n  'REQUEST_ARTICLE',\n  'REQUEST_ARTICLE_FAILURE',\n  'LOAD_ARTICLE',\n\n  // UI Actions\n  'OPEN_ARTICLE',\n  'CLOSE_ARTICLE',\n\n);\n\nexport default C;\n","import { MP, getLocationArgPairs, isStaticPage, stripPathname } from 'fancyutils';\n\nimport { historyData } from '../container/history';\nimport store from '../store/store';\nimport { closeModal } from '../container/routeutils';\nimport {\n    closeArticle,\n    openArticle,\n    loadArticle,\n    requestArticle,\n    requestArticleFail,\n} from './actions';\nimport { ArticleCache, cache } from '../cache';\nimport { history } from 'common-components';\n\n\nfunction shouldOpenArticle(state) {\n    return state.appContext.visible !== true;\n}\n\n// Blocks illegal requests\nfunction shouldFetchArticle(state, articleID) {\n    if (state.article.ID === articleID || state.article.isFetching) {\n        return false;\n    } else {\n        return true;\n    }\n}\n\nexport function closeOverlay() {\n    return dispatch => {\n        if (isStaticPage()) {\n            return;\n        }\n        closeModal();\n        historyData.overlayIsOn = false;\n        history.push(stripPathname(historyData.preservedHref), null);\n        document.title = historyData.initialTitle;\n\n        dispatch(closeArticle());\n        $(document).off('keydown.overlayArticle');\n        $(window).trigger('scroll');\n    }\n}\n\nexport function fetchArticle(articleID, type = ArticleCache.ARTICLES, killCache = false, queryString = '') {\n    return (dispatch, getState) => {\n        if (articleID == null) {\n            console.warn('fetchArticle(): articleID was null.');\n            return;\n        }\n        var state = getState();\n        if (shouldOpenArticle(state)) {\n            dispatch(openArticle());\n        }\n        if (killCache) {\n            cache.remove(articleID, type);\n            delete state.article;\n        }\n\n        if (killCache || shouldFetchArticle(state, articleID)) {\n            if (cache.exists(articleID, type)) {\n                const cac = cache.get(articleID, type);\n                dispatch(loadArticle(articleID, cac));\n                onLoadArticle(cac);\n                // if cache is crawled one, request should continue\n                if (!(cac.isCrawled)) {\n                    return;\n                }\n            }\n            dispatch(requestArticle(articleID));\n            const options = { saved_users_top:10, raw_content: 'true', include_viewer: 'true'};\n            if (getLocationArgPairs('preview')) {\n                options.preview = true;\n            }\n            $.get(`/rest-api/v1/articles/${articleID}${queryString}`, options)\n                .then(article => {\n                    cache.add(articleID, article, type);\n                    dispatch(loadArticle(articleID, article));\n                    onLoadArticle(article);\n                })\n                .fail(failureXHR => {\n                    // FIXME: This error handling only happens when there's server-side error -\n                    //        can't handle client-side ones\n                    dispatch(requestArticleFail(articleID));\n                    if (failureXHR.status === 404) {\n                        alertify.alert(\"This page is not available. Please try again later.\");\n                    // } else if (failureXHR.status >= 500) {\n                    } else {\n                        alertify.alert(\"There was an error while opening the page.<br> Please try again or contact <a mailto=\\\"cs@fancy.com\\\">cs@fancy.com</a>.\");\n                    }\n\n                    if (historyData.initialPageIsArticlePage) {\n                        location.href = '/';\n                    } else {\n                        dispatch(closeOverlay());\n                    }\n                });\n        }\n    };\n}\n\n// TODO: make unified eventemitter interface after all\nfunction onLoadArticle(article) {\n    const MPArgs = { article_id: article.id };\n    const currentLocationArgPair = getLocationArgPairs('utm');\n    if (currentLocationArgPair) {\n        MPArgs.utm = currentLocationArgPair[1];\n    }\n    MP('View Article Detail', MPArgs);\n}\n\nwindow.___D = () => {\n    return store.getState();\n};\n","    import C from './action-constants';\n\n\n// Action on requesting article starts\nexport function requestArticle(pendingID) {\n    return {\n        type: C.REQUEST_ARTICLE,\n        status: 'request',\n        pendingID\n    };\n}\n\n// Action on requesting article fails\nexport function requestArticleFail(/*lastRequestFailedArticleID*/) {\n    return {\n        type: C.REQUEST_ARTICLE_FAILURE,\n        status: 'failed'\n    };\n}\n\n// action on loading request result\nexport function loadArticle(ID, data) {\n    // FIXME: should we do this here?\n    const title = data.name;\n    if (title) {\n        document.title = `Fancy | ${title}`;\n    }\n\n    return {\n        type: C.LOAD_ARTICLE,\n        status: 'idle',\n        ID,\n        data\n    };\n}\n\n// Action on close overlay\nexport function openArticle() {\n    return {\n        type: C.OPEN_ARTICLE\n    };\n}\n\n// Action on close overlay\nexport function closeArticle() {\n    return {\n        type: C.CLOSE_ARTICLE,\n        ID: null,\n        pendingID: null,\n        article: null\n    };\n}\n\nexport function updateAppContext(contextObject) {\n    return {\n        type: C.UPDATE_APP_CONTEXT,\n        context: contextObject\n    };\n}\n","// App state that does not usually change during app lifecycle. (i.e. Login state)\n// import assign from 'object-assign';\n\n// module-level login state object and setter\nconst state = { viewer: {} };\nexport default state;\n\n/*\nexport function statify(config) {\n    assign(state, config);\n    state.loginNeededAttr = config.loggedIn ? {} : {'data-require_login': \"true\"};\n}\n*/\n\nexport function updateState(k, v) {\n    state[k] = v;\n}\n","import { index } from 'fancyutils';\n\n// Cache bucket\nexport class ArticleCache {\n    articles = {};\n    count = 0;\n    static ARTICLES = 'articles';\n\n    exists = (id, type, ignoreCralwed) => {\n        const cac = this.get(id, type);\n        var existence = cac != null && typeof cac === 'object';\n        if (ignoreCralwed) {\n            existence = existence && cac.isCrawled !== true;\n        }\n        return existence;\n    }\n\n    // resolver function\n    _get = (id) => {\n        return this[ArticleCache.ARTICLES][id] || null;\n    }\n\n    get = (id, type = ArticleCache.ARTICLES) => {\n        const cac = this[type][id] || this.getCrawled(id, type);\n        return cac;\n    }\n\n    getCrawled = (id, type) => {\n        const cac = this[type][id];\n        if (cac && cac.isCrawled) {\n            return cac;\n        } else {\n            return null;\n        }\n    }\n\n    add = (id, data, type) => {\n        // to add, cache should not be exist or crawled one\n        const cac = this[type][id];\n        if (\n            cac == null || \n            cac.isCrawled === true\n        ) {\n            this[type][id] = data;\n            this.count += 1;\n        } else {\n            console.warn('cache.add(): Cache overwrite');\n        }\n    }\n\n    remove = (id, type) => {\n        if (this[type][id]) {\n            delete this[type][id];\n            this.count -= 1;\n        } else {\n            console.warn('cache.remove(): Non-existing cache removal');\n        }\n    }\n\n    // selector = 'a.b.c'\n    update = (id, type = ArticleCache.ARTICLES, selector, value) => {\n        if (selector == null) {\n            console.warn('ArticleCache#update(): selector is empty');\n            return;\n        }\n        const t = this.get(id, type);\n        if (t) {\n            index(t, selector, value);\n        }\n    }\n\n    sweep() {\n        // TODO: should sweep cache if too many cache added by looking `cache.count`\n    }\n}\n\nexport const cache = new ArticleCache();\n","import { isEmpty } from 'fancyutils';\n\n\nexport function getDescription(article) {\n    return article.description;\n}\n\nexport function formatPrice(amount) {\n    var newPrice = amount.toFixed(2) + '';\n    var regex = /(\\d)(\\d{3})([,\\.]|$)/;\n    while (regex.test(newPrice)) {\n        newPrice = newPrice.replace(regex, '$1,$2$3');\n    }\n    if (window.numberType === 2) {\n        newPrice = newPrice.replace(/,/g, ' ').replace(/\\./g, ',');\n    }\n    return newPrice;\n}\n\nexport function getSafeNameProp({ emojified_name, name }) {\n    if (emojified_name) {\n        return { dangerouslySetInnerHTML: { __html: emojified_name } };\n    } else {\n        return { children: name };\n    }\n}\n\nfunction salesAvailable(thing) {\n    if (!isEmpty(thing.sales)) {\n        return thing.sales_available;\n    }\n    return false;\n}\n\nexport function getThingName(thing) {\n    if (thing.type === 'giftcard') {\n        return gettext('Fancy Gift Card');\n    } else if (salesAvailable(thing)) {\n        return thing.sales.name;\n    } else {\n        return thing.name;\n    }\n}","import React, { Component } from 'react';\nimport classnames from 'classnames';\nimport { MP, getConciseNumberString } from 'fancyutils';\nimport { Display } from 'fancymixin';\n\nimport { FancyStatus } from '../config';\nimport { cache } from '../cache';\n\n\nexport function handleProfileMouseOver(event) {\n    const $profile = $(event.currentTarget).find('em');\n    $profile.css('margin-left', `${-($profile.width() / 2) - 10}px`);\n}\n\nconst FancydUser = ({ user = {}, display, isViewer }) => (\n    <a href={user.html_url}\n       className={classnames(\"user\", { _viewer: isViewer })}\n       onMouseOver={handleProfileMouseOver}\n       style={display}>\n        <img src=\"/_ui/images/common/blank.gif\"\n             style={{ backgroundImage: `url(${user.user_square_image_small || user.image_url})`}} />\n        <em>{user.full_name || user.fullname}</em>\n    </a>\n);\n\nfunction isUserEqual(a, b) {\n    if (a == null || b == null) {\n        return false;\n    }\n    return a.id === b.id;\n}\n\nconst bgXPosSequence = [0, -54, -108, -163, -218, -272, -327, -436, -490, -545, -599, -654, -708, -763, -817, -872, -926, -981, -1035, -1144, -1199, -1253, -1308, -1417, -1471];\n\nfunction _handleFancydStateOnLoadThing(thingID, { fancyd, fancyd_count }, stateSetter = _ => _) {\n    // onFancyButtonUpdate(thingID, fancyd, getConciseNumberString(fancyd_count));\n    stateSetter({\n        fancyd,\n        fancyd_count,\n        loading: false,\n        fancyStatus: FancyStatus.Idle,\n    })\n}\n\nfunction getFancyStatus(nextFancydState) {\n    return nextFancydState ? FancyStatus.Addition : FancyStatus.Removal;\n}\nfunction getCompletionIdleStatus(currentFancyState) {\n    const prevFancyState = !currentFancyState;\n    return prevFancyState ? FancyStatus.AfterRemoval : FancyStatus.AfterAddition;\n}\nfunction getNextFancydCount(nextFancyd, currentFancydCount) {\n    if (nextFancyd === true) {\n        return currentFancydCount + 1;\n    } else {\n        return currentFancydCount - 1;\n    }\n}\nfunction toggleFancy(thingID, currentState, stateSetter = _ => _) {\n    const { fancyd, fancyd_count, loading } = currentState;\n    const nextFancyd = !fancyd;\n    const nextFancydCount = getNextFancydCount(nextFancyd, fancyd_count);\n\n    if (!loading) {\n        stateSetter({\n            fancyd: nextFancyd, loading: true, fancyd_count: nextFancydCount, fancyStatus: getFancyStatus(nextFancyd)\n        });\n\n        $.ajax({\n            type: 'PUT',\n            url: `/rest-api/v1/things/${thingID}`,\n            data: {\n                fancyd: nextFancyd\n            }\n        })\n        .done(function(json){\n            if (json.id && json.fancyd === !fancyd) {\n                // Completing fancy\n                const nextFancydCount = (json.fancyd === true) ? (fancyd_count||0) + 1 : (fancyd_count||0) - 1;\n\n                cache.update(thingID, undefined, 'fancyd', nextFancyd);\n                cache.update(thingID, undefined, 'fancyd_count', nextFancydCount);\n                // onFancyButtonUpdate(thingID, nextFancyd, getConciseNumberString(nextFancydCount));\n\n                stateSetter({\n                    loading: false, fancyd: nextFancyd, fancyd_count: nextFancydCount, fancyStatus: getCompletionIdleStatus(nextFancyd)\n                });\n            } else {\n                // cancelling fancy\n                stateSetter({ loading: false, fancyd, fancyd_count, fancyStatus: getFancyStatus(fancyd) });\n            }\n        })\n        .fail(function() {\n            // cancelling fancy\n            stateSetter({ loading: false, fancyd, fancyd_count, fancyStatus: getFancyStatus(fancyd) });\n        });\n    }\n}\n\n// workaround for profile heads overflow on animation\nconst bigContainerStyle = { width: '285px' };\n\nexport class FancydUsers extends Component {\n    _getInitialState() {\n        return {\n            fancyAnimation: false,\n            // button state\n            fancyd: null,\n            loading: false,\n            fancyd_count: null,\n            fancyStatus: FancyStatus.Idle, // fancyStatus = 'Idle', { Idle | Addition | Removal | After- } - Fancy'd status for animation control\n        };\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = this._getInitialState();\n        this.fancyBGAnimationRef = element => {\n            this.fancyBGAnimation = element;\n        }\n    }\n\n    getFancydCountString = () => {\n        const { fancyd_count } = this.state;\n        return fancyd_count != null ? getConciseNumberString(fancyd_count, 0) : '0';\n    }\n\n    animateFancyBG = (frame) => {\n        if (frame === undefined) {\n            this.animateFancyBG(0);\n        } else if (frame < bgXPosSequence.length) {\n            // Special branching due to misposition in background\n            var xPos = bgXPosSequence[frame];\n            $(this.fancyBGAnimation).css('background-position-x', `${xPos}px`);\n            setTimeout(() => { this.animateFancyBG(frame + 1) }, 10);\n        } else if (frame >= bgXPosSequence.length) {\n            this.setState({ fancyAnimation: false });\n        }\n    }\n\n    getFancyduserDisplay = (user, index, totalLength) => {\n        const {\n            appContext: { viewer },\n            bigContainer,\n        } = this.props;\n        const {\n            fancyd,\n            fancyStatus,\n        } = this.state;\n\n        const first = index === 0;\n        const last = index === totalLength - 1;\n\n        var display;\n        if (fancyStatus === FancyStatus.AfterAddition || fancyStatus === FancyStatus.Addition) {\n            // designer satisfaction 1)\n            if (totalLength <= 2) {\n                display = Display.Inline;\n            } else {\n                if (first) {\n                    display = Display.Inline;\n                } \n            }\n        } else if (fancyStatus === FancyStatus.AfterRemoval || fancyStatus === FancyStatus.Removal) {\n            if (first) {\n                display = Display.None;\n            } else if (last) {\n                display = Display.Inline;\n            }\n        }\n        // designer satisfaction 2) https://app.asana.com/0/86925821949642/161445424426526\n        const indexLimit = bigContainer ? 6 : 5;\n        if (\n            (fancyStatus === FancyStatus.AfterAddition ||\n             fancyStatus === FancyStatus.Addition ||\n             fancyStatus === FancyStatus.Removal ||\n             (fancyd && fancyStatus === FancyStatus.Idle)\n            ) &&\n            index > indexLimit\n        ) {\n            display = Display.None;\n        }\n\n        if (fancyStatus === FancyStatus.Idle &&\n            !fancyd &&\n            isUserEqual(user, viewer)\n        ) {\n            display = Display.None;\n        }\n\n        return display;\n    }\n\n    toggleFancy = () => {\n        toggleFancy(this.props.thing.id, this.state, ns => { this.setState(ns) });\n    }\n\n    handleFancydStateOnLoadThing = (thing) => {\n        if (thing == null) {\n            thing = this.props.thing;\n        }\n        _handleFancydStateOnLoadThing(thing.id, { fancyd: thing.fancyd, fancyd_count: thing.fancyd_count }, ns => { this.setState(ns); });\n    }\n\n    handleFancyClick = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        if (!this.props.appContext.loggedIn) {\n            window.require_login && window.require_login();\n            return;\n        }\n        const { thing } = this.props;\n        const { fancyAnimation, fancyd, loading } = this.state;\n        if (loading) {\n            return;\n        }\n        if (!fancyd && !fancyAnimation) {\n            this.setState({ fancyAnimation: true }, _ => { this.animateFancyBG(); });\n        }\n\n        if (!fancyd) {\n            MP('Fancy', { thing_id: thing.id });\n        } else {\n            MP('Unfancy', { thing_id: thing.id });\n        }\n\n        this.toggleFancy();\n    }\n\n    componentDidMount() {\n        this.handleFancydStateOnLoadThing();\n    }\n\n    componentDidUpdate({ thing }) {\n        // Thing has been updated.\n        if (thing.id !== this.props.thing.id || thing.isCrawled !== this.props.thing.isCrawled) {\n            this.handleFancydStateOnLoadThing(thing);\n        }\n    }\n\n    render() {\n        const {\n            appContext: { loggedIn, viewer },\n            thing: { fancyd_users, user },\n            bigContainer,\n        } = this.props;\n        const {\n            fancyd,\n            fancyAnimation,\n            fancyStatus,\n        } = this.state;\n\n        const fancydUsers = [\n            loggedIn && viewer,\n            loggedIn && !isUserEqual(viewer, user) && user\n        ]\n        .concat(\n            fancyd_users &&\n            fancyd_users.filter(fancydUser => !isUserEqual(fancydUser, user) &&\n                                              !isUserEqual(fancydUser, viewer))\n        )\n        .filter(e => e);\n\n        var fancydUserAnimClass;\n        if (fancyStatus === FancyStatus.Addition) {\n            fancydUserAnimClass = \"add\";\n        } else if (fancyStatus === FancyStatus.Removal) {\n            fancydUserAnimClass = \"remove\";\n        }\n        // designer satisfaction 1)\n        // If user is less than 2 we need to apply special class.\n        // In this way dont owner profile dont get 'consumed': https://app.asana.com/0/86925821949642/173945332708784\n        const userCountSufficiency = fancydUsers.length <= 2 ? '_insuff' : '_suff';\n\n        return (\n            <span style={bigContainer && bigContainerStyle} className=\"fancyd_users-wrap\">\n                <span className=\"count\">\n                    <a onClick={this.handleFancyClick}\n                       className={classnames(\"button button-static fancy _count\", { fancyd, loading: fancyAnimation })}>\n                        <span ref={this.fancyBGAnimationRef}>\n                            <i />\n                        </span>{this.getFancydCountString()}\n                    </a>\n                    <span className=\"_fancyd\" />\n                </span>\n                <span className={classnames(\"fancyd_user\", fancydUserAnimClass, userCountSufficiency)}>\n                    {fancydUsers.map((user, index) => {\n                        const isViewer = isUserEqual(user, viewer);\n                        return (\n                            <FancydUser key={index}\n                                        user={user}\n                                        display={this.getFancyduserDisplay(user, index, fancydUsers.length)}\n                                        isViewer={isViewer} />\n                        );\n                    })}\n                </span>\n            </span>\n        );\n    }\n}\n","import React, { Component } from \"react\";\nimport classnames from \"classnames\";\nimport { numberFormat, isPlainLeftClick } from \"fancyutils\";\nimport { MoreShare, MoreShareFacade } from \"common-components\";\n\nimport appState from \"../appstate\";\nimport { addItemToCart, logAddCartMixpanel } from \"../../overlay-thing/components/map.cart\";\nimport { getSafeNameProp, getThingName } from \"./map\";\nimport { LinkTypes, transition } from \"../container/routeutils\";\nimport { FancydUsers } from \"./ThingFancydUsers\";\nimport { OaContainer } from \"../container/entry-events\";\n\nconst itemTraits = {\n    article: {\n        utm: \"article\",\n        section: \"items\",\n        via: \"article\",\n    },\n    similar: {\n        section: \"recommended\",\n        utm: \"rec\",\n        via: \"thing more\",\n    },\n    recently: {\n        section: \"recently viewed\",\n        utm: \"rv\",\n        via: \"thing more\",\n    },\n};\n\nexport default class ThingCard extends Component {\n    static defaultProps = {\n        showDelete: true,\n    };\n\n    state = {\n        fancydCount: 0,\n        quantity: 1,\n        optionID: null,\n        showCart: false,\n        popupOpened: false,\n    };\n\n    constructor(props) {\n        super(props);\n        this.handleLinkClick = _.throttle(this.handleLinkClick, 500);\n    }\n\n    componentDidMount() {\n        this.setState({ fancydCount: this.props.fancyd_count || 0 });\n    }\n\n    componentWillUnmount() {\n        this.unmounted = true;\n    }\n\n    handleCartAddition = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        this.addToCart();\n    };\n\n    addToCart() {\n        if (!appState.loggedIn) {\n            window.require_login && window.require_login();\n            return;\n        }\n        const { id, itemType } = this.props;\n        const { quantity } = this.state;\n\n        const sales = this.getSales();\n        const saleAvailable = this.isSaleAvailable();\n        const saleOptionExists = this.isSaleOptionExists();\n        const option = this.getSaleOption();\n\n        if (!saleAvailable || this.state.loading) {\n            return;\n        }\n        if (isNaN(quantity) || quantity <= 0) {\n            alert(gettext(\"Please select a valid quantity.\"));\n            return;\n        }\n\n        const param = {\n            seller_id: sales.seller.id, // sisi\n            thing_id: id, // tid\n            sale_item_id: sales.sale_id, // sii\n            quantity,\n        };\n        if (saleOptionExists && option) {\n            param.option_id = option.id;\n        }\n\n        const traits = itemTraits[itemType];\n        const title = getThingName(this.props);\n        this.setState({ loading: true }, () => {\n            const log = {\n                salesID: sales.sale_id,\n                utm: traits.utm,\n                section: traits.section,\n                via: traits.via,\n            };\n            if (option) {\n                log.saleOptionID = option.id;\n            }\n            logAddCartMixpanel(log);\n            // ga shit\n            const discounting = sales && sales.discount_percentage !== \"0\";\n            const meta = {\n                title,\n                price: discounting ? sales.retail_price : sales.deal_price,\n                brand_name: sales.seller.brand_name,\n            };\n            addItemToCart(\n                param,\n                () => {\n                    if (!this.unmounted) {\n                        this.setState({ loading: false });\n                    }\n                },\n                meta\n            );\n        });\n    }\n\n    handleQuickCartToggle = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        const saleAvailable = this.isSaleAvailable();\n        const saleOptionExists = this.isSaleOptionExists();\n        if (saleAvailable) {\n            if (saleOptionExists) {\n                this.setState({ showCart: !this.state.showCart });\n            } else {\n                this.addToCart();\n            }\n        } else {\n            this.setState({ showCart: !this.state.showCart });\n        }\n    };\n\n    isSaleAvailable = () => {\n        const { sales_available } = this.props;\n        const sales = this.getSales();\n        if (sales) {\n            return sales_available && sales.quantity !== 0;\n        } else {\n            return false;\n        }\n    };\n\n    getSaleOption = () => {\n        const saleOptionExists = this.isSaleOptionExists();\n        const sales = this.getSales();\n        if (sales && saleOptionExists) {\n            const optionID = this.state.optionID || sales.options[0].id;\n            const option = sales.options.filter((option) => option.id === optionID)[0] || null;\n            return option;\n        } else {\n            return null;\n        }\n    };\n\n    isSaleOptionExists = () => {\n        const sales = this.getSales();\n        if (sales) {\n            return sales.has_options === true;\n        } else {\n            return false;\n        }\n    };\n\n    isSaleOptionAvailable = () => {\n        const option = this.getSaleOption();\n        if (option) {\n            return option.available_for_sale === true && option.quantity !== 0;\n        } else {\n            return false;\n        }\n    };\n\n    getSales = () => {\n        return this.props.sales;\n    };\n\n    getFancydCount = () => {\n        return _.isNumber(this.state.fancydCount) ? this.state.fancydCount : this.props.fancyd_count;\n    };\n\n    handleFancydCount = (diff) => {\n        this.setState({\n            fancydCount: this.state.fancydCount + diff,\n        });\n    };\n\n    getQuantityRange = () => {\n        const saleOptionExists = this.isSaleOptionExists();\n        var max;\n        if (saleOptionExists && this.isSaleOptionAvailable()) {\n            max = this.getSaleOption().quantity;\n        } else if (this.isSaleAvailable()) {\n            max = this.getSales().quantity;\n        }\n        return max == null ? [\"1\"] : _.range(1, Math.min(10, max + 1));\n    };\n\n    handleOptionChange = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        this.setState({ optionID: parseInt(event.target.value, 10), quantity: 1 });\n    };\n\n    handleOptionQuantityChange = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        this.setState({ quantity: parseInt(event.target.value, 10) });\n    };\n\n    handleTrickClick = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        this.setState({ showCart: false });\n    };\n\n    handleRecentlyDelete = () => {\n        $.post(\"/remove_recently_viewed_thing\", { thing_id: this.props.id }, (json) => {\n            if (!json || json.status_code !== 1) {\n                window.alertify.alert(`Sorry, failed to remove \"${this.props.name}\". Please retry.`);\n            } else {\n                this.props.onDelete(this.props);\n            }\n        }).fail(() => {\n            window.alertify.alert(`Sorry, failed to remove \"${this.props.name}\". Please retry.`);\n        });\n    };\n\n    handleLinkClick = (event) => {\n        event.stopPropagation();\n        if (isPlainLeftClick(event)) {\n            event.preventDefault();\n\n            if (!window.isWhitelabel) OaContainer.scrollToTop();\n\n            transition(this.html_url(), LinkTypes.Timeline);\n        }\n    };\n\n    handleShowSomething = (popupOpened) => {\n        this.setState({ popupOpened });\n    };\n\n    handleNotifySoldout = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        if (!appState.loggedIn) {\n            window.require_login && window.require_login();\n            return;\n        }\n        const sales = this.getSales();\n        const params = { sale_item_id: sales.sale_id };\n        const waiting = this.getWaiting(sales);\n        if (waiting) {\n            params.remove = 1;\n        }\n\n        $.ajax({\n            type: \"post\",\n            url: \"/wait_for_product.json\",\n            data: params,\n            dataType: \"json\",\n        })\n            .done((json) => {\n                if (!json || json.status_code == null) {\n                    return;\n                }\n                if (json.status_code == 0 && json.message) {\n                    window.alertify.alert(json.message);\n                    return;\n                }\n                const waiting = params.remove ? false : true;\n                this.setState({ waiting });\n            })\n            .fail(function (json) {\n                if (json && json.message) {\n                    window.alertify.alert(json.message);\n                } else {\n                    window.alertify.alert(\"There was an error while processing your request. Please try again later.\");\n                }\n            });\n    };\n\n    getWaiting = () => {\n        const sales = this.getSales();\n        if (sales) {\n            if (this.state.waiting == null) {\n                return sales.waiting;\n            } else {\n                return this.state.waiting;\n            }\n        } else {\n            return false;\n        }\n    };\n\n    html_url = () => {\n        const { utm } = itemTraits[this.props.itemType] || {};\n        return `${this.props.html_url}${utm ? \"?utm=\" + utm : \"\"}`;\n    };\n\n    render() {\n        const { id, thumb_image_url_310, thumb_image_url_558, itemIdx, loggedIn, viewer, showDelete } = this.props;\n        const { showCart, loading, popupOpened } = this.state;\n        const html_url = this.html_url();\n\n        const sales = this.getSales();\n        const discounting = sales && sales.discount_percentage !== \"0\";\n        const waiting = this.getWaiting();\n\n        const saleAvailable = this.isSaleAvailable();\n        const saleOptionExists = this.isSaleOptionExists();\n        const saleOptionAvailable = this.isSaleOptionAvailable();\n\n        const showFrom =\n            sales && sales.max_price !== null && sales.min_price !== null && sales.max_price > sales.min_price;\n\n        return __Config.new_card ? (\n            <li className={classnames({ \"quick-cart\": loading, active: popupOpened || showCart })}>\n                <div className={classnames(\"figure-item new\", { toggled: showCart })}>\n                    <figure>\n                        <a\n                            href={html_url}\n                            rel={`thing-${id}`}\n                            onClick={this.handleLinkClick}\n                            data-prevent-overlay=\"true\">\n                            <span className=\"figure\">\n                                <img\n                                    src=\"/_ui/images/common/blank.gif\"\n                                    style={{ backgroundImage: `url(${thumb_image_url_558 || thumb_image_url_310})` }}\n                                />\n                            </span>\n                        </a>\n                        <div className=\"buttons\">\n                            <FancydUsers\n                                thing={this.props}\n                                appContext={this.props.appContext}\n                                displayCount={6}\n                                showFancydUser={false}\n                            />\n                            <MoreShareFacade\n                                objectType=\"thing\"\n                                objectId={id}\n                                loggedIn={loggedIn}\n                                title={getThingName(this.props)}\n                                viewerUsername={viewer.username}\n                                onShowSomething={this.handleShowSomething}\n                            />\n                        </div>\n                        <div\n                            className={classnames(\"show_cart\", { opened: showCart })}\n                            style={!sales ? { display: \"none\" } : undefined}>\n                            {sales && (\n                                <button\n                                    className=\"btn-cart nopopup\"\n                                    onClick={this.handleCartAddition}\n                                    disabled={!saleOptionAvailable}>\n                                    <em>Add to Cart</em>\n                                </button>\n                            )}\n                            <em className=\"sale-item-input\">\n                                <small\n                                    className=\"trick\"\n                                    style={{ display: showCart ? \"block\" : undefined }}\n                                    onClick={this.handleTrickClick}\n                                />\n                                {saleAvailable ? (\n                                    <span className=\"frm\">\n                                        {saleOptionExists && (\n                                            <select\n                                                name=\"option_id\"\n                                                id={`${id}-option_id`}\n                                                onChange={this.handleOptionChange}>\n                                                {sales.options.map((option, i) => (\n                                                    <option\n                                                        key={`other-item-${itemIdx}-saleoption-${i}`}\n                                                        value={option.id}>\n                                                        {option.option} -{\" \"}\n                                                        {!option.available_for_sale || option.quantity === 0\n                                                            ? gettext(\"Sold out\")\n                                                            : `$${numberFormat(option.deal_price, 0)}`}\n                                                    </option>\n                                                ))}\n                                            </select>\n                                        )}\n                                        <select\n                                            className=\"option\"\n                                            id={`${id}-quantity`}\n                                            name=\"quantity\"\n                                            disabled={!saleOptionAvailable}\n                                            onChange={this.handleOptionQuantityChange}>\n                                            {this.getQuantityRange().map((e, i) => (\n                                                <option key={`other-item-${itemIdx}-quantityOption-${i}`} value={e}>\n                                                    {e}\n                                                </option>\n                                            ))}\n                                        </select>\n                                        <button\n                                            className=\"add_to_cart btns-green-embo\"\n                                            onClick={this.handleCartAddition}\n                                            disabled={!saleOptionAvailable}>\n                                            {gettext(\"Add to Cart\")}\n                                        </button>\n                                    </span>\n                                ) : (\n                                    <span className=\"frm\">\n                                        <span className=\"notify-soldout\">Sorry, this item has sold out</span>\n                                        <button\n                                            className={classnames(\"btns-green-embo btn-notify\", {\n                                                subscribed: waiting,\n                                            })}\n                                            onClick={this.handleNotifySoldout}>\n                                            {waiting ? \"Subscribed\" : \"Notify me when available\"}\n                                        </button>\n                                    </span>\n                                )}\n                            </em>\n                        </div>\n                    </figure>\n                    <figcaption>\n                        <a\n                            href={html_url}\n                            className=\"title\"\n                            rel={`thing-${id}`}\n                            onClick={this.handleLinkClick}\n                            data-prevent-overlay=\"true\">\n                            <b className=\"title\" {...getSafeNameProp(this.props)} />\n                            {sales && (\n                                <span\n                                    className={`price ${discounting ? \"sales\" : \"\"} ${saleAvailable ? \"\" : \"soldout\"}`}>\n                                    {discounting && (\n                                        <small key=\"ThingCard2-price-deal\">\n                                            ${numberFormat(sales.retail_price, 0)}\n                                        </small>\n                                    )}\n                                    {showFrom ? (\n                                        <React.Fragment>\n                                            <em className=\"from\">from </em> ${numberFormat(sales.min_price, 0)}\n                                        </React.Fragment>\n                                    ) : (\n                                        `$\n                                        ${numberFormat(sales.deal_price, 0)}`\n                                    )}\n                                </span>\n                            )}\n                        </a>\n                    </figcaption>\n                    <a className=\"delete\" onClick={this.handleRecentlyDelete} />\n                </div>\n            </li>\n        ) : (\n            <li className={classnames({ \"quick-cart\": loading, active: popupOpened || showCart })}>\n                <div className={classnames(\"figure-item\", { toggled: showCart })}>\n                    <figure>\n                        <a href={html_url} rel={`thing-${id}`} onClick={this.handleLinkClick}>\n                            <span className=\"back\" />\n                            <img\n                                className=\"figure\"\n                                style={{ backgroundImage: `url(${thumb_image_url_310})` }}\n                                src=\"/_ui/images/common/blank.gif\"\n                            />\n                        </a>\n                    </figure>\n                    <figcaption>\n                        <span\n                            className={classnames(\"show_cart\", { opened: showCart })}\n                            style={{ display: sales ? null : \"none\" }}>\n                            {sales && (\n                                <button\n                                    className={`btn-cart nopopup ${discounting ? \"sales\" : \"\"} ${\n                                        saleAvailable ? \"\" : \"soldout\"\n                                    }`}\n                                    onClick={this.handleQuickCartToggle}>\n                                    <em>\n                                        {discounting\n                                            ? [\n                                                  <small key=\"ThingCard2-price-deal\">\n                                                      ${numberFormat(sales.retail_price, 0)}\n                                                  </small>,\n                                                  `$${numberFormat(sales.deal_price, 0)}`,\n                                              ]\n                                            : `$${numberFormat(sales.deal_price, 0)}`}\n                                    </em>\n                                </button>\n                            )}\n                            <em className=\"sale-item-input\">\n                                <small\n                                    className=\"trick\"\n                                    style={{ display: showCart ? \"block\" : null }}\n                                    onClick={this.handleTrickClick}\n                                />\n                                {saleAvailable ? (\n                                    <span className=\"frm\">\n                                        {saleOptionExists && (\n                                            <select\n                                                name=\"option_id\"\n                                                id={`${id}-option_id`}\n                                                onChange={this.handleOptionChange}>\n                                                {sales.options.map((option, i) => (\n                                                    <option\n                                                        key={`other-item-${itemIdx}-saleoption-${i}`}\n                                                        value={option.id}>\n                                                        {option.option} -{\" \"}\n                                                        {!option.available_for_sale || option.quantity === 0\n                                                            ? gettext(\"Sold out\")\n                                                            : `$${numberFormat(option.deal_price, 0)}`}\n                                                    </option>\n                                                ))}\n                                            </select>\n                                        )}\n                                        <select\n                                            className=\"option\"\n                                            id={`${id}-quantity`}\n                                            name=\"quantity\"\n                                            disabled={!saleOptionAvailable}\n                                            onChange={this.handleOptionQuantityChange}>\n                                            {this.getQuantityRange().map((e, i) => (\n                                                <option key={`other-item-${itemIdx}-quantityOption-${i}`} value={e}>\n                                                    {e}\n                                                </option>\n                                            ))}\n                                        </select>\n                                        <button\n                                            className=\"add_to_cart btns-green-embo\"\n                                            onClick={this.handleCartAddition}\n                                            disabled={!saleOptionAvailable}>\n                                            {gettext(\"Add to Cart\")}\n                                        </button>\n                                    </span>\n                                ) : (\n                                    <span className=\"frm\">\n                                        <span className=\"notify-soldout\">Sorry, this item has sold out</span>\n                                        <button\n                                            className={classnames(\"btns-green-embo btn-notify\", {\n                                                subscribed: waiting,\n                                            })}\n                                            onClick={this.handleNotifySoldout}>\n                                            {waiting ? \"Subscribed\" : \"Notify me when available\"}\n                                        </button>\n                                    </span>\n                                )}\n                            </em>\n                        </span>\n                        <a\n                            href={html_url}\n                            className=\"title\"\n                            rel={`thing-${id}`}\n                            onClick={this.handleLinkClick}\n                            {...getSafeNameProp(this.props)}\n                        />\n                        <span className={classnames(\"buttons\" /*, { 'no-cart': saleAvailable }*/)}>\n                            <FancydUsers thing={this.props} appContext={this.props.appContext} />\n                            <MoreShare\n                                objectType=\"thing\"\n                                objectId={id}\n                                loggedIn={loggedIn}\n                                title={getThingName(this.props)}\n                                viewerUsername={viewer.username}\n                                onShowSomething={this.handleShowSomething}\n                            />\n                        </span>\n                    </figcaption>\n                    {showDelete && <a className=\"delete\" onClick={this.handleRecentlyDelete} />}\n                </div>\n            </li>\n        );\n    }\n}\n","import React, { Component } from 'react';\nimport { isPlainLeftClick } from 'fancyutils';\n\nimport { LinkTypes, transition } from '../container/routeutils';\n\n\nexport default class ArticleCard extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {};\n\n        this.handleLinkClick = _.throttle(this.handleLinkClick, 500);\n    }\n\n    handleLinkClick = (event) => {\n        event.stopPropagation();\n        if (isPlainLeftClick(event)) {\n            event.preventDefault();\n\n            const { html_url } = this.props;\n            transition(html_url, LinkTypes.Timeline);\n        }\n    }\n\n    componentWillUnmount() {\n        this.unmounted = true;\n    }\n\n    render() {\n        const { id, cover_image, title, url, tagline } = this.props;\n        \n        return (\n            <div className=\"article_item detail\">\n              <a href={url} >\n                <span className=\"cover\">\n                  { cover_image &&\n                  <img src=\"/_ui/images/common/blank.gif\" style={{backgroundImage: `url(${cover_image.url})`}}/>\n                  }\n                  { !cover_image &&\n                    <img src=\"/_ui/images/common/blank.gif\"/>\n                  }\n                </span>\n                <span className=\"title\">{title}</span>\n                <span className=\"description\">{tagline}</span>\n              </a>\n            </div>\n        );\n    }\n}","import React, { Component } from \"react\";\nimport { convertThingsV1ToRest } from \"fancyutils\";\n\nimport ThingCard from \"./ThingCard\";\nimport ArticleCard from \"./ArticleCard\";\nimport { cache } from \"../cache\";\n\n\nexport class ThingList extends Component {\n    lastarticleID = null;\n    state = {\n        showShare: false,\n        things: []\n    };\n\n    componentDidMount() {\n        // Initial loading\n        this.updateThingList(this.props.article.id, true);\n        const things = convertThingsV1ToRest(this.props.article.things);\n        this.setState({ things: things });\n\n        this.lastarticleID = this.props.article.id;\n    }\n\n    componentDidUpdate() {\n        const nextProps = this.props\n        // Article has changed, reset things.\n        if (this.lastarticleID !== nextProps.article.id) {\n            const idCopy = nextProps.article.id;\n            this.lastarticleID = idCopy;\n            this.updateThingList(nextProps.article.id, true);\n            const things = convertThingsV1ToRest(nextProps.article.things);\n            this.setState({ things: things });\n        }\n    }\n\n    componentWillUnmount() {\n        this.unmounted = true;\n    }\n\n    logExposed = (things) => {\n        if (typeof window.LogExposed == \"undefined\") return;\n        things.forEach(thing => {\n            window.LogExposed.addLog(thing.id + \"\", \"article\");\n        });\n    }\n\n    updateThingList = (articleID) => {\n        if (articleID == null) {\n            return;\n        }\n        $.ajax({\n            type: \"get\",\n            url: `/rest-api/v1/articles/${articleID}/items`,\n        })\n            .done(response => {\n                if (!this.unmounted) {\n                    const things = convertThingsV1ToRest(response.article_items).map(t => {\n                        if (window.isWhitelabel && t.sales) {\n                            const url = `${t.html_url}`\n                            t.url = url\n                            t.html_url = url\n                        }\n                        return t\n                    })\n                    this.logExposed(things);\n                    this.setState({ things: things });\n                }\n            })\n            .fail(function(xhr) {\n                console.warn(\"updateThingList():\", xhr);\n            });\n    }\n\n    render() {\n        const { article, appContext, appContext: { loggedIn }, hasPagination } = this.props;\n        const { things } = this.state;\n\n        const thingsHeader = (article.options && article.options.item_header) || null;\n\n        return (\n            <div id=\"content\" className={`content ${things.length === 0 ? \"_empty\" : \"\"}`}>\n                {thingsHeader && <h3>{thingsHeader}</h3>}\n                {things.length > 0 ? (\n                    <MaybePaginationWindow hasPagination={hasPagination} length={things.length}>\n                        {things &&\n                            things.map((thing, idx) => (\n                                <ThingCard\n                                    itemIdx={idx}\n                                    itemType={\"article\"}\n                                    loggedIn={loggedIn}\n                                    key={`timeline-recently-${idx}`}\n                                    onDelete={this.handleDelete}\n                                    viewer={this.props.appContext.viewer}\n                                    appContext={appContext}\n                                    showDelete={false}\n                                    {...thing}\n                                />\n                            ))}\n                    </MaybePaginationWindow>\n                ) : null}\n            </div>\n        );\n    }\n}\n\nexport class MaybePaginationWindow extends Component {\n    state = {\n        page: 0\n    }\n\n    handlePrevClick = (e) => {\n        e.preventDefault();\n        const minPage = 0;\n        this.setState({ page: Math.max(this.state.page - 1, minPage) });\n    }\n\n    handleNextClick = (e) => {\n        e.preventDefault();\n        const maxPage = Math.floor(this.props.length / 4) - 1;\n        this.setState({ page: Math.min(this.state.page + 1, maxPage) });\n    }\n\n    render() {\n        const { hasPagination, children } = this.props;\n        const style = {};\n        if (hasPagination) {\n            style.transform = `translateX(${ -101 * this.state.page }%)`;\n        }\n        const stream = (\n            <ol className=\"stream after\" style={style}>{children}</ol>\n        );\n\n        if (hasPagination) {\n            return (\n                <div className=\"itemSlide\">\n                    <div className=\"itemSlideWrap\">\n                        {stream}\n                    </div>\n                    <a href=\"#\" className=\"prev\" onClick={this.handlePrevClick}>Prev</a>\n                    <a href=\"#\" className=\"next\" onClick={this.handleNextClick}>Next</a>\n                </div>\n            );\n        } else {\n            return stream;\n        }\n    }\n}\n    \n\nexport class ArticleList extends Component {\n    lastarticleID = null;\n    state = {\n        articles: [],\n        page: 1\n    };\n\n    componentDidMount() {\n        // Initial loading\n        this.updateArticleList(this.props.article.id);\n        this.lastarticleID = this.props.article.id;\n    }\n\n    componentDidUpdate() {\n        const nextProps = this.props;\n        // Article has changed, reset articles.\n        if (this.lastarticleID !== nextProps.article.id) {\n            const idCopy = nextProps.article.id;\n            this.lastarticleID = idCopy;\n            this.updateArticleList(nextProps.article.id, true);\n        }\n    }\n\n    componentWillUnmount() {\n        this.unmounted = true;\n    }\n\n    updateArticleList = (articleID) => {\n        if (articleID == null) {\n            return;\n        }\n        $.ajax({\n            type: \"get\",\n            url: window.isWhitelabel ? \"/rest-api/v1/articles?limit=4&concise=true\" : \"/rest-api/v1/articles?featured\"\n        })\n            .done(response => {\n                if (!this.unmounted) {\n                    var articles = response.articles.filter(article => article.id !== articleID);\n                    this.setState({ articles: articles });\n                }\n            })\n            .fail(function(xhr) {\n                console.warn(\"updateArticleList():\", xhr);\n            });\n    }\n\n    handlePrevClick = (event) => {\n        event.preventDefault();\n        var $this = $(event.target);\n        if ($this.hasClass(\"disabled\")) return;\n        this.setState({ page: this.state.page - 1 });\n    }\n\n    handleNextClick = (event) => {\n        event.preventDefault();\n        var $this = $(event.target);\n        if ($this.hasClass(\"disabled\")) return;\n        this.setState({ page: this.state.page + 1 });\n    }\n\n    getLeftOffset = () => {\n        const { articles, page } = this.state;\n        const left = (page - 1) * -860 - (page > 1 ? 4 : 0);\n        const lastPageNum = ((articles.length / 4) | 0) + ((articles.length % 4) > 0 ? 1 : 0)\n        if (articles.length > 4 && page >= lastPageNum) {\n            const CardWidth = 205\n            const CardMargin = 10\n            const CardContainerWidth = 970;\n            const CardContainerPadding = 14;\n            const max = ((articles.length - 1) * CardMargin + articles.length * CardWidth) - CardContainerWidth + (CardContainerPadding * 2);\n    \n            return `${Math.max(left, -max)}px`;\n        } else {\n            return left;\n        }\n    }\n\n    render() {\n        const { appContext } = this.props;\n        const { articles, page } = this.state;\n        var maxPage = Math.ceil(articles.length / 4);\n        var prevDisabled = page == 1;\n        var nextDisabled = page == maxPage;\n\n        return (\n            <div id=\"sidebar\">\n                <div className=\"wrapper recommend-article\">\n                    <h3 className=\"stit\">MORE ARTICLES</h3>\n                    {articles.length ? (\n                        <div className=\"article_wrap\" style={{ left: this.getLeftOffset() }}>\n                            {articles &&\n                                articles.map((article, idx) => (\n                                    <ArticleCard key={article.id} itemIdx={idx} appContext={appContext} {...article} />\n                                ))}\n                        </div>\n                    ) : (\n                        <div />\n                    )}\n                    {articles.length > 4 && (\n                        <div className=\"paging\">\n                            <a\n                                href=\"#\"\n                                className={`${prevDisabled ? \"disabled\" : \"\"} prev`}\n                                onClick={this.handlePrevClick}>\n                                Prev\n                            </a>\n                            <a\n                                href=\"#\"\n                                className={`${nextDisabled ? \"disabled\" : \"\"} next`}\n                                onClick={this.handleNextClick}>\n                                Next\n                            </a>\n                        </div>\n                    )}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport class AdminHeader extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            is_active: props.article.is_active\n        };\n    }\n\n    handleLiveClick = event => {\n        event.preventDefault();\n        const self = this;\n        const $this = $(event.target);\n        const { article } = this.props;\n\n        let message = `Are you sure you want to set ${article.title} live on ${\n            window.isWhitelabel ? \"Gear\" : \"Fancy\"\n        }?`;\n        if ($this.hasClass(\"on\"))\n            message = `Are you sure you want to hide ${article.title} from ${window.isWhitelabel ? \"Gear\" : \"Fancy\"}?`;\n        const original_labels = window.alertify.labels;\n        window.alertify.set({ labels: { ok: $this.hasClass(\"on\") ? \"Hide\" : \"Set Live\", cancel: \"Cancel\" } });\n        window.alertify.confirm(message, function(yes) {\n            if (yes) {\n                var is_active = !$this.hasClass(\"on\");\n                $.post(\n                    \"/_admin/articles/update_active.json\",\n                    { article_id: article.id, is_active: is_active },\n                    function(json) {\n                        if (json.error) {\n                            window.alertify.alert(json.error);\n                        } else {\n                            window.alertify.alert(is_active ? \"Activated\" : \"Deactivated\");\n                            self.setState({ is_active: is_active });\n                            cache.update(self.props.article.slug, undefined, \"is_active\", is_active);\n                        }\n                    }\n                );\n            }\n        });\n        window.alertify.set({ labels: original_labels })\n    };\n\n    handleEditArticleClick = (e) => {\n        e.preventDefault();\n        const { article } = this.props;\n        window.open(`/_admin/articles/edit?id=${article.id}`);\n    }\n\n\n    render() {\n        const { is_active } = this.state;\n\n        return (\n            <div className=\"admin-header\">\n                <div className=\"inner\">\n                    <h2>Admin Panel</h2>\n                    <a onClick={this.handleEditArticleClick}>\n                        Edit Article\n                    </a>\n                    <label>Live</label>\n                    <button className={`${is_active ? \"on\" : \"\"} btn-switch`} onClick={this.handleLiveClick} />\n                </div>\n            </div>\n        );\n    }\n}\n\n\nexport function initGallery(container) {\n\n    /*! Hammer.JS - v2.0.8 - 2016-04-23\n * http://hammerjs.github.io/\n *\n * Copyright (c) 2016 Jorik Tangelder;\n * Licensed under the MIT license */\n!function(a,b,c,d){\"use strict\";function e(a,b,c){return setTimeout(j(a,c),b)}function f(a,b,c){return Array.isArray(a)?(g(a,c[b],c),!0):!1}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(b,c,d){var e=\"DEPRECATED METHOD: \"+c+\"\\n\"+d+\" AT \\n\";return function(){var c=new Error(\"get-stack-trace\"),d=c&&c.stack?c.stack.replace(/^[^\\(]+?[\\n$]/gm,\"\").replace(/^\\s+at\\s+/gm,\"\").replace(/^Object.<anonymous>\\s*\\(/gm,\"{anonymous}()@\"):\"Unknown Stack Trace\",f=a.console&&(a.console.warn||a.console.log);return f&&f.call(a.console,e,d),b.apply(this,arguments)}}function i(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&la(d,c)}function j(a,b){return function(){return a.apply(b,arguments)}}function k(a,b){return typeof a==oa?a.apply(b?b[0]||d:d,b):a}function l(a,b){return a===d?b:a}function m(a,b,c){g(q(b),function(b){a.addEventListener(b,c,!1)})}function n(a,b,c){g(q(b),function(b){a.removeEventListener(b,c,!1)})}function o(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function p(a,b){return a.indexOf(b)>-1}function q(a){return a.trim().split(/\\s+/g)}function r(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function s(a){return Array.prototype.slice.call(a,0)}function t(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];r(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function u(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<ma.length;){if(c=ma[g],e=c?c+f:b,e in a)return e;g++}return d}function v(){return ua++}function w(b){var c=b.ownerDocument||b;return c.defaultView||c.parentWindow||a}function x(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){k(a.options.enable,[a])&&c.handler(b)},this.init()}function y(a){var b,c=a.options.inputClass;return new(b=c?c:xa?M:ya?P:wa?R:L)(a,z)}function z(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&Ea&&d-e===0,g=b&(Ga|Ha)&&d-e===0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,A(a,c),a.emit(\"hammer.input\",c),a.recognize(c),a.session.prevInput=c}function A(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=D(b)),e>1&&!c.firstMultiple?c.firstMultiple=D(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=E(d);b.timeStamp=ra(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=I(h,i),b.distance=H(h,i),B(c,b),b.offsetDirection=G(b.deltaX,b.deltaY);var j=F(b.deltaTime,b.deltaX,b.deltaY);b.overallVelocityX=j.x,b.overallVelocityY=j.y,b.overallVelocity=qa(j.x)>qa(j.y)?j.x:j.y,b.scale=g?K(g.pointers,d):1,b.rotation=g?J(g.pointers,d):0,b.maxPointers=c.prevInput?b.pointers.length>c.prevInput.maxPointers?b.pointers.length:c.prevInput.maxPointers:b.pointers.length,C(c,b);var k=a.element;o(b.srcEvent.target,k)&&(k=b.srcEvent.target),b.target=k}function B(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};b.eventType!==Ea&&f.eventType!==Ga||(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}function C(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Ha&&(i>Da||h.velocity===d)){var j=b.deltaX-h.deltaX,k=b.deltaY-h.deltaY,l=F(i,j,k);e=l.x,f=l.y,c=qa(l.x)>qa(l.y)?l.x:l.y,g=G(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function D(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:pa(a.pointers[c].clientX),clientY:pa(a.pointers[c].clientY)},c++;return{timeStamp:ra(),pointers:b,center:E(b),deltaX:a.deltaX,deltaY:a.deltaY}}function E(a){var b=a.length;if(1===b)return{x:pa(a[0].clientX),y:pa(a[0].clientY)};for(var c=0,d=0,e=0;b>e;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:pa(c/b),y:pa(d/b)}}function F(a,b,c){return{x:b/a||0,y:c/a||0}}function G(a,b){return a===b?Ia:qa(a)>=qa(b)?0>a?Ja:Ka:0>b?La:Ma}function H(a,b,c){c||(c=Qa);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function I(a,b,c){c||(c=Qa);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function J(a,b){return I(b[1],b[0],Ra)+I(a[1],a[0],Ra)}function K(a,b){return H(b[0],b[1],Ra)/H(a[0],a[1],Ra)}function L(){this.evEl=Ta,this.evWin=Ua,this.pressed=!1,x.apply(this,arguments)}function M(){this.evEl=Xa,this.evWin=Ya,x.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function N(){this.evTarget=$a,this.evWin=_a,this.started=!1,x.apply(this,arguments)}function O(a,b){var c=s(a.touches),d=s(a.changedTouches);return b&(Ga|Ha)&&(c=t(c.concat(d),\"identifier\",!0)),[c,d]}function P(){this.evTarget=bb,this.targetIds={},x.apply(this,arguments)}function Q(a,b){var c=s(a.touches),d=this.targetIds;if(b&(Ea|Fa)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=s(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return o(a.target,i)}),b===Ea)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Ga|Ha)&&delete d[g[e].identifier],e++;return h.length?[t(f.concat(h),\"identifier\",!0),h]:void 0}function R(){x.apply(this,arguments);var a=j(this.handler,this);this.touch=new P(this.manager,a),this.mouse=new L(this.manager,a),this.primaryTouch=null,this.lastTouches=[]}function S(a,b){a&Ea?(this.primaryTouch=b.changedPointers[0].identifier,T.call(this,b)):a&(Ga|Ha)&&T.call(this,b)}function T(a){var b=a.changedPointers[0];if(b.identifier===this.primaryTouch){var c={x:b.clientX,y:b.clientY};this.lastTouches.push(c);var d=this.lastTouches,e=function(){var a=d.indexOf(c);a>-1&&d.splice(a,1)};setTimeout(e,cb)}}function U(a){for(var b=a.srcEvent.clientX,c=a.srcEvent.clientY,d=0;d<this.lastTouches.length;d++){var e=this.lastTouches[d],f=Math.abs(b-e.x),g=Math.abs(c-e.y);if(db>=f&&db>=g)return!0}return!1}function V(a,b){this.manager=a,this.set(b)}function W(a){if(p(a,jb))return jb;var b=p(a,kb),c=p(a,lb);return b&&c?jb:b||c?b?kb:lb:p(a,ib)?ib:hb}function X(){if(!fb)return!1;var b={},c=a.CSS&&a.CSS.supports;return[\"auto\",\"manipulation\",\"pan-y\",\"pan-x\",\"pan-x pan-y\",\"none\"].forEach(function(d){b[d]=c?a.CSS.supports(\"touch-action\",d):!0}),b}function Y(a){this.options=la({},this.defaults,a||{}),this.id=v(),this.manager=null,this.options.enable=l(this.options.enable,!0),this.state=nb,this.simultaneous={},this.requireFail=[]}function Z(a){return a&sb?\"cancel\":a&qb?\"end\":a&pb?\"move\":a&ob?\"start\":\"\"}function $(a){return a==Ma?\"down\":a==La?\"up\":a==Ja?\"left\":a==Ka?\"right\":\"\"}function _(a,b){var c=b.manager;return c?c.get(a):a}function aa(){Y.apply(this,arguments)}function ba(){aa.apply(this,arguments),this.pX=null,this.pY=null}function ca(){aa.apply(this,arguments)}function da(){Y.apply(this,arguments),this._timer=null,this._input=null}function ea(){aa.apply(this,arguments)}function fa(){aa.apply(this,arguments)}function ga(){Y.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ha(a,b){return b=b||{},b.recognizers=l(b.recognizers,ha.defaults.preset),new ia(a,b)}function ia(a,b){this.options=la({},ha.defaults,b||{}),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=a,this.input=y(this),this.touchAction=new V(this,this.options.touchAction),ja(this,!0),g(this.options.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function ja(a,b){var c=a.element;if(c.style){var d;g(a.options.cssProps,function(e,f){d=u(c.style,f),b?(a.oldCssProps[d]=c.style[d],c.style[d]=e):c.style[d]=a.oldCssProps[d]||\"\"}),b||(a.oldCssProps={})}}function ka(a,c){var d=b.createEvent(\"Event\");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}var la,ma=[\"\",\"webkit\",\"Moz\",\"MS\",\"ms\",\"o\"],na=b.createElement(\"div\"),oa=\"function\",pa=Math.round,qa=Math.abs,ra=Date.now;la=\"function\"!=typeof Object.assign?function(a){if(a===d||null===a)throw new TypeError(\"Cannot convert undefined or null to object\");for(var b=Object(a),c=1;c<arguments.length;c++){var e=arguments[c];if(e!==d&&null!==e)for(var f in e)e.hasOwnProperty(f)&&(b[f]=e[f])}return b}:Object.assign;var sa=h(function(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a},\"extend\",\"Use `assign`.\"),ta=h(function(a,b){return sa(a,b,!0)},\"merge\",\"Use `assign`.\"),ua=1,va=/mobile|tablet|ip(ad|hone|od)|android/i,wa=\"ontouchstart\"in a,xa=u(a,\"PointerEvent\")!==d,ya=wa&&va.test(navigator.userAgent),za=\"touch\",Aa=\"pen\",Ba=\"mouse\",Ca=\"kinect\",Da=25,Ea=1,Fa=2,Ga=4,Ha=8,Ia=1,Ja=2,Ka=4,La=8,Ma=16,Na=Ja|Ka,Oa=La|Ma,Pa=Na|Oa,Qa=[\"x\",\"y\"],Ra=[\"clientX\",\"clientY\"];x.prototype={handler:function(){},init:function(){this.evEl&&m(this.element,this.evEl,this.domHandler),this.evTarget&&m(this.target,this.evTarget,this.domHandler),this.evWin&&m(w(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(w(this.element),this.evWin,this.domHandler)}};var Sa={mousedown:Ea,mousemove:Fa,mouseup:Ga},Ta=\"mousedown\",Ua=\"mousemove mouseup\";i(L,x,{handler:function(a){var b=Sa[a.type];b&Ea&&0===a.button&&(this.pressed=!0),b&Fa&&1!==a.which&&(b=Ga),this.pressed&&(b&Ga&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:Ba,srcEvent:a}))}});var Va={pointerdown:Ea,pointermove:Fa,pointerup:Ga,pointercancel:Ha,pointerout:Ha},Wa={2:za,3:Aa,4:Ba,5:Ca},Xa=\"pointerdown\",Ya=\"pointermove pointerup pointercancel\";a.MSPointerEvent&&!a.PointerEvent&&(Xa=\"MSPointerDown\",Ya=\"MSPointerMove MSPointerUp MSPointerCancel\"),i(M,x,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace(\"ms\",\"\"),e=Va[d],f=Wa[a.pointerType]||a.pointerType,g=f==za,h=r(b,a.pointerId,\"pointerId\");e&Ea&&(0===a.button||g)?0>h&&(b.push(a),h=b.length-1):e&(Ga|Ha)&&(c=!0),0>h||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var Za={touchstart:Ea,touchmove:Fa,touchend:Ga,touchcancel:Ha},$a=\"touchstart\",_a=\"touchstart touchmove touchend touchcancel\";i(N,x,{handler:function(a){var b=Za[a.type];if(b===Ea&&(this.started=!0),this.started){var c=O.call(this,a,b);b&(Ga|Ha)&&c[0].length-c[1].length===0&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:za,srcEvent:a})}}});var ab={touchstart:Ea,touchmove:Fa,touchend:Ga,touchcancel:Ha},bb=\"touchstart touchmove touchend touchcancel\";i(P,x,{handler:function(a){var b=ab[a.type],c=Q.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:za,srcEvent:a})}});var cb=2500,db=25;i(R,x,{handler:function(a,b,c){var d=c.pointerType==za,e=c.pointerType==Ba;if(!(e&&c.sourceCapabilities&&c.sourceCapabilities.firesTouchEvents)){if(d)S.call(this,b,c);else if(e&&U.call(this,c))return;this.callback(a,b,c)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var eb=u(na.style,\"touchAction\"),fb=eb!==d,gb=\"compute\",hb=\"auto\",ib=\"manipulation\",jb=\"none\",kb=\"pan-x\",lb=\"pan-y\",mb=X();V.prototype={set:function(a){a==gb&&(a=this.compute()),fb&&this.manager.element.style&&mb[a]&&(this.manager.element.style[eb]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){k(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),W(a.join(\" \"))},preventDefaults:function(a){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var d=this.actions,e=p(d,jb)&&!mb[jb],f=p(d,lb)&&!mb[lb],g=p(d,kb)&&!mb[kb];if(e){var h=1===a.pointers.length,i=a.distance<2,j=a.deltaTime<250;if(h&&i&&j)return}return g&&f?void 0:e||f&&c&Na||g&&c&Oa?this.preventSrc(b):void 0},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var nb=1,ob=2,pb=4,qb=8,rb=qb,sb=16,tb=32;Y.prototype={defaults:{},set:function(a){return la(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,\"recognizeWith\",this))return this;var b=this.simultaneous;return a=_(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,\"dropRecognizeWith\",this)?this:(a=_(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,\"requireFailure\",this))return this;var b=this.requireFail;return a=_(a,this),-1===r(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,\"dropRequireFailure\",this))return this;a=_(a,this);var b=r(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(b,a)}var c=this,d=this.state;qb>d&&b(c.options.event+Z(d)),b(c.options.event),a.additionalEvent&&b(a.additionalEvent),d>=qb&&b(c.options.event+Z(d))},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=tb)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(tb|nb)))return!1;a++}return!0},recognize:function(a){var b=la({},a);return k(this.options.enable,[this,b])?(this.state&(rb|sb|tb)&&(this.state=nb),this.state=this.process(b),void(this.state&(ob|pb|qb|sb)&&this.tryEmit(b))):(this.reset(),void(this.state=tb))},process:function(a){},getTouchAction:function(){},reset:function(){}},i(aa,Y,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(ob|pb),e=this.attrTest(a);return d&&(c&Ha||!e)?b|sb:d||e?c&Ga?b|qb:b&ob?b|pb:ob:tb}}),i(ba,aa,{defaults:{event:\"pan\",threshold:10,pointers:1,direction:Pa},getTouchAction:function(){var a=this.options.direction,b=[];return a&Na&&b.push(lb),a&Oa&&b.push(kb),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Na?(e=0===f?Ia:0>f?Ja:Ka,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?Ia:0>g?La:Ma,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return aa.prototype.attrTest.call(this,a)&&(this.state&ob||!(this.state&ob)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=$(a.direction);b&&(a.additionalEvent=this.options.event+b),this._super.emit.call(this,a)}}),i(ca,aa,{defaults:{event:\"pinch\",threshold:0,pointers:2},getTouchAction:function(){return[jb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&ob)},emit:function(a){if(1!==a.scale){var b=a.scale<1?\"in\":\"out\";a.additionalEvent=this.options.event+b}this._super.emit.call(this,a)}}),i(da,Y,{defaults:{event:\"press\",pointers:1,time:251,threshold:9},getTouchAction:function(){return[hb]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Ga|Ha)&&!f)this.reset();else if(a.eventType&Ea)this.reset(),this._timer=e(function(){this.state=rb,this.tryEmit()},b.time,this);else if(a.eventType&Ga)return rb;return tb},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===rb&&(a&&a.eventType&Ga?this.manager.emit(this.options.event+\"up\",a):(this._input.timeStamp=ra(),this.manager.emit(this.options.event,this._input)))}}),i(ea,aa,{defaults:{event:\"rotate\",threshold:0,pointers:2},getTouchAction:function(){return[jb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&ob)}}),i(fa,aa,{defaults:{event:\"swipe\",threshold:10,velocity:.3,direction:Na|Oa,pointers:1},getTouchAction:function(){return ba.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Na|Oa)?b=a.overallVelocity:c&Na?b=a.overallVelocityX:c&Oa&&(b=a.overallVelocityY),this._super.attrTest.call(this,a)&&c&a.offsetDirection&&a.distance>this.options.threshold&&a.maxPointers==this.options.pointers&&qa(b)>this.options.velocity&&a.eventType&Ga},emit:function(a){var b=$(a.offsetDirection);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),i(ga,Y,{defaults:{event:\"tap\",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ib]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&Ea&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Ga)return this.failTimeout();var g=this.pTime?a.timeStamp-this.pTime<b.interval:!0,h=!this.pCenter||H(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;var i=this.count%b.taps;if(0===i)return this.hasRequireFailures()?(this._timer=e(function(){this.state=rb,this.tryEmit()},b.interval,this),ob):rb}return tb},failTimeout:function(){return this._timer=e(function(){this.state=tb},this.options.interval,this),tb},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==rb&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ha.VERSION=\"2.0.8\",ha.defaults={domEvents:!1,touchAction:gb,enable:!0,inputTarget:null,inputClass:null,preset:[[ea,{enable:!1}],[ca,{enable:!1},[\"rotate\"]],[fa,{direction:Na}],[ba,{direction:Na},[\"swipe\"]],[ga],[ga,{event:\"doubletap\",taps:2},[\"tap\"]],[da]],cssProps:{userSelect:\"none\",touchSelect:\"none\",touchCallout:\"none\",contentZooming:\"none\",userDrag:\"none\",tapHighlightColor:\"rgba(0,0,0,0)\"}};var ub=1,vb=2;ia.prototype={set:function(a){return la(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?vb:ub},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&rb)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],b.stopped===vb||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(ob|pb|qb)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof Y)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,\"add\",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,\"remove\",this))return this;if(a=this.get(a)){var b=this.recognizers,c=r(b,a);-1!==c&&(b.splice(c,1),this.touchAction.update())}return this},on:function(a,b){if(a!==d&&b!==d){var c=this.handlers;return g(q(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this}},off:function(a,b){if(a!==d){var c=this.handlers;return g(q(a),function(a){b?c[a]&&c[a].splice(r(c[a],b),1):delete c[a]}),this}},emit:function(a,b){this.options.domEvents&&ka(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&ja(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},la(ha,{INPUT_START:Ea,INPUT_MOVE:Fa,INPUT_END:Ga,INPUT_CANCEL:Ha,STATE_POSSIBLE:nb,STATE_BEGAN:ob,STATE_CHANGED:pb,STATE_ENDED:qb,STATE_RECOGNIZED:rb,STATE_CANCELLED:sb,STATE_FAILED:tb,DIRECTION_NONE:Ia,DIRECTION_LEFT:Ja,DIRECTION_RIGHT:Ka,DIRECTION_UP:La,DIRECTION_DOWN:Ma,DIRECTION_HORIZONTAL:Na,DIRECTION_VERTICAL:Oa,DIRECTION_ALL:Pa,Manager:ia,Input:x,TouchAction:V,TouchInput:P,MouseInput:L,PointerEventInput:M,TouchMouseInput:R,SingleTouchInput:N,Recognizer:Y,AttrRecognizer:aa,Tap:ga,Pan:ba,Swipe:fa,Pinch:ca,Rotate:ea,Press:da,on:m,off:n,each:g,merge:ta,extend:sa,assign:la,inherit:i,bindFn:j,prefixed:u});var wb=\"undefined\"!=typeof a?a:\"undefined\"!=typeof self?self:{};wb.Hammer=ha,\"function\"==typeof define&&define.amd?define(function(){return ha}):\"undefined\"!=typeof module&&module.exports?module.exports=ha:a[c]=ha}(window,document,\"Hammer\");\n\n    const $this = $(container);\n    $this.find(\".description .gallery li:first-child\").addClass(\"active\");\n    $this.find(\".description .gallery .paging a:first-child\").addClass(\"current\");\n    $this.find(\".description .gallery img\").on('load', () => {\n        let totalW = 104;\n        for (let i = 0; i < $this.find(\".description .gallery li\").length; i++) {\n            totalW = totalW + $this.find(\".description .gallery li:eq(\" + i + \") img\").width() + 20;\n            $this.find(\".description .gallery .photo-list\").width(totalW);\n        }\n    });\n    $this.find(\".description .gallery\").each((i, e) => {\n        const { Hammer } = window;\n        (new Hammer(e)).on('swipe', function({ type, direction }) {\n            console.log(arguments[0])\n            if (type === 'swipe') {\n                if (direction === Hammer.DIRECTION_LEFT) {\n                    $(e).find('.paging .prev')[0].click();\n                } else if (direction === Hammer.DIRECTION_RIGHT) {\n                    $(e).find('.paging .next')[0].click();\n                }\n            }\n        })\n    });\n}\n","\nexport const FancyStatus = {\n    Addition: 'Addition',\n    Removal: 'Removal',\n    AfterAddition: 'AfterAddition',\n    AfterRemoval: 'AfterRemoval',\n    Idle: 'Idle',\n};\n\nconst commonWrapperSelector = '#sidebar .wrapper.article';\nexport const Selectors = {\n    HomepageWrapper: commonWrapperSelector,\n};\n","import { KEYS, didClickOn, getObjectTypeFromUrl, getPathname, isPlainLeftClick, isHomepage } from \"fancyutils\";\n\nimport store from \"../store/store\";\nimport { Selectors } from \"../config\";\nimport { LinkTypes, transition } from \"./routeutils\";\nimport { closeOverlay } from \"../action/action-helpers\";\nimport { historyData } from './history';\n\n\nfunction handleOverlayArticleKeyEvents(event) {\n    if (event.target.tagName === \"TEXTAREA\" || event.target.tagName === \"INPUT\") {\n        return;\n    }\n\n    switch (event.which) {\n        case KEYS.ESC:\n            // If popup is not on\n            if ($(\"#popup_container:visible\").length === 0) {\n                store.dispatch(closeOverlay());\n            }\n            break;\n    }\n}\n\nfunction conditionalTransition(aElement) {\n    // Turn off video\n    $(\"#container-wrapper .btn-pause\")\n        .attr(\"scroll\", true)\n        .click();\n    // Ensure anchor is static (sticked to homepage timeline) or not.\n    if (isHomepage() && $(Selectors.HomepageWrapper).has(aElement)) {\n        transition(aElement.getAttribute(\"href\"), LinkTypes.Static);\n    } else {\n        transition(aElement.getAttribute(\"href\"));\n    }\n}\n\nvar oneshotEventAttached = false;\nexport function attachEntryEvents() {\n    if (oneshotEventAttached) {\n        return;\n    }\n    oneshotEventAttached = true;\n    // Remove pre-existing url event and start transition first\n    $(document.body).off(\"click.overlayArticleInit\");\n    if (window.__INIT_ARTICLE_ANCHOR != null) {\n        conditionalTransition(window.__INIT_ARTICLE_ANCHOR);\n        delete window.__INIT_ARTICLE_ANCHOR;\n    }\n    // TODO: replace to class-based event binding\n    $(document.body).on(\"click\", \"a\", function(event) {\n        if (\n            isPlainLeftClick(event) &&\n            this.getAttribute(\"data-prevent-overlay\") == null &&\n            getObjectTypeFromUrl(getPathname(this)) === \"Article\"\n        ) {\n            event.preventDefault();\n            // note: key event will be detached inside `closeOverlay()` call\n            $(document).on(\"keydown.overlayArticle\", handleOverlayArticleKeyEvents);\n            conditionalTransition(this);\n        }\n    });\n\n    $(\"#overlay-article\").on(\"click\", function(event) {\n        const $targ = $(event.target);\n        if (didClickOn($targ, \"#article-container\") || historyData.initialPageIsArticlePage) {\n            //pass\n        } else {\n            store.dispatch(closeOverlay());\n        }\n    });\n}\n\nexport const OaContainer = {\n    isStatic() {\n        return $(document.body).is(\".static-article\");\n    },\n    getDynamic() {\n        return $(\"#article-container\");\n    },\n    getStatic() {\n        return $(document);\n    },\n    get() {\n        return this.isStatic() ? this.getStatic() : this.getDynamic();\n    },\n    scrollToTop() {\n        if (this.isStatic()) {\n            $(document.body.parentElement).scrollTop(0);\n        } else {\n            this.getDynamic().scrollTop(0);\n        }\n    }\n};\n","import { extractMetaFromArticleURL, extractMetaFromURL } from 'fancyutils';\nimport { history } from 'common-components';\nimport store from '../store/store';\nimport { closeOverlay, fetchArticle } from '../action/action-helpers';\nimport {\n    closeArticle,\n} from '../action/actions';\n\n\nconst initialArticlePageID = extractMetaFromArticleURL(location.pathname).id;\nconst initialPageIsArticlePage = initialArticlePageID != null;\n\n// This stores initial static page history info that needs to be restored when modal get closed.\nexport const historyData = {\n    initialPath: location.pathname,\n    /* mut */preservedHref: location.href, // Preserved Href just before open, and to be returned when closed.\n    initialArticlePageID,\n    initialPageIsArticlePage,\n    initialTitle: document.title,\n    // This prop indicates current location is (static) article page. Mutable.\n    locationIsArticlePage: initialPageIsArticlePage,\n    overlayIsOn: false,\n};\n\nexport function runOverlay(articleID, articleURLType, killCache = false, queryString) {\n    if (!$(document.body).hasClass('error-page')) {\n        // Context needs to be isolated from hook: https://github.com/rackt/redux-router/issues/157\n        requestIdleCallback(() => {\n            $(document.body).addClass('article-overlay-on');\n            store.dispatch(fetchArticle(articleID, articleURLType, killCache, queryString));\n            historyData.overlayIsOn = true;\n        });\n    }\n}\n\nexport function stopOverlay() {\n    historyData.overlayIsOn = false;\n    store.dispatch(closeOverlay());\n}\n\nexport function historyHook({ pathname, search /*, action*/ }) {\n    const meta = extractMetaFromArticleURL(pathname);\n    const articleID = meta && meta.id;\n    // When initially (statically) renderred page is article page\n    // Moving to new article page\n    historyData.locationIsArticlePage = articleID != null;\n    if (historyData.locationIsArticlePage) {\n        runOverlay(articleID, meta.type, false, search);\n    } else if (historyData.overlayIsOn) {\n        stopOverlay();\n    }\n}\n\nhistory.listen(historyHook)\n","import { extractMetaFromArticleURL, getObjectTypeFromUrl, isStaticPage, stripPathname } from 'fancyutils';\nimport { history } from 'common-components';\n\nimport { historyData } from './history';\n\n\nexport const LinkTypes = {\n    Dynamic: 0,\n    Static: 1,\n    Timeline: 2,\n    Internal: 3, // no update needed\n};\n\n// `staticLink`: transition from statically attached links\nexport function transition(href) {\n    // ID-only\n    if (!_.isNaN(Number(href))) {\n        href = `/articles/${href}`;\n    }\n\n    if (getObjectTypeFromUrl(href) === 'Article') {\n        const meta = extractMetaFromArticleURL(href);\n        // Update URL to go back when overlay is closed\n        if (!historyData.overlayIsOn) {\n            historyData.preservedHref = location.href;\n        }\n        history.push(stripPathname(meta.href), null);\n\n    } else {\n        redirect(href);\n    }\n}\n\nexport function closeModal() {\n    if (isStaticPage()) {\n        return;\n    }\n    $(document.body).removeClass('article-overlay-on');\n}\n\nexport function redirect(destination) {\n    if (destination == null) {\n        return false;\n    } else {\n        location.href = destination;\n        return true;\n    }\n}\n","import React, { Component } from 'react';\n\nimport { closeOverlay } from '../action/action-helpers';\nimport store from '../store/store';\nimport { historyHook } from './history';\n\n\nclass App extends Component {\n    handleCloseArticle(event) {\n        event.preventDefault();\n        event.stopPropagation();\n        store.dispatch(closeOverlay());\n    }\n\n    render() {\n        return (\n            <div className={`popup article ${window.isWhitelabel ? 'whitelabel-article' : ''} ${window.isWhitelabelV2 ? 'whitelabel-article-v2' : ''}`} id=\"article-container\">\n                {this.props.children}\n                <a href=\"#\" className=\"ly-close\" onClick={this.handleCloseArticle}>Close</a>\n            </div>\n        );\n    }\n}\n\nexport default App;\n","// This module deals with outside of React context (mostly raw DOM) with observing DOM structure and \n// do sub'd actions when React-context actions fires.\nimport { dedupeArray } from 'fancyutils';\n\n/*\nif (process.env.NODE_ENV !== 'production') {\n    window.__assert = true;\n}\n\nfunction assert(a,b) {\n    if (window.__assert) console.assert(a,b)\n}\n*/\n\nfunction findFancyButton(id)/*:jQuery?*/ {\n    if (typeof id === 'string') {\n        const domCache = thingsDomCache[id];\n        if (typeof domCache === 'object') {\n            return $(domCache);\n        } else if (domCache === false) {\n            // NOOP\n        } else {\n            const $query = $(`#container-wrapper a[href^=\"/things/${id}\"]:visible`);\n            if ($query.length > 0) {\n                const containers = dedupeArray(\n                    $query.map((i, e) => {\n                        return $(e).closest('div.figure-item').get(0)\n                    }).toArray()\n                );\n                if (containers && containers.length > 0) {\n                    const $btn = $(containers[0]).find('button.fancy, button.fancyd, a.fancyd, a.fancy');\n                    if ($btn.length > 0) {\n                        thingsDomCache[id] = $btn[0];\n                        return $btn;\n                    }\n                }\n            }\n            // If not returned\n            thingsDomCache[id] = false;\n        }\n    }\n}\n\nfunction findArticleFancyButton(id)/*:jQuery?*/ {\n    if (typeof id === 'string') {\n        const domCache = thingsDomCache[id];\n        if (typeof domCache === 'object') {\n            return $(domCache);\n        } else if (domCache === false) {\n            // NOOP\n        } else {\n            const $query = $(`#container-wrapper a[href^=\"/articles/${id}\"]:visible`);\n            if ($query.length > 0) {\n                const containers = dedupeArray(\n                    $query.map((i, e) => {\n                        return $(e).closest('div.article_item').get(0)\n                    }).toArray()\n                );\n                if (containers && containers.length > 0) {\n                    const $btn = $(containers[0]).find('button.fancy, button.fancyd, a.fancyd, a.fancy');\n                    if ($btn.length > 0) {\n                        thingsDomCache[id] = $btn[0];\n                        return $btn;\n                    }\n                }\n            }\n            // If not returned\n            thingsDomCache[id] = false;\n        }\n    }\n}\n\n// via thing id \nconst thingsDomCache = {};\n\nfunction toggleFancyButton($btn, fancyd) {\n    $btn.removeClass('fancy').removeClass('fancyd');\n    $btn.addClass(fancyd ? 'fancyd' : 'fancy');\n}\n\nfunction replaceFancyCount($btn, fancyd, fc) {\n    // Fancy | Fancy'd\n    if ($btn.text().toLowerCase().indexOf('fancy') >= 0) {\n        $btn.html(`<span><i></i></span> ${fancyd ? 'Fancy\\'d' : 'Fancy'}`);\n    // Fancy count\n    } else {\n        $btn.html(`<span><i></i></span> ${fc}`);\n    }\n}\n\nexport function onFancyButtonUpdate(id/*:string*/, fancyd/*:boolean*/, fc/*:string*/) {\n    const $btn = findFancyButton(id);\n    if ($btn && $btn.length > 0) {\n        toggleFancyButton($btn, fancyd);\n        replaceFancyCount($btn, fancyd, fc);\n    }\n}\n\nexport function onArticleFancyButtonUpdate(id/*:string*/, fancyd/*:boolean*/, fc/*:string*/) {\n    const $btn = findArticleFancyButton(id);\n    if ($btn && $btn.length > 0) {\n        toggleFancyButton($btn, fancyd);\n        replaceFancyCount($btn, fancyd, fc);\n    }\n}\n","import React, { Component } from 'react';\nimport classnames from 'classnames';\nimport { MP, getConciseNumberString } from 'fancyutils';\nimport { Display } from 'fancymixin';\n\nimport { FancyStatus } from '../config';\nimport { cache } from '../cache';\nimport { onArticleFancyButtonUpdate } from '../SyncedContext';\n\nexport function handleProfileMouseOver(event) {\n    const $profile = $(event.currentTarget).find('em');\n    $profile.css('margin-left', `${-($profile.width() / 2) - 10}px`);\n}\n\nconst FancydUser = ({ user = {}, display, isViewer }) => (\n    <a href={user.html_url}\n       className={classnames(\"user\", { _viewer: isViewer })}\n       onMouseOver={handleProfileMouseOver}\n       style={display}>\n        <img src=\"/_ui/images/common/blank.gif\"\n             style={{ backgroundImage: `url(${user.image_url || user.profile_image_url})`}} />\n        <em>{user.fullname || user.full_name}</em>\n    </a>\n);\n\nconst bgXPosSequence = [0, -54, -108, -163, -218, -272, -327, -436, -490, -545, -599, -654, -708, -763, -817, -872, -926, -981, -1035, -1144, -1199, -1253, -1308, -1417, -1471];\n\nfunction isUserEqual(a, b) {\n    if (a == null || b == null) {\n        return false;\n    }\n    return a.id === b.id;\n}\n\nfunction _handleFancydStateOnLoadArticle(slug, { fancyd, save_count }, stateSetter = _ => _) {\n    onArticleFancyButtonUpdate(slug, fancyd, getConciseNumberString(save_count));\n    stateSetter({\n        fancyd,\n        save_count,\n        loading: false,\n        fancyStatus: FancyStatus.Idle,\n    })\n}\n\nfunction getFancyStatus(nextFancydState) {\n    return nextFancydState ? FancyStatus.Addition : FancyStatus.Removal;\n}\nfunction getCompletionIdleStatus(currentFancyState) {\n    const prevFancyState = !currentFancyState;\n    return prevFancyState ? FancyStatus.AfterRemoval : FancyStatus.AfterAddition;\n}\nfunction getNextFancydCount(nextFancyd, currentFancydCount) {\n    if (nextFancyd === true) {\n        return currentFancydCount + 1;\n    } else {\n        return currentFancydCount - 1;\n    }\n}\nfunction toggleFancy(article, currentState, stateSetter = _ => _) {\n    const { fancyd, save_count, loading } = currentState;\n    const nextFancyd = !fancyd;\n    const nextFancydCount = getNextFancydCount(nextFancyd, save_count);\n    \n    if (!loading) {\n        stateSetter({\n            fancyd: nextFancyd, loading: true, fancyStatus: getFancyStatus(nextFancyd)\n        });\n\n        $.ajax({\n            type: 'POST',\n            url: '/articles/save.json',\n            data: {\n                article_id: article.id,\n                action: nextFancyd ? 'save':'unsave',\n            }\n        })\n        .done(function(json){\n            if (json.article_id && json.saved === !fancyd) {\n                // Completing fancy\n                \n                cache.update(article.slug, undefined, 'saved', nextFancyd);\n                cache.update(article.slug, undefined, 'save_count', nextFancydCount);\n                onArticleFancyButtonUpdate(article.slug, nextFancyd, getConciseNumberString(nextFancydCount));\n                \n                stateSetter({\n                    loading: false, fancyd: nextFancyd, save_count: nextFancydCount, fancyStatus: getCompletionIdleStatus(nextFancyd)\n                });\n            } else {\n                // cancelling fancy\n                stateSetter({ loading: false, fancyd, save_count, fancyStatus: getFancyStatus(fancyd) });\n            }\n        })\n        .fail(function() {\n            // cancelling fancy\n            stateSetter({ loading: false, fancyd, save_count, fancyStatus: getFancyStatus(fancyd) });\n        });\n    }\n}\n\nexport class FancydUsers extends Component {\n    _getInitialState() {\n        return {\n            fancyAnimation: false,\n            // button state\n            fancyd: null,\n            loading: false,\n            save_count: null,\n            fancyStatus: FancyStatus.Idle, // fancyStatus = 'Idle', { Idle | Addition | Removal | After- } - Fancy'd status for animation control\n        };\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = this._getInitialState();\n        this.fancyBGAnimationRef = element => {\n            this.fancyBGAnimation = element;\n        }\n    }\n\n    getFancydCountString = () => {\n        const { save_count } = this.state;\n        return save_count != null ? getConciseNumberString(save_count, 0) : '0';\n    }\n\n    animateFancyBG = (frame) => {\n        if (frame === undefined) {\n            this.animateFancyBG(0);\n        } else if (frame < bgXPosSequence.length) {\n            // Special branching due to misposition in background\n            var xPos = bgXPosSequence[frame];\n            $(this.fancyBGAnimation).css('background-position-x', `${xPos}px`);\n            setTimeout(() => { this.animateFancyBG(frame + 1) }, 10);\n        } else if (frame >= bgXPosSequence.length) {\n            this.setState({ fancyAnimation: false });\n        }\n    }\n\n    getFancyduserDisplay = (user, index, totalLength) => {\n        const {\n            appContext: { viewer },\n        } = this.props;\n        const {\n            fancyd,\n            fancyStatus,\n        } = this.state;\n\n        const first = index === 0;\n        const last = index === totalLength - 1;\n\n        var display;\n        if (fancyStatus === FancyStatus.AfterAddition || fancyStatus === FancyStatus.Addition) {\n            // designer satisfaction 1)\n            if (totalLength <= 8) {\n                display = Display.Inline;\n            } else {\n                if (first) {\n                    display = Display.Inline;\n                } \n            }\n        } else if (fancyStatus === FancyStatus.AfterRemoval || fancyStatus === FancyStatus.Removal) {\n            if (first) {\n                display = Display.None;\n            } else if (last) {\n                display = Display.Inline;\n            }\n        }\n        // designer satisfaction 2) https://app.asana.com/0/86925821949642/161445424426526\n        const indexLimit = 8;\n        if (\n            (fancyStatus === FancyStatus.AfterAddition ||\n             fancyStatus === FancyStatus.Addition ||\n             (fancyd && fancyStatus === FancyStatus.Idle)\n            ) &&\n            index > indexLimit\n        ) {\n            display = Display.None;\n        }else if (\n            fancyStatus === FancyStatus.Removal \n            &&\n            index >= indexLimit\n        ) {\n            display = Display.None;\n        }\n\n        if (fancyStatus === FancyStatus.Idle &&\n            !fancyd &&\n            isUserEqual(user, viewer)\n        ) {\n            display = Display.None;\n        }\n\n        return display;\n    }\n\n    toggleFancy = () => {\n        toggleFancy(this.props.article, this.state, ns => { this.setState(ns) });\n    }\n\n    handleFancydStateOnLoadArticle = (article) => {\n        if (article == null) {\n            article = this.props.article;\n        }\n        _handleFancydStateOnLoadArticle(article.slug, { fancyd: article.saved, save_count: article.save_count  }, ns => { this.setState(ns); });\n    }\n\n    handleFancyClick = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        const { article } = this.props;\n        if (!this.props.appContext.loggedIn) {\n            window.require_login && window.require_login(null, 'fancy_article', article.id);\n            return;\n        }\n        const { fancyAnimation, fancyd, loading } = this.state;\n        if (loading) {\n            return;\n        }\n        if (!fancyd && !fancyAnimation) {\n            this.setState({ fancyAnimation: true }, _ => { this.animateFancyBG(); });\n        }\n\n        if (!fancyd) {\n            MP('Fancy', { article_id: article.id });\n        } else {\n            MP('Unfancy', { article_id: article.id });\n        }\n\n        this.toggleFancy();\n    }\n\n    componentDidMount() {\n        this.handleFancydStateOnLoadArticle();\n    }\n\n    componentDidUpdate(prevProps) {\n        const { article } = prevProps;\n        const np = this.props\n        // Thing has been updated.\n        if (article.id !== np.article.id || article.isCrawled !== np.article.isCrawled) {\n            this.handleFancydStateOnLoadArticle(article);\n        }\n    }\n\n    render() {\n        const {\n            appContext: { loggedIn, viewer },\n            article: { saved_users, user },\n        } = this.props;\n        const {\n            fancyd,\n            fancyAnimation,\n            fancyStatus,\n        } = this.state;\n\n        const fancydUsers = [\n            loggedIn && viewer,\n            loggedIn && !isUserEqual(viewer, user) && user\n        ]\n        .concat(\n            saved_users &&\n            saved_users.filter(fancydUser => !isUserEqual(fancydUser, user) &&\n                                              !isUserEqual(fancydUser, viewer))\n        )\n        .filter(e => e);\n\n        var fancydUserAnimClass;\n        if (fancyStatus === FancyStatus.Addition) {\n            fancydUserAnimClass = \"add\";\n        } else if (fancyStatus === FancyStatus.Removal) {\n            fancydUserAnimClass = \"remove\";\n        }\n\n        // designer satisfaction 1)\n        // If user is less than 2 we need to apply special class.\n        // In this way dont owner profile dont get 'consumed': https://app.asana.com/0/86925821949642/173945332708784\n        const userCountSufficiency = fancydUsers.length <= 2 ? '_insuff' : '_suff';\n\n        return (\n            <div className=\"like\">\n                <span className=\"count\">\n                    <a onClick={this.handleFancyClick}\n                       className={classnames(\"button button-static fancy _count\", { fancyd, loading: fancyAnimation })}>\n                        <span ref={this.fancyBGAnimationRef}>\n                            <i />\n                        </span>{this.getFancydCountString()}\n                    </a>\n                    <span className=\"_fancyd\" />\n                </span>\n                <span className={classnames(\"fancyd_user\", fancydUserAnimClass, userCountSufficiency)}>\n                    {fancydUsers.map((user, index) => {\n                        const isViewer = isUserEqual(user, viewer);\n                        return (\n                            <FancydUser key={index}\n                                        user={user}\n                                        display={this.getFancyduserDisplay(user, index, fancydUsers.length)}\n                                        isViewer={isViewer} />\n                        );\n                    })}\n                </span>\n            </div>\n        );\n    }\n}\n","import React, { Component, lazy, Suspense } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { connect } from \"react-redux\";\nimport { MoreShare, Video } from \"common-components\";\nimport { isStaticArticlePage } from \"fancyutils\";\nimport dateFormat from 'date-fns/format';\n\nimport { historyData } from \"../container/history\";\nimport { FancydUsers } from \"./ArticleFancydUsers\";\nimport { OaContainer } from \"../container/entry-events\";\nimport { AdminHeader, ArticleList, ThingList, initGallery } from \"./ArticleWidgets\";\nimport \"../Shortcode\";\nimport { applyProductSlide } from 'common-components';\n\n\nfunction mapStateToProps(state) {\n    var { appContext, article: { data, isFetching, status } } = state;\n\n    if (data && data.content && window.convertArticleShortcode) {\n        data.content = window.convertArticleShortcode(data.content);\n    }\n\n    return {\n        appContext,\n        status,\n        article: data,\n        isFetching\n    };\n}\nconst Lightbox = lazy(() => import(/* webpackChunkName: \"OverlayArticle\" */'react-images'));\n\n// Container class for overlayed article detail.\nexport class OverlayArticle extends Component {\n    componentDidMount() {\n        OaContainer.scrollToTop();\n        applyProductSlide();\n\n        // fitvids 1.2.0\n        !function(t){t.fn.fitVids=function(e){var i={customSelector:null,ignore:null};if(!document.getElementById(\"fit-vids-style\")){var r=document.head||document.getElementsByTagName(\"head\")[0],a=\".fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}\",d=document.createElement(\"div\");d.innerHTML='<p>x</p><style id=\"fit-vids-style\">'+a+\"</style>\",r.appendChild(d.childNodes[1])}return e&&t.extend(i,e),this.each(function(){var e=['iframe[src*=\"player.vimeo.com\"]','iframe[src*=\"youtube.com\"]','iframe[src*=\"youtube-nocookie.com\"]','iframe[src*=\"kickstarter.com\"][src*=\"video.html\"]',\"object\",\"embed\"];i.customSelector&&e.push(i.customSelector);var r=\".fitvidsignore\";i.ignore&&(r=r+\", \"+i.ignore);var a=t(this).find(e.join(\",\"));a=a.not(\"object object\"),a=a.not(r),a.each(function(){var e=t(this);if(!(e.parents(r).length>0||\"embed\"===this.tagName.toLowerCase()&&e.parent(\"object\").length||e.parent(\".fluid-width-video-wrapper\").length)){e.css(\"height\")||e.css(\"width\")||!isNaN(e.attr(\"height\"))&&!isNaN(e.attr(\"width\"))||(e.attr(\"height\",9),e.attr(\"width\",16));var i=\"object\"===this.tagName.toLowerCase()||e.attr(\"height\")&&!isNaN(parseInt(e.attr(\"height\"),10))?parseInt(e.attr(\"height\"),10):e.height(),a=isNaN(parseInt(e.attr(\"width\"),10))?e.width():parseInt(e.attr(\"width\"),10),d=i/a;if(!e.attr(\"name\")){var o=\"fitvid\"+t.fn.fitVids._count;e.attr(\"name\",o),t.fn.fitVids._count++}e.wrap('<div class=\"fluid-width-video-wrapper\"></div>').parent(\".fluid-width-video-wrapper\").css(\"padding-top\",100*d+\"%\"),e.removeAttr(\"height\").removeAttr(\"width\")}})})},t.fn.fitVids._count=0}(window.jQuery||window.Zepto);\n\n        $('.media-youtube').fitVids();\n    }\n\n    componentDidUpdate(prevProps) {\n        const pt = prevProps.article;\n        const ct = this.props.article;\n\n        if (ct != null) {\n            if (!pt || pt.id !== ct.id) {\n                if (!isStaticArticlePage()) {\n                    $(\"#overlay-article > .popup\").attr(\"tabindex\", -1).focus();\n                }\n                OaContainer.scrollToTop();\n            }\n\n            if (this.props.appContext.viewer.is_admin_senior) {\n                $(\"body\").addClass(\"admin\");\n            } else {\n                $(\"body\").removeClass(\"admin\");\n            }\n        }\n    }\n\n    render() {\n        const { article, appContext: { viewer } } = this.props;\n\n        var display = null;\n        if (historyData.locationIsArticlePage) {\n            if (article != null) {\n                display = (\n                    <div>\n                        {viewer.is_admin_senior && <AdminHeader {...this.props} />}\n                        <Article {...this.props} />\n                        <div className={\"container\"}>\n                            <ThingList {...this.props} hasPagination={window.isWhitelabel} />\n                            <ArticleList {...this.props} />\n                        </div>\n                    </div>\n                );\n            } else {\n                display = <div />;\n            }\n        } else {\n            display = <div />;\n        }\n\n        return display;\n    }\n}\n\nexport default connect(mapStateToProps)(OverlayArticle);\n\nclass Article extends Component {\n    state = {\n        lightboxImages: [],\n        lightboxOpen: false,\n    }\n    constructor(props) {\n        super(props);\n        if ($(\"#article-fonts\").length === 0) {\n            $(document.head).append(\n                '<link rel=\"stylesheet\" id=\"article-fonts\" href=\"//fonts.googleapis.com/css?family=Merriweather:300,300i,400,400i,700,700i,900,900i|Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Source+Sans+Pro:200,200i,300,300i,400,400i,600,600i,700,700i,900,900i|Merriweather+Sans:300,300i,400,400i,700,700i,800,800i\" type=\"text/css\" />'\n            );\n\n            if ($(\"body\").is(\".static-article\")) {\n                $(\"#container-wrapper #scroll-to-top\").hide();\n            }\n        }\n    }\n\n    componentDidMount() {\n        // Initial loading\n        initGallery(ReactDOM.findDOMNode(this));\n        if (window.isWhitelabelV2) {\n            setTimeout(() => {\n                $('.itemSlide.product').productSlide({ itemPerSlide: 4, center: true });\n            }, 2500);\n        }\n    }\n\n    handleGalleryClick = (event) => {\n        var $this = $(event.target);\n        if (window.isWhitelabelV2) {\n            if ($this.is(\".gallery .paging a\")) {\n                event.preventDefault();\n                const $gallery = $this.closest(\".gallery\");\n                const $paging = $gallery.find(\".paging\");\n                const len = $gallery.find('.paging a.pager').length;\n                const galleryNth = $('.gallery').index($this.closest(\".gallery\"));\n                const indexSelector = `.gallery:eq(${galleryNth}) .paging a.pager`\n\n                let idx;\n                let incdec = 0\n                if ($this.is(\".btn .prev\")) {\n                    idx = $gallery.find('.paging a.pager.current').index(indexSelector);\n                    incdec = -1\n                } else if ($this.is(\".btn .next\")) {\n                    idx = $gallery.find('.paging a.pager.current').index(indexSelector);\n                    incdec = +1\n                } else {\n                    idx = $this.index(indexSelector);\n                }\n                idx += incdec;\n                if (idx < 0) {\n                    idx = len - 1\n                } else if (idx >= len - 1) {\n                    idx = 0\n                }\n                $paging\n                    .find(\"a.current\").removeClass(\"current\").end()\n                    .find(`a.pager:eq(${idx})`).addClass(\"current\");\n                $gallery\n                    .find(\"li.active\").removeClass(\"active\").end()\n                    .find(`li:eq(${idx})`).addClass(\"active\");\n            } \n        } else {\n            if ($this.is(\".gallery .paging a, .gallery li *\")) {\n                if ($this.is(\":not(.gallery li a.linked, .gallery li a.linked *)\")) {\n                    event.preventDefault();\n                }\n                if ($this.is(\".gallery li *\")) {\n                    $this = $this.closest(\"li\");\n                }\n    \n                var $gallery = $this.closest(\".gallery\");\n                var $paging = $gallery.find(\".paging\");\n    \n                var idx = $this.index();\n                $paging.find(\"a.current\").removeClass(\"current\").end().find(\"a:eq(\" + idx + \")\").addClass(\"current\");\n                $gallery.find(\"li.active\").removeClass(\"active\").end().find(\"li:eq(\" + idx + \")\").addClass(\"active\");\n                var left = 0;\n                if (idx == 0) {\n                    left = 0;\n                } else if (idx == $gallery.find(\"li\").length - 1) {\n                    left = $gallery.width() - $gallery.find(\".photo-list\").width();\n                } else {\n                    left =\n                        ($gallery.width() - $gallery.find(\"li:eq(\" + idx + \")\").width()) / 2 -\n                        $gallery.find(\"li:eq(\" + idx + \")\").position().left;\n                }\n                $gallery.find(\".photo-list\").css(\"left\", left + \"px\");\n            }\n        }\n    }\n\n    prepareProductSlide = (event, $this) => {\n        var $slide = $this.closest('.product');\n        if ($slide.data('slideInit')) {\n            event.preventDefault();\n        } else {\n            $slide.productSlide({ itemPerSlide: 4, center: true })\n            setTimeout(() => {\n                $this.click();\n            }, 500);\n        }\n    }\n\n    handleContentClick = (event) => {\n        var $this = $(event.target);\n        if ($this.is(\".gallery *\")) {\n            this.handleGalleryClick(event);\n        } else if ($this.is(\".description .grid\")) {\n            this.prepareLightboxOpen();\n        } else if ($this.is('.itemSlide .prev, .itemSlide .next')) {\n            this.prepareProductSlide(event, $this);\n        }\n    }\n\n    // lightbox stuff\n    prepareLightboxOpen() {\n        this.setState({\n            lightboxOpen: true,\n            lightboxCurrentImage: 0,\n            lightboxImages: $('.grid img').toArray().map((e) => ({ src: $(e).data('src')}) ),\n        });\n    }\n\n    handleClickPrev = () => {\n        this.setState({ lightboxCurrentImage: Math.max(this.state.lightboxCurrentImage - 1, 0) });\n    }\n\n    handleClickNext = () => {\n        this.setState({ lightboxCurrentImage: Math.min(this.state.lightboxCurrentImage + 1, this.state.lightboxImages.length - 1) });\n    }\n\n    handleClose = () => {\n        this.setState({ lightboxOpen: false });\n    }\n\n    handleClickThumbnail = (idx) => {\n        this.setState({ lightboxCurrentImage: idx })\n    }\n\n    render() {\n        const { appContext: { lastFullyRenderedArticleID, viewer, loggedIn }, article } = this.props;\n\n        let video;\n        let coverImgUrl = '';\n        if (article.cover_image) {\n            coverImgUrl = article.cover_image.url;\n        }\n        if (Video.isVideoAvailableForArticle(article)) {\n            const videoProps = {\n                object: article,\n                display: true,\n                autoplay: article.cover_video.autoplay || false,\n                lastFullyRenderedObjectID: lastFullyRenderedArticleID,\n            };\n            if (coverImgUrl) {\n                videoProps.poster = coverImgUrl;\n            }\n            video = <Video {...videoProps} />;\n        }\n\n        const coverImage = (\n            <div className=\"inner-wrapper\">\n                <div id=\"coverImage\" className=\"cover image purple\">\n                    {video}\n                    {!video &&\n                        <div className=\"image\">\n                            <img id=\"coverImg\" src={coverImgUrl} />\n                        </div>}\n                </div>\n            </div>\n        );\n\n        const author = (\n            article.options &&\n            article.options.authors &&\n            <div className=\"author\" dangerouslySetInnerHTML={{ __html: article.options.authors }} />\n        );\n\n        return (\n            <div id=\"summary\" className=\"wrapper article-wrapper\">\n                {!window.isWhitelabelV2 && coverImage}\n                {/*floatingVideo*/}\n                <div className=\"info\">\n                    <h1 className=\"title\"><b>{article.title}</b> <small>{article.tagline}</small></h1>\n                    {window.isWhitelabelV2 && author}\n                    {window.isWhitelabelV2 && article.date_created &&\n                        <div className=\"date text-placeholder\">{\n                            dateFormat(article.date_created || new Date, 'MMMM DD, YYYY')\n                        }</div>\n                    }\n                    {window.isWhitelabel ? null : <FancydUsers {...this.props} />}\n                    <div className=\"interaction\">\n                        <MoreShare objectType=\"article\" objectId={article.id} loggedIn={loggedIn} title={article.title}\n                                       viewerUsername={viewer.username} showShortcuts={true} fromThingSidebar={true} />\n                        {article.options &&\n                            article.options.action_button &&\n                            (_.isString(article.options.action_button.text) &&\n                                article.options.action_button.text.trim()) &&\n                            <a href={`${article.options.action_button.link}`} className=\"btn-shop\">\n                                {article.options.action_button.text}\n                            </a>}\n                        {window.isWhitelabel ? <FancydUsers {...this.props} /> : null}\n                    </div>\n                </div>\n                {window.isWhitelabelV2 && coverImage}\n                <div className=\"description more\">\n                    {!window.isWhitelabelV2 && author}\n                    <div dangerouslySetInnerHTML={{ __html: article.content }} onClick={this.handleContentClick} />\n                </div>\n                {window.isWhitelabelV2 && \n                    <Suspense fallback={<div />}>\n                        <Lightbox \n                            fallback={<div />}\n                            images={this.state.lightboxImages}\n                            isOpen={this.state.lightboxOpen}\n                            preventScroll={true}\n                            showThumbnails={true}\n                            currentImage={this.state.lightboxCurrentImage}\n                            onClickPrev={this.handleClickPrev}\n                            onClickNext={this.handleClickNext}\n                            onClose={this.handleClose}\n                            onClickThumbnail={this.handleClickThumbnail}\n                        />\n                    </Suspense>\n                }\n            </div>\n        );\n    }\n}\n","// This is entrypoint, which `React.render` takes place after DOM is ready.\nimport React from \"react\";\nimport { Route, Router, Switch } from \"react-router-dom\";\nimport { render } from \"react-dom\";\nimport { Provider } from \"react-redux\";\nimport { selectOrCreate } from \"fancyutils\";\nimport { history } from 'common-components';\n\nimport App from \"./container/app\";\nimport { attachEntryEvents } from \"./container/entry-events\";\nimport store from \"./store/store\";\nimport OverlayArticle from \"./components/article\";\nimport { historyHook } from \"./container/history\";\n\n\nconst onLoad = () => {\n    require(\"./shared\");\n    const overlayArticleContainer = selectOrCreate(\"#overlay-article\");\n    const $overlayArticleContainer = $(overlayArticleContainer);\n    if ($overlayArticleContainer.hasClass('seo')) {\n        $overlayArticleContainer.empty();\n        $overlayArticleContainer.removeClass('seo');\n    }\n    render(\n        <Provider store={store}>\n            <Router history={history}>\n                <App>\n                    <Switch>\n                        <Route path=\"/articles/*\" component={OverlayArticle} />\n                        <Route path=\"*\" component={() => null} />\n                    </Switch>\n                </App>\n            </Router>\n        </Provider>,\n        overlayArticleContainer,\n        () => {\n            history.listen(historyHook);\n            historyHook({ pathname: location.pathname, search: location.search }) // should init once\n            attachEntryEvents();\n        }\n    );\n}\n\n\nlet loaded = false;\nlet timer = setInterval(function() {\n    if (loaded) {\n        return;\n    }\n    if (window.$ && document.readyState !== 'loading') {\n        loaded = true\n        clearInterval(timer);\n        onLoad()\n    }\n}, 250)\n","import { getFancyDepsRoot } from 'fancyutils';\n\nimport store from './store/store';\nimport { cache } from './cache';\nimport { transition } from './container/routeutils';\n// import { reloadCurrentArticle } from './container/history';\n\n\ngetFancyDepsRoot().Shared = {\n    getStore: () => store.getState(),\n    cache,\n    transition,\n    // reloadCurrentArticle,\n};\n","// Warning: objects has to be flat in each context\nexport function getInitialStoreState(contextName) {\n    switch(contextName) {\n    case 'appContext':\n        return {\n            visible: false,\n            viewer: {},\n            loggedIn: null,\n            userCountry: 'US',\n        };\n    case 'article':\n        return {\n            data: null,\n            ID: null,\n            pendingID: null,\n            isFetching: null,\n            status: 'idle' // { idle | request | failed }\n        };\n    default:\n        console.warn('`getInitialStoreState()`: Unknown context name ', contextName);\n    }\n};\n\nvar contexts = [\n    'article',\n    'appContext'\n];\n\nexport function getAllInitialStoreState() {\n    return contexts.reduce((state, contextKey) => {\n        state[contextKey] = getInitialStoreState(contextKey);\n        return state;\n    } , {});\n}\n","import { combineReducers } from 'redux';\nimport { extractMetaFromURL, update, updateShallow, isEmpty } from 'fancyutils';\n\nimport C from './action/action-constants';\nimport { getInitialStoreState } from './store/initial-store';\nimport { updateState } from './appstate';\n\n\nconst isLoggedIn = viewer => !isEmpty(viewer) && viewer.id != null;\n\nvar loaded = false;\nvar lastFullyRenderedArticleID = 0;\nfunction appContext(state = getInitialStoreState('appContext'), action) {\n    switch (action.type) {\n    case C.OPEN_ARTICLE:\n        return updateShallow(state, {\n            visible: true,\n        });\n    case C.CLOSE_ARTICLE:\n        lastFullyRenderedArticleID = 0;\n        loaded = false;\n        return updateShallow(state, {\n            visible: false,\n            lastFullyRenderedArticleID\n        });\n    case C.UPDATE_APP_CONTEXT:\n        return updateShallow(state, action.context);\n    case C.LOAD_ARTICLE: {\n        // Due to multi-stage rendering (cache -> from-server-data -> ...) \n        // it is unable to check state change correctly just by comparing ID;\n        // Therefore, we set internal state per every update cycle and check \n        // if state is fully updated.\n\n        // FIXME: when cached response exist, it marks as rendered before\n        if (\n            loaded === true &&\n            lastFullyRenderedArticleID !== action.data.id\n        ) {\n            lastFullyRenderedArticleID = action.data.id;\n        }\n        const viewer = action.data.viewer || window.viewer || {};\n        const loggedIn = isLoggedIn(viewer);\n        const userCountry = action.data.current_country_code || state.userCountry;\n\n        updateState('loggedIn', loggedIn);\n        updateState('viewer', viewer);\n        loaded = true;\n\n        return update(state, { lastFullyRenderedArticleID, loggedIn, viewer, userCountry });\n    }\n    default:\n        return state;\n    }\n}\n\nfunction populateArticleContext(articleData) {\n    articleData.loading = articleData.fromServer !== true;\n    articleData.URLMeta = extractMetaFromURL(location.href); // FIXME: provide current pathname\n    articleData.owner = articleData.user;\n}\n\n// Article context\nfunction article(state = getInitialStoreState('article'), action) {\n    switch (action.type) {\n    case C.LOAD_ARTICLE:\n        populateArticleContext(action.data)\n        return updateShallow(state, {\n            data: action.data,\n            status: action.status,\n            ID: action.ID,\n            pendingID: null,\n            isFetching: false\n        });\n    case C.REQUEST_ARTICLE:\n        return update(state, {\n            pendingID: action.pendingID,\n            status: action.status,\n            isFetching: true\n        });\n    case C.REQUEST_ARTICLE_FAILURE:\n        return update(state, {\n            status: action.status,\n            isFetching: false\n        });\n\n    // Reset state\n    case C.CLOSE_ARTICLE:\n        return updateShallow(getInitialStoreState('article'));\n    default:\n        return state;\n    }\n}\n\nconst rootReducer = combineReducers({\n    appContext,\n    article,\n});\n\nexport default rootReducer;\n","import { createStore, applyMiddleware } from 'redux';\nimport thunk from 'redux-thunk';\n\nimport rootReducer from '../reducers';\n\n\nconst middleware = [thunk];\n\nexport const configureStore = (initialState) => (\n    createStore(rootReducer, initialState, applyMiddleware(...middleware))\n);\n","import { configureStore } from './configure-store';\nimport { getAllInitialStoreState } from './initial-store';\n\nconst store = configureStore(getAllInitialStoreState());\n\nexport default store;\n","import { getLocationArgPairs } from 'fancyutils';\nimport { GlobalFancySomething } from 'ftypes';\n\n\ndeclare global {\n    interface Window {\n        _: typeof import('underscore');\n        track_event: Function;\n        alertify: alertify.IAlertifyStatic;\n        dataLayer: Array<any>;\n        Fancy: GlobalFancySomething;\n        from_sds_page: boolean;\n        TrackingEvents: {\n            addToCart(_: any): any\n        }\n    }\n}\n\nconst { Fancy, track_event, dataLayer, from_sds_page, TrackingEvents } = window;\n\nexport function logAddCartMixpanel({\n    salesID,\n    saleOptionID,\n    utm,\n    section,\n    via,\n} : {\n    salesID: any;\n    saleOptionID: any;\n    utm: any;\n    section: any;\n    via: any;\n}) {\n    if (salesID == null) {\n        return;\n    }\n    if (utm == null) {\n        const currentLocationArgPair = getLocationArgPairs('utm');\n        if (currentLocationArgPair) {\n            utm = currentLocationArgPair[1];\n        }\n    }\n    const log = {\n        'sale id': salesID,\n        via: via || 'thing page',\n        utm: utm,\n    };\n    if (section) {\n        log.section = section;\n    }\n    if (saleOptionID && salesID !== saleOptionID) {\n        log['option id'] = saleOptionID;\n    }\n    try {\n        window.track_event && track_event('Add to Cart', log);\n    } catch (e) {}\n    return log;\n}\n\nexport function addItemToCart(param, callback, meta) {\n    // should be replaced by Fancy.CartAPI.addItem\n    param.from_sds_page = from_sds_page;\n    if (window.dataLayer) {\n        window.dataLayer.push({\n            event: 'Add_to_Cart_Button',\n            product_id: param['sale_item_id'],\n            option_id: param['option_id'],\n            products: undefined,\n            products_info: undefined,\n            revenue: undefined\n        });\n    }\n    return $.ajax({\n        type: 'POST',\n        url: '/add_item_to_cart.json',\n        data: param\n    })\n    .done(json => {\n        if (!json || json.status_code == null) {\n            return;\n        }\n        if (json.status_code === 1) {\n            if (meta) {\n                TrackingEvents.addToCart([{\n                    id: param.sale_item_id,\n                    brand: meta.brand_name,\n                    name: meta.title,\n                    quantity: param.quantity,\n                    price: meta.price,\n                    variant: json.option,\n                }]); // avoid NaN\n            }\n            var args: any = {\n                'THING_ID': param.thing_id,\n                'ITEMCODE': json.itemcode,\n                'THUMBNAIL_IMAGE_URL': json.image_url,\n                'ITEMNAME': json.itemname,\n                'QUANTITY':json.quantity,\n                'PRICE': json.price,\n                'OPTIONS': json.option,\n                'HTML_URL': json.html_url,\n                'CART_ID': json.cart_id,\n            };\n            if (json.fancy_price) {\n                args.FANCY_PRICE = json.fancy_price;\n            }\n            Fancy.Cart.addItem(args);\n            Fancy.Cart.openPopup();\n        } else if (json.status_code == 0) {\n            if(json.message) {\n                alert(json.message);\n            }\n        }\n    })\n    .always(function() { callback && callback(); });\n}\n"],"sourceRoot":""}