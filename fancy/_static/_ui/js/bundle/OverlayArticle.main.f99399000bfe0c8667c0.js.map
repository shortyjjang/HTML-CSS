{"version":3,"sources":["webpack://fancy/webpack/runtime/load script","webpack://fancy/./_static/modules/ui/overlay-article/Shortcode.js","webpack://fancy/./_static/modules/ui/overlay-article/action/action-constants.js","webpack://fancy/./_static/modules/ui/overlay-article/action/action-helpers.js","webpack://fancy/./_static/modules/ui/overlay-article/action/actions.js","webpack://fancy/./_static/modules/ui/overlay-article/appstate.js","webpack://fancy/./_static/modules/ui/overlay-article/cache.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/map.cart.ts","webpack://fancy/./_static/modules/ui/overlay-article/components/map.js","webpack://fancy/./_static/modules/ui/overlay-article/components/ThingFancydUsers.js","webpack://fancy/./_static/modules/ui/overlay-article/components/ThingCard.js","webpack://fancy/./_static/modules/ui/overlay-article/components/ArticleCard.js","webpack://fancy/./_static/modules/ui/overlay-article/components/ArticleWidgets.js","webpack://fancy/./_static/modules/ui/overlay-article/config.js","webpack://fancy/./_static/modules/ui/overlay-article/container/entry-events.js","webpack://fancy/./_static/modules/ui/overlay-article/container/history.js","webpack://fancy/./_static/modules/ui/overlay-article/container/routeutils.js","webpack://fancy/./_static/modules/ui/overlay-article/container/app.js","webpack://fancy/./_static/modules/ui/overlay-article/SyncedContext.js","webpack://fancy/./_static/modules/ui/overlay-article/components/ArticleFancydUsers.js","webpack://fancy/./_static/modules/ui/overlay-article/components/article.js","webpack://fancy/./_static/modules/ui/overlay-article/index.js","webpack://fancy/./_static/modules/ui/overlay-article/shared.js","webpack://fancy/./_static/modules/ui/overlay-article/store/initial-store.js","webpack://fancy/./_static/modules/ui/overlay-article/reducers.js","webpack://fancy/./_static/modules/ui/overlay-article/store/configure-store.js","webpack://fancy/./_static/modules/ui/overlay-article/store/store.js","webpack://fancy/webpack/bootstrap","webpack://fancy/webpack/runtime/amd options","webpack://fancy/webpack/runtime/compat get default export","webpack://fancy/webpack/runtime/define property getters","webpack://fancy/webpack/runtime/ensure chunk","webpack://fancy/webpack/runtime/get javascript chunk filename","webpack://fancy/webpack/runtime/global","webpack://fancy/webpack/runtime/harmony module decorator","webpack://fancy/webpack/runtime/hasOwnProperty shorthand","webpack://fancy/webpack/runtime/make namespace object","webpack://fancy/webpack/runtime/publicPath","webpack://fancy/webpack/runtime/jsonp chunk loading","webpack://fancy/webpack/startup"],"names":["inProgress","dataWebpackPrefix","ImageModes","getJumper","$element","_id","String","Math","random","substr","attr","$","getProductContext","products","callback","arrayOfPromises","length","filter","e","map","sid","dfd","Deferred","get","then","thing","resolve","fail","xhr","status","alertify","alert","console","warn","promise","jQuery","when","apply","Array","prototype","slice","call","arguments","done","things","ctx","items","image_fit_to_bounds","image","src","sales","images","fit_to_bounds","title","emojified_name","price","retail_price","id","ShortCodeTransformers","options","$shortcode","tagline","markup","window","isWhitelabelV2","$next","_","template","find","wrap","append","replaceWith","prop","html","reduce","prev","imageMode","getTemplateByImageMode","mode","getIsolatedShortcodeElement","next","convertArticleShortcode","content","$wrapped","$disposable","unmountedDOM","document","body","eq","empty","style","appendTo","mountToDisposable","each","i","shortcode","$sc","data","JSON","parse","name","remove","keys","constantGen","shouldOpenArticle","state","appContext","visible","shouldFetchArticle","articleID","article","ID","isFetching","closeOverlay","dispatch","isStaticPage","closeModal","historyData","history","stripPathname","closeArticle","off","trigger","fetchArticle","type","ArticleCache","killCache","queryString","getState","openArticle","cache","cac","loadArticle","onLoadArticle","isCrawled","requestArticle","saved_users_top","raw_content","include_viewer","getLocationArgPairs","preview","failureXHR","requestArticleFail","location","href","MPArgs","article_id","currentLocationArgPair","utm","MP","___D","store","pendingID","C","viewer","updateState","k","v","ignoreCralwed","existence","ARTICLES","getCrawled","count","selector","value","t","index","Fancy","track_event","from_sds_page","dataLayer","TrackingEvents","getSafeNameProp","dangerouslySetInnerHTML","__html","children","getThingName","gettext","isEmpty","sales_available","salesAvailable","handleProfileMouseOver","event","$profile","currentTarget","css","width","FancydUser","user","display","isViewer","html_url","className","classnames","_viewer","onMouseOver","backgroundImage","user_square_image_small","image_url","full_name","fullname","isUserEqual","a","b","bgXPosSequence","getFancyStatus","nextFancydState","FancyStatus","getCompletionIdleStatus","currentFancyState","getNextFancydCount","nextFancyd","currentFancydCount","bigContainerStyle","FancydUsers","props","fancyd_count","getConciseNumberString","frame","undefined","animateFancyBG","xPos","fancyBGAnimation","setTimeout","setState","fancyAnimation","totalLength","bigContainer","fancyd","fancyStatus","first","last","Display","indexLimit","thingID","currentState","stateSetter","loading","nextFancydCount","ajax","url","json","toggleFancy","ns","_handleFancydStateOnLoadThing","preventDefault","stopPropagation","loggedIn","thing_id","require_login","_getInitialState","fancyBGAnimationRef","element","this","handleFancydStateOnLoadThing","fancydUserAnimClass","fancyd_users","fancydUsers","concat","fancydUser","userCountSufficiency","onClick","handleFancyClick","ref","getFancydCountString","key","getFancyduserDisplay","Component","itemTraits","section","via","similar","recently","ThingCard","fancydCount","quantity","optionID","showCart","popupOpened","addToCart","saleAvailable","isSaleAvailable","saleOptionExists","isSaleOptionExists","getSales","option","has_options","getSaleOption","available_for_sale","isNumber","diff","max","isSaleOptionAvailable","range","min","parseInt","target","post","status_code","onDelete","isPlainLeftClick","isWhitelabel","OaContainer","transition","LinkTypes","appState","params","sale_item_id","sale_id","getWaiting","dataType","message","waiting","itemType","handleLinkClick","throttle","unmounted","isNaN","param","seller_id","seller","option_id","traits","log","salesID","saleOptionID","logAddCartMixpanel","discounting","discount_percentage","meta","deal_price","brand_name","push","product_id","products_info","revenue","brand","variant","args","itemcode","itemname","cart_id","fancy_price","FANCY_PRICE","Cart","addItem","openPopup","always","addItemToCart","thumb_image_url_310","thumb_image_url_558","itemIdx","showDelete","saleOptionAvailable","showFrom","max_price","min_price","__Config","new_card","active","toggled","rel","data-prevent-overlay","displayCount","showFancydUser","objectType","objectId","viewerUsername","username","onShowSomething","handleShowSomething","opened","handleCartAddition","disabled","handleTrickClick","onChange","handleOptionChange","numberFormat","handleOptionQuantityChange","getQuantityRange","subscribed","handleNotifySoldout","handleRecentlyDelete","handleQuickCartToggle","ArticleCard","cover_image","ThingList","showShare","LogExposed","forEach","addLog","response","convertThingsV1ToRest","article_items","logExposed","updateThingList","lastarticleID","nextProps","idCopy","hasPagination","thingsHeader","item_header","MaybePaginationWindow","idx","handleDelete","page","maxPage","floor","transform","stream","handlePrevClick","handleNextClick","ArticleList","articles","hasClass","left","lastPageNum","CardContainerPadding","updateArticleList","prevDisabled","nextDisabled","ceil","getLeftOffset","AdminHeader","self","$this","original_labels","labels","set","ok","cancel","confirm","yes","is_active","error","slug","open","handleEditArticleClick","handleLiveClick","initGallery","container","c","d","j","f","isArray","g","hasOwnProperty","h","Error","stack","replace","Object","create","constructor","_super","la","oa","l","m","q","addEventListener","n","removeEventListener","o","parentNode","p","indexOf","trim","split","r","s","sort","u","toUpperCase","ma","w","ownerDocument","defaultView","parentWindow","x","manager","inputTarget","domHandler","enable","handler","init","z","pointers","changedPointers","Ea","Ga","Ha","isFirst","isFinal","session","eventType","firstInput","D","firstMultiple","center","E","timeStamp","ra","deltaTime","angle","I","distance","H","offsetDelta","prevDelta","prevInput","deltaX","y","deltaY","B","offsetDirection","G","F","overallVelocityX","overallVelocityY","overallVelocity","qa","scale","Ra","K","rotation","J","maxPointers","srcEvent","A","emit","recognize","lastInterval","Da","velocity","velocityX","velocityY","direction","clientX","pa","clientY","Ia","Ja","Ka","La","Ma","Qa","sqrt","atan2","PI","L","evEl","Ta","evWin","Ua","pressed","M","Xa","Ya","pointerEvents","N","evTarget","$a","_a","started","O","touches","changedTouches","P","bb","targetIds","Q","Fa","identifier","R","touch","mouse","primaryTouch","lastTouches","S","T","splice","cb","U","abs","db","V","Y","defaults","ua","nb","simultaneous","requireFail","Z","sb","qb","pb","ob","aa","ba","pX","pY","ca","da","_timer","_input","ea","fa","ga","pTime","pCenter","ha","recognizers","preset","ia","handlers","oldCssProps","input","inputClass","xa","ya","wa","touchAction","ja","add","recognizeWith","requireFailure","cssProps","ka","createEvent","initEvent","gesture","dispatchEvent","na","createElement","round","Date","now","assign","TypeError","sa","ta","test","navigator","userAgent","za","Ba","Na","Oa","Pa","destroy","Sa","mousedown","mousemove","mouseup","button","which","pointerType","Va","pointerdown","pointermove","pointerup","pointercancel","pointerout","Wa","2","3","4","5","MSPointerEvent","PointerEvent","toLowerCase","pointerId","Za","touchstart","touchmove","touchend","touchcancel","ab","sourceCapabilities","firesTouchEvents","eb","fb","gb","hb","ib","jb","kb","lb","mb","CSS","supports","X","compute","actions","update","getTouchAction","W","join","preventDefaults","prevented","preventSrc","rb","tb","dropRecognizeWith","dropRequireFailure","hasRequireFailures","canRecognizeWith","additionalEvent","tryEmit","canEmit","process","reset","attrTest","threshold","directionTest","time","clearTimeout","taps","interval","posThreshold","failTimeout","tapCount","VERSION","domEvents","userSelect","touchSelect","touchCallout","contentZooming","userDrag","tapHighlightColor","stop","stopped","curRecognizer","on","INPUT_START","INPUT_MOVE","INPUT_END","INPUT_CANCEL","STATE_POSSIBLE","STATE_BEGAN","STATE_CHANGED","STATE_ENDED","STATE_RECOGNIZED","STATE_CANCELLED","STATE_FAILED","DIRECTION_NONE","DIRECTION_LEFT","DIRECTION_RIGHT","DIRECTION_UP","DIRECTION_DOWN","DIRECTION_HORIZONTAL","DIRECTION_VERTICAL","DIRECTION_ALL","Manager","Input","TouchAction","TouchInput","MouseInput","PointerEventInput","TouchMouseInput","SingleTouchInput","Recognizer","AttrRecognizer","Tap","Pan","Swipe","Pinch","Rotate","Press","merge","extend","inherit","bindFn","prefixed","Hammer","define","module","exports","addClass","totalW","click","Addition","Removal","AfterAddition","AfterRemoval","Idle","Selectors","HomepageWrapper","handleOverlayArticleKeyEvents","tagName","KEYS","conditionalTransition","aElement","isHomepage","has","getAttribute","oneshotEventAttached","attachEntryEvents","__INIT_ARTICLE_ANCHOR","getObjectTypeFromUrl","getPathname","$targ","didClickOn","isStatic","is","getDynamic","getStatic","scrollToTop","parentElement","scrollTop","initialArticlePageID","extractMetaFromArticleURL","pathname","initialPageIsArticlePage","initialPath","preservedHref","initialTitle","locationIsArticlePage","overlayIsOn","historyHook","search","articleURLType","requestIdleCallback","runOverlay","Dynamic","Static","Timeline","Internal","Number","destination","removeClass","handleCloseArticle","thingsDomCache","toggleFancyButton","$btn","replaceFancyCount","fc","text","onArticleFancyButtonUpdate","domCache","$query","containers","dedupeArray","closest","toArray","findArticleFancyButton","profile_image_url","save_count","action","saved","_handleFancydStateOnLoadArticle","handleFancydStateOnLoadArticle","prevProps","np","saved_users","Lightbox","lazy","OverlayArticle","applyProductSlide","Zepto","fn","fitVids","customSelector","ignore","getElementById","head","getElementsByTagName","innerHTML","appendChild","childNodes","not","parents","parent","height","_count","removeAttr","pt","ct","isStaticArticlePage","focus","is_admin_senior","Article","connect","lightboxImages","lightboxOpen","$gallery","$paging","len","galleryNth","indexSelector","incdec","end","position","$slide","productSlide","itemPerSlide","handleGalleryClick","prepareLightboxOpen","prepareProductSlide","lightboxCurrentImage","hide","ReactDOM","video","lastFullyRenderedArticleID","coverImgUrl","Video","videoProps","object","autoplay","cover_video","lastFullyRenderedObjectID","poster","coverImage","author","authors","date_created","dateFormat","showShortcuts","fromThingSidebar","action_button","isString","link","handleContentClick","Suspense","fallback","isOpen","preventScroll","showThumbnails","currentImage","onClickPrev","handleClickPrev","onClickNext","handleClickNext","onClose","handleClose","onClickThumbnail","handleClickThumbnail","Route","path","component","onLoad","require","thingRegex","articleRegex","initialHref","match","reload","overlayArticleContainer","selectOrCreate","$overlayArticleContainer","render","Router","Switch","readyState","getFancyDepsRoot","Shared","getStore","getInitialStoreState","contextName","userCountry","contexts","isLoggedIn","loaded","populateArticleContext","articleData","fromServer","URLMeta","extractMetaFromURL","owner","combineReducers","updateShallow","context","current_country_code","initialState","middleware","thunk","contextKey","createStore","rootReducer","applyMiddleware","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","amdO","getter","__esModule","definition","defineProperty","enumerable","chunkId","Promise","all","promises","globalThis","Function","hmd","obj","script","needAttach","scripts","charset","timeout","nc","setAttribute","onScriptComplete","onerror","onload","doneFns","removeChild","bind","Symbol","toStringTag","installedChunks","16","deferredModules","installedChunkData","reject","errorType","realSrc","request","checkDeferredModules","checkDeferredModulesImpl","result","deferredModule","fulfilled","depId","chunkLoadingGlobal","webpackJsonpCallback","chunkIds","moreModules","runtime","executeModules","resolves","parentChunkLoadingFunction","shift"],"mappings":"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","file":"OverlayArticle.main.f99399000bfe0c8667c0.js","sourcesContent":["var inProgress = {};\nvar dataWebpackPrefix = \"fancy:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => fn(event));\n\t\tif(prev) return prev(event);\n\t}\n\t;\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","/* BEWARE: this code is directly imported via mobile article.new.html, use ES5 */\nvar ImageModes = {\n    Full: 'Full',\n    Normal: 'Normal',\n    Quoted: 'Quoted',\n    Grid: 'Grid',\n};\n\nfunction getRandomId() {\n    return 'shortcode-' + String(Math.random()).substr(2)\n}\n\nfunction getJumper($element) {\n    var _id = getRandomId();\n    $element.attr('id', _id);\n    return function () {\n        return $('#' + _id)\n    }\n}\n\nfunction jQueryPromiseAll(arrayOfPromises) {\n    return jQuery.when.apply(jQuery, arrayOfPromises).then(function() {\n        return Array.prototype.slice.call(arguments, 0);\n    });\n}\nfunction getProductContext(products, callback) {\n    if (products.length > 0) {\n        jQueryPromiseAll(products.filter(function(e){ return e }).map(function(sid) {\n            var dfd = $.Deferred()\n            $.get('/rest-api/v1/things/' + sid + '?sales=true&include_every_image=true')\n                .then(function(thing) {\n                    dfd.resolve(thing);\n                })\n                .fail(function(xhr) {\n                    if (xhr.status === 404) {\n                        alertify.alert('Product id ' + sid + 'not found.');\n                    } else {\n                        console.warn('There was an error whiel fetching sid:', sid, xhr)\n                    }\n                    dfd.resolve(null);\n                });\n            return dfd.promise()\n        }))\n        .done(function(things) {\n            var ctx = {\n                items: things.map(function(thing){\n                    var image_fit_to_bounds = false;\n                    var image = thing.image.src;\n                    try {\n                        image_fit_to_bounds = thing.sales.images[0].fit_to_bounds;\n                        image = thing.sales.images[0].src;\n                    } catch(e) {}\n                    return thing.sales && { title: thing.sales.emojified_name, price: thing.sales.price, retail_price: thing.sales.retail_price, image: image, image_fit_to_bounds: image_fit_to_bounds, id: thing.sales.id }\n                }).filter(function(e){ return e })\n            };\n            callback(ctx);\n        })\n    } else {\n        console.warn('[ShortCodeTransformers]: Error - product does not exist');\n    }\n}\n\nfunction getTemplateByImageMode(imageMode) {\n    switch (imageMode) {\n        case ImageModes.Grid:\n            return (\n                '<div class=\"grid\"><img src=\"/_ui/images/common/blank.gif\"  alt=\"<%= image.caption %>\" class=\"\" style=\"background-image:url(\\'<%= image.src %>\\');\" data-src=\"<%= image.src %>\"><% if (image.caption) { %><figcaption class=\"text-placeholder\"><%= image.caption %></figcaption><% } %></div>'\n            )\n        case ImageModes.Full:\n            return (\n                '<figure class=\"mode-full\"><img src=\"<%= image.src %>\" alt=\"<%= image.caption %>\"></figure>'\n            );\n        case ImageModes.Quoted:\n            return (\n                '<figure class=\"mode-quoted\"><p><img src=\"<%= image.src %>\" alt=\"<%= image.caption %>\"></p><p class=\"textarea\"><%= image.caption %></p></figure>'\n            );\n        case ImageModes.Normal:\n        default:\n            return (\n                '<figure class=\"mode-normal\"><img src=\"<%= image.src %>\" alt=\"<%= image.caption %>\"></figure>'\n            );\n    }\n}\n\nvar ShortCodeTransformers = {};\n/* \n<% {\"name\": fancy-article-gallery,\n    \"images\": [{ src: \"https://img-address-1\", caption: \"An image caption\", uiid: 1 }, ... ],\n    \"title\": \"a gallery title\",\n    \"tagline\": \"a gallery tagline\"} %>\n*/\nShortCodeTransformers['fancy-article-gallery'] = function(options, $shortcode) {\n    var images  = options.images;\n    var title   = options.title;\n    var tagline = options.tagline;\n    var markup = '';\n        markup += '<div class=\"gallery\">'\n        markup +=   '<h3><span><%= title %></span><small class=\"tagline\"><span><%= tagline %></span></small></h3>'\n        markup +=   '<ul class=\"photo-list\">'\n        markup +=     '<% _.each(images, function(image, idx) { %>'\n        markup +=       '<li class=\"<%= idx === 0 ? \\'active\\' : \\'\\' %>\"><a href=\"<%= image.link %>\" <%= image.link ? \"rel=\\'noopener\\' target=\\'_blank\\' class=\\'linked\\'\" : \"onclick=\\'return false;\\'\" %>><img src=\"<%= image.src %>\"></a><span><%= image.caption %></span></li>'\n        markup +=     '<% }) %>'\n        markup +=   '</ul>'\n        markup +=   '<div class=\"paging\">'\n    if (window.isWhitelabelV2) {\n        markup +=     '<div class=\"btn\"><a class=\"prev\"></a><a class=\"next\"></a></div>'\n    }\n        markup +=     '<% _.each(images, function(e, idx) { %> '\n        markup +=       '<a href=\"#\" class=\"<%= idx === 0 ? \\'current\\' : \\'\\' %> pager\"><%= idx + 1 %></a>'\n        markup +=     '<% }) %>'\n        markup +=   '</div>'\n        markup += '</div>'\n\n    var $next = $(_.template(markup)({ images: images, title: title, tagline: tagline }));\n    if (window.isWhitelabelV2) {\n        $next.find('img').wrap('<span class=\"figure\" />');\n        $next = $('<div class=\"gallery-container\" />').append($next);\n    }\n    $shortcode.replaceWith($next.prop('outerHTML'));\n};\n/*\n<% {\"name\": \"fancy-article-img\",\n    \"images\": [{\n        \"mode\": \"Quoted\",\n        \"src\": \"https://img-address\",\n        \"caption\": \"A image caption\",\n    }]\n   } %>\n*/\nShortCodeTransformers['fancy-article-img'] = function(options, $shortcode) {\n    var images = options.images;\n    var html = images.reduce(function(prev, image) {\n        return prev + _.template(getTemplateByImageMode(image.mode))({ image: image });\n    }, '');\n    if (images[0] && images[0].mode === ImageModes.Grid) {\n        html = ('<figure class=\"mode-grid\">' + html + '</figure>')\n    }\n    $shortcode.replaceWith(html);\n};\n\nShortCodeTransformers['fancy-article-product'] = function(options, $shortcode) {\n    var items  = options.products;\n    const getIsolatedShortcodeElement = getJumper($shortcode)\n    getProductContext(items, function (ctx) {\n    var markup = '';\n        markup += '<ul class=\"itemList product\">'\n        markup += '<% items.forEach(function(item) { %>'\n        markup +=   '<li class=\"itemListElement\" data-id=\"<%= item.id %>\">'\n        markup +=     '<a href=\"<%= item.html_url %>?utm=article\">'\n        markup +=     '<span class=\"figure <% if (item.image_fit_to_bounds) { %>fit<% } %>\">'\n        markup +=       '<img src=\"/_ui/images/common/blank.gif\" style=\"background-image:url(<%= item.image %>)\">'\n        markup +=     '</span>'\n        markup +=     '<span class=\"figcaption\">'\n        markup +=       '<span class=\"title\"><%= item.title %></span>'\n        markup +=       '<% if (item.retail_price != null) { %><b class=\"price sales\">$<%= item.price %> <small class=\"before\">$<%= item.retail_price %></small></b><% } else { %><b class=\"price\">$<%= item.price %></b><% } %>'\n        markup +=     '</span>'\n        markup +=   '</li>'\n        markup += '<% }); %>'\n        markup += '</ul>'\n        var next = _.template(markup)(ctx);\n        getIsolatedShortcodeElement().replaceWith(next);\n    });\n};\n\nShortCodeTransformers['fancy-article-product-slideshow'] = function(options, $shortcode) {\n    var items  = options.products;\n    const getIsolatedShortcodeElement = getJumper($shortcode)\n    getProductContext(items, function(ctx) {\n    var markup = '';\n        markup += '<div class=\"itemSlide product\">'\n        markup +=   '<div class=\"itemSlideWrap\">'\n        markup +=     '<ul class=\"stream after\">'\n        markup +=       '<% items.forEach(function(item) { %>'\n        markup +=       '<li class=\"itemSlideElement\">'\n        markup +=         '<div class=\"figure-item\">'\n        markup +=           '<figure <% if (item.image_fit_to_bounds) { %>class=\"fit\"<% } %>><a href=\"<% if (item.html_url) { %><%= item.html_url %><% } else { %>/sales/<%= item.id %>?utm=article<% } %>?utm=article\">'\n        markup +=             '<span class=\"back\"></span>'\n        markup +=             '<img class=\"figure\" src=\"/_ui/images/common/blank.gif\"'\n        markup +=                  'style=\"background-image: url(<%= item.image %>);\">'\n        markup +=           '</a></figure>'\n        markup +=           '<figcaption>'\n        markup +=             '<span class=\"show_cart\">'\n        markup +=               '<button class=\"btn-cart nopopup soldout\">'\n        markup +=                 '<% if (item.retail_price != null) { %><b class=\"price sales\">$<%= item.price %> <small class=\"before\">$<%= item.retail_price %></small></b><% } else { %><b class=\"price\">$<%= item.price %></b><% } %>'\n        markup +=               '</button>'\n        markup +=             '</span>'\n        markup +=             '<a href=\"<%= item.html_url %>?utm=article\" class=\"title\"><%= item.title %></a>'\n        markup +=           '</figcaption>'\n        markup +=         '</div>'\n        markup +=       '</li>'\n        markup +=       '<% }); %>'\n        markup +=     '</ul>'\n        markup +=   '</div>'\n        markup +=   '<a href=\"#\" class=\"prev\">Prev</a>'\n        markup +=   '<a href=\"#\" class=\"next\">Next</a>'\n        markup += '</div>'\n\n        var next = _.template(markup)(ctx);\n        getIsolatedShortcodeElement().replaceWith(next);\n    });\n};\n\nfunction getWrappedSingleNode(target) {\n    return $('<div class=\"singlenode-wrapper\">' + target + '</div>');\n}\n\nfunction convertShortcode(content) {\n    var $wrapped = getWrappedSingleNode(content);\n    var $disposable = mountToDisposable($wrapped);\n\n    $wrapped.find('p.shortcode').each(function(i, shortcode) {\n        var $sc = $(shortcode);\n        try {\n            var data = JSON.parse($sc.attr('data-internal'));\n            ShortCodeTransformers[data.name](data, $sc);\n        } catch(e) { console.warn(e) }\n    });\n\n    $disposable.remove();\n    return $wrapped.html();\n}\nwindow.convertArticleShortcode = convertShortcode;\n\nfunction mountToDisposable(unmountedDOM) {\n    // Create/Select disposable mounting DIV to correctly modify a element.\n    let $disposable = $(document.body).find('.disposable');\n    if ($disposable.length > 0) {\n        $disposable = $disposable.eq(0).empty();\n    } else {\n        $disposable = $('<div />', { id: 'disposable', style: 'display:none;'}).appendTo(document.body);\n    }\n\n    if (unmountedDOM) {\n        // Append unmounted DOM if exists\n        $disposable.append(unmountedDOM);\n    }\n    // return disposable DOM\n    return $disposable;\n}\n","// Generate `key: String(key)` structure by given string key arguments\nfunction constantGen() {\n    var keys = [].slice.call(arguments);\n    return keys.reduce((prev, next) => {\n        prev[next] = next;\n        return prev;\n    }, {});\n}\n\nvar C = constantGen(\n  'UPDATE_APP_CONTEXT',\n  // Loading\n  'REQUEST_ARTICLE',\n  'REQUEST_ARTICLE_FAILURE',\n  'LOAD_ARTICLE',\n\n  // UI Actions\n  'OPEN_ARTICLE',\n  'CLOSE_ARTICLE',\n\n);\n\nexport default C;\n","import { MP, getLocationArgPairs, isStaticPage, stripPathname } from 'fancyutils';\n\nimport { historyData } from '../container/history';\nimport store from '../store/store';\nimport { closeModal } from '../container/routeutils';\nimport {\n    closeArticle,\n    openArticle,\n    loadArticle,\n    requestArticle,\n    requestArticleFail,\n} from './actions';\nimport { ArticleCache, cache } from '../cache';\nimport { history } from 'common-components';\n\n\nfunction shouldOpenArticle(state) {\n    return state.appContext.visible !== true;\n}\n\n// Blocks illegal requests\nfunction shouldFetchArticle(state, articleID) {\n    if (state.article.ID === articleID || state.article.isFetching) {\n        return false;\n    } else {\n        return true;\n    }\n}\n\nexport function closeOverlay() {\n    return dispatch => {\n        if (isStaticPage()) {\n            return;\n        }\n        closeModal();\n        historyData.overlayIsOn = false;\n        history.push(stripPathname(historyData.preservedHref), null);\n        document.title = historyData.initialTitle;\n\n        dispatch(closeArticle());\n        $(document).off('keydown.overlayArticle');\n        $(window).trigger('scroll');\n    }\n}\n\nexport function fetchArticle(articleID, type = ArticleCache.ARTICLES, killCache = false, queryString = '') {\n    return (dispatch, getState) => {\n        if (articleID == null) {\n            console.warn('fetchArticle(): articleID was null.');\n            return;\n        }\n        var state = getState();\n        if (shouldOpenArticle(state)) {\n            dispatch(openArticle());\n        }\n        if (killCache) {\n            cache.remove(articleID, type);\n            delete state.article;\n        }\n\n        if (killCache || shouldFetchArticle(state, articleID)) {\n            if (cache.exists(articleID, type)) {\n                const cac = cache.get(articleID, type);\n                dispatch(loadArticle(articleID, cac));\n                onLoadArticle(cac);\n                // if cache is crawled one, request should continue\n                if (!(cac.isCrawled)) {\n                    return;\n                }\n            }\n            dispatch(requestArticle(articleID));\n            const options = { saved_users_top:10, raw_content: 'true', include_viewer: 'true'};\n            if (getLocationArgPairs('preview')) {\n                options.preview = true;\n            }\n            $.get(`/rest-api/v1/articles/${articleID}${queryString}`, options)\n                .then(article => {\n                    cache.add(articleID, article, type);\n                    dispatch(loadArticle(articleID, article));\n                    onLoadArticle(article);\n                })\n                .fail(failureXHR => {\n                    // FIXME: This error handling only happens when there's server-side error -\n                    //        can't handle client-side ones\n                    dispatch(requestArticleFail(articleID));\n                    if (failureXHR.status === 404) {\n                        alertify.alert(\"This page is not available. Please try again later.\");\n                    // } else if (failureXHR.status >= 500) {\n                    } else {\n                        alertify.alert(\"There was an error while opening the page.<br> Please try again or contact <a mailto=\\\"cs@fancy.com\\\">cs@fancy.com</a>.\");\n                    }\n\n                    if (historyData.initialPageIsArticlePage) {\n                        location.href = '/';\n                    } else {\n                        dispatch(closeOverlay());\n                    }\n                });\n        }\n    };\n}\n\n// TODO: make unified eventemitter interface after all\nfunction onLoadArticle(article) {\n    const MPArgs = { article_id: article.id };\n    const currentLocationArgPair = getLocationArgPairs('utm');\n    if (currentLocationArgPair) {\n        MPArgs.utm = currentLocationArgPair[1];\n    }\n    MP('View Article Detail', MPArgs);\n}\n\nwindow.___D = () => {\n    return store.getState();\n};\n","    import C from './action-constants';\n\n\n// Action on requesting article starts\nexport function requestArticle(pendingID) {\n    return {\n        type: C.REQUEST_ARTICLE,\n        status: 'request',\n        pendingID\n    };\n}\n\n// Action on requesting article fails\nexport function requestArticleFail(/*lastRequestFailedArticleID*/) {\n    return {\n        type: C.REQUEST_ARTICLE_FAILURE,\n        status: 'failed'\n    };\n}\n\n// action on loading request result\nexport function loadArticle(ID, data) {\n    // FIXME: should we do this here?\n    const title = data.name;\n    if (title) {\n        document.title = `Fancy | ${title}`;\n    }\n\n    return {\n        type: C.LOAD_ARTICLE,\n        status: 'idle',\n        ID,\n        data\n    };\n}\n\n// Action on close overlay\nexport function openArticle() {\n    return {\n        type: C.OPEN_ARTICLE\n    };\n}\n\n// Action on close overlay\nexport function closeArticle() {\n    return {\n        type: C.CLOSE_ARTICLE,\n        ID: null,\n        pendingID: null,\n        article: null\n    };\n}\n\nexport function updateAppContext(contextObject) {\n    return {\n        type: C.UPDATE_APP_CONTEXT,\n        context: contextObject\n    };\n}\n","// App state that does not usually change during app lifecycle. (i.e. Login state)\n// import assign from 'object-assign';\n\n// module-level login state object and setter\nconst state = { viewer: {} };\nexport default state;\n\n/*\nexport function statify(config) {\n    assign(state, config);\n    state.loginNeededAttr = config.loggedIn ? {} : {'data-require_login': \"true\"};\n}\n*/\n\nexport function updateState(k, v) {\n    state[k] = v;\n}\n","import { index } from 'fancyutils';\n\n// Cache bucket\nexport class ArticleCache {\n    articles = {};\n    count = 0;\n    static ARTICLES = 'articles';\n\n    exists = (id, type, ignoreCralwed) => {\n        const cac = this.get(id, type);\n        var existence = cac != null && typeof cac === 'object';\n        if (ignoreCralwed) {\n            existence = existence && cac.isCrawled !== true;\n        }\n        return existence;\n    }\n\n    // resolver function\n    _get = (id) => {\n        return this[ArticleCache.ARTICLES][id] || null;\n    }\n\n    get = (id, type = ArticleCache.ARTICLES) => {\n        const cac = this[type][id] || this.getCrawled(id, type);\n        return cac;\n    }\n\n    getCrawled = (id, type) => {\n        const cac = this[type][id];\n        if (cac && cac.isCrawled) {\n            return cac;\n        } else {\n            return null;\n        }\n    }\n\n    add = (id, data, type) => {\n        // to add, cache should not be exist or crawled one\n        const cac = this[type][id];\n        if (\n            cac == null || \n            cac.isCrawled === true\n        ) {\n            this[type][id] = data;\n            this.count += 1;\n        } else {\n            console.warn('cache.add(): Cache overwrite');\n        }\n    }\n\n    remove = (id, type) => {\n        if (this[type][id]) {\n            delete this[type][id];\n            this.count -= 1;\n        } else {\n            console.warn('cache.remove(): Non-existing cache removal');\n        }\n    }\n\n    // selector = 'a.b.c'\n    update = (id, type = ArticleCache.ARTICLES, selector, value) => {\n        if (selector == null) {\n            console.warn('ArticleCache#update(): selector is empty');\n            return;\n        }\n        const t = this.get(id, type);\n        if (t) {\n            index(t, selector, value);\n        }\n    }\n\n    sweep() {\n        // TODO: should sweep cache if too many cache added by looking `cache.count`\n    }\n}\n\nexport const cache = new ArticleCache();\n","import { getLocationArgPairs } from 'fancyutils';\nimport { GlobalFancySomething } from 'ftypes';\n\n\ndeclare global {\n    interface Window {\n        _: typeof import('underscore');\n        track_event: Function;\n        alertify: alertify.IAlertifyStatic;\n        dataLayer: Array<any>;\n        Fancy: GlobalFancySomething;\n        from_sds_page: boolean;\n        TrackingEvents: {\n            addToCart(_: any): any\n        }\n    }\n}\n\nconst { Fancy, track_event, dataLayer, from_sds_page, TrackingEvents } = window;\n\nexport function logAddCartMixpanel({\n    salesID,\n    saleOptionID,\n    utm,\n    section,\n    via,\n} : {\n    salesID: any;\n    saleOptionID: any;\n    utm: any;\n    section: any;\n    via: any;\n}) {\n    if (salesID == null) {\n        return;\n    }\n    if (utm == null) {\n        const currentLocationArgPair = getLocationArgPairs('utm');\n        if (currentLocationArgPair) {\n            utm = currentLocationArgPair[1];\n        }\n    }\n    const log = {\n        'sale id': salesID,\n        via: via || 'thing page',\n        utm: utm,\n    };\n    if (section) {\n        log.section = section;\n    }\n    if (saleOptionID && salesID !== saleOptionID) {\n        log['option id'] = saleOptionID;\n    }\n    try {\n        window.track_event && track_event('Add to Cart', log);\n    } catch (e) {}\n    return log;\n}\n\nexport function addItemToCart(param, callback, meta) {\n    // should be replaced by Fancy.CartAPI.addItem\n    param.from_sds_page = from_sds_page;\n    if (window.dataLayer) {\n        window.dataLayer.push({\n            event: 'Add_to_Cart_Button',\n            product_id: param['sale_item_id'],\n            option_id: param['option_id'],\n            products: undefined,\n            products_info: undefined,\n            revenue: undefined\n        });\n    }\n    return $.ajax({\n        type: 'POST',\n        url: '/add_item_to_cart.json',\n        data: param\n    })\n    .done(json => {\n        if (!json || json.status_code == null) {\n            return;\n        }\n        if (json.status_code === 1) {\n            if (meta) {\n                TrackingEvents.addToCart([{\n                    id: param.sale_item_id,\n                    brand: meta.brand_name,\n                    name: meta.title,\n                    quantity: param.quantity,\n                    price: meta.price,\n                    variant: json.option,\n                }]); // avoid NaN\n            }\n            var args: any = {\n                'THING_ID': param.thing_id,\n                'ITEMCODE': json.itemcode,\n                'THUMBNAIL_IMAGE_URL': json.image_url,\n                'ITEMNAME': json.itemname,\n                'QUANTITY':json.quantity,\n                'PRICE': json.price,\n                'OPTIONS': json.option,\n                'HTML_URL': json.html_url,\n                'CART_ID': json.cart_id,\n            };\n            if (json.fancy_price) {\n                args.FANCY_PRICE = json.fancy_price;\n            }\n            Fancy.Cart.addItem(args);\n            Fancy.Cart.openPopup();\n        } else if (json.status_code == 0) {\n            if(json.message) {\n                alert(json.message);\n            }\n        }\n    })\n    .always(function() { callback && callback(); });\n}\n","import { isEmpty } from 'fancyutils';\n\n\nexport function getDescription(article) {\n    return article.description;\n}\n\nexport function formatPrice(amount) {\n    var newPrice = amount.toFixed(2) + '';\n    var regex = /(\\d)(\\d{3})([,\\.]|$)/;\n    while (regex.test(newPrice)) {\n        newPrice = newPrice.replace(regex, '$1,$2$3');\n    }\n    if (window.numberType === 2) {\n        newPrice = newPrice.replace(/,/g, ' ').replace(/\\./g, ',');\n    }\n    return newPrice;\n}\n\nexport function getSafeNameProp({ emojified_name, name }) {\n    if (emojified_name) {\n        return { dangerouslySetInnerHTML: { __html: emojified_name } };\n    } else {\n        return { children: name };\n    }\n}\n\nfunction salesAvailable(thing) {\n    if (!isEmpty(thing.sales)) {\n        return thing.sales_available;\n    }\n    return false;\n}\n\nexport function getThingName(thing) {\n    if (thing.type === 'giftcard') {\n        return gettext('Fancy Gift Card');\n    } else if (salesAvailable(thing)) {\n        return thing.sales.name;\n    } else {\n        return thing.name;\n    }\n}","import React, { Component } from 'react';\nimport classnames from 'classnames';\nimport { MP, getConciseNumberString } from 'fancyutils';\nimport { Display } from 'fancymixin';\n\nimport { FancyStatus } from '../config';\nimport { cache } from '../cache';\n\n\nexport function handleProfileMouseOver(event) {\n    const $profile = $(event.currentTarget).find('em');\n    $profile.css('margin-left', `${-($profile.width() / 2) - 10}px`);\n}\n\nconst FancydUser = ({ user = {}, display, isViewer }) => (\n    <a href={user.html_url}\n       className={classnames(\"user\", { _viewer: isViewer })}\n       onMouseOver={handleProfileMouseOver}\n       style={display}>\n        <img src=\"/_ui/images/common/blank.gif\"\n             style={{ backgroundImage: `url(${user.user_square_image_small || user.image_url})`}} />\n        <em>{user.full_name || user.fullname}</em>\n    </a>\n);\n\nfunction isUserEqual(a, b) {\n    if (a == null || b == null) {\n        return false;\n    }\n    return a.id === b.id;\n}\n\nconst bgXPosSequence = [0, -54, -108, -163, -218, -272, -327, -436, -490, -545, -599, -654, -708, -763, -817, -872, -926, -981, -1035, -1144, -1199, -1253, -1308, -1417, -1471];\n\nfunction _handleFancydStateOnLoadThing(thingID, { fancyd, fancyd_count }, stateSetter = _ => _) {\n    // onFancyButtonUpdate(thingID, fancyd, getConciseNumberString(fancyd_count));\n    stateSetter({\n        fancyd,\n        fancyd_count,\n        loading: false,\n        fancyStatus: FancyStatus.Idle,\n    })\n}\n\nfunction getFancyStatus(nextFancydState) {\n    return nextFancydState ? FancyStatus.Addition : FancyStatus.Removal;\n}\nfunction getCompletionIdleStatus(currentFancyState) {\n    const prevFancyState = !currentFancyState;\n    return prevFancyState ? FancyStatus.AfterRemoval : FancyStatus.AfterAddition;\n}\nfunction getNextFancydCount(nextFancyd, currentFancydCount) {\n    if (nextFancyd === true) {\n        return currentFancydCount + 1;\n    } else {\n        return currentFancydCount - 1;\n    }\n}\nfunction toggleFancy(thingID, currentState, stateSetter = _ => _) {\n    const { fancyd, fancyd_count, loading } = currentState;\n    const nextFancyd = !fancyd;\n    const nextFancydCount = getNextFancydCount(nextFancyd, fancyd_count);\n\n    if (!loading) {\n        stateSetter({\n            fancyd: nextFancyd, loading: true, fancyd_count: nextFancydCount, fancyStatus: getFancyStatus(nextFancyd)\n        });\n\n        $.ajax({\n            type: 'PUT',\n            url: `/rest-api/v1/things/${thingID}`,\n            data: {\n                fancyd: nextFancyd\n            }\n        })\n        .done(function(json){\n            if (json.id && json.fancyd === !fancyd) {\n                // Completing fancy\n                const nextFancydCount = (json.fancyd === true) ? (fancyd_count||0) + 1 : (fancyd_count||0) - 1;\n\n                cache.update(thingID, undefined, 'fancyd', nextFancyd);\n                cache.update(thingID, undefined, 'fancyd_count', nextFancydCount);\n                // onFancyButtonUpdate(thingID, nextFancyd, getConciseNumberString(nextFancydCount));\n\n                stateSetter({\n                    loading: false, fancyd: nextFancyd, fancyd_count: nextFancydCount, fancyStatus: getCompletionIdleStatus(nextFancyd)\n                });\n            } else {\n                // cancelling fancy\n                stateSetter({ loading: false, fancyd, fancyd_count, fancyStatus: getFancyStatus(fancyd) });\n            }\n        })\n        .fail(function() {\n            // cancelling fancy\n            stateSetter({ loading: false, fancyd, fancyd_count, fancyStatus: getFancyStatus(fancyd) });\n        });\n    }\n}\n\n// workaround for profile heads overflow on animation\nconst bigContainerStyle = { width: '285px' };\n\nexport class FancydUsers extends Component {\n    _getInitialState() {\n        return {\n            fancyAnimation: false,\n            // button state\n            fancyd: null,\n            loading: false,\n            fancyd_count: null,\n            fancyStatus: FancyStatus.Idle, // fancyStatus = 'Idle', { Idle | Addition | Removal | After- } - Fancy'd status for animation control\n        };\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = this._getInitialState();\n        this.fancyBGAnimationRef = element => {\n            this.fancyBGAnimation = element;\n        }\n    }\n\n    getFancydCountString = () => {\n        const { fancyd_count } = this.state;\n        return fancyd_count != null ? getConciseNumberString(fancyd_count, 0) : '0';\n    }\n\n    animateFancyBG = (frame) => {\n        if (frame === undefined) {\n            this.animateFancyBG(0);\n        } else if (frame < bgXPosSequence.length) {\n            // Special branching due to misposition in background\n            var xPos = bgXPosSequence[frame];\n            $(this.fancyBGAnimation).css('background-position-x', `${xPos}px`);\n            setTimeout(() => { this.animateFancyBG(frame + 1) }, 10);\n        } else if (frame >= bgXPosSequence.length) {\n            this.setState({ fancyAnimation: false });\n        }\n    }\n\n    getFancyduserDisplay = (user, index, totalLength) => {\n        const {\n            appContext: { viewer },\n            bigContainer,\n        } = this.props;\n        const {\n            fancyd,\n            fancyStatus,\n        } = this.state;\n\n        const first = index === 0;\n        const last = index === totalLength - 1;\n\n        var display;\n        if (fancyStatus === FancyStatus.AfterAddition || fancyStatus === FancyStatus.Addition) {\n            // designer satisfaction 1)\n            if (totalLength <= 2) {\n                display = Display.Inline;\n            } else {\n                if (first) {\n                    display = Display.Inline;\n                } \n            }\n        } else if (fancyStatus === FancyStatus.AfterRemoval || fancyStatus === FancyStatus.Removal) {\n            if (first) {\n                display = Display.None;\n            } else if (last) {\n                display = Display.Inline;\n            }\n        }\n        // designer satisfaction 2) https://app.asana.com/0/86925821949642/161445424426526\n        const indexLimit = bigContainer ? 6 : 5;\n        if (\n            (fancyStatus === FancyStatus.AfterAddition ||\n             fancyStatus === FancyStatus.Addition ||\n             fancyStatus === FancyStatus.Removal ||\n             (fancyd && fancyStatus === FancyStatus.Idle)\n            ) &&\n            index > indexLimit\n        ) {\n            display = Display.None;\n        }\n\n        if (fancyStatus === FancyStatus.Idle &&\n            !fancyd &&\n            isUserEqual(user, viewer)\n        ) {\n            display = Display.None;\n        }\n\n        return display;\n    }\n\n    toggleFancy = () => {\n        toggleFancy(this.props.thing.id, this.state, ns => { this.setState(ns) });\n    }\n\n    handleFancydStateOnLoadThing = (thing) => {\n        if (thing == null) {\n            thing = this.props.thing;\n        }\n        _handleFancydStateOnLoadThing(thing.id, { fancyd: thing.fancyd, fancyd_count: thing.fancyd_count }, ns => { this.setState(ns); });\n    }\n\n    handleFancyClick = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        if (!this.props.appContext.loggedIn) {\n            window.require_login && window.require_login();\n            return;\n        }\n        const { thing } = this.props;\n        const { fancyAnimation, fancyd, loading } = this.state;\n        if (loading) {\n            return;\n        }\n        if (!fancyd && !fancyAnimation) {\n            this.setState({ fancyAnimation: true }, _ => { this.animateFancyBG(); });\n        }\n\n        if (!fancyd) {\n            MP('Fancy', { thing_id: thing.id });\n        } else {\n            MP('Unfancy', { thing_id: thing.id });\n        }\n\n        this.toggleFancy();\n    }\n\n    componentDidMount() {\n        this.handleFancydStateOnLoadThing();\n    }\n\n    componentDidUpdate({ thing }) {\n        // Thing has been updated.\n        if (thing.id !== this.props.thing.id || thing.isCrawled !== this.props.thing.isCrawled) {\n            this.handleFancydStateOnLoadThing(thing);\n        }\n    }\n\n    render() {\n        const {\n            appContext: { loggedIn, viewer },\n            thing: { fancyd_users, user },\n            bigContainer,\n        } = this.props;\n        const {\n            fancyd,\n            fancyAnimation,\n            fancyStatus,\n        } = this.state;\n\n        const fancydUsers = [\n            loggedIn && viewer,\n            loggedIn && !isUserEqual(viewer, user) && user\n        ]\n        .concat(\n            fancyd_users &&\n            fancyd_users.filter(fancydUser => !isUserEqual(fancydUser, user) &&\n                                              !isUserEqual(fancydUser, viewer))\n        )\n        .filter(e => e);\n\n        var fancydUserAnimClass;\n        if (fancyStatus === FancyStatus.Addition) {\n            fancydUserAnimClass = \"add\";\n        } else if (fancyStatus === FancyStatus.Removal) {\n            fancydUserAnimClass = \"remove\";\n        }\n        // designer satisfaction 1)\n        // If user is less than 2 we need to apply special class.\n        // In this way dont owner profile dont get 'consumed': https://app.asana.com/0/86925821949642/173945332708784\n        const userCountSufficiency = fancydUsers.length <= 2 ? '_insuff' : '_suff';\n\n        return (\n            <span style={bigContainer && bigContainerStyle} className=\"fancyd_users-wrap\">\n                <span className=\"count\">\n                    <a onClick={this.handleFancyClick}\n                       className={classnames(\"button button-static fancy _count\", { fancyd, loading: fancyAnimation })}>\n                        <span ref={this.fancyBGAnimationRef}>\n                            <i />\n                        </span>{this.getFancydCountString()}\n                    </a>\n                    <span className=\"_fancyd\" />\n                </span>\n                <span className={classnames(\"fancyd_user\", fancydUserAnimClass, userCountSufficiency)}>\n                    {fancydUsers.map((user, index) => {\n                        const isViewer = isUserEqual(user, viewer);\n                        return (\n                            <FancydUser key={index}\n                                        user={user}\n                                        display={this.getFancyduserDisplay(user, index, fancydUsers.length)}\n                                        isViewer={isViewer} />\n                        );\n                    })}\n                </span>\n            </span>\n        );\n    }\n}\n","import React, { Component } from \"react\";\nimport classnames from \"classnames\";\nimport { numberFormat, isPlainLeftClick } from \"fancyutils\";\nimport { MoreShare, MoreShareFacade } from \"common-components\";\n\nimport appState from \"../appstate\";\nimport { addItemToCart, logAddCartMixpanel } from \"../../overlay-thing/components/map.cart\";\nimport { getSafeNameProp, getThingName } from \"./map\";\nimport { LinkTypes, transition } from \"../container/routeutils\";\nimport { FancydUsers } from \"./ThingFancydUsers\";\nimport { OaContainer } from \"../container/entry-events\";\n\nconst itemTraits = {\n    article: {\n        utm: \"article\",\n        section: \"items\",\n        via: \"article\",\n    },\n    similar: {\n        section: \"recommended\",\n        utm: \"rec\",\n        via: \"thing more\",\n    },\n    recently: {\n        section: \"recently viewed\",\n        utm: \"rv\",\n        via: \"thing more\",\n    },\n};\n\nexport default class ThingCard extends Component {\n    static defaultProps = {\n        showDelete: true,\n    };\n\n    state = {\n        fancydCount: 0,\n        quantity: 1,\n        optionID: null,\n        showCart: false,\n        popupOpened: false,\n    };\n\n    constructor(props) {\n        super(props);\n        this.handleLinkClick = _.throttle(this.handleLinkClick, 500);\n    }\n\n    componentDidMount() {\n        this.setState({ fancydCount: this.props.fancyd_count || 0 });\n    }\n\n    componentWillUnmount() {\n        this.unmounted = true;\n    }\n\n    handleCartAddition = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        this.addToCart();\n    };\n\n    addToCart() {\n        if (!appState.loggedIn) {\n            window.require_login && window.require_login();\n            return;\n        }\n        const { id, itemType } = this.props;\n        const { quantity } = this.state;\n\n        const sales = this.getSales();\n        const saleAvailable = this.isSaleAvailable();\n        const saleOptionExists = this.isSaleOptionExists();\n        const option = this.getSaleOption();\n\n        if (!saleAvailable || this.state.loading) {\n            return;\n        }\n        if (isNaN(quantity) || quantity <= 0) {\n            alert(gettext(\"Please select a valid quantity.\"));\n            return;\n        }\n\n        const param = {\n            seller_id: sales.seller.id, // sisi\n            thing_id: id, // tid\n            sale_item_id: sales.sale_id, // sii\n            quantity,\n        };\n        if (saleOptionExists && option) {\n            param.option_id = option.id;\n        }\n\n        const traits = itemTraits[itemType];\n        const title = getThingName(this.props);\n        this.setState({ loading: true }, () => {\n            const log = {\n                salesID: sales.sale_id,\n                utm: traits.utm,\n                section: traits.section,\n                via: traits.via,\n            };\n            if (option) {\n                log.saleOptionID = option.id;\n            }\n            logAddCartMixpanel(log);\n            // ga shit\n            const discounting = sales && sales.discount_percentage !== \"0\";\n            const meta = {\n                title,\n                price: discounting ? sales.retail_price : sales.deal_price,\n                brand_name: sales.seller.brand_name,\n            };\n            addItemToCart(\n                param,\n                () => {\n                    if (!this.unmounted) {\n                        this.setState({ loading: false });\n                    }\n                },\n                meta\n            );\n        });\n    }\n\n    handleQuickCartToggle = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        const saleAvailable = this.isSaleAvailable();\n        const saleOptionExists = this.isSaleOptionExists();\n        if (saleAvailable) {\n            if (saleOptionExists) {\n                this.setState({ showCart: !this.state.showCart });\n            } else {\n                this.addToCart();\n            }\n        } else {\n            this.setState({ showCart: !this.state.showCart });\n        }\n    };\n\n    isSaleAvailable = () => {\n        const { sales_available } = this.props;\n        const sales = this.getSales();\n        if (sales) {\n            return sales_available && sales.quantity !== 0;\n        } else {\n            return false;\n        }\n    };\n\n    getSaleOption = () => {\n        const saleOptionExists = this.isSaleOptionExists();\n        const sales = this.getSales();\n        if (sales && saleOptionExists) {\n            const optionID = this.state.optionID || sales.options[0].id;\n            const option = sales.options.filter((option) => option.id === optionID)[0] || null;\n            return option;\n        } else {\n            return null;\n        }\n    };\n\n    isSaleOptionExists = () => {\n        const sales = this.getSales();\n        if (sales) {\n            return sales.has_options === true;\n        } else {\n            return false;\n        }\n    };\n\n    isSaleOptionAvailable = () => {\n        const option = this.getSaleOption();\n        if (option) {\n            return option.available_for_sale === true && option.quantity !== 0;\n        } else {\n            return false;\n        }\n    };\n\n    getSales = () => {\n        return this.props.sales;\n    };\n\n    getFancydCount = () => {\n        return _.isNumber(this.state.fancydCount) ? this.state.fancydCount : this.props.fancyd_count;\n    };\n\n    handleFancydCount = (diff) => {\n        this.setState({\n            fancydCount: this.state.fancydCount + diff,\n        });\n    };\n\n    getQuantityRange = () => {\n        const saleOptionExists = this.isSaleOptionExists();\n        var max;\n        if (saleOptionExists && this.isSaleOptionAvailable()) {\n            max = this.getSaleOption().quantity;\n        } else if (this.isSaleAvailable()) {\n            max = this.getSales().quantity;\n        }\n        return max == null ? [\"1\"] : _.range(1, Math.min(10, max + 1));\n    };\n\n    handleOptionChange = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        this.setState({ optionID: parseInt(event.target.value, 10), quantity: 1 });\n    };\n\n    handleOptionQuantityChange = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        this.setState({ quantity: parseInt(event.target.value, 10) });\n    };\n\n    handleTrickClick = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        this.setState({ showCart: false });\n    };\n\n    handleRecentlyDelete = () => {\n        $.post(\"/remove_recently_viewed_thing\", { thing_id: this.props.id }, (json) => {\n            if (!json || json.status_code !== 1) {\n                window.alertify.alert(`Sorry, failed to remove \"${this.props.name}\". Please retry.`);\n            } else {\n                this.props.onDelete(this.props);\n            }\n        }).fail(() => {\n            window.alertify.alert(`Sorry, failed to remove \"${this.props.name}\". Please retry.`);\n        });\n    };\n\n    handleLinkClick = (event) => {\n        event.stopPropagation();\n        if (isPlainLeftClick(event)) {\n            event.preventDefault();\n\n            if (!window.isWhitelabel) OaContainer.scrollToTop();\n\n            transition(this.html_url(), LinkTypes.Timeline);\n        }\n    };\n\n    handleShowSomething = (popupOpened) => {\n        this.setState({ popupOpened });\n    };\n\n    handleNotifySoldout = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        if (!appState.loggedIn) {\n            window.require_login && window.require_login();\n            return;\n        }\n        const sales = this.getSales();\n        const params = { sale_item_id: sales.sale_id };\n        const waiting = this.getWaiting(sales);\n        if (waiting) {\n            params.remove = 1;\n        }\n\n        $.ajax({\n            type: \"post\",\n            url: \"/wait_for_product.json\",\n            data: params,\n            dataType: \"json\",\n        })\n            .done((json) => {\n                if (!json || json.status_code == null) {\n                    return;\n                }\n                if (json.status_code == 0 && json.message) {\n                    window.alertify.alert(json.message);\n                    return;\n                }\n                const waiting = params.remove ? false : true;\n                this.setState({ waiting });\n            })\n            .fail(function (json) {\n                if (json && json.message) {\n                    window.alertify.alert(json.message);\n                } else {\n                    window.alertify.alert(\"There was an error while processing your request. Please try again later.\");\n                }\n            });\n    };\n\n    getWaiting = () => {\n        const sales = this.getSales();\n        if (sales) {\n            if (this.state.waiting == null) {\n                return sales.waiting;\n            } else {\n                return this.state.waiting;\n            }\n        } else {\n            return false;\n        }\n    };\n\n    html_url = () => {\n        const { utm } = itemTraits[this.props.itemType] || {};\n        return `${this.props.html_url}${utm ? \"?utm=\" + utm : \"\"}`;\n    };\n\n    render() {\n        const { id, thumb_image_url_310, thumb_image_url_558, itemIdx, loggedIn, viewer, showDelete } = this.props;\n        const { showCart, loading, popupOpened } = this.state;\n        const html_url = this.html_url();\n\n        const sales = this.getSales();\n        const discounting = sales && sales.discount_percentage !== \"0\";\n        const waiting = this.getWaiting();\n\n        const saleAvailable = this.isSaleAvailable();\n        const saleOptionExists = this.isSaleOptionExists();\n        const saleOptionAvailable = this.isSaleOptionAvailable();\n\n        const showFrom =\n            sales && sales.max_price !== null && sales.min_price !== null && sales.max_price > sales.min_price;\n\n        return __Config.new_card ? (\n            <li className={classnames({ \"quick-cart\": loading, active: popupOpened || showCart })}>\n                <div className={classnames(\"figure-item new\", { toggled: showCart })}>\n                    <figure>\n                        <a\n                            href={html_url}\n                            rel={`thing-${id}`}\n                            onClick={this.handleLinkClick}\n                            data-prevent-overlay=\"true\">\n                            <span className=\"figure\">\n                                <img\n                                    src=\"/_ui/images/common/blank.gif\"\n                                    style={{ backgroundImage: `url(${thumb_image_url_558 || thumb_image_url_310})` }}\n                                />\n                            </span>\n                        </a>\n                        <div className=\"buttons\">\n                            <FancydUsers\n                                thing={this.props}\n                                appContext={this.props.appContext}\n                                displayCount={6}\n                                showFancydUser={false}\n                            />\n                            <MoreShareFacade\n                                objectType=\"thing\"\n                                objectId={id}\n                                loggedIn={loggedIn}\n                                title={getThingName(this.props)}\n                                viewerUsername={viewer.username}\n                                onShowSomething={this.handleShowSomething}\n                            />\n                        </div>\n                        <div\n                            className={classnames(\"show_cart\", { opened: showCart })}\n                            style={!sales ? { display: \"none\" } : undefined}>\n                            {sales && (\n                                <button\n                                    className=\"btn-cart nopopup\"\n                                    onClick={this.handleCartAddition}\n                                    disabled={!saleOptionAvailable}>\n                                    <em>Add to Cart</em>\n                                </button>\n                            )}\n                            <em className=\"sale-item-input\">\n                                <small\n                                    className=\"trick\"\n                                    style={{ display: showCart ? \"block\" : undefined }}\n                                    onClick={this.handleTrickClick}\n                                />\n                                {saleAvailable ? (\n                                    <span className=\"frm\">\n                                        {saleOptionExists && (\n                                            <select\n                                                name=\"option_id\"\n                                                id={`${id}-option_id`}\n                                                onChange={this.handleOptionChange}>\n                                                {sales.options.map((option, i) => (\n                                                    <option\n                                                        key={`other-item-${itemIdx}-saleoption-${i}`}\n                                                        value={option.id}>\n                                                        {option.option} -{\" \"}\n                                                        {!option.available_for_sale || option.quantity === 0\n                                                            ? gettext(\"Sold out\")\n                                                            : `$${numberFormat(option.deal_price, 0)}`}\n                                                    </option>\n                                                ))}\n                                            </select>\n                                        )}\n                                        <select\n                                            className=\"option\"\n                                            id={`${id}-quantity`}\n                                            name=\"quantity\"\n                                            disabled={!saleOptionAvailable}\n                                            onChange={this.handleOptionQuantityChange}>\n                                            {this.getQuantityRange().map((e, i) => (\n                                                <option key={`other-item-${itemIdx}-quantityOption-${i}`} value={e}>\n                                                    {e}\n                                                </option>\n                                            ))}\n                                        </select>\n                                        <button\n                                            className=\"add_to_cart btns-green-embo\"\n                                            onClick={this.handleCartAddition}\n                                            disabled={!saleOptionAvailable}>\n                                            {gettext(\"Add to Cart\")}\n                                        </button>\n                                    </span>\n                                ) : (\n                                    <span className=\"frm\">\n                                        <span className=\"notify-soldout\">Sorry, this item has sold out</span>\n                                        <button\n                                            className={classnames(\"btns-green-embo btn-notify\", {\n                                                subscribed: waiting,\n                                            })}\n                                            onClick={this.handleNotifySoldout}>\n                                            {waiting ? \"Subscribed\" : \"Notify me when available\"}\n                                        </button>\n                                    </span>\n                                )}\n                            </em>\n                        </div>\n                    </figure>\n                    <figcaption>\n                        <a\n                            href={html_url}\n                            className=\"title\"\n                            rel={`thing-${id}`}\n                            onClick={this.handleLinkClick}\n                            data-prevent-overlay=\"true\">\n                            <b className=\"title\" {...getSafeNameProp(this.props)} />\n                            {sales && (\n                                <span\n                                    className={`price ${discounting ? \"sales\" : \"\"} ${saleAvailable ? \"\" : \"soldout\"}`}>\n                                    {discounting && (\n                                        <small key=\"ThingCard2-price-deal\">\n                                            ${numberFormat(sales.retail_price, 0)}\n                                        </small>\n                                    )}\n                                    {showFrom ? (\n                                        <React.Fragment>\n                                            <em className=\"from\">from </em> ${numberFormat(sales.min_price, 0)}\n                                        </React.Fragment>\n                                    ) : (\n                                        `$\n                                        ${numberFormat(sales.deal_price, 0)}`\n                                    )}\n                                </span>\n                            )}\n                        </a>\n                    </figcaption>\n                    <a className=\"delete\" onClick={this.handleRecentlyDelete} />\n                </div>\n            </li>\n        ) : (\n            <li className={classnames({ \"quick-cart\": loading, active: popupOpened || showCart })}>\n                <div className={classnames(\"figure-item\", { toggled: showCart })}>\n                    <figure>\n                        <a href={html_url} rel={`thing-${id}`} onClick={this.handleLinkClick}>\n                            <span className=\"back\" />\n                            <img\n                                className=\"figure\"\n                                style={{ backgroundImage: `url(${thumb_image_url_310})` }}\n                                src=\"/_ui/images/common/blank.gif\"\n                            />\n                        </a>\n                    </figure>\n                    <figcaption>\n                        <span\n                            className={classnames(\"show_cart\", { opened: showCart })}\n                            style={{ display: sales ? null : \"none\" }}>\n                            {sales && (\n                                <button\n                                    className={`btn-cart nopopup ${discounting ? \"sales\" : \"\"} ${\n                                        saleAvailable ? \"\" : \"soldout\"\n                                    }`}\n                                    onClick={this.handleQuickCartToggle}>\n                                    <em>\n                                        {discounting\n                                            ? [\n                                                  <small key=\"ThingCard2-price-deal\">\n                                                      ${numberFormat(sales.retail_price, 0)}\n                                                  </small>,\n                                                  `$${numberFormat(sales.deal_price, 0)}`,\n                                              ]\n                                            : `$${numberFormat(sales.deal_price, 0)}`}\n                                    </em>\n                                </button>\n                            )}\n                            <em className=\"sale-item-input\">\n                                <small\n                                    className=\"trick\"\n                                    style={{ display: showCart ? \"block\" : null }}\n                                    onClick={this.handleTrickClick}\n                                />\n                                {saleAvailable ? (\n                                    <span className=\"frm\">\n                                        {saleOptionExists && (\n                                            <select\n                                                name=\"option_id\"\n                                                id={`${id}-option_id`}\n                                                onChange={this.handleOptionChange}>\n                                                {sales.options.map((option, i) => (\n                                                    <option\n                                                        key={`other-item-${itemIdx}-saleoption-${i}`}\n                                                        value={option.id}>\n                                                        {option.option} -{\" \"}\n                                                        {!option.available_for_sale || option.quantity === 0\n                                                            ? gettext(\"Sold out\")\n                                                            : `$${numberFormat(option.deal_price, 0)}`}\n                                                    </option>\n                                                ))}\n                                            </select>\n                                        )}\n                                        <select\n                                            className=\"option\"\n                                            id={`${id}-quantity`}\n                                            name=\"quantity\"\n                                            disabled={!saleOptionAvailable}\n                                            onChange={this.handleOptionQuantityChange}>\n                                            {this.getQuantityRange().map((e, i) => (\n                                                <option key={`other-item-${itemIdx}-quantityOption-${i}`} value={e}>\n                                                    {e}\n                                                </option>\n                                            ))}\n                                        </select>\n                                        <button\n                                            className=\"add_to_cart btns-green-embo\"\n                                            onClick={this.handleCartAddition}\n                                            disabled={!saleOptionAvailable}>\n                                            {gettext(\"Add to Cart\")}\n                                        </button>\n                                    </span>\n                                ) : (\n                                    <span className=\"frm\">\n                                        <span className=\"notify-soldout\">Sorry, this item has sold out</span>\n                                        <button\n                                            className={classnames(\"btns-green-embo btn-notify\", {\n                                                subscribed: waiting,\n                                            })}\n                                            onClick={this.handleNotifySoldout}>\n                                            {waiting ? \"Subscribed\" : \"Notify me when available\"}\n                                        </button>\n                                    </span>\n                                )}\n                            </em>\n                        </span>\n                        <a\n                            href={html_url}\n                            className=\"title\"\n                            rel={`thing-${id}`}\n                            onClick={this.handleLinkClick}\n                            {...getSafeNameProp(this.props)}\n                        />\n                        <span className={classnames(\"buttons\" /*, { 'no-cart': saleAvailable }*/)}>\n                            <FancydUsers thing={this.props} appContext={this.props.appContext} />\n                            <MoreShare\n                                objectType=\"thing\"\n                                objectId={id}\n                                loggedIn={loggedIn}\n                                title={getThingName(this.props)}\n                                viewerUsername={viewer.username}\n                                onShowSomething={this.handleShowSomething}\n                            />\n                        </span>\n                    </figcaption>\n                    {showDelete && <a className=\"delete\" onClick={this.handleRecentlyDelete} />}\n                </div>\n            </li>\n        );\n    }\n}\n","import React, { Component } from 'react';\nimport { isPlainLeftClick } from 'fancyutils';\n\nimport { LinkTypes, transition } from '../container/routeutils';\n\n\nexport default class ArticleCard extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {};\n\n        this.handleLinkClick = _.throttle(this.handleLinkClick, 500);\n    }\n\n    handleLinkClick = (event) => {\n        event.stopPropagation();\n        if (isPlainLeftClick(event)) {\n            event.preventDefault();\n\n            const { html_url } = this.props;\n            transition(html_url, LinkTypes.Timeline);\n        }\n    }\n\n    componentWillUnmount() {\n        this.unmounted = true;\n    }\n\n    render() {\n        const { id, cover_image, title, url, tagline } = this.props;\n        \n        return (\n            <div className=\"article_item detail\">\n              <a href={url} >\n                <span className=\"cover\">\n                  { cover_image &&\n                  <img src=\"/_ui/images/common/blank.gif\" style={{backgroundImage: `url(${cover_image.url})`}}/>\n                  }\n                  { !cover_image &&\n                    <img src=\"/_ui/images/common/blank.gif\"/>\n                  }\n                </span>\n                <span className=\"title\">{title}</span>\n                <span className=\"description\">{tagline}</span>\n              </a>\n            </div>\n        );\n    }\n}","import React, { Component } from \"react\";\nimport { convertThingsV1ToRest } from \"fancyutils\";\n\nimport ThingCard from \"./ThingCard\";\nimport ArticleCard from \"./ArticleCard\";\nimport { cache } from \"../cache\";\n\n\nexport class ThingList extends Component {\n    lastarticleID = null;\n    state = {\n        showShare: false,\n        things: []\n    };\n\n    componentDidMount() {\n        // Initial loading\n        this.updateThingList(this.props.article.id, true);\n        const things = convertThingsV1ToRest(this.props.article.things);\n        this.setState({ things: things });\n\n        this.lastarticleID = this.props.article.id;\n    }\n\n    componentDidUpdate() {\n        const nextProps = this.props\n        // Article has changed, reset things.\n        if (this.lastarticleID !== nextProps.article.id) {\n            const idCopy = nextProps.article.id;\n            this.lastarticleID = idCopy;\n            this.updateThingList(nextProps.article.id, true);\n            const things = convertThingsV1ToRest(nextProps.article.things);\n            this.setState({ things: things });\n        }\n    }\n\n    componentWillUnmount() {\n        this.unmounted = true;\n    }\n\n    logExposed = (things) => {\n        if (typeof window.LogExposed == \"undefined\") return;\n        things.forEach(thing => {\n            window.LogExposed.addLog(thing.id + \"\", \"article\");\n        });\n    }\n\n    updateThingList = (articleID) => {\n        if (articleID == null) {\n            return;\n        }\n        $.ajax({\n            type: \"get\",\n            url: `/rest-api/v1/articles/${articleID}/items`,\n        })\n            .done(response => {\n                if (!this.unmounted) {\n                    const things = convertThingsV1ToRest(response.article_items).map(t => {\n                        if (window.isWhitelabel && t.sales) {\n                            const url = `${t.html_url}`\n                            t.url = url\n                            t.html_url = url\n                        }\n                        return t\n                    })\n                    this.logExposed(things);\n                    this.setState({ things: things });\n                }\n            })\n            .fail(function(xhr) {\n                console.warn(\"updateThingList():\", xhr);\n            });\n    }\n\n    render() {\n        const { article, appContext, appContext: { loggedIn }, hasPagination } = this.props;\n        const { things } = this.state;\n\n        const thingsHeader = (article.options && article.options.item_header) || null;\n\n        return (\n            <div id=\"content\" className={`content ${things.length === 0 ? \"_empty\" : \"\"}`}>\n                {thingsHeader && <h3>{thingsHeader}</h3>}\n                {things.length > 0 ? (\n                    <MaybePaginationWindow hasPagination={hasPagination} length={things.length}>\n                        {things &&\n                            things.map((thing, idx) => (\n                                <ThingCard\n                                    itemIdx={idx}\n                                    itemType={\"article\"}\n                                    loggedIn={loggedIn}\n                                    key={`timeline-recently-${idx}`}\n                                    onDelete={this.handleDelete}\n                                    viewer={this.props.appContext.viewer}\n                                    appContext={appContext}\n                                    showDelete={false}\n                                    {...thing}\n                                />\n                            ))}\n                    </MaybePaginationWindow>\n                ) : null}\n            </div>\n        );\n    }\n}\n\nexport class MaybePaginationWindow extends Component {\n    state = {\n        page: 0\n    }\n\n    handlePrevClick = (e) => {\n        e.preventDefault();\n        const minPage = 0;\n        this.setState({ page: Math.max(this.state.page - 1, minPage) });\n    }\n\n    handleNextClick = (e) => {\n        e.preventDefault();\n        const maxPage = Math.floor(this.props.length / 4) - 1;\n        this.setState({ page: Math.min(this.state.page + 1, maxPage) });\n    }\n\n    render() {\n        const { hasPagination, children } = this.props;\n        const style = {};\n        if (hasPagination) {\n            style.transform = `translateX(${ -101 * this.state.page }%)`;\n        }\n        const stream = (\n            <ol className=\"stream after\" style={style}>{children}</ol>\n        );\n\n        if (hasPagination) {\n            return (\n                <div className=\"itemSlide\">\n                    <div className=\"itemSlideWrap\">\n                        {stream}\n                    </div>\n                    <a href=\"#\" className=\"prev\" onClick={this.handlePrevClick}>Prev</a>\n                    <a href=\"#\" className=\"next\" onClick={this.handleNextClick}>Next</a>\n                </div>\n            );\n        } else {\n            return stream;\n        }\n    }\n}\n    \n\nexport class ArticleList extends Component {\n    lastarticleID = null;\n    state = {\n        articles: [],\n        page: 1\n    };\n\n    componentDidMount() {\n        // Initial loading\n        this.updateArticleList(this.props.article.id);\n        this.lastarticleID = this.props.article.id;\n    }\n\n    componentDidUpdate() {\n        const nextProps = this.props;\n        // Article has changed, reset articles.\n        if (this.lastarticleID !== nextProps.article.id) {\n            const idCopy = nextProps.article.id;\n            this.lastarticleID = idCopy;\n            this.updateArticleList(nextProps.article.id, true);\n        }\n    }\n\n    componentWillUnmount() {\n        this.unmounted = true;\n    }\n\n    updateArticleList = (articleID) => {\n        if (articleID == null) {\n            return;\n        }\n        $.ajax({\n            type: \"get\",\n            url: window.isWhitelabel ? \"/rest-api/v1/articles?limit=4&concise=true\" : \"/rest-api/v1/articles?featured\"\n        })\n            .done(response => {\n                if (!this.unmounted) {\n                    var articles = response.articles.filter(article => article.id !== articleID);\n                    this.setState({ articles: articles });\n                }\n            })\n            .fail(function(xhr) {\n                console.warn(\"updateArticleList():\", xhr);\n            });\n    }\n\n    handlePrevClick = (event) => {\n        event.preventDefault();\n        var $this = $(event.target);\n        if ($this.hasClass(\"disabled\")) return;\n        this.setState({ page: this.state.page - 1 });\n    }\n\n    handleNextClick = (event) => {\n        event.preventDefault();\n        var $this = $(event.target);\n        if ($this.hasClass(\"disabled\")) return;\n        this.setState({ page: this.state.page + 1 });\n    }\n\n    getLeftOffset = () => {\n        const { articles, page } = this.state;\n        const left = (page - 1) * -860 - (page > 1 ? 4 : 0);\n        const lastPageNum = ((articles.length / 4) | 0) + ((articles.length % 4) > 0 ? 1 : 0)\n        if (articles.length > 4 && page >= lastPageNum) {\n            const CardWidth = 205\n            const CardMargin = 10\n            const CardContainerWidth = 970;\n            const CardContainerPadding = 14;\n            const max = ((articles.length - 1) * CardMargin + articles.length * CardWidth) - CardContainerWidth + (CardContainerPadding * 2);\n    \n            return `${Math.max(left, -max)}px`;\n        } else {\n            return left;\n        }\n    }\n\n    render() {\n        const { appContext } = this.props;\n        const { articles, page } = this.state;\n        var maxPage = Math.ceil(articles.length / 4);\n        var prevDisabled = page == 1;\n        var nextDisabled = page == maxPage;\n\n        return (\n            <div id=\"sidebar\">\n                <div className=\"wrapper recommend-article\">\n                    <h3 className=\"stit\">MORE ARTICLES</h3>\n                    {articles.length ? (\n                        <div className=\"article_wrap\" style={{ left: this.getLeftOffset() }}>\n                            {articles &&\n                                articles.map((article, idx) => (\n                                    <ArticleCard key={article.id} itemIdx={idx} appContext={appContext} {...article} />\n                                ))}\n                        </div>\n                    ) : (\n                        <div />\n                    )}\n                    {articles.length > 4 && (\n                        <div className=\"paging\">\n                            <a\n                                href=\"#\"\n                                className={`${prevDisabled ? \"disabled\" : \"\"} prev`}\n                                onClick={this.handlePrevClick}>\n                                Prev\n                            </a>\n                            <a\n                                href=\"#\"\n                                className={`${nextDisabled ? \"disabled\" : \"\"} next`}\n                                onClick={this.handleNextClick}>\n                                Next\n                            </a>\n                        </div>\n                    )}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport class AdminHeader extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            is_active: props.article.is_active\n        };\n    }\n\n    handleLiveClick = event => {\n        event.preventDefault();\n        const self = this;\n        const $this = $(event.target);\n        const { article } = this.props;\n\n        let message = `Are you sure you want to set ${article.title} live on ${\n            window.isWhitelabel ? \"Gear\" : \"Fancy\"\n        }?`;\n        if ($this.hasClass(\"on\"))\n            message = `Are you sure you want to hide ${article.title} from ${window.isWhitelabel ? \"Gear\" : \"Fancy\"}?`;\n        const original_labels = window.alertify.labels;\n        window.alertify.set({ labels: { ok: $this.hasClass(\"on\") ? \"Hide\" : \"Set Live\", cancel: \"Cancel\" } });\n        window.alertify.confirm(message, function(yes) {\n            if (yes) {\n                var is_active = !$this.hasClass(\"on\");\n                $.post(\n                    \"/_admin/articles/update_active.json\",\n                    { article_id: article.id, is_active: is_active },\n                    function(json) {\n                        if (json.error) {\n                            window.alertify.alert(json.error);\n                        } else {\n                            window.alertify.alert(is_active ? \"Activated\" : \"Deactivated\");\n                            self.setState({ is_active: is_active });\n                            cache.update(self.props.article.slug, undefined, \"is_active\", is_active);\n                        }\n                    }\n                );\n            }\n        });\n        window.alertify.set({ labels: original_labels })\n    };\n\n    handleEditArticleClick = (e) => {\n        e.preventDefault();\n        const { article } = this.props;\n        window.open(`/_admin/articles/edit?id=${article.id}`);\n    }\n\n\n    render() {\n        const { is_active } = this.state;\n\n        return (\n            <div className=\"admin-header\">\n                <div className=\"inner\">\n                    <h2>Admin Panel</h2>\n                    <a onClick={this.handleEditArticleClick}>\n                        Edit Article\n                    </a>\n                    <label>Live</label>\n                    <button className={`${is_active ? \"on\" : \"\"} btn-switch`} onClick={this.handleLiveClick} />\n                </div>\n            </div>\n        );\n    }\n}\n\n\nexport function initGallery(container) {\n\n    /*! Hammer.JS - v2.0.8 - 2016-04-23\n * http://hammerjs.github.io/\n *\n * Copyright (c) 2016 Jorik Tangelder;\n * Licensed under the MIT license */\n!function(a,b,c,d){\"use strict\";function e(a,b,c){return setTimeout(j(a,c),b)}function f(a,b,c){return Array.isArray(a)?(g(a,c[b],c),!0):!1}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(b,c,d){var e=\"DEPRECATED METHOD: \"+c+\"\\n\"+d+\" AT \\n\";return function(){var c=new Error(\"get-stack-trace\"),d=c&&c.stack?c.stack.replace(/^[^\\(]+?[\\n$]/gm,\"\").replace(/^\\s+at\\s+/gm,\"\").replace(/^Object.<anonymous>\\s*\\(/gm,\"{anonymous}()@\"):\"Unknown Stack Trace\",f=a.console&&(a.console.warn||a.console.log);return f&&f.call(a.console,e,d),b.apply(this,arguments)}}function i(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&la(d,c)}function j(a,b){return function(){return a.apply(b,arguments)}}function k(a,b){return typeof a==oa?a.apply(b?b[0]||d:d,b):a}function l(a,b){return a===d?b:a}function m(a,b,c){g(q(b),function(b){a.addEventListener(b,c,!1)})}function n(a,b,c){g(q(b),function(b){a.removeEventListener(b,c,!1)})}function o(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function p(a,b){return a.indexOf(b)>-1}function q(a){return a.trim().split(/\\s+/g)}function r(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function s(a){return Array.prototype.slice.call(a,0)}function t(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];r(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function u(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<ma.length;){if(c=ma[g],e=c?c+f:b,e in a)return e;g++}return d}function v(){return ua++}function w(b){var c=b.ownerDocument||b;return c.defaultView||c.parentWindow||a}function x(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){k(a.options.enable,[a])&&c.handler(b)},this.init()}function y(a){var b,c=a.options.inputClass;return new(b=c?c:xa?M:ya?P:wa?R:L)(a,z)}function z(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&Ea&&d-e===0,g=b&(Ga|Ha)&&d-e===0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,A(a,c),a.emit(\"hammer.input\",c),a.recognize(c),a.session.prevInput=c}function A(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=D(b)),e>1&&!c.firstMultiple?c.firstMultiple=D(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=E(d);b.timeStamp=ra(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=I(h,i),b.distance=H(h,i),B(c,b),b.offsetDirection=G(b.deltaX,b.deltaY);var j=F(b.deltaTime,b.deltaX,b.deltaY);b.overallVelocityX=j.x,b.overallVelocityY=j.y,b.overallVelocity=qa(j.x)>qa(j.y)?j.x:j.y,b.scale=g?K(g.pointers,d):1,b.rotation=g?J(g.pointers,d):0,b.maxPointers=c.prevInput?b.pointers.length>c.prevInput.maxPointers?b.pointers.length:c.prevInput.maxPointers:b.pointers.length,C(c,b);var k=a.element;o(b.srcEvent.target,k)&&(k=b.srcEvent.target),b.target=k}function B(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};b.eventType!==Ea&&f.eventType!==Ga||(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}function C(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Ha&&(i>Da||h.velocity===d)){var j=b.deltaX-h.deltaX,k=b.deltaY-h.deltaY,l=F(i,j,k);e=l.x,f=l.y,c=qa(l.x)>qa(l.y)?l.x:l.y,g=G(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function D(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:pa(a.pointers[c].clientX),clientY:pa(a.pointers[c].clientY)},c++;return{timeStamp:ra(),pointers:b,center:E(b),deltaX:a.deltaX,deltaY:a.deltaY}}function E(a){var b=a.length;if(1===b)return{x:pa(a[0].clientX),y:pa(a[0].clientY)};for(var c=0,d=0,e=0;b>e;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:pa(c/b),y:pa(d/b)}}function F(a,b,c){return{x:b/a||0,y:c/a||0}}function G(a,b){return a===b?Ia:qa(a)>=qa(b)?0>a?Ja:Ka:0>b?La:Ma}function H(a,b,c){c||(c=Qa);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function I(a,b,c){c||(c=Qa);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function J(a,b){return I(b[1],b[0],Ra)+I(a[1],a[0],Ra)}function K(a,b){return H(b[0],b[1],Ra)/H(a[0],a[1],Ra)}function L(){this.evEl=Ta,this.evWin=Ua,this.pressed=!1,x.apply(this,arguments)}function M(){this.evEl=Xa,this.evWin=Ya,x.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function N(){this.evTarget=$a,this.evWin=_a,this.started=!1,x.apply(this,arguments)}function O(a,b){var c=s(a.touches),d=s(a.changedTouches);return b&(Ga|Ha)&&(c=t(c.concat(d),\"identifier\",!0)),[c,d]}function P(){this.evTarget=bb,this.targetIds={},x.apply(this,arguments)}function Q(a,b){var c=s(a.touches),d=this.targetIds;if(b&(Ea|Fa)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=s(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return o(a.target,i)}),b===Ea)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Ga|Ha)&&delete d[g[e].identifier],e++;return h.length?[t(f.concat(h),\"identifier\",!0),h]:void 0}function R(){x.apply(this,arguments);var a=j(this.handler,this);this.touch=new P(this.manager,a),this.mouse=new L(this.manager,a),this.primaryTouch=null,this.lastTouches=[]}function S(a,b){a&Ea?(this.primaryTouch=b.changedPointers[0].identifier,T.call(this,b)):a&(Ga|Ha)&&T.call(this,b)}function T(a){var b=a.changedPointers[0];if(b.identifier===this.primaryTouch){var c={x:b.clientX,y:b.clientY};this.lastTouches.push(c);var d=this.lastTouches,e=function(){var a=d.indexOf(c);a>-1&&d.splice(a,1)};setTimeout(e,cb)}}function U(a){for(var b=a.srcEvent.clientX,c=a.srcEvent.clientY,d=0;d<this.lastTouches.length;d++){var e=this.lastTouches[d],f=Math.abs(b-e.x),g=Math.abs(c-e.y);if(db>=f&&db>=g)return!0}return!1}function V(a,b){this.manager=a,this.set(b)}function W(a){if(p(a,jb))return jb;var b=p(a,kb),c=p(a,lb);return b&&c?jb:b||c?b?kb:lb:p(a,ib)?ib:hb}function X(){if(!fb)return!1;var b={},c=a.CSS&&a.CSS.supports;return[\"auto\",\"manipulation\",\"pan-y\",\"pan-x\",\"pan-x pan-y\",\"none\"].forEach(function(d){b[d]=c?a.CSS.supports(\"touch-action\",d):!0}),b}function Y(a){this.options=la({},this.defaults,a||{}),this.id=v(),this.manager=null,this.options.enable=l(this.options.enable,!0),this.state=nb,this.simultaneous={},this.requireFail=[]}function Z(a){return a&sb?\"cancel\":a&qb?\"end\":a&pb?\"move\":a&ob?\"start\":\"\"}function $(a){return a==Ma?\"down\":a==La?\"up\":a==Ja?\"left\":a==Ka?\"right\":\"\"}function _(a,b){var c=b.manager;return c?c.get(a):a}function aa(){Y.apply(this,arguments)}function ba(){aa.apply(this,arguments),this.pX=null,this.pY=null}function ca(){aa.apply(this,arguments)}function da(){Y.apply(this,arguments),this._timer=null,this._input=null}function ea(){aa.apply(this,arguments)}function fa(){aa.apply(this,arguments)}function ga(){Y.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ha(a,b){return b=b||{},b.recognizers=l(b.recognizers,ha.defaults.preset),new ia(a,b)}function ia(a,b){this.options=la({},ha.defaults,b||{}),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=a,this.input=y(this),this.touchAction=new V(this,this.options.touchAction),ja(this,!0),g(this.options.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function ja(a,b){var c=a.element;if(c.style){var d;g(a.options.cssProps,function(e,f){d=u(c.style,f),b?(a.oldCssProps[d]=c.style[d],c.style[d]=e):c.style[d]=a.oldCssProps[d]||\"\"}),b||(a.oldCssProps={})}}function ka(a,c){var d=b.createEvent(\"Event\");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}var la,ma=[\"\",\"webkit\",\"Moz\",\"MS\",\"ms\",\"o\"],na=b.createElement(\"div\"),oa=\"function\",pa=Math.round,qa=Math.abs,ra=Date.now;la=\"function\"!=typeof Object.assign?function(a){if(a===d||null===a)throw new TypeError(\"Cannot convert undefined or null to object\");for(var b=Object(a),c=1;c<arguments.length;c++){var e=arguments[c];if(e!==d&&null!==e)for(var f in e)e.hasOwnProperty(f)&&(b[f]=e[f])}return b}:Object.assign;var sa=h(function(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a},\"extend\",\"Use `assign`.\"),ta=h(function(a,b){return sa(a,b,!0)},\"merge\",\"Use `assign`.\"),ua=1,va=/mobile|tablet|ip(ad|hone|od)|android/i,wa=\"ontouchstart\"in a,xa=u(a,\"PointerEvent\")!==d,ya=wa&&va.test(navigator.userAgent),za=\"touch\",Aa=\"pen\",Ba=\"mouse\",Ca=\"kinect\",Da=25,Ea=1,Fa=2,Ga=4,Ha=8,Ia=1,Ja=2,Ka=4,La=8,Ma=16,Na=Ja|Ka,Oa=La|Ma,Pa=Na|Oa,Qa=[\"x\",\"y\"],Ra=[\"clientX\",\"clientY\"];x.prototype={handler:function(){},init:function(){this.evEl&&m(this.element,this.evEl,this.domHandler),this.evTarget&&m(this.target,this.evTarget,this.domHandler),this.evWin&&m(w(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(w(this.element),this.evWin,this.domHandler)}};var Sa={mousedown:Ea,mousemove:Fa,mouseup:Ga},Ta=\"mousedown\",Ua=\"mousemove mouseup\";i(L,x,{handler:function(a){var b=Sa[a.type];b&Ea&&0===a.button&&(this.pressed=!0),b&Fa&&1!==a.which&&(b=Ga),this.pressed&&(b&Ga&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:Ba,srcEvent:a}))}});var Va={pointerdown:Ea,pointermove:Fa,pointerup:Ga,pointercancel:Ha,pointerout:Ha},Wa={2:za,3:Aa,4:Ba,5:Ca},Xa=\"pointerdown\",Ya=\"pointermove pointerup pointercancel\";a.MSPointerEvent&&!a.PointerEvent&&(Xa=\"MSPointerDown\",Ya=\"MSPointerMove MSPointerUp MSPointerCancel\"),i(M,x,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace(\"ms\",\"\"),e=Va[d],f=Wa[a.pointerType]||a.pointerType,g=f==za,h=r(b,a.pointerId,\"pointerId\");e&Ea&&(0===a.button||g)?0>h&&(b.push(a),h=b.length-1):e&(Ga|Ha)&&(c=!0),0>h||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var Za={touchstart:Ea,touchmove:Fa,touchend:Ga,touchcancel:Ha},$a=\"touchstart\",_a=\"touchstart touchmove touchend touchcancel\";i(N,x,{handler:function(a){var b=Za[a.type];if(b===Ea&&(this.started=!0),this.started){var c=O.call(this,a,b);b&(Ga|Ha)&&c[0].length-c[1].length===0&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:za,srcEvent:a})}}});var ab={touchstart:Ea,touchmove:Fa,touchend:Ga,touchcancel:Ha},bb=\"touchstart touchmove touchend touchcancel\";i(P,x,{handler:function(a){var b=ab[a.type],c=Q.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:za,srcEvent:a})}});var cb=2500,db=25;i(R,x,{handler:function(a,b,c){var d=c.pointerType==za,e=c.pointerType==Ba;if(!(e&&c.sourceCapabilities&&c.sourceCapabilities.firesTouchEvents)){if(d)S.call(this,b,c);else if(e&&U.call(this,c))return;this.callback(a,b,c)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var eb=u(na.style,\"touchAction\"),fb=eb!==d,gb=\"compute\",hb=\"auto\",ib=\"manipulation\",jb=\"none\",kb=\"pan-x\",lb=\"pan-y\",mb=X();V.prototype={set:function(a){a==gb&&(a=this.compute()),fb&&this.manager.element.style&&mb[a]&&(this.manager.element.style[eb]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){k(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),W(a.join(\" \"))},preventDefaults:function(a){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var d=this.actions,e=p(d,jb)&&!mb[jb],f=p(d,lb)&&!mb[lb],g=p(d,kb)&&!mb[kb];if(e){var h=1===a.pointers.length,i=a.distance<2,j=a.deltaTime<250;if(h&&i&&j)return}return g&&f?void 0:e||f&&c&Na||g&&c&Oa?this.preventSrc(b):void 0},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var nb=1,ob=2,pb=4,qb=8,rb=qb,sb=16,tb=32;Y.prototype={defaults:{},set:function(a){return la(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,\"recognizeWith\",this))return this;var b=this.simultaneous;return a=_(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,\"dropRecognizeWith\",this)?this:(a=_(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,\"requireFailure\",this))return this;var b=this.requireFail;return a=_(a,this),-1===r(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,\"dropRequireFailure\",this))return this;a=_(a,this);var b=r(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(b,a)}var c=this,d=this.state;qb>d&&b(c.options.event+Z(d)),b(c.options.event),a.additionalEvent&&b(a.additionalEvent),d>=qb&&b(c.options.event+Z(d))},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=tb)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(tb|nb)))return!1;a++}return!0},recognize:function(a){var b=la({},a);return k(this.options.enable,[this,b])?(this.state&(rb|sb|tb)&&(this.state=nb),this.state=this.process(b),void(this.state&(ob|pb|qb|sb)&&this.tryEmit(b))):(this.reset(),void(this.state=tb))},process:function(a){},getTouchAction:function(){},reset:function(){}},i(aa,Y,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(ob|pb),e=this.attrTest(a);return d&&(c&Ha||!e)?b|sb:d||e?c&Ga?b|qb:b&ob?b|pb:ob:tb}}),i(ba,aa,{defaults:{event:\"pan\",threshold:10,pointers:1,direction:Pa},getTouchAction:function(){var a=this.options.direction,b=[];return a&Na&&b.push(lb),a&Oa&&b.push(kb),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Na?(e=0===f?Ia:0>f?Ja:Ka,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?Ia:0>g?La:Ma,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return aa.prototype.attrTest.call(this,a)&&(this.state&ob||!(this.state&ob)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=$(a.direction);b&&(a.additionalEvent=this.options.event+b),this._super.emit.call(this,a)}}),i(ca,aa,{defaults:{event:\"pinch\",threshold:0,pointers:2},getTouchAction:function(){return[jb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&ob)},emit:function(a){if(1!==a.scale){var b=a.scale<1?\"in\":\"out\";a.additionalEvent=this.options.event+b}this._super.emit.call(this,a)}}),i(da,Y,{defaults:{event:\"press\",pointers:1,time:251,threshold:9},getTouchAction:function(){return[hb]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Ga|Ha)&&!f)this.reset();else if(a.eventType&Ea)this.reset(),this._timer=e(function(){this.state=rb,this.tryEmit()},b.time,this);else if(a.eventType&Ga)return rb;return tb},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===rb&&(a&&a.eventType&Ga?this.manager.emit(this.options.event+\"up\",a):(this._input.timeStamp=ra(),this.manager.emit(this.options.event,this._input)))}}),i(ea,aa,{defaults:{event:\"rotate\",threshold:0,pointers:2},getTouchAction:function(){return[jb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&ob)}}),i(fa,aa,{defaults:{event:\"swipe\",threshold:10,velocity:.3,direction:Na|Oa,pointers:1},getTouchAction:function(){return ba.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Na|Oa)?b=a.overallVelocity:c&Na?b=a.overallVelocityX:c&Oa&&(b=a.overallVelocityY),this._super.attrTest.call(this,a)&&c&a.offsetDirection&&a.distance>this.options.threshold&&a.maxPointers==this.options.pointers&&qa(b)>this.options.velocity&&a.eventType&Ga},emit:function(a){var b=$(a.offsetDirection);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),i(ga,Y,{defaults:{event:\"tap\",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ib]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&Ea&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Ga)return this.failTimeout();var g=this.pTime?a.timeStamp-this.pTime<b.interval:!0,h=!this.pCenter||H(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;var i=this.count%b.taps;if(0===i)return this.hasRequireFailures()?(this._timer=e(function(){this.state=rb,this.tryEmit()},b.interval,this),ob):rb}return tb},failTimeout:function(){return this._timer=e(function(){this.state=tb},this.options.interval,this),tb},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==rb&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ha.VERSION=\"2.0.8\",ha.defaults={domEvents:!1,touchAction:gb,enable:!0,inputTarget:null,inputClass:null,preset:[[ea,{enable:!1}],[ca,{enable:!1},[\"rotate\"]],[fa,{direction:Na}],[ba,{direction:Na},[\"swipe\"]],[ga],[ga,{event:\"doubletap\",taps:2},[\"tap\"]],[da]],cssProps:{userSelect:\"none\",touchSelect:\"none\",touchCallout:\"none\",contentZooming:\"none\",userDrag:\"none\",tapHighlightColor:\"rgba(0,0,0,0)\"}};var ub=1,vb=2;ia.prototype={set:function(a){return la(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?vb:ub},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&rb)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],b.stopped===vb||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(ob|pb|qb)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof Y)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,\"add\",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,\"remove\",this))return this;if(a=this.get(a)){var b=this.recognizers,c=r(b,a);-1!==c&&(b.splice(c,1),this.touchAction.update())}return this},on:function(a,b){if(a!==d&&b!==d){var c=this.handlers;return g(q(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this}},off:function(a,b){if(a!==d){var c=this.handlers;return g(q(a),function(a){b?c[a]&&c[a].splice(r(c[a],b),1):delete c[a]}),this}},emit:function(a,b){this.options.domEvents&&ka(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&ja(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},la(ha,{INPUT_START:Ea,INPUT_MOVE:Fa,INPUT_END:Ga,INPUT_CANCEL:Ha,STATE_POSSIBLE:nb,STATE_BEGAN:ob,STATE_CHANGED:pb,STATE_ENDED:qb,STATE_RECOGNIZED:rb,STATE_CANCELLED:sb,STATE_FAILED:tb,DIRECTION_NONE:Ia,DIRECTION_LEFT:Ja,DIRECTION_RIGHT:Ka,DIRECTION_UP:La,DIRECTION_DOWN:Ma,DIRECTION_HORIZONTAL:Na,DIRECTION_VERTICAL:Oa,DIRECTION_ALL:Pa,Manager:ia,Input:x,TouchAction:V,TouchInput:P,MouseInput:L,PointerEventInput:M,TouchMouseInput:R,SingleTouchInput:N,Recognizer:Y,AttrRecognizer:aa,Tap:ga,Pan:ba,Swipe:fa,Pinch:ca,Rotate:ea,Press:da,on:m,off:n,each:g,merge:ta,extend:sa,assign:la,inherit:i,bindFn:j,prefixed:u});var wb=\"undefined\"!=typeof a?a:\"undefined\"!=typeof self?self:{};wb.Hammer=ha,\"function\"==typeof define&&define.amd?define(function(){return ha}):\"undefined\"!=typeof module&&module.exports?module.exports=ha:a[c]=ha}(window,document,\"Hammer\");\n\n    const $this = $(container);\n    $this.find(\".description .gallery li:first-child\").addClass(\"active\");\n    $this.find(\".description .gallery .paging a:first-child\").addClass(\"current\");\n    $this.find(\".description .gallery img\").on('load', () => {\n        let totalW = 104;\n        for (let i = 0; i < $this.find(\".description .gallery li\").length; i++) {\n            totalW = totalW + $this.find(\".description .gallery li:eq(\" + i + \") img\").width() + 20;\n            $this.find(\".description .gallery .photo-list\").width(totalW);\n        }\n    });\n    $this.find(\".description .gallery\").each((i, e) => {\n        const { Hammer } = window;\n        (new Hammer(e)).on('swipe', function({ type, direction }) {\n            console.log(arguments[0])\n            if (type === 'swipe') {\n                if (direction === Hammer.DIRECTION_LEFT) {\n                    $(e).find('.paging .prev')[0].click();\n                } else if (direction === Hammer.DIRECTION_RIGHT) {\n                    $(e).find('.paging .next')[0].click();\n                }\n            }\n        })\n    });\n}\n","\nexport const FancyStatus = {\n    Addition: 'Addition',\n    Removal: 'Removal',\n    AfterAddition: 'AfterAddition',\n    AfterRemoval: 'AfterRemoval',\n    Idle: 'Idle',\n};\n\nconst commonWrapperSelector = '#sidebar .wrapper.article';\nexport const Selectors = {\n    HomepageWrapper: commonWrapperSelector,\n};\n","import { KEYS, didClickOn, getObjectTypeFromUrl, getPathname, isPlainLeftClick, isHomepage } from \"fancyutils\";\n\nimport store from \"../store/store\";\nimport { Selectors } from \"../config\";\nimport { LinkTypes, transition } from \"./routeutils\";\nimport { closeOverlay } from \"../action/action-helpers\";\nimport { historyData } from './history';\n\n\nfunction handleOverlayArticleKeyEvents(event) {\n    if (event.target.tagName === \"TEXTAREA\" || event.target.tagName === \"INPUT\") {\n        return;\n    }\n\n    switch (event.which) {\n        case KEYS.ESC:\n            // If popup is not on\n            if ($(\"#popup_container:visible\").length === 0) {\n                store.dispatch(closeOverlay());\n            }\n            break;\n    }\n}\n\nfunction conditionalTransition(aElement) {\n    // Turn off video\n    $(\"#container-wrapper .btn-pause\")\n        .attr(\"scroll\", true)\n        .click();\n    // Ensure anchor is static (sticked to homepage timeline) or not.\n    if (isHomepage() && $(Selectors.HomepageWrapper).has(aElement)) {\n        transition(aElement.getAttribute(\"href\"), LinkTypes.Static);\n    } else {\n        transition(aElement.getAttribute(\"href\"));\n    }\n}\n\nvar oneshotEventAttached = false;\nexport function attachEntryEvents() {\n    if (oneshotEventAttached) {\n        return;\n    }\n    oneshotEventAttached = true;\n    // Remove pre-existing url event and start transition first\n    $(document.body).off(\"click.overlayArticleInit\");\n    if (window.__INIT_ARTICLE_ANCHOR != null) {\n        conditionalTransition(window.__INIT_ARTICLE_ANCHOR);\n        delete window.__INIT_ARTICLE_ANCHOR;\n    }\n    // TODO: replace to class-based event binding\n    $(document.body).on(\"click\", \"a\", function(event) {\n        if (\n            isPlainLeftClick(event) &&\n            this.getAttribute(\"data-prevent-overlay\") == null &&\n            getObjectTypeFromUrl(getPathname(this)) === \"Article\"\n        ) {\n            event.preventDefault();\n            // note: key event will be detached inside `closeOverlay()` call\n            $(document).on(\"keydown.overlayArticle\", handleOverlayArticleKeyEvents);\n            conditionalTransition(this);\n        }\n    });\n\n    $(\"#overlay-article\").on(\"click\", function(event) {\n        const $targ = $(event.target);\n        if (didClickOn($targ, \"#article-container\") || historyData.initialPageIsArticlePage) {\n            //pass\n        } else {\n            store.dispatch(closeOverlay());\n        }\n    });\n}\n\nexport const OaContainer = {\n    isStatic() {\n        return $(document.body).is(\".static-article\");\n    },\n    getDynamic() {\n        return $(\"#article-container\");\n    },\n    getStatic() {\n        return $(document);\n    },\n    get() {\n        return this.isStatic() ? this.getStatic() : this.getDynamic();\n    },\n    scrollToTop() {\n        if (this.isStatic()) {\n            $(document.body.parentElement).scrollTop(0);\n        } else {\n            this.getDynamic().scrollTop(0);\n        }\n    }\n};\n","import { extractMetaFromArticleURL, extractMetaFromURL } from 'fancyutils';\nimport { history } from 'common-components';\nimport store from '../store/store';\nimport { closeOverlay, fetchArticle } from '../action/action-helpers';\nimport {\n    closeArticle,\n} from '../action/actions';\n\n\nconst initialArticlePageID = extractMetaFromArticleURL(location.pathname).id;\nconst initialPageIsArticlePage = initialArticlePageID != null;\n\n// This stores initial static page history info that needs to be restored when modal get closed.\nexport const historyData = {\n    initialPath: location.pathname,\n    /* mut */preservedHref: location.href, // Preserved Href just before open, and to be returned when closed.\n    initialArticlePageID,\n    initialPageIsArticlePage,\n    initialTitle: document.title,\n    // This prop indicates current location is (static) article page. Mutable.\n    locationIsArticlePage: initialPageIsArticlePage,\n    overlayIsOn: false,\n};\n\nexport function runOverlay(articleID, articleURLType, killCache = false, queryString) {\n    if (!$(document.body).hasClass('error-page')) {\n        // Context needs to be isolated from hook: https://github.com/rackt/redux-router/issues/157\n        requestIdleCallback(() => {\n            $(document.body).addClass('article-overlay-on');\n            store.dispatch(fetchArticle(articleID, articleURLType, killCache, queryString));\n            historyData.overlayIsOn = true;\n        });\n    }\n}\n\nexport function stopOverlay() {\n    historyData.overlayIsOn = false;\n    store.dispatch(closeOverlay());\n}\n\nexport function historyHook({ pathname, search /*, action*/ }) {\n    const meta = extractMetaFromArticleURL(pathname);\n    const articleID = meta && meta.id;\n    // When initially (statically) renderred page is article page\n    // Moving to new article page\n    historyData.locationIsArticlePage = articleID != null;\n    if (historyData.locationIsArticlePage) {\n        runOverlay(articleID, meta.type, false, search);\n    } else if (historyData.overlayIsOn) {\n        stopOverlay();\n    }\n}\n\nhistory.listen(historyHook)\n","import { extractMetaFromArticleURL, getObjectTypeFromUrl, isStaticPage, stripPathname } from 'fancyutils';\nimport { history } from 'common-components';\n\nimport { historyData } from './history';\n\n\nexport const LinkTypes = {\n    Dynamic: 0,\n    Static: 1,\n    Timeline: 2,\n    Internal: 3, // no update needed\n};\n\n// `staticLink`: transition from statically attached links\nexport function transition(href) {\n    // ID-only\n    if (!_.isNaN(Number(href))) {\n        href = `/articles/${href}`;\n    }\n\n    if (getObjectTypeFromUrl(href) === 'Article') {\n        const meta = extractMetaFromArticleURL(href);\n        // Update URL to go back when overlay is closed\n        if (!historyData.overlayIsOn) {\n            historyData.preservedHref = location.href;\n        }\n        history.push(stripPathname(meta.href), null);\n\n    } else {\n        redirect(href);\n    }\n}\n\nexport function closeModal() {\n    if (isStaticPage()) {\n        return;\n    }\n    $(document.body).removeClass('article-overlay-on');\n}\n\nexport function redirect(destination) {\n    if (destination == null) {\n        return false;\n    } else {\n        location.href = destination;\n        return true;\n    }\n}\n","import React, { Component } from 'react';\n\nimport { closeOverlay } from '../action/action-helpers';\nimport store from '../store/store';\nimport { historyHook } from './history';\n\n\nclass App extends Component {\n    handleCloseArticle(event) {\n        event.preventDefault();\n        event.stopPropagation();\n        store.dispatch(closeOverlay());\n    }\n\n    render() {\n        return (\n            <div className={`popup article ${window.isWhitelabel ? 'whitelabel-article' : ''} ${window.isWhitelabelV2 ? 'whitelabel-article-v2' : ''}`} id=\"article-container\">\n                {this.props.children}\n                <a href=\"#\" className=\"ly-close\" onClick={this.handleCloseArticle}>Close</a>\n            </div>\n        );\n    }\n}\n\nexport default App;\n","// This module deals with outside of React context (mostly raw DOM) with observing DOM structure and \n// do sub'd actions when React-context actions fires.\nimport { dedupeArray } from 'fancyutils';\n\n/*\nif (process.env.NODE_ENV !== 'production') {\n    window.__assert = true;\n}\n\nfunction assert(a,b) {\n    if (window.__assert) console.assert(a,b)\n}\n*/\n\nfunction findFancyButton(id)/*:jQuery?*/ {\n    if (typeof id === 'string') {\n        const domCache = thingsDomCache[id];\n        if (typeof domCache === 'object') {\n            return $(domCache);\n        } else if (domCache === false) {\n            // NOOP\n        } else {\n            const $query = $(`#container-wrapper a[href^=\"/things/${id}\"]:visible`);\n            if ($query.length > 0) {\n                const containers = dedupeArray(\n                    $query.map((i, e) => {\n                        return $(e).closest('div.figure-item').get(0)\n                    }).toArray()\n                );\n                if (containers && containers.length > 0) {\n                    const $btn = $(containers[0]).find('button.fancy, button.fancyd, a.fancyd, a.fancy');\n                    if ($btn.length > 0) {\n                        thingsDomCache[id] = $btn[0];\n                        return $btn;\n                    }\n                }\n            }\n            // If not returned\n            thingsDomCache[id] = false;\n        }\n    }\n}\n\nfunction findArticleFancyButton(id)/*:jQuery?*/ {\n    if (typeof id === 'string') {\n        const domCache = thingsDomCache[id];\n        if (typeof domCache === 'object') {\n            return $(domCache);\n        } else if (domCache === false) {\n            // NOOP\n        } else {\n            const $query = $(`#container-wrapper a[href^=\"/articles/${id}\"]:visible`);\n            if ($query.length > 0) {\n                const containers = dedupeArray(\n                    $query.map((i, e) => {\n                        return $(e).closest('div.article_item').get(0)\n                    }).toArray()\n                );\n                if (containers && containers.length > 0) {\n                    const $btn = $(containers[0]).find('button.fancy, button.fancyd, a.fancyd, a.fancy');\n                    if ($btn.length > 0) {\n                        thingsDomCache[id] = $btn[0];\n                        return $btn;\n                    }\n                }\n            }\n            // If not returned\n            thingsDomCache[id] = false;\n        }\n    }\n}\n\n// via thing id \nconst thingsDomCache = {};\n\nfunction toggleFancyButton($btn, fancyd) {\n    $btn.removeClass('fancy').removeClass('fancyd');\n    $btn.addClass(fancyd ? 'fancyd' : 'fancy');\n}\n\nfunction replaceFancyCount($btn, fancyd, fc) {\n    // Fancy | Fancy'd\n    if ($btn.text().toLowerCase().indexOf('fancy') >= 0) {\n        $btn.html(`<span><i></i></span> ${fancyd ? 'Fancy\\'d' : 'Fancy'}`);\n    // Fancy count\n    } else {\n        $btn.html(`<span><i></i></span> ${fc}`);\n    }\n}\n\nexport function onFancyButtonUpdate(id/*:string*/, fancyd/*:boolean*/, fc/*:string*/) {\n    const $btn = findFancyButton(id);\n    if ($btn && $btn.length > 0) {\n        toggleFancyButton($btn, fancyd);\n        replaceFancyCount($btn, fancyd, fc);\n    }\n}\n\nexport function onArticleFancyButtonUpdate(id/*:string*/, fancyd/*:boolean*/, fc/*:string*/) {\n    const $btn = findArticleFancyButton(id);\n    if ($btn && $btn.length > 0) {\n        toggleFancyButton($btn, fancyd);\n        replaceFancyCount($btn, fancyd, fc);\n    }\n}\n","import React, { Component } from 'react';\nimport classnames from 'classnames';\nimport { MP, getConciseNumberString } from 'fancyutils';\nimport { Display } from 'fancymixin';\n\nimport { FancyStatus } from '../config';\nimport { cache } from '../cache';\nimport { onArticleFancyButtonUpdate } from '../SyncedContext';\n\nexport function handleProfileMouseOver(event) {\n    const $profile = $(event.currentTarget).find('em');\n    $profile.css('margin-left', `${-($profile.width() / 2) - 10}px`);\n}\n\nconst FancydUser = ({ user = {}, display, isViewer }) => (\n    <a href={user.html_url}\n       className={classnames(\"user\", { _viewer: isViewer })}\n       onMouseOver={handleProfileMouseOver}\n       style={display}>\n        <img src=\"/_ui/images/common/blank.gif\"\n             style={{ backgroundImage: `url(${user.image_url || user.profile_image_url})`}} />\n        <em>{user.fullname || user.full_name}</em>\n    </a>\n);\n\nconst bgXPosSequence = [0, -54, -108, -163, -218, -272, -327, -436, -490, -545, -599, -654, -708, -763, -817, -872, -926, -981, -1035, -1144, -1199, -1253, -1308, -1417, -1471];\n\nfunction isUserEqual(a, b) {\n    if (a == null || b == null) {\n        return false;\n    }\n    return a.id === b.id;\n}\n\nfunction _handleFancydStateOnLoadArticle(slug, { fancyd, save_count }, stateSetter = _ => _) {\n    onArticleFancyButtonUpdate(slug, fancyd, getConciseNumberString(save_count));\n    stateSetter({\n        fancyd,\n        save_count,\n        loading: false,\n        fancyStatus: FancyStatus.Idle,\n    })\n}\n\nfunction getFancyStatus(nextFancydState) {\n    return nextFancydState ? FancyStatus.Addition : FancyStatus.Removal;\n}\nfunction getCompletionIdleStatus(currentFancyState) {\n    const prevFancyState = !currentFancyState;\n    return prevFancyState ? FancyStatus.AfterRemoval : FancyStatus.AfterAddition;\n}\nfunction getNextFancydCount(nextFancyd, currentFancydCount) {\n    if (nextFancyd === true) {\n        return currentFancydCount + 1;\n    } else {\n        return currentFancydCount - 1;\n    }\n}\nfunction toggleFancy(article, currentState, stateSetter = _ => _) {\n    const { fancyd, save_count, loading } = currentState;\n    const nextFancyd = !fancyd;\n    const nextFancydCount = getNextFancydCount(nextFancyd, save_count);\n    \n    if (!loading) {\n        stateSetter({\n            fancyd: nextFancyd, loading: true, fancyStatus: getFancyStatus(nextFancyd)\n        });\n\n        $.ajax({\n            type: 'POST',\n            url: '/articles/save.json',\n            data: {\n                article_id: article.id,\n                action: nextFancyd ? 'save':'unsave',\n            }\n        })\n        .done(function(json){\n            if (json.article_id && json.saved === !fancyd) {\n                // Completing fancy\n                \n                cache.update(article.slug, undefined, 'saved', nextFancyd);\n                cache.update(article.slug, undefined, 'save_count', nextFancydCount);\n                onArticleFancyButtonUpdate(article.slug, nextFancyd, getConciseNumberString(nextFancydCount));\n                \n                stateSetter({\n                    loading: false, fancyd: nextFancyd, save_count: nextFancydCount, fancyStatus: getCompletionIdleStatus(nextFancyd)\n                });\n            } else {\n                // cancelling fancy\n                stateSetter({ loading: false, fancyd, save_count, fancyStatus: getFancyStatus(fancyd) });\n            }\n        })\n        .fail(function() {\n            // cancelling fancy\n            stateSetter({ loading: false, fancyd, save_count, fancyStatus: getFancyStatus(fancyd) });\n        });\n    }\n}\n\nexport class FancydUsers extends Component {\n    _getInitialState() {\n        return {\n            fancyAnimation: false,\n            // button state\n            fancyd: null,\n            loading: false,\n            save_count: null,\n            fancyStatus: FancyStatus.Idle, // fancyStatus = 'Idle', { Idle | Addition | Removal | After- } - Fancy'd status for animation control\n        };\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = this._getInitialState();\n        this.fancyBGAnimationRef = element => {\n            this.fancyBGAnimation = element;\n        }\n    }\n\n    getFancydCountString = () => {\n        const { save_count } = this.state;\n        return save_count != null ? getConciseNumberString(save_count, 0) : '0';\n    }\n\n    animateFancyBG = (frame) => {\n        if (frame === undefined) {\n            this.animateFancyBG(0);\n        } else if (frame < bgXPosSequence.length) {\n            // Special branching due to misposition in background\n            var xPos = bgXPosSequence[frame];\n            $(this.fancyBGAnimation).css('background-position-x', `${xPos}px`);\n            setTimeout(() => { this.animateFancyBG(frame + 1) }, 10);\n        } else if (frame >= bgXPosSequence.length) {\n            this.setState({ fancyAnimation: false });\n        }\n    }\n\n    getFancyduserDisplay = (user, index, totalLength) => {\n        const {\n            appContext: { viewer },\n        } = this.props;\n        const {\n            fancyd,\n            fancyStatus,\n        } = this.state;\n\n        const first = index === 0;\n        const last = index === totalLength - 1;\n\n        var display;\n        if (fancyStatus === FancyStatus.AfterAddition || fancyStatus === FancyStatus.Addition) {\n            // designer satisfaction 1)\n            if (totalLength <= 8) {\n                display = Display.Inline;\n            } else {\n                if (first) {\n                    display = Display.Inline;\n                } \n            }\n        } else if (fancyStatus === FancyStatus.AfterRemoval || fancyStatus === FancyStatus.Removal) {\n            if (first) {\n                display = Display.None;\n            } else if (last) {\n                display = Display.Inline;\n            }\n        }\n        // designer satisfaction 2) https://app.asana.com/0/86925821949642/161445424426526\n        const indexLimit = 8;\n        if (\n            (fancyStatus === FancyStatus.AfterAddition ||\n             fancyStatus === FancyStatus.Addition ||\n             (fancyd && fancyStatus === FancyStatus.Idle)\n            ) &&\n            index > indexLimit\n        ) {\n            display = Display.None;\n        }else if (\n            fancyStatus === FancyStatus.Removal \n            &&\n            index >= indexLimit\n        ) {\n            display = Display.None;\n        }\n\n        if (fancyStatus === FancyStatus.Idle &&\n            !fancyd &&\n            isUserEqual(user, viewer)\n        ) {\n            display = Display.None;\n        }\n\n        return display;\n    }\n\n    toggleFancy = () => {\n        toggleFancy(this.props.article, this.state, ns => { this.setState(ns) });\n    }\n\n    handleFancydStateOnLoadArticle = (article) => {\n        if (article == null) {\n            article = this.props.article;\n        }\n        _handleFancydStateOnLoadArticle(article.slug, { fancyd: article.saved, save_count: article.save_count  }, ns => { this.setState(ns); });\n    }\n\n    handleFancyClick = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        const { article } = this.props;\n        if (!this.props.appContext.loggedIn) {\n            window.require_login && window.require_login(null, 'fancy_article', article.id);\n            return;\n        }\n        const { fancyAnimation, fancyd, loading } = this.state;\n        if (loading) {\n            return;\n        }\n        if (!fancyd && !fancyAnimation) {\n            this.setState({ fancyAnimation: true }, _ => { this.animateFancyBG(); });\n        }\n\n        if (!fancyd) {\n            MP('Fancy', { article_id: article.id });\n        } else {\n            MP('Unfancy', { article_id: article.id });\n        }\n\n        this.toggleFancy();\n    }\n\n    componentDidMount() {\n        this.handleFancydStateOnLoadArticle();\n    }\n\n    componentDidUpdate(prevProps) {\n        const { article } = prevProps;\n        const np = this.props\n        // Thing has been updated.\n        if (article.id !== np.article.id || article.isCrawled !== np.article.isCrawled) {\n            this.handleFancydStateOnLoadArticle(article);\n        }\n    }\n\n    render() {\n        const {\n            appContext: { loggedIn, viewer },\n            article: { saved_users, user },\n        } = this.props;\n        const {\n            fancyd,\n            fancyAnimation,\n            fancyStatus,\n        } = this.state;\n\n        const fancydUsers = [\n            loggedIn && viewer,\n            loggedIn && !isUserEqual(viewer, user) && user\n        ]\n        .concat(\n            saved_users &&\n            saved_users.filter(fancydUser => !isUserEqual(fancydUser, user) &&\n                                              !isUserEqual(fancydUser, viewer))\n        )\n        .filter(e => e);\n\n        var fancydUserAnimClass;\n        if (fancyStatus === FancyStatus.Addition) {\n            fancydUserAnimClass = \"add\";\n        } else if (fancyStatus === FancyStatus.Removal) {\n            fancydUserAnimClass = \"remove\";\n        }\n\n        // designer satisfaction 1)\n        // If user is less than 2 we need to apply special class.\n        // In this way dont owner profile dont get 'consumed': https://app.asana.com/0/86925821949642/173945332708784\n        const userCountSufficiency = fancydUsers.length <= 2 ? '_insuff' : '_suff';\n\n        return (\n            <div className=\"like\">\n                <span className=\"count\">\n                    <a onClick={this.handleFancyClick}\n                       className={classnames(\"button button-static fancy _count\", { fancyd, loading: fancyAnimation })}>\n                        <span ref={this.fancyBGAnimationRef}>\n                            <i />\n                        </span>{this.getFancydCountString()}\n                    </a>\n                    <span className=\"_fancyd\" />\n                </span>\n                <span className={classnames(\"fancyd_user\", fancydUserAnimClass, userCountSufficiency)}>\n                    {fancydUsers.map((user, index) => {\n                        const isViewer = isUserEqual(user, viewer);\n                        return (\n                            <FancydUser key={index}\n                                        user={user}\n                                        display={this.getFancyduserDisplay(user, index, fancydUsers.length)}\n                                        isViewer={isViewer} />\n                        );\n                    })}\n                </span>\n            </div>\n        );\n    }\n}\n","import React, { Component, lazy, Suspense } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { connect } from \"react-redux\";\nimport { MoreShare, Video } from \"common-components\";\nimport { isStaticArticlePage } from \"fancyutils\";\nimport dateFormat from 'date-fns/format';\n\nimport { historyData } from \"../container/history\";\nimport { FancydUsers } from \"./ArticleFancydUsers\";\nimport { OaContainer } from \"../container/entry-events\";\nimport { AdminHeader, ArticleList, ThingList, initGallery } from \"./ArticleWidgets\";\nimport \"../Shortcode\";\nimport { applyProductSlide } from 'common-components';\n\n\nfunction mapStateToProps(state) {\n    var { appContext, article: { data, isFetching, status } } = state;\n\n    if (data && data.content && window.convertArticleShortcode) {\n        data.content = window.convertArticleShortcode(data.content);\n    }\n\n    return {\n        appContext,\n        status,\n        article: data,\n        isFetching\n    };\n}\nconst Lightbox = lazy(() => import(/* webpackChunkName: \"OverlayArticle\" */'react-images'));\n\n// Container class for overlayed article detail.\nexport class OverlayArticle extends Component {\n    componentDidMount() {\n        OaContainer.scrollToTop();\n        applyProductSlide();\n\n        // fitvids 1.2.0\n        !function(t){t.fn.fitVids=function(e){var i={customSelector:null,ignore:null};if(!document.getElementById(\"fit-vids-style\")){var r=document.head||document.getElementsByTagName(\"head\")[0],a=\".fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}\",d=document.createElement(\"div\");d.innerHTML='<p>x</p><style id=\"fit-vids-style\">'+a+\"</style>\",r.appendChild(d.childNodes[1])}return e&&t.extend(i,e),this.each(function(){var e=['iframe[src*=\"player.vimeo.com\"]','iframe[src*=\"youtube.com\"]','iframe[src*=\"youtube-nocookie.com\"]','iframe[src*=\"kickstarter.com\"][src*=\"video.html\"]',\"object\",\"embed\"];i.customSelector&&e.push(i.customSelector);var r=\".fitvidsignore\";i.ignore&&(r=r+\", \"+i.ignore);var a=t(this).find(e.join(\",\"));a=a.not(\"object object\"),a=a.not(r),a.each(function(){var e=t(this);if(!(e.parents(r).length>0||\"embed\"===this.tagName.toLowerCase()&&e.parent(\"object\").length||e.parent(\".fluid-width-video-wrapper\").length)){e.css(\"height\")||e.css(\"width\")||!isNaN(e.attr(\"height\"))&&!isNaN(e.attr(\"width\"))||(e.attr(\"height\",9),e.attr(\"width\",16));var i=\"object\"===this.tagName.toLowerCase()||e.attr(\"height\")&&!isNaN(parseInt(e.attr(\"height\"),10))?parseInt(e.attr(\"height\"),10):e.height(),a=isNaN(parseInt(e.attr(\"width\"),10))?e.width():parseInt(e.attr(\"width\"),10),d=i/a;if(!e.attr(\"name\")){var o=\"fitvid\"+t.fn.fitVids._count;e.attr(\"name\",o),t.fn.fitVids._count++}e.wrap('<div class=\"fluid-width-video-wrapper\"></div>').parent(\".fluid-width-video-wrapper\").css(\"padding-top\",100*d+\"%\"),e.removeAttr(\"height\").removeAttr(\"width\")}})})},t.fn.fitVids._count=0}(window.jQuery||window.Zepto);\n\n        $('.media-youtube').fitVids();\n    }\n\n    componentDidUpdate(prevProps) {\n        const pt = prevProps.article;\n        const ct = this.props.article;\n\n        if (ct != null) {\n            if (!pt || pt.id !== ct.id) {\n                if (!isStaticArticlePage()) {\n                    $(\"#overlay-article > .popup\").attr(\"tabindex\", -1).focus();\n                }\n                OaContainer.scrollToTop();\n            }\n\n            if (this.props.appContext.viewer.is_admin_senior) {\n                $(\"body\").addClass(\"admin\");\n            } else {\n                $(\"body\").removeClass(\"admin\");\n            }\n        }\n    }\n\n    render() {\n        const { article, appContext: { viewer } } = this.props;\n\n        var display = null;\n        if (historyData.locationIsArticlePage) {\n            if (article != null) {\n                display = (\n                    <div>\n                        {viewer.is_admin_senior && <AdminHeader {...this.props} />}\n                        <Article {...this.props} />\n                        <div className={\"container\"}>\n                            <ThingList {...this.props} hasPagination={window.isWhitelabel} />\n                            <ArticleList {...this.props} />\n                        </div>\n                    </div>\n                );\n            } else {\n                display = <div />;\n            }\n        } else {\n            display = <div />;\n        }\n\n        return display;\n    }\n}\n\nexport default connect(mapStateToProps)(OverlayArticle);\n\nclass Article extends Component {\n    state = {\n        lightboxImages: [],\n        lightboxOpen: false,\n    }\n    constructor(props) {\n        super(props);\n        if ($(\"#article-fonts\").length === 0) {\n            $(document.head).append(\n                '<link rel=\"stylesheet\" id=\"article-fonts\" href=\"//fonts.googleapis.com/css?family=Merriweather:300,300i,400,400i,700,700i,900,900i|Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Source+Sans+Pro:200,200i,300,300i,400,400i,600,600i,700,700i,900,900i|Merriweather+Sans:300,300i,400,400i,700,700i,800,800i\" type=\"text/css\" />'\n            );\n\n            if ($(\"body\").is(\".static-article\")) {\n                $(\"#container-wrapper #scroll-to-top\").hide();\n            }\n        }\n    }\n\n    componentDidMount() {\n        // Initial loading\n        initGallery(ReactDOM.findDOMNode(this));\n        if (window.isWhitelabelV2) {\n            setTimeout(() => {\n                $('.itemSlide.product').productSlide({ itemPerSlide: 4, center: true });\n            }, 2500);\n        }\n    }\n\n    handleGalleryClick = (event) => {\n        var $this = $(event.target);\n        if (window.isWhitelabelV2) {\n            if ($this.is(\".gallery .paging a\")) {\n                event.preventDefault();\n                const $gallery = $this.closest(\".gallery\");\n                const $paging = $gallery.find(\".paging\");\n                const len = $gallery.find('.paging a.pager').length;\n                const galleryNth = $('.gallery').index($this.closest(\".gallery\"));\n                const indexSelector = `.gallery:eq(${galleryNth}) .paging a.pager`\n\n                let idx;\n                let incdec = 0\n                if ($this.is(\".btn .prev\")) {\n                    idx = $gallery.find('.paging a.pager.current').index(indexSelector);\n                    incdec = -1\n                } else if ($this.is(\".btn .next\")) {\n                    idx = $gallery.find('.paging a.pager.current').index(indexSelector);\n                    incdec = +1\n                } else {\n                    idx = $this.index(indexSelector);\n                }\n                idx += incdec;\n                if (idx < 0) {\n                    idx = len - 1\n                } else if (idx >= len - 1) {\n                    idx = 0\n                }\n                $paging\n                    .find(\"a.current\").removeClass(\"current\").end()\n                    .find(`a.pager:eq(${idx})`).addClass(\"current\");\n                $gallery\n                    .find(\"li.active\").removeClass(\"active\").end()\n                    .find(`li:eq(${idx})`).addClass(\"active\");\n            } \n        } else {\n            if ($this.is(\".gallery .paging a, .gallery li *\")) {\n                if ($this.is(\":not(.gallery li a.linked, .gallery li a.linked *)\")) {\n                    event.preventDefault();\n                }\n                if ($this.is(\".gallery li *\")) {\n                    $this = $this.closest(\"li\");\n                }\n    \n                var $gallery = $this.closest(\".gallery\");\n                var $paging = $gallery.find(\".paging\");\n    \n                var idx = $this.index();\n                $paging.find(\"a.current\").removeClass(\"current\").end().find(\"a:eq(\" + idx + \")\").addClass(\"current\");\n                $gallery.find(\"li.active\").removeClass(\"active\").end().find(\"li:eq(\" + idx + \")\").addClass(\"active\");\n                var left = 0;\n                if (idx == 0) {\n                    left = 0;\n                } else if (idx == $gallery.find(\"li\").length - 1) {\n                    left = $gallery.width() - $gallery.find(\".photo-list\").width();\n                } else {\n                    left =\n                        ($gallery.width() - $gallery.find(\"li:eq(\" + idx + \")\").width()) / 2 -\n                        $gallery.find(\"li:eq(\" + idx + \")\").position().left;\n                }\n                $gallery.find(\".photo-list\").css(\"left\", left + \"px\");\n            }\n        }\n    }\n\n    prepareProductSlide = (event, $this) => {\n        var $slide = $this.closest('.product');\n        if ($slide.data('slideInit')) {\n            event.preventDefault();\n        } else {\n            $slide.productSlide({ itemPerSlide: 4, center: true })\n            setTimeout(() => {\n                $this.click();\n            }, 500);\n        }\n    }\n\n    handleContentClick = (event) => {\n        var $this = $(event.target);\n        if ($this.is(\".gallery *\")) {\n            this.handleGalleryClick(event);\n        } else if ($this.is(\".description .grid\")) {\n            this.prepareLightboxOpen();\n        } else if ($this.is('.itemSlide .prev, .itemSlide .next')) {\n            this.prepareProductSlide(event, $this);\n        }\n    }\n\n    // lightbox stuff\n    prepareLightboxOpen() {\n        this.setState({\n            lightboxOpen: true,\n            lightboxCurrentImage: 0,\n            lightboxImages: $('.grid img').toArray().map((e) => ({ src: $(e).data('src')}) ),\n        });\n    }\n\n    handleClickPrev = () => {\n        this.setState({ lightboxCurrentImage: Math.max(this.state.lightboxCurrentImage - 1, 0) });\n    }\n\n    handleClickNext = () => {\n        this.setState({ lightboxCurrentImage: Math.min(this.state.lightboxCurrentImage + 1, this.state.lightboxImages.length - 1) });\n    }\n\n    handleClose = () => {\n        this.setState({ lightboxOpen: false });\n    }\n\n    handleClickThumbnail = (idx) => {\n        this.setState({ lightboxCurrentImage: idx })\n    }\n\n    render() {\n        const { appContext: { lastFullyRenderedArticleID, viewer, loggedIn }, article } = this.props;\n\n        let video;\n        let coverImgUrl = '';\n        if (article.cover_image) {\n            coverImgUrl = article.cover_image.url;\n        }\n        if (Video.isVideoAvailableForArticle(article)) {\n            const videoProps = {\n                object: article,\n                display: true,\n                autoplay: article.cover_video.autoplay || false,\n                lastFullyRenderedObjectID: lastFullyRenderedArticleID,\n            };\n            if (coverImgUrl) {\n                videoProps.poster = coverImgUrl;\n            }\n            video = <Video {...videoProps} />;\n        }\n\n        const coverImage = (\n            <div className=\"inner-wrapper\">\n                <div id=\"coverImage\" className=\"cover image purple\">\n                    {video}\n                    {!video &&\n                        <div className=\"image\">\n                            <img id=\"coverImg\" src={coverImgUrl} />\n                        </div>}\n                </div>\n            </div>\n        );\n\n        const author = (\n            article.options &&\n            article.options.authors &&\n            <div className=\"author\" dangerouslySetInnerHTML={{ __html: article.options.authors }} />\n        );\n\n        return (\n            <div id=\"summary\" className=\"wrapper article-wrapper\">\n                {!window.isWhitelabelV2 && coverImage}\n                {/*floatingVideo*/}\n                <div className=\"info\">\n                    <h1 className=\"title\"><b>{article.title}</b> <small>{article.tagline}</small></h1>\n                    {window.isWhitelabelV2 && author}\n                    {window.isWhitelabelV2 && article.date_created &&\n                        <div className=\"date text-placeholder\">{\n                            dateFormat(article.date_created || new Date, 'MMMM DD, YYYY')\n                        }</div>\n                    }\n                    {window.isWhitelabel ? null : <FancydUsers {...this.props} />}\n                    <div className=\"interaction\">\n                        <MoreShare objectType=\"article\" objectId={article.id} loggedIn={loggedIn} title={article.title}\n                                       viewerUsername={viewer.username} showShortcuts={true} fromThingSidebar={true} />\n                        {article.options &&\n                            article.options.action_button &&\n                            (_.isString(article.options.action_button.text) &&\n                                article.options.action_button.text.trim()) &&\n                            <a href={`${article.options.action_button.link}`} className=\"btn-shop\">\n                                {article.options.action_button.text}\n                            </a>}\n                        {window.isWhitelabel ? <FancydUsers {...this.props} /> : null}\n                    </div>\n                </div>\n                {window.isWhitelabelV2 && coverImage}\n                <div className=\"description more\">\n                    {!window.isWhitelabelV2 && author}\n                    <div dangerouslySetInnerHTML={{ __html: article.content }} onClick={this.handleContentClick} />\n                </div>\n                {window.isWhitelabelV2 && \n                    <Suspense fallback={<div />}>\n                        <Lightbox \n                            fallback={<div />}\n                            images={this.state.lightboxImages}\n                            isOpen={this.state.lightboxOpen}\n                            preventScroll={true}\n                            showThumbnails={true}\n                            currentImage={this.state.lightboxCurrentImage}\n                            onClickPrev={this.handleClickPrev}\n                            onClickNext={this.handleClickNext}\n                            onClose={this.handleClose}\n                            onClickThumbnail={this.handleClickThumbnail}\n                        />\n                    </Suspense>\n                }\n            </div>\n        );\n    }\n}\n","// This is entrypoint, which `React.render` takes place after DOM is ready.\nimport React from \"react\";\nimport { Route, Router, Switch } from \"react-router-dom\";\nimport { render } from \"react-dom\";\nimport { Provider } from \"react-redux\";\nimport { selectOrCreate } from \"fancyutils\";\nimport { history } from 'common-components';\n\nimport App from \"./container/app\";\nimport { attachEntryEvents } from \"./container/entry-events\";\nimport store from \"./store/store\";\nimport OverlayArticle from \"./components/article\";\nimport { historyHook } from \"./container/history\";\n\n\nconst onLoad = () => {\n    require(\"./shared\");\n\n    const thingRegex = /\\/(sales|things)\\/(\\d+)/;\n    const articleRegex = /\\/articles\\/(.+)/;\n    const initialHref = location.href;\n\n    $(window).on(\"popstate.overlay\", function(event) {\n        if (\n            location.href !== initialHref &&\n            !(location.pathname.match(thingRegex) || location.pathname.match(articleRegex))\n        ) {\n            event.preventDefault();\n            location.reload();\n        }\n    });\n\n    const overlayArticleContainer = selectOrCreate(\"#overlay-article\");\n    const $overlayArticleContainer = $(overlayArticleContainer);\n    if ($overlayArticleContainer.hasClass('seo')) {\n        $overlayArticleContainer.empty();\n        $overlayArticleContainer.removeClass('seo');\n    }\n    render(\n        <Provider store={store}>\n            <Router history={history}>\n                <App>\n                    <Switch>\n                        <Route path=\"/articles/*\" component={OverlayArticle} />\n                        <Route path=\"*\" component={() => null} />\n                    </Switch>\n                </App>\n            </Router>\n        </Provider>,\n        overlayArticleContainer,\n        () => {\n            history.listen(historyHook);\n            historyHook({ pathname: location.pathname, search: location.search }) // should init once\n            attachEntryEvents();\n        }\n    );\n}\n\nif (document.readyState !== \"loading\") {\n    onLoad();\n} else {\n    document.addEventListener(\"DOMContentLoaded\", onLoad);\n}\n","import { getFancyDepsRoot } from 'fancyutils';\n\nimport store from './store/store';\nimport { cache } from './cache';\nimport { transition } from './container/routeutils';\n// import { reloadCurrentArticle } from './container/history';\n\n\ngetFancyDepsRoot().Shared = {\n    getStore: () => store.getState(),\n    cache,\n    transition,\n    // reloadCurrentArticle,\n};\n","// Warning: objects has to be flat in each context\nexport function getInitialStoreState(contextName) {\n    switch(contextName) {\n    case 'appContext':\n        return {\n            visible: false,\n            viewer: {},\n            loggedIn: null,\n            userCountry: 'US',\n        };\n    case 'article':\n        return {\n            data: null,\n            ID: null,\n            pendingID: null,\n            isFetching: null,\n            status: 'idle' // { idle | request | failed }\n        };\n    default:\n        console.warn('`getInitialStoreState()`: Unknown context name ', contextName);\n    }\n};\n\nvar contexts = [\n    'article',\n    'appContext'\n];\n\nexport function getAllInitialStoreState() {\n    return contexts.reduce((state, contextKey) => {\n        state[contextKey] = getInitialStoreState(contextKey);\n        return state;\n    } , {});\n}\n","import { combineReducers } from 'redux';\nimport { extractMetaFromURL, update, updateShallow, isEmpty } from 'fancyutils';\n\nimport C from './action/action-constants';\nimport { getInitialStoreState } from './store/initial-store';\nimport { updateState } from './appstate';\n\n\nconst isLoggedIn = viewer => !isEmpty(viewer) && viewer.id != null;\n\nvar loaded = false;\nvar lastFullyRenderedArticleID = 0;\nfunction appContext(state = getInitialStoreState('appContext'), action) {\n    switch (action.type) {\n    case C.OPEN_ARTICLE:\n        return updateShallow(state, {\n            visible: true,\n        });\n    case C.CLOSE_ARTICLE:\n        lastFullyRenderedArticleID = 0;\n        loaded = false;\n        return updateShallow(state, {\n            visible: false,\n            lastFullyRenderedArticleID\n        });\n    case C.UPDATE_APP_CONTEXT:\n        return updateShallow(state, action.context);\n    case C.LOAD_ARTICLE: {\n        // Due to multi-stage rendering (cache -> from-server-data -> ...) \n        // it is unable to check state change correctly just by comparing ID;\n        // Therefore, we set internal state per every update cycle and check \n        // if state is fully updated.\n\n        // FIXME: when cached response exist, it marks as rendered before\n        if (\n            loaded === true &&\n            lastFullyRenderedArticleID !== action.data.id\n        ) {\n            lastFullyRenderedArticleID = action.data.id;\n        }\n        const viewer = action.data.viewer || window.viewer || {};\n        const loggedIn = isLoggedIn(viewer);\n        const userCountry = action.data.current_country_code || state.userCountry;\n\n        updateState('loggedIn', loggedIn);\n        updateState('viewer', viewer);\n        loaded = true;\n\n        return update(state, { lastFullyRenderedArticleID, loggedIn, viewer, userCountry });\n    }\n    default:\n        return state;\n    }\n}\n\nfunction populateArticleContext(articleData) {\n    articleData.loading = articleData.fromServer !== true;\n    articleData.URLMeta = extractMetaFromURL(location.href); // FIXME: provide current pathname\n    articleData.owner = articleData.user;\n}\n\n// Article context\nfunction article(state = getInitialStoreState('article'), action) {\n    switch (action.type) {\n    case C.LOAD_ARTICLE:\n        populateArticleContext(action.data)\n        return updateShallow(state, {\n            data: action.data,\n            status: action.status,\n            ID: action.ID,\n            pendingID: null,\n            isFetching: false\n        });\n    case C.REQUEST_ARTICLE:\n        return update(state, {\n            pendingID: action.pendingID,\n            status: action.status,\n            isFetching: true\n        });\n    case C.REQUEST_ARTICLE_FAILURE:\n        return update(state, {\n            status: action.status,\n            isFetching: false\n        });\n\n    // Reset state\n    case C.CLOSE_ARTICLE:\n        return updateShallow(getInitialStoreState('article'));\n    default:\n        return state;\n    }\n}\n\nconst rootReducer = combineReducers({\n    appContext,\n    article,\n});\n\nexport default rootReducer;\n","import { createStore, applyMiddleware } from 'redux';\nimport thunk from 'redux-thunk';\n\nimport rootReducer from '../reducers';\n\n\nconst middleware = [thunk];\n\nexport const configureStore = (initialState) => (\n    createStore(rootReducer, initialState, applyMiddleware(...middleware))\n);\n","import { configureStore } from './configure-store';\nimport { getAllInitialStoreState } from './initial-store';\n\nconst store = configureStore(getAllInitialStoreState());\n\nexport default store;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.amdO = {};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => module['default'] :\n\t\t() => module;\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + \"OverlayArticle\" + \".\" + \"6fad1491f4b683b74c51\" + \".js\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.hmd = (module) => {\n\tmodule = Object.create(module);\n\tif (!module.children) module.children = [];\n\tObject.defineProperty(module, 'exports', {\n\t\tenumerable: true,\n\t\tset: () => {\n\t\t\tthrow new Error('ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: ' + module.id);\n\t\t}\n\t});\n\treturn module;\n};","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"https://static-ec1.thefancy.com/_static_gen/_ui/js/bundle/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// Promise = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t16: 0\n};\n\nvar deferredModules = [\n\t[3578,216,130]\n];\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => {\n\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n\t\t\t\t\t});\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\nvar checkDeferredModules = () => {\n\n};\nfunction checkDeferredModulesImpl() {\n\tvar result;\n\tfor(var i = 0; i < deferredModules.length; i++) {\n\t\tvar deferredModule = deferredModules[i];\n\t\tvar fulfilled = true;\n\t\tfor(var j = 1; j < deferredModule.length; j++) {\n\t\t\tvar depId = deferredModule[j];\n\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferredModules.splice(i--, 1);\n\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n\t\t}\n\t}\n\tif(deferredModules.length === 0) {\n\t\t__webpack_require__.x();\n\t\t__webpack_require__.x = () => {\n\n\t\t}\n\t}\n\treturn result;\n}\n__webpack_require__.x = () => {\n\t// reset startup function so it can be called again when more startup code is added\n\t__webpack_require__.x = () => {\n\n\t}\n\tchunkLoadingGlobal = chunkLoadingGlobal.slice();\n\tfor(var i = 0; i < chunkLoadingGlobal.length; i++) webpackJsonpCallback(chunkLoadingGlobal[i]);\n\treturn (checkDeferredModules = checkDeferredModulesImpl)();\n};\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (data) => {\n\tvar [chunkIds, moreModules, runtime, executeModules] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0, resolves = [];\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tresolves.push(installedChunks[chunkId][0]);\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\tfor(moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\tparentChunkLoadingFunction(data);\n\twhile(resolves.length) {\n\t\tresolves.shift()();\n\t}\n\n\t// add entry modules from loaded chunk to deferred list\n\tif(executeModules) deferredModules.push.apply(deferredModules, executeModules);\n\n\t// run deferred modules when all chunks ready\n\treturn checkDeferredModules();\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkfancy\"] = self[\"webpackChunkfancy\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = webpackJsonpCallback;","// run startup\nreturn __webpack_require__.x();\n"],"sourceRoot":""}