{"version":3,"file":"OverlayThing.main.old.00148b8c215c4c57bdd2.js","sources":["webpack://fancy/./_static/modules/ui/overlay-thing/API.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/FancydUsers.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/Overlay.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/Perf.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/Recommendation.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/Thing.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/ThingCard.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/ThingDetails.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/map.cart.ts","webpack://fancy/./_static/modules/ui/overlay-thing/components/sidebar/action-buttons.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/sidebar/heads/Mixin.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/sidebar/heads/SaleItem.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/sidebar/heads/index.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/sidebar/index.js","webpack://fancy/./_static/modules/ui/overlay-thing/data/Countries.js"],"sourcesContent":["export function deleteThing(thing, callback) {\n  alertify.confirm(\"Remove this from Fancy?\", function (ok) {\n    if (ok) {\n      var param = {\n        thing_id: thing.id,\n        uid: thing.user.id,\n        ntid: thing.ntid\n      };\n      $.post(\"/remove_new_thing.xml\", param, function (xml) {\n        if ($(xml).find(\"status_code\").length > 0 && $(xml).find(\"status_code\").text() == 1) {\n          location.href = $(xml).find(\"url\").text();\n        } else if ($(xml).find(\"status_code\").length > 0 && $(xml).find(\"status_code\").text() == 0) {\n          var msg = $(xml).find(\"message\").text();\n          alertify.alert(msg);\n        }\n\n        callback && callback();\n      }, \"xml\");\n    } else {\n      callback && callback();\n    }\n  });\n}","import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from \"react\";\nimport classnames from \"classnames\";\nimport { MP, getConciseNumberString } from \"fancyutils\";\nimport { FancyStatus } from \"../config\";\nimport { cache } from \"../cache\";\n\nfunction _handleFancydStateOnLoadThing(thingID, _ref) {\n  var fancyd = _ref.fancyd,\n      fancyd_count = _ref.fancyd_count;\n  var stateSetter = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function (_) {\n    return _;\n  };\n  stateSetter({\n    fancyd: fancyd,\n    fancyd_count: fancyd_count,\n    loading: false,\n    fancyStatus: FancyStatus.Idle\n  });\n}\n\nfunction getFancyStatus(nextFancydState) {\n  return nextFancydState ? FancyStatus.Addition : FancyStatus.Removal;\n}\n\nfunction getCompletionIdleStatus(currentFancyState) {\n  var prevFancyState = !currentFancyState;\n  return prevFancyState ? FancyStatus.AfterRemoval : FancyStatus.AfterAddition;\n}\n\nfunction getNextFancydCount(nextFancyd, currentFancydCount) {\n  if (nextFancyd === true) {\n    return currentFancydCount + 1;\n  } else {\n    return currentFancydCount - 1;\n  }\n}\n\nfunction toggleFancy(thingID, currentState) {\n  var stateSetter = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function (_) {\n    return _;\n  };\n  var fancyd = currentState.fancyd,\n      fancyd_count = currentState.fancyd_count,\n      loading = currentState.loading;\n  var nextFancyd = !fancyd;\n  var nextFancydCount = getNextFancydCount(nextFancyd, fancyd_count);\n\n  if (!loading) {\n    stateSetter({\n      fancyd: nextFancyd,\n      loading: true,\n      fancyd_count: nextFancydCount,\n      fancyStatus: getFancyStatus(nextFancyd)\n    });\n    $.ajax({\n      type: \"PUT\",\n      url: \"/rest-api/v1/things/\".concat(thingID),\n      data: {\n        fancyd: nextFancyd\n      }\n    }).done(function (json) {\n      if (json.id && json.fancyd === !fancyd) {\n        // Completing fancy\n        var _nextFancydCount = json.fancyd === true ? (fancyd_count || 0) + 1 : (fancyd_count || 0) - 1;\n\n        cache.update(thingID, undefined, \"fancyd\", nextFancyd);\n        cache.update(thingID, undefined, \"fancyd_count\", _nextFancydCount);\n        stateSetter({\n          loading: false,\n          fancyd: nextFancyd,\n          fancyd_count: _nextFancydCount,\n          fancyStatus: getCompletionIdleStatus(nextFancyd)\n        });\n      } else {\n        // cancelling fancy\n        stateSetter({\n          loading: false,\n          fancyd: fancyd,\n          fancyd_count: fancyd_count,\n          fancyStatus: getFancyStatus(fancyd)\n        });\n      }\n    }).fail(function () {\n      // cancelling fancy\n      stateSetter({\n        loading: false,\n        fancyd: fancyd,\n        fancyd_count: fancyd_count,\n        fancyStatus: getFancyStatus(fancyd)\n      });\n    });\n  }\n} // workaround for profile heads overflow on animation\n\n\nvar bigContainerStyle = {\n  width: \"285px\"\n};\nexport var FancydUsers = /*#__PURE__*/function (_Component) {\n  _inherits(FancydUsers, _Component);\n\n  _createClass(FancydUsers, [{\n    key: \"_getInitialState\",\n    value: function _getInitialState() {\n      return {\n        fancyAnimation: false,\n        // button state\n        fancyd: null,\n        loading: false,\n        fancyd_count: null,\n        fancyStatus: FancyStatus.Idle // fancyStatus = 'Idle', { Idle | Addition | Removal | After- } - Fancy'd status for animation control\n\n      };\n    }\n  }]);\n\n  function FancydUsers(props) {\n    var _this;\n\n    _classCallCheck(this, FancydUsers);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(FancydUsers).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"getFancydCountString\", function () {\n      var fancyd_count = _this.state.fancyd_count;\n      return fancyd_count != null ? getConciseNumberString(fancyd_count, 0) : \"0\";\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"toggleFancy\", function () {\n      toggleFancy(_this.props.thing.id, _this.state, function (ns) {\n        _this.setState(ns);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleFancydStateOnLoadThing\", function (thing) {\n      if (thing == null) {\n        thing = _this.props.thing;\n      }\n\n      _handleFancydStateOnLoadThing(thing.id, {\n        fancyd: thing.fancyd,\n        fancyd_count: thing.fancyd_count\n      }, function (ns) {\n        _this.setState(ns);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleFancyClick\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n      var thing = _this.props.thing;\n\n      if (!_this.props.appContext.loggedIn) {\n        window.require_login(null, \"fancy_thing\", thing.id);\n        return;\n      }\n\n      var _this$state = _this.state,\n          fancyd = _this$state.fancyd,\n          loading = _this$state.loading;\n\n      if (loading) {\n        return;\n      }\n\n      if (!fancyd) {\n        MP(\"Fancy\", {\n          thing_id: thing.id\n        });\n      } else {\n        MP(\"Unfancy\", {\n          thing_id: thing.id\n        });\n      }\n\n      _this.toggleFancy();\n    });\n\n    _this.state = _this._getInitialState();\n    return _this;\n  }\n\n  _createClass(FancydUsers, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.handleFancydStateOnLoadThing();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      // Thing has been updated.\n      var thing = this.props.thing;\n      var prevThing = prevProps.thing;\n\n      if (thing.id !== prevThing.id || thing.isCrawled !== prevThing.isCrawled) {\n        this.handleFancydStateOnLoadThing(thing);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var bigContainer = this.props.bigContainer;\n      var fancyd = this.state.fancyd;\n      return /*#__PURE__*/React.createElement(\"span\", {\n        style: bigContainer && bigContainerStyle,\n        className: \"fancyd_users-wrap\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"count\"\n      }, /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handleFancyClick,\n        className: classnames(\"button button-static fancy _count\", {\n          fancyd: fancyd\n        })\n      }, this.getFancydCountString()), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"_fancyd\"\n      })));\n    }\n  }]);\n\n  return FancydUsers;\n}(Component);\n\n_defineProperty(FancydUsers, \"defaultProps\", {\n  displayCount: 8\n});","import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _extends from \"@babel/runtime/helpers/extends\";\nimport React, { Component, lazy, Suspense } from \"react\";\nimport { connect } from \"react-redux\";\nimport { isEmpty, isStaticPage, isSafari } from \"fancyutils\";\nimport { Sidebar } from \"./sidebar/index\";\nimport { historyData } from \"../container/history\";\nimport { mapStateToThingProps } from \"./map\";\nvar FooterReviews = /*#__PURE__*/lazy(function () {\n  return import(\n  /* webpackChunkName: \"OverlayThing.extras\" */\n  \"./FooterReviews\");\n});\nimport Thing from \"./Thing\";\nimport Timeline from \"./Recommendation\";\nimport { updateSaleContext } from \"../action/action-helpers\";\nimport store from \"../store/store\";\n\nfunction getAdminSidebar(props) {\n  var viewer = props.appContext.viewer,\n      thing = props.thing;\n  var admin = null;\n  var AdminComponent;\n\n  if (viewer.is_admin_business || viewer.is_admin_design) {\n    AdminComponent = /*#__PURE__*/lazy(function () {\n      return import(\n      /* webpackChunkName: \"OverlayThing.admin\" */\n      \"./Admin\");\n    });\n  } else if (viewer.is_admin_wholesale && thing.show_on_homepage) {\n    AdminComponent = /*#__PURE__*/lazy(function () {\n      return import(\n      /* webpackChunkName: \"OverlayThing.admin\" */\n      \"./AdminSimple\");\n    });\n  }\n\n  if (AdminComponent) {\n    admin = /*#__PURE__*/React.createElement(Suspense, {\n      fallback: /*#__PURE__*/React.createElement(\"div\", null)\n    }, /*#__PURE__*/React.createElement(AdminComponent, _extends({}, props, {\n      fallback: /*#__PURE__*/React.createElement(\"div\", null)\n    })));\n  }\n\n  return admin;\n} // Container class for overlayed thing detail.\n\n\nvar _Overlay = /*#__PURE__*/function (_Component) {\n  _inherits(_Overlay, _Component);\n\n  function _Overlay() {\n    _classCallCheck(this, _Overlay);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(_Overlay).apply(this, arguments));\n  }\n\n  _createClass(_Overlay, [{\n    key: \"componentDidUpdate\",\n    // health check\n    value: function componentDidUpdate(prevProps) {\n      var pt = prevProps.thing;\n      var ct = this.props.thing;\n\n      if (ct != null) {\n        if (!pt || pt.id !== ct.id) {\n          if (isStaticPage()) {\n            $(window).scrollTop(0);\n          } else {\n            $(\"#overlay-thing > .popup\").attr(\"tabindex\", -1).focus();\n          }\n\n          if (ct.sales && ct.sales.options && ct.sales.options.length > 1) {\n            var nonSoldoutOptions = ct.sales.options.filter(function (o) {\n              return !o.soldout;\n            });\n            var minimumOption;\n\n            if (nonSoldoutOptions.length > 0) {\n              minimumOption = _.min(nonSoldoutOptions, function (o) {\n                return Number(o.price);\n              });\n            } else {\n              minimumOption = _.min(ct.sales.options, function (o) {\n                return Number(o.price);\n              });\n            }\n\n            if (ct.sales.options[0].id !== minimumOption.id) {\n              store.dispatch(updateSaleContext({\n                saleOptionID: minimumOption.id\n              }));\n            }\n          }\n        }\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var thing = this.props.thing;\n      var display = null;\n\n      if (historyData.locationIsThingPage) {\n        if (thing != null) {\n          var showReview = thing.sales && !isEmpty(thing.sales.reviews);\n          display = /*#__PURE__*/React.createElement(\"div\", {\n            className: \"wrapper-content thing-detail-container thing-detail-overlay \".concat(isSafari() ? \"safari\" : \"\"),\n            key: \"thing-detail-container\"\n          }, /*#__PURE__*/React.createElement(\"div\", {\n            className: \"content\"\n          }, /*#__PURE__*/React.createElement(Thing, this.props), showReview && /*#__PURE__*/React.createElement(Suspense, {\n            fallback: /*#__PURE__*/React.createElement(\"div\", null)\n          }, /*#__PURE__*/React.createElement(FooterReviews, this.props))), /*#__PURE__*/React.createElement(Sidebar, this.props), /*#__PURE__*/React.createElement(Timeline, _extends({\n            fallback: /*#__PURE__*/React.createElement(\"div\", {\n              className: \"timeline other-thing newcard loading\"\n            })\n          }, this.props)), getAdminSidebar(this.props), /*#__PURE__*/React.createElement(\"a\", {\n            href: \"#header\",\n            id: \"scroll-to-top\",\n            style: {\n              display: \"inline\"\n            }\n          }, /*#__PURE__*/React.createElement(\"span\", null, \"Jump to top\")));\n        } else {\n          display = /*#__PURE__*/React.createElement(\"div\", {\n            className: \"wrapper-content thing-detail-container thing-detail-overlay\",\n            key: \"thing-detail-container\"\n          });\n        }\n      } else {\n        display = /*#__PURE__*/React.createElement(\"div\", {\n          key: \"thing-detail-container\"\n        });\n      }\n\n      return display;\n    }\n  }]);\n\n  return _Overlay;\n}(Component);\n\nvar ReduxComponentEnhancer = connect(mapStateToThingProps);\nvar Overlay = ReduxComponentEnhancer(_Overlay);\nexport default Overlay;","export var Keys = {\n  Sidebar: {\n    Wrap: 'SIDEBAR_WRAP',\n    Body: 'SIDEBAR_BODY',\n    Title: 'SIDEBAR_TITLE',\n    Price: 'SIDEBAR_PRICE',\n    Form: 'SIDEBAR_FORM',\n    Desc: 'SIDEBAR_DESCRIPTION',\n    Owner: 'SIDEBAR_OWNER'\n  }\n};","import _extends from \"@babel/runtime/helpers/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from \"react\";\nimport classnames from \"classnames\";\nimport { isEmpty, convertThingsV1ToRest, debounceUntilTimeout } from \"fancyutils\";\nimport { Display } from \"fancymixin\";\nimport { OtContainer, scrollEvent } from \"../container/entry-events\";\nimport { ThingCache, cache } from \"../cache\";\nimport ThingCard from \"./ThingCard\";\nvar Views = {\n  Similar: \"similar\",\n  Recently: \"recently\"\n}; // bound later to timeline\n\nfunction scrollTouchdown(isReached) {\n  if (this.state.similarLoading || isReached !== true) {\n    return;\n  }\n\n  this.updateSimilar(this.props.thing.id);\n}\n\nfunction shouldShowRecommendation() {\n  if (!OtContainer.isStatic()) {\n    return true;\n  }\n\n  var wHeight = $(window).height();\n  var $content = $(\"#overlay-thing .wrapper-content .content > .wrapper\");\n  var tabHeight = $(\"#overlay-thing .wrapper-content .timeline .tabs\").outerHeight();\n  var footerHeight = $(\"#overlay-thing .timeline .tabs\").outerHeight();\n  var topOffset = $content.offset().top;\n  return wHeight - (topOffset + ($content.height() + tabHeight) + footerHeight) > 0;\n}\n\nvar Timeline = /*#__PURE__*/function (_Component) {\n  _inherits(Timeline, _Component);\n\n  function Timeline() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Timeline);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Timeline)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"similarCursorEndReached\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"lastthingID\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"similarNextCursor\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"recentlyNextCursor\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      currentView: Views.Similar,\n      similarLoading: false,\n      recently: [],\n      similar: []\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleToggleSimilar\", function (event) {\n      event.preventDefault();\n\n      _this.setState({\n        currentView: Views.Similar\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleToggleRecently\", function (event) {\n      event.preventDefault();\n\n      _this.updateRecently(_this.props.thing.id);\n\n      _this.setState({\n        currentView: Views.Recently\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"updateSimilar\", function (thingID, reset) {\n      if (thingID == null || _this.state.similarLoading || _this.similarCursorEndReached) {\n        return;\n      }\n\n      _this.setState({\n        similarLoading: true\n      }, function () {\n        var nextCursorString = \"\";\n\n        if (_this.similarNextCursor != null) {\n          nextCursorString = \"&cursor=\".concat(_this.similarNextCursor);\n        }\n\n        $.ajax({\n          type: \"get\",\n          url: \"/might_also_fancy.json?include_sale_item_option=True&rapi_compl=True&thing_id=\".concat(thingID, \"&lang=\").concat(window.CURRENT_LANGCODE || \"\", \"&count=20\").concat(nextCursorString)\n        }).done(function (_ref) {\n          var next_cursor = _ref.next_cursor,\n              results = _ref.results;\n\n          if (!_this.unmounted) {\n            var similar = _this.state.similar;\n            var converted = convertThingsV1ToRest(results);\n            cacheSimilarThings(converted);\n            logExposed(converted); // Update/Insert things array\n\n            var things;\n\n            if (reset || isEmpty(similar)) {\n              things = converted;\n            } else if (_.isArray(similar)) {\n              things = similar.concat(converted);\n            } // Write if page is reached end.\n            // this.similarCursorEndReached = ( next_cursor == null || !converted.length) ;    // End reached\n\n\n            _this.similarCursorEndReached = true; // End reached\n\n            _this.similarNextCursor = next_cursor;\n\n            _this.setState({\n              similar: things\n            });\n          }\n        }).fail(function (xhr) {\n          console.warn(\"updateSimilar():\", xhr);\n        }).always(function () {\n          _this.setState({\n            similarLoading: false\n          });\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"updateRecently\", function (thingID) {\n      if (thingID == null) {\n        return;\n      } // TODO: Should update overlay viewed things.\n\n\n      $.ajax({\n        type: \"get\",\n        url: \"/recently_viewed_things_json?include_sale_item_option=True&rapi_compl=True&thing_id=\".concat(thingID)\n      }).done(function (response) {\n        if (!_this.unmounted) {\n          var recently = convertThingsV1ToRest(response).filter(function (_, i) {\n            return i < 20;\n          });\n          logExposed(recently);\n\n          _this.setState({\n            recently: recently\n          });\n        }\n      }).fail(function (xhr) {\n        console.warn(\"updateRecently():\", xhr);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDelete\", function (deletedThing) {\n      _this.setState({\n        recently: _this.state.recently.filter(function (thing) {\n          return thing.id !== deletedThing.id;\n        })\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(Timeline, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // // in case browser is too big, load manually\n      if (shouldShowRecommendation() || !this.props.thing.sales) {\n        this.updateSimilar(this.props.thing.id);\n      }\n\n      scrollEvent.attach(debounceUntilTimeout(scrollTouchdown, 150, this));\n      this.lastthingID = this.props.thing.id;\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      var nextProps = this.props; // Thing has changed, reset similar things.\n\n      if (this.lastthingID !== nextProps.thing.id) {\n        var idCopy = nextProps.thing.id;\n        this.lastthingID = idCopy;\n        this.similarCursorEndReached = null;\n        this.similarNextCursor = null;\n\n        if (shouldShowRecommendation() || !nextProps.thing.sales) {\n          this.updateSimilar(nextProps.thing.id, true);\n        }\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.unmounted = true; // this.thingContext.disconnectTimeline();\n\n      delete this.thingContext;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          appContext = _this$props.appContext,\n          loggedIn = _this$props.appContext.loggedIn,\n          thing = _this$props.thing;\n      var _this$state = this.state,\n          currentView = _this$state.currentView,\n          recently = _this$state.recently,\n          similar = _this$state.similar;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: classnames(\"timeline other-thing newcard\", {\n          loading: thing.loading\n        })\n      }, /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"tabs after\"\n      }, /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"a\", {\n        className: classnames(Views.Similar, {\n          current: currentView === Views.Similar\n        }),\n        onClick: this.handleToggleSimilar\n      }, __Config.nostore ? gettext(\"Similar items\") : gettext(\"You may also Fancy\"))), /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"a\", {\n        className: classnames(Views.Recently, {\n          current: currentView === Views.Recently\n        }),\n        onClick: this.handleToggleRecently\n      }, gettext(\"Recently viewed\")))), currentView === Views.Similar && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"inner similar\",\n        style: {\n          display: similar.length > 0 || this.state.similarLoading ? \"block\" : \"none\"\n        }\n      }, /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"after fancy-suggestions\"\n      }, similar && similar.map(function (similarThing, idx) {\n        return /*#__PURE__*/React.createElement(ThingCard, _extends({\n          itemIdx: idx,\n          itemType: \"similar\",\n          loggedIn: loggedIn,\n          key: \"timeline-similar-\".concat(idx),\n          viewer: _this2.props.appContext.viewer,\n          appContext: appContext\n        }, similarThing));\n      })), /*#__PURE__*/React.createElement(RecommendationItemLoading, {\n        display: this.state.similarLoading\n      })), currentView === Views.Recently && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"inner recently\",\n        style: {\n          display: recently.length > 0 ? \"block\" : \"none\"\n        }\n      }, /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"after fancy-suggestions\"\n      }, recently && recently.map(function (recentlyThing, idx) {\n        return /*#__PURE__*/React.createElement(ThingCard, _extends({\n          itemIdx: idx,\n          itemType: \"recently\",\n          loggedIn: loggedIn,\n          key: \"timeline-recently-\".concat(idx),\n          onDelete: _this2.handleDelete,\n          viewer: _this2.props.appContext.viewer,\n          appContext: appContext\n        }, recentlyThing));\n      }))));\n    }\n  }]);\n\n  return Timeline;\n}(Component);\n\nexport { Timeline as default };\n\nfunction RecommendationItemLoading(_ref2) {\n  var display = _ref2.display;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: \"infscr-loading\",\n    style: Display.NoneIf(!display)\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    alt: \"Loading...\",\n    src: \"/_ui/images/common/loading.gif\"\n  }), /*#__PURE__*/React.createElement(\"div\", null));\n}\n\nfunction cacheSimilarThings(things) {\n  things.forEach(function (thing) {\n    if (!cache.exists(thing.id, ThingCache.THINGS)) {\n      cache.add(thing.id, thing, ThingCache.THINGS);\n    }\n  });\n}\n\nfunction logExposed(things) {\n  if (typeof LogExposed == \"undefined\") return;\n  things.forEach(function (thing) {\n    window.LogExposed.addLog(thing.id + \"\", \"thing related\");\n  });\n}","import _extends from \"@babel/runtime/helpers/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from \"react\";\nimport assign from \"object-assign\";\nimport classnames from \"classnames\";\nimport { schemeless, isEmpty, promisifiedFetchImage, renderPopup, minmax } from \"fancyutils\";\nimport { Display } from \"fancymixin\";\nimport { Video } from \"common-components\";\nimport { deleteThing } from \"../API\";\nimport { setThumbnailIndex } from \"../action/actions\";\nimport { updateSaleContext } from \"../action/action-helpers\";\nimport { getCurrentSaleOption, getSaleItemId, getDetailType, getSaleImages, getSeller } from \"./map\";\nimport { ItemDetail } from \"./ThingDetails\";\nimport { StaticThingViewConfig, ThingViewConfig } from \"../config\";\nvar zoomMargin = ThingViewConfig.zoomMargin,\n    zoomBoxSize = ThingViewConfig.zoomBoxSize,\n    zoomScale = ThingViewConfig.zoomScale;\nvar ThumbnailsLimit = StaticThingViewConfig.ThumbnailsLimit;\n\nvar Thing = /*#__PURE__*/function (_Component) {\n  _inherits(Thing, _Component);\n\n  function Thing(props) {\n    var _this;\n\n    _classCallCheck(this, Thing);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Thing).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"transitionDuration\", 350);\n\n    _defineProperty(_assertThisInitialized(_this), \"_isRequestFresh\", function (savedTID) {\n      return !_this.state.loaded && savedTID === _this.props.thing.id;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"changeFigureTo\", function (index, saleOptionID) {\n      var tid = _this.props.thing.id;\n\n      if (saleOptionID) {\n        _this.props.dispatch(updateSaleContext({\n          saleOptionID: saleOptionID\n        }));\n      }\n\n      if (index !== _this.props.slideContext.thumbnailIndex && _this.state.loaded === true) {\n        _this.setState({\n          loaded: false\n        }, function () {\n          setTimeout(function () {\n            if (_this._isRequestFresh(tid)) {\n              _this.props.dispatch(setThumbnailIndex(index));\n\n              promisifiedFetchImage(_this.getImage(index).src, function () {\n                if (_this._isRequestFresh(tid)) {\n                  _this.setState({\n                    loaded: true\n                  });\n                }\n              }, 1500);\n            }\n          }, _this.transitionDuration);\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getAbsoluteIndex\", function (diff) {\n      var _this$props = _this.props,\n          thing = _this$props.thing,\n          sales = _this$props.thing.sales,\n          slideContext = _this$props.slideContext,\n          saleContext = _this$props.saleContext;\n      var option = getCurrentSaleOption(sales, saleContext, true);\n      var thingImagesLength = getSaleImages(thing, option).length;\n      var nextIndex = slideContext.thumbnailIndex + diff;\n      var ret; // => end of index reached (reversed)\n\n      if (nextIndex < 0) {\n        ret = (nextIndex + thingImagesLength) % thingImagesLength; // => end of index reached\n      } else if (nextIndex >= thingImagesLength) {\n        ret = 0;\n      } else {\n        ret = nextIndex % thingImagesLength;\n      }\n\n      return ret;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handlePrev\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      _this.changeFigureTo(_this.getAbsoluteIndex(-1));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleNext\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      _this.changeFigureTo(_this.getAbsoluteIndex(+1));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isZoomable\", function () {\n      var boundarySize = ThingViewConfig.boundarySize;\n      return _this.getImage().width > boundarySize;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getZoomImageDimension\", function (img) {\n      var boundarySize = ThingViewConfig.boundarySize;\n      return {\n        width: boundarySize * zoomScale + zoomMargin,\n        height: boundarySize * img.height / img.width * zoomScale + zoomMargin\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getImageMeta\", function (img) {\n      var boundarySize = ThingViewConfig.boundarySize;\n      var width, height, marginHoriz, marginVert; // responsive encoding\n      // - regular mode\n\n      var $fig = $(\"#overlay-thing .figure-item figure\");\n\n      if ($(window).width() > 700) {\n        width = $fig.width();\n        height = $fig.height();\n        marginHoriz = 0;\n\n        if (width > height) {\n          marginHoriz = 0;\n          marginVert = (boundarySize - height) / 2;\n        } else {\n          marginHoriz = (boundarySize - width) / 2;\n          marginVert = 0;\n        } // - mobile mode\n\n      } else {}\n\n      return {\n        width: width,\n        height: height,\n        marginHoriz: marginHoriz,\n        marginVert: marginVert\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"moveZoomImage\", function (pageX, pageY) {\n      var boundarySize = ThingViewConfig.boundarySize;\n      var $wrapper = $(_this.wrapper);\n\n      var img = _this.getImage();\n\n      var meta = _this.getImageMeta(img);\n\n      var offset = $wrapper.offset();\n      var left = pageX - offset.left;\n      var top = pageY - offset.top; // Fishy\n\n      var topPosition = top - (boundarySize - meta.height) / 2;\n      var showZoomImage;\n\n      if ($(window).width() <= 700) {\n        showZoomImage = false;\n      } else {\n        showZoomImage = left > 0 && topPosition > 0 && topPosition < meta.height;\n      }\n\n      var zoomImageStyle;\n\n      if (showZoomImage) {\n        var zd = _this.getZoomImageDimension(img);\n\n        var zoomImageContainerX = minmax(left - zoomMargin, meta.marginHoriz, meta.marginHoriz + meta.width - zoomBoxSize); // 0 need to be fixed\n\n        var zoomImageContainerY = minmax(top - zoomMargin, meta.marginVert, meta.marginVert + meta.height - zoomBoxSize); // 0 need to be fixed\n\n        var backgroundLeft = zd.width * left / boundarySize - zoomMargin;\n        var backgroundTop = zd.height * top / boundarySize - zoomMargin;\n        var bgPosX = -minmax(backgroundLeft, 0, zd.width - zoomBoxSize);\n        var bgPosY = -minmax(backgroundTop, 0, zd.height - zoomBoxSize);\n        zoomImageStyle = {\n          left: \"\".concat(zoomImageContainerX, \"px\"),\n          top: \"\".concat(zoomImageContainerY, \"px\"),\n          backgroundPosition: \"\".concat(bgPosX, \"px \").concat(bgPosY, \"px\"),\n          display: \"inline\"\n        };\n      } else {\n        zoomImageStyle = Display.None;\n      }\n\n      _this.setState({\n        zoomImageStyle: zoomImageStyle\n      }); // FIXME\n\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleZoomBGClick\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      if (_this.isZoomable()) {\n        var nextZoom = !_this.state.zoom;\n\n        _this.setState({\n          zoom: nextZoom\n        });\n\n        if (nextZoom) {\n          _this.moveZoomImage(event.pageX, event.pageY);\n        }\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleZoomBGMouseMove\", function (_ref) {\n      var pageX = _ref.pageX,\n          pageY = _ref.pageY;\n\n      // TODO: deactivate event on video thing\n      if (_this.state.zoom) {\n        _this.moveZoomImage(pageX, pageY);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleZoomImageClick\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      _this.setState({\n        zoom: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getImage\", function () {\n      var _this$props2 = _this.props,\n          thing = _this$props2.thing,\n          sales = _this$props2.thing.sales,\n          thumbnailIndex = _this$props2.slideContext.thumbnailIndex,\n          saleContext = _this$props2.saleContext;\n      var thumbnailsLimit = _this.state.thumbnailsLimit;\n      var option = getCurrentSaleOption(sales, saleContext, true);\n      var saleImages = getSaleImages(thing, option, thumbnailsLimit);\n\n      if (saleImages.length > thumbnailIndex) {\n        return saleImages[thumbnailIndex];\n      } else {\n        return saleImages[0];\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getImageURL\", function () {\n      var image = _this.getImage();\n\n      return \"url(\".concat(schemeless(image.src), \")\");\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getBGImageStyle\", function () {\n      var boundarySize = ThingViewConfig.boundarySize;\n      var style = {\n        backgroundImage: _this.getImageURL(),\n        opacity: _this.state.loaded ? 1 : 0\n      };\n\n      if (_this.props.slideContext.thumbnailIndex !== 0) {\n        style.lineHeight = \"\".concat(boundarySize - 2, \"px\");\n        style.height = boundarySize;\n      }\n\n      return style;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"shouldVideoDisplayed\", function () {\n      var currentThumbIsVideo = _this.getImage().thumbType === \"video\";\n      return currentThumbIsVideo;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleThumbnailsLimitChange\", function (thumbnailsLimit) {\n      _this.setState({\n        thumbnailsLimit: thumbnailsLimit\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleEdit\", function () {\n      var _this$props3 = _this.props,\n          appContext = _this$props3.appContext,\n          thing = _this$props3.thing;\n      import(\n      /* webpackChunkName: \"OverlayThing.popup\" */\n      './popup/index').then(function (_ref2) {\n        var EditPopup = _ref2.EditPopup;\n        renderPopup(EditPopup, {\n          appContext: appContext,\n          thing: thing\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDelete\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n      deleteThing(_this.props.thing);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"MaxDimension\", 640);\n\n    _defineProperty(_assertThisInitialized(_this), \"getBoundaryImageStyle\", function () {\n      var _this$getImage = _this.getImage(),\n          width = _this$getImage.width,\n          height = _this$getImage.height; // let dominant;\n\n\n      if (height > width) {\n        if (height > _this.MaxDimension) {\n          width = width / (height / _this.MaxDimension);\n          height = _this.MaxDimension;\n        }\n      }\n\n      return _.extend({\n        width: width,\n        height: height\n      }, Display.NoneIf(_this.shouldVideoDisplayed()));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleVideoStyle\", function () {\n      if (_this.props.slideContext.thumbnailIndex !== 0 && _this.shouldVideoDisplayed()) {\n        return {\n          top: \"\".concat(($(\"#overlay-thing .figure-item .figure\").height() - $(\"#overlay-thing .video_player\").height()) / 2, \"px\")\n        };\n      }\n\n      return {};\n    });\n\n    _this.state = {\n      loaded: true,\n      zoom: false,\n      zoomImageStyle: Display.None,\n      thumbnailsLimit: ThumbnailsLimit.Basic\n    };\n    $(window).on(\"resize.ThingView\", function () {\n      ThingViewConfig.boundarySize = $(\"#overlay-thing .figure-item figure:visible\").width();\n    });\n    return _this;\n  }\n\n  _createClass(Thing, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      $(window).trigger(\"resize.ThingView\");\n    }\n  }, {\n    key: \"getZoomImageStyle\",\n    // Set zoomed image's style\n    value: function getZoomImageStyle() {\n      var ret = {};\n\n      if (this.isZoomable() && this.state.zoom) {\n        var img = this.getImage();\n        var zd = this.getZoomImageDimension(img);\n        assign(ret, this.state.zoomImageStyle, {\n          backgroundSize: \"\".concat(zd.width, \"px \").concat(zd.height, \"px\"),\n          backgroundImage: \"url(\".concat(img.src, \")\")\n        });\n      } else {\n        ret.display = \"none\";\n      }\n\n      return ret;\n    }\n  }, {\n    key: \"isFit\",\n    value: function isFit() {\n      return this.getImage().width > 640 || this.props.slideContext.thumbnailIndex === 0;\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(nextProps) {\n      var thumbnailChanged = nextProps.slideContext.thumbnailIndex !== this.props.slideContext.thumbnailIndex;\n\n      if (thumbnailChanged && nextProps.slideContext.thumbnailIndex > this.state.thumbnailsLimit - 1) {\n        this.handleThumbnailsLimitChange(ThumbnailsLimit.More);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props4 = this.props,\n          _this$props4$appConte = _this$props4.appContext,\n          viewer = _this$props4$appConte.viewer,\n          lastFullyRenderedThingID = _this$props4$appConte.lastFullyRenderedThingID,\n          thing = _this$props4.thing,\n          _this$props4$thing = _this$props4.thing,\n          sales = _this$props4$thing.sales,\n          META = _this$props4$thing.META,\n          saleContext = _this$props4.saleContext;\n      var type = getDetailType(thing); // Admin sale item view\n\n      var saleItemId = getSaleItemId(thing, viewer);\n      var seller = getSeller(thing);\n      var showZoom = this.isZoomable();\n      var option = getCurrentSaleOption(sales, saleContext, true);\n      var videoDisplay = this.shouldVideoDisplayed(); // show prev/next arrow only for sale items\n\n      var prevNextStyle;\n\n      if (META.PlainThing || META.LaunchApp || getSaleImages(thing, option, 2).length !== 2 // When image is only 1 (or possibly 0)\n      ) {\n          prevNextStyle = Display.None;\n        }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper figure-section\",\n        ref: function ref(element) {\n          _this2.wrapper = element;\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: classnames(\"figure-item\", {\n          video: videoDisplay\n        })\n      }, /*#__PURE__*/React.createElement(\"figure\", null, /*#__PURE__*/React.createElement(\"span\", {\n        onClick: this.handleZoomBGClick,\n        onMouseMove: this.handleZoomBGMouseMove,\n        className: classnames(\"figure\", {\n          startZoom: this.state.zoom,\n          zoomShow: showZoom,\n          loading: thing.loading\n        }),\n        style: this.getBGImageStyle()\n      }, Video.isVideoAvailableForThing(thing) && /*#__PURE__*/React.createElement(Video, {\n        object: thing,\n        display: videoDisplay,\n        lastFullyRenderedObjectID: lastFullyRenderedThingID,\n        allow: {\n          fullScreen: true\n        },\n        style: this.handleVideoStyle()\n      }), /*#__PURE__*/React.createElement(\"em\", {\n        className: \"zoomImage\",\n        onClick: this.handleZoomImageClick,\n        style: this.getZoomImageStyle()\n      }), /*#__PURE__*/React.createElement(\"img\", {\n        src: schemeless(this.getImage().src),\n        className: this.isFit() ? \"fit\" : undefined,\n        style: this.getBoundaryImageStyle(),\n        alt: thing.emojified_name || thing.name\n      }), /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handlePrev,\n        className: \"prev\",\n        style: prevNextStyle\n      }), /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handleNext,\n        className: \"next\",\n        style: prevNextStyle\n      })), !isEmpty(thing.user) && !isEmpty(thing.user.username) && /*#__PURE__*/React.createElement(\"span\", {\n        className: \"submitted\"\n      }, \"Submitted by \", /*#__PURE__*/React.createElement(\"b\", null, thing.user.username)), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"figure-button\"\n      }, saleItemId && seller && (viewer.is_admin_senior || viewer.is_admin_business || viewer.is_admin_brand || viewer.is_admin_cs) && /*#__PURE__*/React.createElement(\"a\", {\n        href: \"/merchant/products/\".concat(saleItemId, \"/edit?seller_id=\").concat(seller.id),\n        className: \"edit_sale\",\n        target: \"_blank\"\n      }, gettext(\"Edit Sale\"), \" \", /*#__PURE__*/React.createElement(\"small\", null, \"(\", gettext(\"Moderator\"), \")\")), !isEmpty(sales) && viewer.id == seller.id && !(viewer.is_admin_senior || viewer.is_admin_business) && /*#__PURE__*/React.createElement(\"a\", {\n        href: \"/merchant/products/\".concat(sales.id, \"/edit\"),\n        className: \"edit_sale\",\n        target: \"_blank\"\n      }, gettext(\"Edit Sale\")), (thing.can_be_modified || viewer.is_admin_content || viewer.is_admin_business) && /*#__PURE__*/React.createElement(\"a\", {\n        className: \"edit\",\n        onClick: this.handleEdit\n      }, gettext(\"Edit\")), (!isEmpty(thing.user) && thing.user.username != null && thing.user.username === viewer.username || viewer.is_admin_senior || viewer.is_admin_business) && /*#__PURE__*/React.createElement(\"a\", {\n        className: \"remove_new_thing delete\",\n        onClick: this.handleDelete\n      }, gettext(\"Delete item\")))), type && /*#__PURE__*/React.createElement(ItemDetail, _extends({}, this.props, {\n        type: type,\n        handleChangeFigure: this.changeFigureTo,\n        thumbnailsLimit: this.state.thumbnailsLimit,\n        onThumbnailsLimitChange: this.handleThumbnailsLimitChange\n      }))));\n    }\n  }]);\n\n  return Thing;\n}(Component);\n\nexport { Thing as default };","import _extends from \"@babel/runtime/helpers/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from \"react\";\nimport classnames from \"classnames\";\nimport { numberFormat, isPlainLeftClick } from \"fancyutils\";\nimport { MoreShareFacade } from \"common-components\";\nimport appState from \"../appstate\";\nimport { addItemToCart, logAddCartMixpanel } from \"./map.cart\";\nimport { getSafeNameProp, getThingName } from \"./map\";\nimport { LinkTypes, transition } from \"../container/routeutils\";\nimport { FancydUsers } from \"./FancydUsers\";\nimport { OtContainer } from \"../container/entry-events\";\nvar itemTraits = {\n  article: {\n    utm: \"article\",\n    section: \"items\",\n    via: \"article\"\n  },\n  similar: {\n    section: \"recommended\",\n    utm: \"rec\",\n    via: \"thing more\"\n  },\n  recently: {\n    section: \"recently viewed\",\n    utm: \"rv\",\n    via: \"thing more\"\n  }\n};\n\nvar ThingCard = /*#__PURE__*/function (_Component) {\n  _inherits(ThingCard, _Component);\n\n  function ThingCard(props) {\n    var _this;\n\n    _classCallCheck(this, ThingCard);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ThingCard).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      fancydCount: 0,\n      quantity: 1,\n      optionID: null,\n      showCart: false,\n      popupOpened: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCartAddition\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      _this.addToCart();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"addToCart\", function () {\n      if (!appState.loggedIn) {\n        window.require_login && window.require_login();\n        return;\n      }\n\n      var _this$props = _this.props,\n          id = _this$props.id,\n          itemType = _this$props.itemType;\n      var quantity = _this.state.quantity;\n\n      var sales = _this.getSales();\n\n      var saleAvailable = _this.isSaleAvailable();\n\n      var saleOptionExists = _this.isSaleOptionExists();\n\n      var option = _this.getSaleOption();\n\n      if (!saleAvailable || _this.state.loading) {\n        return;\n      }\n\n      if (isNaN(quantity) || quantity <= 0) {\n        alert(gettext(\"Please select a valid quantity.\"));\n        return;\n      }\n\n      var param = {\n        seller_id: sales.seller.id,\n        // sisi\n        thing_id: id,\n        // tid\n        sale_item_id: sales.sale_id,\n        // sii\n        quantity: quantity\n      };\n\n      if (saleOptionExists && option) {\n        param.option_id = option.id;\n      }\n\n      var traits = itemTraits[itemType];\n      var title = getThingName(_this.props);\n\n      _this.setState({\n        loading: true\n      }, function () {\n        var log = {\n          salesID: sales.sale_id,\n          utm: traits.utm,\n          section: traits.section,\n          via: traits.via\n        };\n\n        if (option) {\n          log.saleOptionID = option.id;\n        }\n\n        logAddCartMixpanel(log); // ga shit\n\n        var discounting = sales && sales.discount_percentage !== \"0\";\n        var meta = {\n          title: title,\n          price: discounting ? sales.retail_price : sales.deal_price,\n          brand_name: sales.seller.brand_name\n        };\n        addItemToCart(param, function () {\n          if (!_this.unmounted) {\n            _this.setState({\n              loading: false\n            });\n          }\n        }, meta);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleQuickCartToggle\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      var saleAvailable = _this.isSaleAvailable();\n\n      var saleOptionExists = _this.isSaleOptionExists();\n\n      if (saleAvailable) {\n        if (saleOptionExists) {\n          _this.setState({\n            showCart: !_this.state.showCart\n          });\n        } else {\n          _this.addToCart();\n        }\n      } else {\n        _this.setState({\n          showCart: !_this.state.showCart\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isSaleAvailable\", function () {\n      var sales_available = _this.props.sales_available;\n\n      var sales = _this.getSales();\n\n      if (sales) {\n        return sales_available && sales.quantity !== 0;\n      } else {\n        return false;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getSaleOption\", function () {\n      var saleOptionExists = _this.isSaleOptionExists();\n\n      var sales = _this.getSales();\n\n      if (sales && saleOptionExists) {\n        var optionID = _this.state.optionID || sales.options[0].id;\n        var option = sales.options.filter(function (option) {\n          return option.id === optionID;\n        })[0] || null;\n        return option;\n      } else {\n        return null;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isSaleOptionExists\", function () {\n      var sales = _this.getSales();\n\n      if (sales) {\n        return sales.has_options === true;\n      } else {\n        return false;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isSaleOptionAvailable\", function () {\n      var option = _this.getSaleOption();\n\n      if (option) {\n        return option.available_for_sale === true && option.quantity !== 0;\n      } else {\n        return false;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getSales\", function () {\n      return _this.props.sales;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getFancydCount\", function () {\n      return _.isNumber(_this.state.fancydCount) ? _this.state.fancydCount : _this.props.fancyd_count;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleFancydCount\", function (diff) {\n      _this.setState({\n        fancydCount: _this.state.fancydCount + diff\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getQuantityRange\", function () {\n      var saleOptionExists = _this.isSaleOptionExists();\n\n      var max;\n\n      if (saleOptionExists && _this.isSaleOptionAvailable()) {\n        max = _this.getSaleOption().quantity;\n      } else if (_this.isSaleAvailable()) {\n        max = _this.getSales().quantity;\n      }\n\n      return max == null ? [\"1\"] : _.range(1, Math.min(10, max + 1));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleOptionChange\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      _this.setState({\n        optionID: parseInt(event.target.value, 10),\n        quantity: 1\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleOptionQuantityChange\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      _this.setState({\n        quantity: parseInt(event.target.value, 10)\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleTrickClick\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      _this.setState({\n        showCart: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleRecentlyDelete\", function () {\n      $.post(\"/remove_recently_viewed_thing\", {\n        thing_id: _this.props.id\n      }, function (json) {\n        if (!json || json.status_code !== 1) {\n          window.alertify.alert(\"Sorry, failed to remove \\\"\".concat(_this.props.name, \"\\\". Please retry.\"));\n        } else {\n          _this.props.onDelete(_this.props);\n        }\n      }).fail(function () {\n        window.alertify.alert(\"Sorry, failed to remove \\\"\".concat(_this.props.name, \"\\\". Please retry.\"));\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleLinkClick\", function (event) {\n      event.stopPropagation();\n\n      if (isPlainLeftClick(event)) {\n        event.preventDefault();\n        OtContainer.scrollToTop();\n        transition(_this.html_url(), LinkTypes.Timeline);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleShowSomething\", function (popupOpened) {\n      _this.setState({\n        popupOpened: popupOpened\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleNotifySoldout\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      if (!appState.loggedIn) {\n        return window.require_login();\n      }\n\n      var sales = _this.getSales();\n\n      var params = {\n        sale_item_id: sales.sale_id\n      };\n\n      var waiting = _this.getWaiting(sales);\n\n      if (waiting) {\n        params.remove = 1;\n      }\n\n      $.ajax({\n        type: \"post\",\n        url: \"/wait_for_product.json\",\n        data: params,\n        dataType: \"json\"\n      }).done(function (json) {\n        if (!json || json.status_code == null) {\n          return;\n        }\n\n        if (json.status_code == 0 && json.message) {\n          window.alertify.alert(json.message);\n          return;\n        }\n\n        var waiting = params.remove ? false : true;\n\n        _this.setState({\n          waiting: waiting\n        });\n      }).fail(function (json) {\n        if (json && json.message) {\n          window.alertify.alert(json.message);\n        } else {\n          window.alertify.alert(\"There was an error while processing your request. Please try again later.\");\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getWaiting\", function () {\n      var sales = _this.getSales();\n\n      if (sales) {\n        if (_this.state.waiting == null) {\n          return sales.waiting;\n        } else {\n          return _this.state.waiting;\n        }\n      } else {\n        return false;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"html_url\", function () {\n      var _ref = itemTraits[_this.props.itemType] || {},\n          utm = _ref.utm;\n\n      return \"\".concat(_this.props.html_url).concat(utm ? \"?utm=\" + utm : \"\");\n    });\n\n    _this.handleLinkClick = _.throttle(_this.handleLinkClick, 500);\n    return _this;\n  }\n\n  _createClass(ThingCard, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.setState({\n        fancydCount: this.props.fancyd_count || 0\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.unmounted = true;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          id = _this$props2.id,\n          thumb_image_url_310 = _this$props2.thumb_image_url_310,\n          thumb_image_url_558 = _this$props2.thumb_image_url_558,\n          itemIdx = _this$props2.itemIdx,\n          loggedIn = _this$props2.loggedIn,\n          viewer = _this$props2.viewer;\n      var _this$state = this.state,\n          showCart = _this$state.showCart,\n          loading = _this$state.loading,\n          popupOpened = _this$state.popupOpened;\n      var html_url = this.html_url();\n      var sales = this.getSales();\n      var discounting = sales && sales.discount_percentage !== \"0\";\n      var waiting = this.getWaiting();\n      var saleAvailable = this.isSaleAvailable();\n      var saleOptionExists = this.isSaleOptionExists();\n      var saleOptionAvailable = this.isSaleOptionAvailable();\n      var showFrom = sales && sales.max_price !== null && sales.min_price !== null && sales.max_price > sales.min_price;\n      return __Config.new_card ? /*#__PURE__*/React.createElement(\"li\", {\n        className: classnames({\n          \"quick-cart\": loading,\n          active: popupOpened || showCart\n        })\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: classnames(\"figure-item new\", {\n          toggled: showCart\n        })\n      }, /*#__PURE__*/React.createElement(\"figure\", null, /*#__PURE__*/React.createElement(\"a\", {\n        href: html_url,\n        rel: \"thing-\".concat(id),\n        onClick: this.handleLinkClick,\n        \"data-prevent-overlay\": \"true\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"figure\"\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: \"/_ui/images/common/blank.gif\",\n        style: {\n          backgroundImage: \"url(\".concat(thumb_image_url_558 || thumb_image_url_310, \")\")\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"buttons\"\n      }, /*#__PURE__*/React.createElement(FancydUsers, {\n        thing: this.props,\n        appContext: this.props.appContext,\n        displayCount: 6,\n        showFancydUser: false\n      }), /*#__PURE__*/React.createElement(MoreShareFacade, {\n        objectType: \"thing\",\n        objectId: id,\n        loggedIn: loggedIn,\n        title: getThingName(this.props),\n        viewerUsername: viewer.username,\n        onShowSomething: this.handleShowSomething\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: classnames(\"show_cart\", {\n          opened: showCart\n        }),\n        style: !sales ? {\n          display: \"none\"\n        } : undefined\n      }, sales && /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn-cart nopopup\",\n        onClick: this.handleCartAddition,\n        disabled: !saleOptionAvailable\n      }, /*#__PURE__*/React.createElement(\"em\", null, \"Add to Cart\")), /*#__PURE__*/React.createElement(\"em\", {\n        className: \"sale-item-input\"\n      }, /*#__PURE__*/React.createElement(\"small\", {\n        className: \"trick\",\n        style: {\n          display: showCart ? \"block\" : undefined\n        },\n        onClick: this.handleTrickClick\n      }), saleAvailable ? /*#__PURE__*/React.createElement(\"span\", {\n        className: \"frm\"\n      }, saleOptionExists && /*#__PURE__*/React.createElement(\"select\", {\n        name: \"option_id\",\n        id: \"\".concat(id, \"-option_id\"),\n        onChange: this.handleOptionChange\n      }, sales.options.map(function (option, i) {\n        return /*#__PURE__*/React.createElement(\"option\", {\n          key: \"other-item-\".concat(itemIdx, \"-saleoption-\").concat(i),\n          value: option.id\n        }, option.option, \" -\", \" \", !option.available_for_sale || option.quantity === 0 ? gettext(\"Sold out\") : \"$\".concat(numberFormat(option.deal_price, 0)));\n      })), /*#__PURE__*/React.createElement(\"select\", {\n        className: \"option\",\n        id: \"\".concat(id, \"-quantity\"),\n        name: \"quantity\",\n        disabled: !saleOptionAvailable,\n        onChange: this.handleOptionQuantityChange\n      }, this.getQuantityRange().map(function (e, i) {\n        return /*#__PURE__*/React.createElement(\"option\", {\n          key: \"other-item-\".concat(itemIdx, \"-quantityOption-\").concat(i),\n          value: e\n        }, e);\n      })), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"add_to_cart btns-green-embo\",\n        onClick: this.handleCartAddition,\n        disabled: !saleOptionAvailable\n      }, gettext(\"Add to Cart\"))) : /*#__PURE__*/React.createElement(\"span\", {\n        className: \"frm\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"notify-soldout\"\n      }, \"Sorry, this item has sold out\"), /*#__PURE__*/React.createElement(\"button\", {\n        className: classnames(\"btns-green-embo btn-notify\", {\n          subscribed: waiting\n        }),\n        onClick: this.handleNotifySoldout\n      }, waiting ? \"Subscribed\" : \"Notify me when available\"))))), /*#__PURE__*/React.createElement(\"figcaption\", null, /*#__PURE__*/React.createElement(\"a\", {\n        href: html_url,\n        className: \"title\",\n        rel: \"thing-\".concat(id),\n        onClick: this.handleLinkClick,\n        \"data-prevent-overlay\": \"true\"\n      }, /*#__PURE__*/React.createElement(\"b\", _extends({\n        className: \"title\"\n      }, getSafeNameProp(this.props))), sales && /*#__PURE__*/React.createElement(\"span\", {\n        className: \"price \".concat(discounting ? \"sales\" : \"\", \" \").concat(saleAvailable ? \"\" : \"soldout\")\n      }, discounting && /*#__PURE__*/React.createElement(\"small\", {\n        key: \"ThingCard2-price-deal\"\n      }, \"$\", numberFormat(sales.retail_price, 0)), showFrom ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"em\", {\n        className: \"from\"\n      }, \"from \"), \" $\", numberFormat(sales.min_price, 0)) : \"$\\n                                        \".concat(numberFormat(sales.deal_price, 0))))), /*#__PURE__*/React.createElement(\"a\", {\n        className: \"delete\",\n        onClick: this.handleRecentlyDelete\n      }))) : /*#__PURE__*/React.createElement(\"li\", {\n        className: classnames({\n          \"quick-cart\": loading,\n          active: popupOpened || showCart\n        })\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: classnames(\"figure-item\", {\n          toggled: showCart\n        })\n      }, /*#__PURE__*/React.createElement(\"figure\", null, /*#__PURE__*/React.createElement(\"a\", {\n        href: html_url,\n        rel: \"thing-\".concat(id),\n        onClick: this.handleLinkClick,\n        \"data-prevent-overlay\": \"true\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"back\"\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"figure\"\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: \"/_ui/images/common/blank.gif\",\n        style: {\n          backgroundImage: \"url(\".concat(thumb_image_url_558 || thumb_image_url_310, \")\")\n        }\n      })))), /*#__PURE__*/React.createElement(\"figcaption\", null, /*#__PURE__*/React.createElement(\"span\", {\n        className: classnames(\"show_cart\", {\n          opened: showCart\n        }),\n        style: !sales ? {\n          display: \"none\"\n        } : undefined\n      }, sales && /*#__PURE__*/React.createElement(\"button\", {\n        className: \"price btn-cart nopopup \".concat(discounting ? \"sales\" : \"\", \" \").concat(saleAvailable ? \"\" : \"soldout\"),\n        onClick: this.handleQuickCartToggle\n      }, /*#__PURE__*/React.createElement(\"em\", null, discounting && /*#__PURE__*/React.createElement(\"small\", {\n        key: \"ThingCard2-price-deal\"\n      }, \"$\", numberFormat(sales.retail_price, 0)), /*#__PURE__*/React.createElement(\"b\", null, showFrom ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"em\", {\n        className: \"from\"\n      }, \"from \"), \" $\", numberFormat(sales.min_price, 0)) : \"$\".concat(numberFormat(sales.deal_price, 0))))), /*#__PURE__*/React.createElement(\"em\", {\n        className: \"sale-item-input\"\n      }, /*#__PURE__*/React.createElement(\"small\", {\n        className: \"trick\",\n        style: {\n          display: showCart ? \"block\" : null\n        },\n        onClick: this.handleTrickClick\n      }), saleAvailable ? /*#__PURE__*/React.createElement(\"span\", {\n        className: \"frm\"\n      }, saleOptionExists && /*#__PURE__*/React.createElement(\"select\", {\n        name: \"option_id\",\n        id: \"\".concat(id, \"-option_id\"),\n        onChange: this.handleOptionChange\n      }, sales.options.map(function (option, i) {\n        return /*#__PURE__*/React.createElement(\"option\", {\n          key: \"other-item-\".concat(itemIdx, \"-saleoption-\").concat(i),\n          value: option.id\n        }, option.option, \" -\", \" \", !option.available_for_sale || option.quantity === 0 ? gettext(\"Sold out\") : \"$\".concat(numberFormat(option.deal_price, 0)));\n      })), /*#__PURE__*/React.createElement(\"select\", {\n        className: \"option\",\n        id: \"\".concat(id, \"-quantity\"),\n        name: \"quantity\",\n        disabled: !saleOptionAvailable,\n        onChange: this.handleOptionQuantityChange\n      }, this.getQuantityRange().map(function (e, i) {\n        return /*#__PURE__*/React.createElement(\"option\", {\n          key: \"other-item-\".concat(itemIdx, \"-quantityOption-\").concat(i),\n          value: e\n        }, e);\n      })), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"add_to_cart btns-green-embo\",\n        onClick: this.handleCartAddition,\n        disabled: !saleOptionAvailable\n      }, gettext(\"Add to Cart\"))) : /*#__PURE__*/React.createElement(\"span\", {\n        className: \"frm\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"notify-soldout\"\n      }, \"Sorry, this item has sold out\"), /*#__PURE__*/React.createElement(\"button\", {\n        className: classnames(\"btns-green-embo btn-notify\", {\n          subscribed: waiting\n        }),\n        onClick: this.handleNotifySoldout\n      }, waiting ? \"Subscribed\" : \"Notify me when available\")))), /*#__PURE__*/React.createElement(\"a\", _extends({\n        href: html_url,\n        className: \"title\",\n        rel: \"thing-\".concat(id),\n        onClick: this.handleLinkClick,\n        \"data-prevent-overlay\": \"true\"\n      }, getSafeNameProp(this.props))), /*#__PURE__*/React.createElement(\"span\", {\n        className: classnames(\"buttons\"\n        /*, { 'no-cart': saleAvailable }*/\n        )\n      }, /*#__PURE__*/React.createElement(FancydUsers, {\n        thing: this.props,\n        appContext: this.props.appContext,\n        displayCount: 6,\n        showFancydUser: false\n      }), /*#__PURE__*/React.createElement(MoreShareFacade, {\n        objectType: \"thing\",\n        objectId: id,\n        loggedIn: loggedIn,\n        title: getThingName(this.props),\n        viewerUsername: viewer.username,\n        onShowSomething: this.handleShowSomething\n      }))), /*#__PURE__*/React.createElement(\"a\", {\n        className: \"delete\",\n        onClick: this.handleRecentlyDelete\n      })));\n    }\n  }]);\n\n  return ThingCard;\n}(Component);\n\nexport { ThingCard as default };","import _extends from \"@babel/runtime/helpers/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from 'react';\nimport classnames from 'classnames';\nimport { cdnUtils, renderPopup } from 'fancyutils';\nimport { Display } from 'fancymixin';\nimport { getDescription, getSales, getDomesticDeliveryDate, getIntlDeliveryDate, getSaleImages } from './map';\nimport { getCountryByCode } from '../data/Countries';\nimport { StaticThingViewConfig } from '../config';\nimport { getCurrentSaleOption } from './map';\nvar ThumbnailsLimit = StaticThingViewConfig.ThumbnailsLimit;\nexport var ItemDetail = /*#__PURE__*/function (_Component) {\n  _inherits(ItemDetail, _Component);\n\n  function ItemDetail(props) {\n    var _this;\n\n    _classCallCheck(this, ItemDetail);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ItemDetail).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"DetailHeight\", 175);\n\n    _defineProperty(_assertThisInitialized(_this), \"handlePolicyDislplay\", function (event) {\n      event.preventDefault();\n      var sales = _this.props.thing.sales;\n\n      if (sales) {\n        import(\n        /* webpackChunkName: \"OverlayThing.popup\" */\n        './popup/index').then(function (_ref) {\n          var ReturnPolicyDetailPopup = _ref.ReturnPolicyDetailPopup;\n          renderPopup(ReturnPolicyDetailPopup, {\n            sales: sales\n          });\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleMore\", function (event) {\n      event.preventDefault();\n\n      _this.setState({\n        showMore: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleLess\", function (event) {\n      event.preventDefault();\n\n      _this.setState({\n        showMore: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleViewAllImages\", function () {\n      _this.props.onThumbnailsLimitChange(ThumbnailsLimit.More);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSelectImage\", function (event) {\n      event.preventDefault();\n      var idx = parseInt($(event.currentTarget).attr('data-idx'));\n      var saleOptionID = parseInt($(event.currentTarget).closest('li').attr('data-option-id')) || undefined;\n\n      _this.props.handleChangeFigure(idx, saleOptionID);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setDescriptionDisplayState\", function () {\n      var detailRef = $(_this.detail);\n      var shortDescription;\n\n      if (detailRef.length > 0) {\n        // Get some of very first two children, which is not 'more' or 'less'\n        shortDescription = detailRef.children().filter(function (i) {\n          return i <= 1;\n        }).toArray().reduce(function (p, n) {\n          return p + $(n).outerHeight();\n        }, 0) < _this.DetailHeight;\n      } else {\n        shortDescription = false;\n      }\n\n      _this.props.onThumbnailsLimitChange(ThumbnailsLimit.Basic);\n\n      _this.setState({\n        shortDescription: shortDescription,\n        showMore: false\n      });\n    });\n\n    _this.state = {\n      showMore: false,\n      shortDescription: false\n    };\n    return _this;\n  }\n\n  _createClass(ItemDetail, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.setDescriptionDisplayState();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.appContext.lastFullyRenderedThingID !== this.props.appContext.lastFullyRenderedThingID) {\n        this.setDescriptionDisplayState();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          thing = _this$props.thing,\n          META = _this$props.thing.META,\n          type = _this$props.type,\n          thumbnailIndex = _this$props.slideContext.thumbnailIndex,\n          thumbnailsLimit = _this$props.thumbnailsLimit,\n          saleContext = _this$props.saleContext;\n      var _this$state = this.state,\n          shortDescription = _this$state.shortDescription,\n          showMore = _this$state.showMore;\n      var sales = getSales(type, thing);\n      var option = getCurrentSaleOption(sales, saleContext, true);\n      var saleImages = getSaleImages(thing, option, thumbnailsLimit);\n\n      if (type === 'urlOnly') {\n        if (thing.user) {\n          return /*#__PURE__*/React.createElement(\"div\", {\n            className: \"figure-detail after\",\n            key: \"thing-figure-detail\",\n            style: Display.NoneIf(thing.loading)\n          }, /*#__PURE__*/React.createElement(\"p\", {\n            className: \"asset\"\n          }, gettext(\"Added by \"), /*#__PURE__*/React.createElement(\"a\", {\n            href: thing.user.html_url,\n            target: \"_blank\"\n          }, thing.user.full_name)));\n        } else {\n          return null;\n        }\n      }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"figure-detail after\",\n        key: \"thing-figure-detail\",\n        style: Display.NoneIf(thing.loading)\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"thumbnail-list\"\n      }, /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"after\"\n      }, saleImages.map(function (image, idx) {\n        var thumbIsVideo = image.thumbType === 'video';\n        var thumbnailURL = thumbIsVideo || META.Hotel ? image.src : cdnUtils.getResizeURL(image.src, 100, 'crop', true, true);\n        var optionProps = {};\n\n        if (image.option_name) {\n          optionProps['data-option-name'] = image.option_name;\n        }\n\n        if (image.option_id) {\n          optionProps['data-option-id'] = image.option_id;\n        }\n\n        return /*#__PURE__*/React.createElement(\"li\", _extends({\n          key: idx,\n          className: thumbnailIndex === idx ? 'current' : null\n        }, optionProps), /*#__PURE__*/React.createElement(\"a\", {\n          \"data-idx\": idx,\n          style: {\n            backgroundImage: \"url(\".concat(thumbnailURL, \")\")\n          },\n          className: classnames(\"thumb\", {\n            \"active\": thumbnailIndex === idx,\n            \"video-thumb\": thumbIsVideo\n          }),\n          onClick: _this2.handleSelectImage\n        }));\n      }), saleImages.length >= thumbnailsLimit && /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"a\", {\n        className: \"more\",\n        onClick: this.handleViewAllImages\n      }, gettext(\"View all images\"))))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"description\"\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: classnames(\"detail\", {\n          'show': showMore,\n          'short': shortDescription\n        }),\n        ref: function ref(element) {\n          _this2.detail = element;\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        className: \"tit\"\n      }, gettext('Description')), /*#__PURE__*/React.createElement(\"div\", {\n        dangerouslySetInnerHTML: {\n          __html: getDescription(type, thing)\n        }\n      }), /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handleMore,\n        className: \"more\"\n      }, gettext(\"Show More\")), /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handleLess,\n        className: \"less\"\n      }, gettext(\"Show Less\"))), type === 'sales' && /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"after\"\n      })));\n    }\n  }]);\n\n  return ItemDetail;\n}(Component);\nexport var DeliveryInformation = /*#__PURE__*/function (_Component2) {\n  _inherits(DeliveryInformation, _Component2);\n\n  function DeliveryInformation() {\n    var _getPrototypeOf2;\n\n    var _this3;\n\n    _classCallCheck(this, DeliveryInformation);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this3 = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(DeliveryInformation)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this3), \"handleShipCountryClick\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n      var _this3$props = _this3.props,\n          userCountry = _this3$props.appContext.userCountry,\n          dispatch = _this3$props.dispatch;\n      import(\n      /* webpackChunkName: \"OverlayThing.popup\" */\n      './popup/index').then(function (_ref2) {\n        var ShippingCountriesPopup = _ref2.ShippingCountriesPopup;\n        renderPopup(ShippingCountriesPopup, {\n          dispatch: dispatch,\n          userCountry: userCountry\n        });\n      });\n    });\n\n    return _this3;\n  }\n\n  _createClass(DeliveryInformation, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          userCountry = _this$props2.appContext.userCountry,\n          thing = _this$props2.thing,\n          type = _this$props2.type;\n      var sales = getSales(type, thing);\n      var deliveryIsDomestic = sales && userCountry === 'US';\n      var ableToShip = deliveryIsDomestic && sales.expected_delivery_day_1 || userCountry !== 'US' && sales.international_shipping;\n      var hideShippingWindow = deliveryIsDomestic && !sales.expected_delivery_day_1;\n      var deliveryDate;\n\n      if (ableToShip) {\n        if (deliveryIsDomestic) {\n          deliveryDate = getDomesticDeliveryDate(sales);\n        } else {\n          deliveryDate = getIntlDeliveryDate(sales);\n        }\n      }\n\n      return /*#__PURE__*/React.createElement(\"li\", {\n        className: \"\".concat(deliveryIsDomestic ? 'domestic' : 'international', \" shipping\"),\n        style: Display.NoneIf(!ableToShip)\n      }, /*#__PURE__*/React.createElement(\"label\", null, deliveryDate ? gettext('Estimated Delivery') : gettext('Delivery')), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"able\",\n        style: Display.NoneIf(!ableToShip)\n      }, deliveryDate ? \"\".concat(deliveryDate, \" days to \") : 'Ships to ', /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handleShipCountryClick\n      }, getCountryByCode(userCountry))), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"unable\",\n        style: Display.NoneIf(ableToShip || hideShippingWindow)\n      }, \"Unable to ship to \", /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handleShipCountryClick\n      }, userCountry)));\n    }\n  }]);\n\n  return DeliveryInformation;\n}(Component);","import { getLocationArgPairs } from 'fancyutils';\nvar _window = window,\n    Fancy = _window.Fancy,\n    track_event = _window.track_event,\n    dataLayer = _window.dataLayer,\n    from_sds_page = _window.from_sds_page,\n    TrackingEvents = _window.TrackingEvents;\nexport function logAddCartMixpanel(_ref) {\n  var salesID = _ref.salesID,\n      saleOptionID = _ref.saleOptionID,\n      utm = _ref.utm,\n      section = _ref.section,\n      via = _ref.via;\n\n  if (salesID == null) {\n    return;\n  }\n\n  if (utm == null) {\n    var currentLocationArgPair = getLocationArgPairs('utm');\n\n    if (currentLocationArgPair) {\n      utm = currentLocationArgPair[1];\n    }\n  }\n\n  var log = {\n    'sale id': salesID,\n    via: via || 'thing page',\n    utm: utm\n  };\n\n  if (section) {\n    log.section = section;\n  }\n\n  if (saleOptionID && salesID !== saleOptionID) {\n    log['option id'] = saleOptionID;\n  }\n\n  try {\n    window.track_event && track_event('Add to Cart', log);\n  } catch (e) {}\n\n  return log;\n}\nexport function addItemToCart(param, callback, meta) {\n  // should be replaced by Fancy.CartAPI.addItem\n  param.from_sds_page = from_sds_page;\n\n  if (window.dataLayer) {\n    window.dataLayer.push({\n      event: 'Add_to_Cart_Button',\n      product_id: param['sale_item_id'],\n      option_id: param['option_id'],\n      products: undefined,\n      products_info: undefined,\n      revenue: undefined\n    });\n  }\n\n  return $.ajax({\n    type: 'POST',\n    url: '/add_item_to_cart.json',\n    data: param\n  }).done(function (json) {\n    if (!json || json.status_code == null) {\n      return;\n    }\n\n    if (json.status_code === 1) {\n      if (meta) {\n        TrackingEvents.addToCart([{\n          id: param.sale_item_id,\n          brand: meta.brand_name,\n          name: meta.title,\n          quantity: param.quantity,\n          price: meta.price,\n          variant: json.option\n        }]); // avoid NaN\n      }\n\n      var args = {\n        'THING_ID': param.thing_id,\n        'ITEMCODE': json.itemcode,\n        'THUMBNAIL_IMAGE_URL': json.image_url,\n        'ITEMNAME': json.itemname,\n        'QUANTITY': json.quantity,\n        'PRICE': json.price,\n        'OPTIONS': json.option,\n        'HTML_URL': json.html_url,\n        'CART_ID': json.cart_id\n      };\n\n      if (json.fancy_price) {\n        args.FANCY_PRICE = json.fancy_price;\n      }\n\n      Fancy.Cart.addItem(args);\n      Fancy.Cart.openPopup();\n    } else if (json.status_code == 0) {\n      if (json.message) {\n        alert(json.message);\n      }\n    }\n  }).always(function () {\n    callback && callback();\n  });\n}","import _extends from \"@babel/runtime/helpers/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport React, { Component } from 'react';\nimport { MoreShareFacade } from 'common-components';\nimport { getThingName } from '../map';\nimport { FancydUsers } from '../FancydUsers';\n\nvar ActionButtons = /*#__PURE__*/function (_Component) {\n  _inherits(ActionButtons, _Component);\n\n  function ActionButtons() {\n    _classCallCheck(this, ActionButtons);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ActionButtons).apply(this, arguments));\n  }\n\n  _createClass(ActionButtons, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          _this$props$appContex = _this$props.appContext,\n          loggedIn = _this$props$appContex.loggedIn,\n          viewer = _this$props$appContex.viewer,\n          thing = _this$props.thing;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"figure-button action-button-v2\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"buttons\"\n      }, /*#__PURE__*/React.createElement(FancydUsers, _extends({}, this.props, {\n        bigContainer: true,\n        displayCount: 4\n      })), /*#__PURE__*/React.createElement(MoreShareFacade, {\n        objectType: \"thing\",\n        objectId: thing.id,\n        loggedIn: loggedIn,\n        title: getThingName(thing),\n        viewerUsername: viewer.username,\n        showShortcuts: true,\n        fromThingSidebar: true\n      })));\n    }\n  }]);\n\n  return ActionButtons;\n}(Component);\n\nexport { ActionButtons as default };","import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _extends from \"@babel/runtime/helpers/extends\";\nimport React from \"react\";\nimport classnames from \"classnames\";\nimport { getCurrentSaleOption, getThingName } from \"../../map\";\nimport { addItemToCart, logAddCartMixpanel } from \"../../map.cart\"; // Generic purchase handler, needs to be bound to insatnce on initialization.\n\n/*\n    data-sii={sales.id}\n    data-sisi={sales.seller_id}\n    data-tid={thing.id}\n*/\n\nexport function handlePurchase(event) {\n  var _this = this;\n\n  event.preventDefault();\n  var _this$props = this.props,\n      thing = _this$props.thing,\n      sales = _this$props.thing.sales,\n      saleContext = _this$props.saleContext;\n  var saleOption = getCurrentSaleOption(sales, saleContext, true);\n  var soldout = saleOption == null ? sales.soldout : saleOption.soldout;\n\n  if (soldout || this.state.loading) {\n    return;\n  }\n\n  var saleOptionID = saleOption != null ? saleOption.id : null;\n  this.setState({\n    loading: true\n  }, function () {\n    var log = {\n      salesID: sales.id\n    };\n\n    if (saleOption) {\n      log.saleOptionID = saleOptionID;\n    }\n\n    logAddCartMixpanel(log);\n    var request = {\n      thing_id: thing.id,\n      seller_id: thing.sales.seller.id,\n      sale_item_id: sales.id,\n      quantity: saleContext.selectedQuantity,\n      personalization: saleContext.personalization\n    };\n\n    if (saleOptionID != null) {\n      request.option_id = saleOptionID;\n    }\n\n    var discounting = sales && sales.discount_percentage !== \"0\";\n    var meta = {\n      title: getThingName(thing),\n      price: discounting ? sales.retail_price : sales.deal_price,\n      brand_name: sales.seller.brand_name\n    };\n    addItemToCart(request, function () {\n      _this.setState({\n        loading: false\n      });\n    }, meta);\n  });\n}\n\nvar SaleOptions = function SaleOptions(_ref) {\n  var _ref$options = _ref.options,\n      options = _ref$options === void 0 ? [\"1\"] : _ref$options,\n      _ref$currentValue = _ref.currentValue,\n      currentValue = _ref$currentValue === void 0 ? \"1\" : _ref$currentValue,\n      _ref$id = _ref.id,\n      id = _ref$id === void 0 ? \"\" : _ref$id,\n      _ref$value = _ref.value,\n      value = _ref$value === void 0 ? function (v) {\n    return v;\n  } : _ref$value,\n      expander = _ref.expander,\n      defaultValue = _ref.defaultValue,\n      printer = _ref.printer,\n      disabled = _ref.disabled,\n      onChange = _ref.onChange,\n      onClick = _ref.onClick,\n      onFocus = _ref.onFocus,\n      unselectedLabel = _ref.unselectedLabel;\n\n  expander = expander || function (option, idx) {\n    return /*#__PURE__*/React.createElement(\"option\", {\n      key: \"sale_options-\".concat(idx),\n      value: value(option)\n    }, printer(option));\n  };\n\n  return /*#__PURE__*/React.createElement(\"select\", {\n    id: id,\n    className: classnames(\"select-boxes2\", {\n      'one-option': options.length <= 1\n    }),\n    value: value(currentValue) || defaultValue,\n    disabled: disabled,\n    onChange: onChange,\n    onClick: onClick,\n    onFocus: onFocus\n  }, unselectedLabel && /*#__PURE__*/React.createElement(\"option\", {\n    value: \"\"\n  }, unselectedLabel), options.map(expander));\n};\n\nexport var CartButton = function CartButton(props) {\n  return /*#__PURE__*/React.createElement(\"button\", _extends({}, props, {\n    label: null\n  }), props.label);\n};\nexport var SelectBox = function SelectBox(props) {\n  var className = props.className,\n      disabled = props.disabled,\n      label = props.label,\n      currentValue = props.currentValue,\n      defaultValue = props.defaultValue,\n      id = props.id,\n      printer = props.printer,\n      tabIndex = props.tabIndex,\n      unselectedLabel = props.unselectedLabel,\n      _props$options = props.options,\n      options = _props$options === void 0 ? ['1'] : _props$options;\n  printer = printer != null ? printer : function (s) {\n    return s;\n  };\n  defaultValue = defaultValue != null ? defaultValue : \"1\";\n  className = className != null ? className : null;\n  var labelValue;\n\n  if (unselectedLabel != null && currentValue === \"\") {\n    labelValue = unselectedLabel;\n  } else {\n    labelValue = printer(currentValue != null ? currentValue : defaultValue);\n  }\n\n  return /*#__PURE__*/React.createElement(\"p\", {\n    className: className\n  }, /*#__PURE__*/React.createElement(\"label\", null, label), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"trick-select \".concat(id)\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    className: classnames(\"selectBox\", {\n      disabled: disabled,\n      'one-option': options.length <= 1\n    }),\n    tabIndex: tabIndex || \"1\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"selectBox-label\"\n  }, labelValue), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"selectBox-arrow\"\n  })), /*#__PURE__*/React.createElement(SaleOptions, _extends({}, props, {\n    printer: printer,\n    defaultValue: defaultValue\n  }))));\n};\nexport var MultiOptionState = /*#__PURE__*/function () {\n  function MultiOptionState(options, option_meta) {\n    _classCallCheck(this, MultiOptionState);\n\n    this.options = options;\n    this.option_meta = option_meta;\n    var orderMap = {};\n    option_meta.forEach(function (m) {\n      if (orderMap[m.type] == null) {\n        orderMap[m.type] = {\n          length: 1\n        };\n        orderMap[m.type][m.name] = 0;\n      } else {\n        orderMap[m.type][m.name] = orderMap[m.type].length;\n        orderMap[m.type].length += 1;\n      }\n    });\n    this.orderMap = orderMap;\n  } // i.e.) getPossibleValues(['a', '1', ''], 1) => ['1', '3', '6']\n  // output: get possible options for 2nd option dependent on ('a' / 1st option)\n\n\n  _createClass(MultiOptionState, [{\n    key: \"getPossibleValuesForIndex\",\n    value: function getPossibleValuesForIndex(selected, targetIndex) {\n      var options = this.options,\n          option_meta = this.option_meta,\n          orderMap = this.orderMap;\n\n      if (targetIndex === 0) {\n        return option_meta[0].values;\n      }\n\n      var filteredOptions = options;\n      option_meta.map(function (m) {\n        var order = orderMap[m.type][m.name];\n\n        if (selected[m.type][order]) {\n          return selected[m.type][order];\n        } else {\n          return selected[m.type][0];\n        }\n      }).forEach(function (sel, idx) {\n        if (idx < targetIndex) {\n          filteredOptions = filteredOptions.filter(function (option) {\n            return option.values[idx] === sel;\n          });\n        }\n      });\n      return _.uniq(filteredOptions.map(function (o) {\n        return o.values[targetIndex];\n      })); // FIXME\n    }\n  }, {\n    key: \"getMultiOptions\",\n    value: function getMultiOptions(selected) {\n      var _this2 = this;\n\n      return this.option_meta.map(function (meta, idx) {\n        return [meta, _this2.getPossibleValuesForIndex(selected, idx)];\n      });\n      /*\n      returns [\n          [type, ['a', 'b', 'c']],\n          [type, ['1', '2']],\n          [tyep, ['red', 'white', 'black']]\n      ]\n      */\n    }\n  }]);\n\n  return MultiOptionState;\n}();\nexport var MultiOption = function MultiOption(props) {\n  var selected = props.selected,\n      multiOptionState = props.multiOptionState,\n      sid = props.sid;\n\n  if (multiOptionState == null) {\n    return null;\n  }\n\n  var multiOptions = multiOptionState.getMultiOptions(selected);\n  return multiOptions.map(function (_ref2, idx) {\n    var _ref3 = _slicedToArray(_ref2, 2),\n        meta = _ref3[0],\n        values = _ref3[1];\n\n    var type = meta.type,\n        name = meta.name;\n    var indexTypeOf = multiOptionState.orderMap[type] && multiOptionState.orderMap[type][name];\n    var additional = {\n      name: name,\n      values: values,\n      indexTypeOf: indexTypeOf,\n      selectedArray: selected && selected[type],\n      selectedValue: selected && selected[type] && selected[type][indexTypeOf],\n      key: \"\".concat(sid, \"-\").concat(idx)\n    };\n\n    if (type === \"dropdown\") {\n      return /*#__PURE__*/React.createElement(MultiSelectBox, _extends({}, props, additional));\n    } else if (type === \"swatch\") {\n      additional.swatch = meta.swatch;\n      return /*#__PURE__*/React.createElement(MultiSwatch, _extends({}, props, additional));\n    } else if (type === \"thumbnail\") {\n      additional.thumbnail = meta.thumbnail;\n      return /*#__PURE__*/React.createElement(MultiThumbnail, _extends({}, props, additional));\n    } else if (type === \"button\") {\n      return /*#__PURE__*/React.createElement(MultiButton, _extends({}, props, additional));\n    }\n  });\n};\nexport var MultiSelectBox = function MultiSelectBox(props) {\n  var values = props.values,\n      name = props.name,\n      onMultiSelectBoxChange = props.onMultiSelectBoxChange,\n      indexTypeOf = props.indexTypeOf,\n      selectedValue = props.selectedValue;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"multi-option\"\n  }, /*#__PURE__*/React.createElement(\"label\", null, name), /*#__PURE__*/React.createElement(\"select\", {\n    onChange: onMultiSelectBoxChange,\n    selected: selectedValue,\n    className: values.length <= 1 ? 'one-option' : null\n  }, values.map(function (value) {\n    return /*#__PURE__*/React.createElement(MultiSelectBoxOption, {\n      value: value,\n      indexTypeOf: indexTypeOf\n    });\n  })));\n};\n\nvar MultiSelectBoxOption = function MultiSelectBoxOption(props) {\n  var value = props.value,\n      indexTypeOf = props.indexTypeOf;\n  return /*#__PURE__*/React.createElement(\"option\", {\n    \"data-value\": value,\n    \"data-index-typeof\": indexTypeOf,\n    value: value\n  }, value);\n};\n\nexport var MultiSwatch = function MultiSwatch(props) {\n  var name = props.name,\n      values = props.values,\n      swatch = props.swatch,\n      indexTypeOf = props.indexTypeOf,\n      selectedValue = props.selectedValue,\n      onClickSwatch = props.onClickSwatch;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"multi-option swatch\"\n  }, /*#__PURE__*/React.createElement(\"label\", null, name), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"value\"\n  }, selectedValue), /*#__PURE__*/React.createElement(\"ul\", null, values.map(function (value) {\n    return /*#__PURE__*/React.createElement(MultiSwatchOption, {\n      value: value,\n      swatch: swatch,\n      indexTypeOf: indexTypeOf,\n      selectedValue: selectedValue,\n      onClick: onClickSwatch\n    });\n  })));\n};\n\nvar MultiSwatchOption = function MultiSwatchOption(props) {\n  var value = props.value,\n      swatch = props.swatch,\n      indexTypeOf = props.indexTypeOf,\n      selectedValue = props.selectedValue,\n      onClick = props.onClick;\n  return /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"a\", {\n    href: \"#\",\n    style: {\n      backgroundColor: swatch[value]\n    },\n    onClick: onClick,\n    \"data-value\": value,\n    \"data-index-typeof\": indexTypeOf,\n    className: selectedValue === value ? \"selected\" : \"\"\n  }));\n};\n\nexport var MultiThumbnail = function MultiThumbnail(props) {\n  var values = props.values,\n      name = props.name,\n      thumbnail = props.thumbnail,\n      onClickThumbnail = props.onClickThumbnail,\n      indexTypeOf = props.indexTypeOf,\n      selectedValue = props.selectedValue;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"multi-option thumbnail\"\n  }, /*#__PURE__*/React.createElement(\"label\", null, name), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"value\"\n  }, selectedValue), /*#__PURE__*/React.createElement(\"ul\", null, values.map(function (value) {\n    return /*#__PURE__*/React.createElement(MultiThumbnailOption, {\n      onClick: onClickThumbnail,\n      value: value,\n      indexTypeOf: indexTypeOf,\n      selectedValue: selectedValue,\n      thumbnail: thumbnail\n    });\n  })));\n};\n\nvar MultiThumbnailOption = function MultiThumbnailOption(_ref4) {\n  var onClick = _ref4.onClick,\n      value = _ref4.value,\n      indexTypeOf = _ref4.indexTypeOf,\n      selectedValue = _ref4.selectedValue,\n      thumbnail = _ref4.thumbnail;\n  return /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"a\", {\n    href: \"#\",\n    onClick: onClick,\n    \"data-value\": value,\n    \"data-index-typeof\": indexTypeOf,\n    className: selectedValue === value ? \"selected\" : \"\"\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: \"/_ui/images/common/blank.gif\",\n    style: {\n      backgroundImage: \"url(\\\"\".concat(thumbnail[value], \"\\\")\")\n    },\n    alt: value\n  })));\n};\n\nexport var MultiButton = function MultiButton(props) {\n  var values = props.values,\n      name = props.name,\n      onClickMutliButton = props.onClickMutliButton,\n      indexTypeOf = props.indexTypeOf,\n      selectedValue = props.selectedValue;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"multi-option button\"\n  }, /*#__PURE__*/React.createElement(\"label\", null, name), /*#__PURE__*/React.createElement(\"ul\", null, values.map(function (value) {\n    return /*#__PURE__*/React.createElement(MultiButtonOption, {\n      onClick: onClickMutliButton,\n      indexTypeOf: indexTypeOf,\n      selectedValue: selectedValue,\n      value: value\n    });\n  })));\n};\n\nvar MultiButtonOption = function MultiButtonOption(props) {\n  var value = props.value,\n      onClick = props.onClick,\n      indexTypeOf = props.indexTypeOf,\n      selectedValue = props.selectedValue;\n  return /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: onClick,\n    className: selectedValue === value ? \"selected\" : \"\",\n    \"data-value\": value,\n    \"data-index-typeof\": indexTypeOf\n  }, value));\n};","import _extends from \"@babel/runtime/helpers/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from \"react\";\nimport classnames from \"classnames\";\nimport { floatFormatMinusTwo, numberFormat, renderPopup, escapeSelector, getLocationArgPairs } from \"fancyutils\";\nimport { Display } from \"fancymixin\";\nimport appState from \"../../../appstate\";\nimport { convertCurrency, updateSaleContext } from \"../../../action/action-helpers\";\nimport ActionButtons from \"../action-buttons\";\nimport { updateAppContext } from \"../../../action/actions\";\nimport { currencyIsUSD, getCurrentSaleOption, getSafeNameProp, getWaiting, isSalesOptionsAvailable, getSales, getDomesticDeliveryDate, getIntlDeliveryDate } from \"../../map\";\nimport { Keys } from \"../../Perf\";\nimport { CartButton, SelectBox, handlePurchase, MultiOption, MultiOptionState } from \"./Mixin\";\n\nfunction optionValueFunction(opt) {\n  return opt.id;\n}\n\nvar saleNamePrinter = function saleNamePrinter(opt) {\n  return \"\".concat(opt.name, \" - $\").concat(opt.price);\n};\n\nvar SaleItemSidebarHead = /*#__PURE__*/function (_Component) {\n  _inherits(SaleItemSidebarHead, _Component);\n\n  function SaleItemSidebarHead(props) {\n    var _this;\n\n    _classCallCheck(this, SaleItemSidebarHead);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SaleItemSidebarHead).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      loading: false,\n      selected: {},\n      disabled: []\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderCurrencyPopup\", function () {\n      import(\n      /* webpackChunkName: \"OverlayThing.popup\" */\n      \"../../popup/index\").then(function (_ref) {\n        var CurrencyPopup = _ref.CurrencyPopup;\n        renderPopup(CurrencyPopup, {\n          currentCurrency: _this.props.saleContext.currencyCode\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCurrencyPopup\", function (event) {\n      event.preventDefault();\n\n      _this.renderCurrencyPopup();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCurrencyPopupUSD\", function (event) {\n      event.preventDefault();\n\n      if (!currencyIsUSD(_this.props)) {\n        return false;\n      }\n\n      _this.renderCurrencyPopup();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getApproxText\", function () {\n      var _this$props$saleConte = _this.props.saleContext,\n          currencySymbol = _this$props$saleConte.currencySymbol,\n          currencyMoney = _this$props$saleConte.currencyMoney;\n      var approxText = gettext(\"Approximately\");\n      return \"\".concat(approxText, \" \").concat(currencySymbol).concat(currencyMoney, \" \");\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleOptionChange\", function (event) {\n      var dispatch = _this.props.dispatch;\n      var saleOptionID = parseInt(event.currentTarget.value, 10);\n      dispatch(updateSaleContext({\n        saleOptionID: saleOptionID\n      }));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleQuantityChange\", function (event) {\n      var dispatch = _this.props.dispatch;\n      var selectedQuantity = parseInt(event.currentTarget.value, 10);\n      dispatch(updateSaleContext({\n        selectedQuantity: selectedQuantity\n      }));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handlePersonalizationChange\", function (event) {\n      var dispatch = _this.props.dispatch;\n      var personalization = event.currentTarget.value;\n      dispatch(updateSaleContext({\n        personalization: personalization\n      }));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleNotifyLater\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      if (!appState.loggedIn) {\n        return window.require_login();\n      }\n\n      var _this$props = _this.props,\n          sales = _this$props.thing.sales,\n          saleContext = _this$props.saleContext;\n      var opt = getCurrentSaleOption(sales, saleContext, true);\n      var params = {\n        sale_item_id: sales.id\n      };\n\n      if (opt != null) {\n        params.option_id = opt.id;\n      }\n\n      var waiting = getWaiting(sales, saleContext);\n\n      if (waiting) {\n        params.remove = 1;\n      }\n\n      $.ajax({\n        type: \"post\",\n        url: \"/wait_for_product.json\",\n        data: params,\n        dataType: \"json\"\n      }).done(function (json) {\n        if (!json || json.status_code == null) {\n          return;\n        }\n\n        if (json.status_code == 0 && json.message) {\n          alertify.alert(json.message);\n          return;\n        }\n\n        var waiting = params.remove ? false : true;\n\n        _this.props.dispatch(updateSaleContext({\n          waiting: waiting\n        }));\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"checkApplePay\", function () {\n      if (window.FancyApplePay) {\n        var sales = _this.props.thing.sales;\n        var os = sales.options.filter(function (o) {\n          return !o.soldout;\n        });\n        var data = {\n          total: {\n            label: sales.title,\n            amount: sales.price * 100 | 0\n          }\n        };\n\n        if (os.length > 0) {\n          data.displayItems = os.map(function (o) {\n            return {\n              label: o.name,\n              amount: Number(o.price) * 100 | 0\n            };\n          });\n        }\n\n        FancyApplePay.checkAvailability(function (available, testmode) {\n          if (available) {\n            _this.props.dispatch(updateAppContext({\n              applePayDisplay: true,\n              applePayTest: testmode\n            }));\n          }\n        }, data);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"initializeMultiOption\", function () {\n      var _this$props2 = _this.props,\n          _this$props2$thing$sa = _this$props2.thing.sales,\n          options = _this$props2$thing$sa.options,\n          option_meta = _this$props2$thing$sa.option_meta,\n          saleContext = _this$props2.saleContext,\n          dispatch = _this$props2.dispatch;\n\n      _this.setState(_this.getInitialMultiOptionState(options, option_meta), function () {\n        // don't block selecting cheapest item\n        if (!(options && options.length > 1)) {\n          _this.updateSaleOptionIDFromMultiOptionState();\n        } // ?option={number} support\n\n\n        var presetOptionId = getLocationArgPairs(\"option\");\n\n        if (presetOptionId && presetOptionId[1] && String(saleContext.saleOptionID) !== presetOptionId[1]) {\n          dispatch(updateSaleContext({\n            saleOptionID: parseInt(presetOptionId[1], 10)\n          }));\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"extractSaleOptionIDFromMultiOptionState\", function (selected) {\n      var sales = _this.props.thing.sales;\n\n      if (selected == null) {\n        selected = _this.state.selected;\n      }\n\n      var multiOptionState = _this.state.multiOptionState;\n      var selectedOptionName = multiOptionState.option_meta.map(function (m) {\n        var order = multiOptionState.orderMap[m.type][m.name];\n\n        if (selected[m.type][order]) {\n          return selected[m.type][order].replace(\" / \", \"/\");\n        } else {\n          return selected[m.type][0];\n        }\n      }).join(\" / \");\n\n      var selectedOption = _.find(sales.options, function (opt) {\n        return opt.name === selectedOptionName;\n      });\n\n      if (selectedOption) {\n        return selectedOption.id;\n      } else {\n        window.DEBUG && console.warn(\"no option found for \", selectedOptionName, \"meta:\", sales.options, _this.state.selected);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"updateSaleOptionIDFromMultiOptionState\", function () {\n      var dispatch = _this.props.dispatch;\n\n      var saleOptionID = _this.extractSaleOptionIDFromMultiOptionState();\n\n      if (saleOptionID === undefined) {\n        var amendedID = _this.amendSaleOptionFromMultiOptionState();\n\n        if (amendedID) {\n          saleOptionID = amendedID;\n        } else {\n          window.DEBUG && console.warn(\"Couldn't recover option\");\n        }\n      }\n\n      dispatch(updateSaleContext({\n        saleOptionID: saleOptionID\n      }));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"amendSaleOptionFromMultiOptionState\", function () {\n      var _this$state = _this.state,\n          selected = _this$state.selected,\n          multiOptionState = _this$state.multiOptionState;\n      var nextSelected = {\n        swatch: [],\n        button: [],\n        thumbnail: [],\n        dropdown: []\n      };\n      multiOptionState.option_meta.forEach(function (_ref2, index) {\n        var type = _ref2.type,\n            name = _ref2.name;\n        var order = multiOptionState.orderMap[type][name];\n        var selectedValue = selected[type][order];\n\n        if (index === 0) {\n          nextSelected[type][order] = selectedValue;\n          return;\n        }\n\n        var values = multiOptionState.getPossibleValuesForIndex(selected, index);\n        var value;\n\n        if (values.some(function (v) {\n          return v === selectedValue;\n        })) {\n          value = selectedValue;\n        } else {\n          value = values[0];\n        }\n\n        selected[type][order] = value; // even though it will be flushed out, it will affect next options so fix it as well\n\n        nextSelected[type][order] = value;\n      });\n\n      _this.setState({\n        selected: nextSelected\n      });\n\n      return _this.extractSaleOptionIDFromMultiOptionState(nextSelected);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickMultiOptionGen\", function (type) {\n      return function (e) {\n        var el = e.currentTarget;\n        var value;\n        var indexOfType;\n\n        if (el.tagName === \"SELECT\") {\n          value = el.value;\n          indexOfType = Number($(el).find(\":selected\").attr(\"data-index-typeof\"));\n        } else {\n          value = $(el).attr(\"data-value\");\n          indexOfType = Number($(el).attr(\"data-index-typeof\"));\n        }\n\n        if (e.currentTarget.className === \"disabled\") {\n          return;\n        }\n\n        _this.state.selected[type][indexOfType] = value; // forceful trigger even though no differences in value.\n\n        _this.setState({\n          selected: _.extend({}, _this.state.selected)\n        }, _this.updateSaleOptionIDFromMultiOptionState);\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickThumbnail\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickSwatch\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"onMultiSelectBoxChange\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickMutliButton\", null);\n\n    _this.handlePurchase = handlePurchase.bind(_assertThisInitialized(_this)); // for multi options\n\n    _this.onClickThumbnail = _this.onClickMultiOptionGen(\"thumbnail\");\n    _this.onClickSwatch = _this.onClickMultiOptionGen(\"swatch\");\n    _this.onMultiSelectBoxChange = _this.onClickMultiOptionGen(\"dropdown\");\n    _this.onClickMutliButton = _this.onClickMultiOptionGen(\"button\");\n    return _this;\n  }\n\n  _createClass(SaleItemSidebarHead, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (!currencyIsUSD(this.props)) {\n        var saleContext = this.props.saleContext;\n        convertCurrency(saleContext.currencyCode, saleContext.price);\n      }\n\n      this.initializeMultiOption();\n      this.checkApplePay();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.thing.id !== this.props.thing.id) {\n        this.initializeMultiOption();\n        this.checkApplePay();\n        return;\n      }\n\n      var saleContext = prevProps.saleContext,\n          sales = prevProps.thing.sales;\n      var nsc = this.props.saleContext;\n      var nextSaleOptionID = nsc.saleOptionID;\n\n      if (saleContext.saleOptionID !== nextSaleOptionID) {\n        var o = _.find(sales.options, function (_o) {\n          return _o.id === nextSaleOptionID;\n        }); // option sync\n\n\n        if (o) {\n          var mos = $(\".sale-item-input .multi-option\");\n          o.values.forEach(function (v, i) {\n            var so = mos.eq(i).find(\"[data-value=\\\"\".concat(escapeSelector(v), \"\\\"]:not(.selected)\")).get(0);\n\n            if (so) {\n              so.click();\n            }\n          });\n\n          if (window.FancyApplePay && FancyApplePay.paymentRequest) {\n            FancyApplePay.paymentRequest.update({\n              total: {\n                label: o.name,\n                amount: Number(o.price) * 100 | 0\n              }\n            });\n          }\n        }\n      }\n    }\n  }, {\n    key: \"getInitialMultiOptionState\",\n    value: function getInitialMultiOptionState(options, option_meta) {\n      var selected = {\n        swatch: [],\n        button: [],\n        thumbnail: [],\n        dropdown: []\n      };\n\n      if (option_meta.length > 0) {\n        var nonSoldout = options.filter(function (o) {\n          return o.quantity !== 0;\n        });\n\n        if (nonSoldout.length !== 0) {\n          var selectedNonSoldoutOption = nonSoldout[0]; // temporary - FIXME\n\n          option_meta.forEach(function (opt, i) {\n            var type = opt.type;\n            var nextValue = selectedNonSoldoutOption.values[i];\n            selected[type].push(nextValue);\n          });\n        } else {\n          // set first available multi option\n          option_meta.forEach(function (opt) {\n            var type = opt.type;\n            var nextValue = opt.values[0];\n            selected[type].push(nextValue);\n          });\n        }\n      }\n\n      var multiOptionState = new MultiOptionState(options, option_meta);\n      return {\n        selected: selected,\n        multiOptionState: multiOptionState\n      };\n    }\n  }, {\n    key: \"UNSAFE_componentWillReceiveProps\",\n    value: function UNSAFE_componentWillReceiveProps(nextProps) {\n      var saleContext = this.props.saleContext;\n      var nsc = nextProps.saleContext;\n      var priceChanges = saleContext.price !== nsc.price;\n      var currencyChanges = saleContext.currencyCode !== nsc.currencyCode;\n\n      if (priceChanges || currencyChanges) {\n        if (!currencyIsUSD(nextProps)) {\n          var _saleContext = nextProps.saleContext;\n          convertCurrency(_saleContext.currencyCode, _saleContext.price, true); // FIXME: unable to comparison since price update comes first (SaleItemSidebarHead.componentWillReceiveProps())\n        }\n      }\n    }\n  }, {\n    key: \"isOptionMulti\",\n    value: function isOptionMulti() {\n      var sales = this.props.thing.sales; // sales.\n\n      if (sales.option_meta.length > 1) {\n        return true;\n      } else if (sales.option_meta.length === 1) {\n        return sales.option_meta[0].type !== \"dropdown\";\n      } else {\n        return false;\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props3 = this.props,\n          sales = _this$props3.thing.sales,\n          applePayDisplay = _this$props3.appContext.applePayDisplay,\n          saleContext = _this$props3.saleContext,\n          _this$props3$saleCont = _this$props3.saleContext,\n          currencyCode = _this$props3$saleCont.currencyCode,\n          currencySymbol = _this$props3$saleCont.currencySymbol,\n          currencyMoney = _this$props3$saleCont.currencyMoney,\n          selectedQuantity = _this$props3$saleCont.selectedQuantity,\n          price = _this$props3$saleCont.price;\n      var opt = getCurrentSaleOption(sales, saleContext);\n      var discountPercentage = parseFloat(opt.discount_percentage); // TODO: use decimal?\n\n      var retailPrice = opt.retail_price;\n      var soldout = opt.soldout,\n          quantity = opt.quantity,\n          remaining_quantity = opt.remaining_quantity;\n      var option_meta = sales.option_meta;\n      var optionIsMulti = this.isOptionMulti();\n      var salesOptionsAvailable = isSalesOptionsAvailable(sales);\n      var discounting = discountPercentage > 0;\n      var converted = currencySymbol != null && currencyMoney != null;\n      var currencyCodeStyle = {\n        display: converted && !currencyIsUSD(this.props) ? \"block\" : \"none\"\n      };\n      var quantitySelectRange = soldout ? [\"1\"] : _.range(1, Math.min(10, (quantity || remaining_quantity) + 1));\n      var showSelectbox = sales.options.length !== 0;\n      var cartButtonStyle;\n\n      if (!soldout) {\n        cartButtonStyle = {\n          display: \"none\"\n        };\n      }\n\n      var waiting = getWaiting(sales, saleContext);\n      var applePayButton;\n\n      if (applePayDisplay && !soldout) {\n        applePayButton = /*#__PURE__*/React.createElement(ApplePayButton, this.props);\n      }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        key: Keys.Sidebar.Wrap\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper figure-info\",\n        key: Keys.Sidebar.Body\n      }, /*#__PURE__*/React.createElement(\"h1\", _extends({\n        key: Keys.Sidebar.Title,\n        className: \"title\"\n      }, getSafeNameProp(sales))), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"price\",\n        key: Keys.Sidebar.Price\n      }, /*#__PURE__*/React.createElement(\"big\", {\n        className: classnames({\n          sale: discounting\n        })\n      }, \"$\", floatFormatMinusTwo(price), /*#__PURE__*/React.createElement(\"small\", {\n        className: \"usd\"\n      }, /*#__PURE__*/React.createElement(\"a\", {\n        className: classnames(\"code\", {\n          \"currently-usd\": currencyIsUSD(this.props)\n        }),\n        onClick: this.handleCurrencyPopupUSD\n      }, \"USD\"))), discounting && /*#__PURE__*/React.createElement(\"span\", {\n        className: \"sales\"\n      }, /*#__PURE__*/React.createElement(\"em\", null, \"$\", floatFormatMinusTwo(retailPrice, 2)), \" (Save\", \" \", numberFormat(discountPercentage, 0), \"%)\"), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"currency_price\",\n        style: currencyCodeStyle\n      }, this.getApproxText(), /*#__PURE__*/React.createElement(\"a\", {\n        className: \"code\",\n        onClick: this.handleCurrencyPopup\n      }, currencyCode))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"frm\",\n        key: Keys.Sidebar.Form\n      }, /*#__PURE__*/React.createElement(\"fieldset\", {\n        className: \"sale-item-input\"\n      }, showSelectbox && !optionIsMulti && /*#__PURE__*/React.createElement(SelectBox, {\n        id: \"option\",\n        label: gettext(\"Option\"),\n        currentValue: opt,\n        value: optionValueFunction,\n        printer: saleNamePrinter,\n        options: sales.options,\n        expander: SaleItemOptionsExpander,\n        disabled: !salesOptionsAvailable,\n        onChange: this.handleOptionChange,\n        handleSizeGuidePopup: this.handleSizeGuidePopup\n      }), showSelectbox && !optionIsMulti && /*#__PURE__*/React.createElement(SelectBox, {\n        id: \"quantity\",\n        label: gettext(\"Quantity\"),\n        defaultValue: \"1\",\n        currentValue: selectedQuantity,\n        options: quantitySelectRange,\n        disabled: !!soldout,\n        onChange: this.handleQuantityChange\n      }), optionIsMulti && /*#__PURE__*/React.createElement(MultiOption, {\n        sid: sales.id,\n        onClickThumbnail: this.onClickThumbnail,\n        onClickSwatch: this.onClickSwatch,\n        onMultiSelectBoxChange: this.onMultiSelectBoxChange,\n        onClickMutliButton: this.onClickMutliButton,\n        selected: this.state.selected,\n        disabled: this.state.disabled,\n        soldout: !!soldout,\n        option_meta: option_meta,\n        multiOptionState: this.state.multiOptionState\n      }), sales.personalizable && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"personalization\"\n      }, /*#__PURE__*/React.createElement(\"label\", null, \"This item can be personalized\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"text\",\n        name: \"personalization\",\n        placeholder: \"Personalization details\",\n        onChange: this.handlePersonalizationChange\n      })), applePayButton, /*#__PURE__*/React.createElement(CartButton, {\n        onClick: this.handlePurchase,\n        className: classnames(\"add_to_cart btn-cart\", {\n          \"btns-blue-embo disabled\": soldout,\n          \"btns-green-embo\": !soldout\n        }),\n        disabled: !!soldout,\n        label: soldout ? gettext(\"Sold out\") : gettext(\"Add to cart\")\n      })), /*#__PURE__*/React.createElement(CartButton, {\n        className: classnames(\"btn-create notify-available\", {\n          subscribed: waiting\n        }),\n        label: waiting ? gettext(\"Subscribed\") : gettext(\"Notify me when available\"),\n        style: cartButtonStyle,\n        onClick: this.handleNotifyLater\n      }), /*#__PURE__*/React.createElement(SalesOverview, this.props), /*#__PURE__*/React.createElement(ActionButtons, this.props))));\n    }\n  }]);\n\n  return SaleItemSidebarHead;\n}(Component);\n\nexport { SaleItemSidebarHead as default };\n\nfunction SaleItemOptionsExpander(sio, idx) {\n  return /*#__PURE__*/React.createElement(\"option\", {\n    value: sio.id,\n    key: \"sale_options-\".concat(idx)\n  }, sio.soldout === true || !(sio.quantity > 0) ? \"\".concat(sio.name, \" - \").concat(gettext(\"Sold out\")) : sio.name);\n}\n\nvar ApplePayButton = /*#__PURE__*/function (_Component2) {\n  _inherits(ApplePayButton, _Component2);\n\n  function ApplePayButton() {\n    var _getPrototypeOf2;\n\n    var _this2;\n\n    _classCallCheck(this, ApplePayButton);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this2 = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ApplePayButton)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this2), \"handleApplePayCheckout\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      if (window.FancyApplePay.clicked) {\n        return;\n      }\n\n      window.FancyApplePay.clicked = true;\n      var applePayTest = _this2.props.appContext.applePayTest;\n      var _this2$props = _this2.props,\n          sales = _this2$props.thing.sales,\n          _this2$props$saleCont = _this2$props.saleContext,\n          saleOptionID = _this2$props$saleCont.saleOptionID,\n          selectedQuantity = _this2$props$saleCont.selectedQuantity,\n          price = _this2$props$saleCont.price;\n      var salesOptionsAvailable = isSalesOptionsAvailable(sales);\n      var title = sales.title;\n      var country = sales.seller.country;\n      var sale_item_id = sales.id;\n      var seller_id = sales.seller.id;\n      var quantity = selectedQuantity;\n      var option_id = null;\n      var option = null;\n\n      if (salesOptionsAvailable) {\n        option_id = parseInt(saleOptionID, 10) || null; // ? should be same value with option except get casted\n\n        option = saleOptionID;\n      }\n\n      try {\n        window.FancyApplePay.requestPurchase(\"Dynamic\", {\n          sale_item_id: sale_item_id,\n          seller_id: seller_id,\n          option_id: option_id,\n          quantity: quantity,\n          price: price,\n          title: title,\n          option: option,\n          country: country,\n          testmode: applePayTest\n        });\n      } catch (err) {\n        window.DEBUG && console.trace(err);\n        alert(err);\n        window.FancyApplePay.clicked = false;\n      }\n    });\n\n    return _this2;\n  }\n\n  _createClass(ApplePayButton, [{\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"apple-pay-button apple-pay-thing-button apple-pay-button-with-text apple-pay-button-black-with-text checkout-express\",\n        onClick: this.handleApplePayCheckout\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"text\"\n      }, \"Buy With\"), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"logo\"\n      }));\n    }\n  }]);\n\n  return ApplePayButton;\n}(Component);\n\nexport var SalesOverview = /*#__PURE__*/function (_Component3) {\n  _inherits(SalesOverview, _Component3);\n\n  function SalesOverview() {\n    var _getPrototypeOf3;\n\n    var _this3;\n\n    _classCallCheck(this, SalesOverview);\n\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    _this3 = _possibleConstructorReturn(this, (_getPrototypeOf3 = _getPrototypeOf(SalesOverview)).call.apply(_getPrototypeOf3, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this3), \"handleShipCountryClick\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n      var _this3$props = _this3.props,\n          userCountry = _this3$props.appContext.userCountry,\n          dispatch = _this3$props.dispatch;\n      import(\n      /* webpackChunkName: \"OverlayThing.popup\" */\n      \"../../popup/index\").then(function (_ref3) {\n        var ShippingCountriesPopup = _ref3.ShippingCountriesPopup;\n        renderPopup(ShippingCountriesPopup, {\n          dispatch: dispatch,\n          userCountry: userCountry\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this3), \"handlePolicyDislplay\", function (event) {\n      event.preventDefault();\n      var sales = _this3.props.thing.sales;\n\n      if (sales) {\n        import(\n        /* webpackChunkName: \"OverlayThing.popup\" */\n        \"../../popup/index\").then(function (_ref4) {\n          var ReturnPolicyDetailPopup = _ref4.ReturnPolicyDetailPopup;\n          renderPopup(ReturnPolicyDetailPopup, {\n            sales: sales\n          });\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this3), \"handleSizeGuidePopup\", function (event) {\n      event.preventDefault();\n      import(\n      /* webpackChunkName: \"OverlayThing.popup\" */\n      \"../../popup/index\").then(function (_ref5) {\n        var SizeGuidePopup = _ref5.SizeGuidePopup;\n        renderPopup(SizeGuidePopup, _this3.props);\n      });\n    });\n\n    return _this3;\n  }\n\n  _createClass(SalesOverview, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props4 = this.props,\n          userCountry = _this$props4.appContext.userCountry,\n          thing = _this$props4.thing,\n          type = _this$props4.type;\n      var sales = getSales(type, thing);\n      var hasSizeGuide = sales.size_guide_id != null;\n      /*|| (sales.size_chart_ids && sales.size_chart_ids.length)*/\n\n      var deliveryIsDomestic = sales && userCountry === \"US\";\n      var ableToShip = deliveryIsDomestic && sales.expected_delivery_day_1 || userCountry !== \"US\" && sales.international_shipping;\n      var hideShippingWindow = deliveryIsDomestic && !sales.expected_delivery_day_1;\n      var deliveryDate;\n\n      if (ableToShip) {\n        if (deliveryIsDomestic) {\n          deliveryDate = getDomesticDeliveryDate(sales);\n        } else {\n          deliveryDate = getIntlDeliveryDate(sales);\n        }\n      }\n\n      var shippingInfo = sales.shipping_info || {};\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"overview\"\n      }, /*#__PURE__*/React.createElement(\"label\", null, \"Overview\"), /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"after\"\n      }, shippingInfo.cost && /*#__PURE__*/React.createElement(\"li\", {\n        className: \"tips\"\n      }, shippingInfo.cost), /*#__PURE__*/React.createElement(\"li\", {\n        className: \"\".concat(deliveryIsDomestic ? \"domestic\" : \"international\", \" shipping\"),\n        style: Display.NoneIf(hideShippingWindow)\n      }, /*#__PURE__*/React.createElement(\"label\", null, deliveryDate ? gettext(\"Estimated Delivery\") : gettext(\"Delivery\")), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"able\"\n      }, shippingInfo.window)), shippingInfo.origin && /*#__PURE__*/React.createElement(\"li\", {\n        className: \"shipping\"\n      }, /*#__PURE__*/React.createElement(\"span\", null, shippingInfo.origin)), sales.return_exchange_policy_title && /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"label\", null, gettext(\"Return policy\")), /*#__PURE__*/React.createElement(\"span\", null, sales.return_exchange_policy_title + \". \", /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handlePolicyDislplay\n      }, gettext(\"View details\")))), hasSizeGuide && /*#__PURE__*/React.createElement(\"li\", {\n        className: \"sizeguide\"\n      }, /*#__PURE__*/React.createElement(\"a\", {\n        href: \"#\",\n        onClick: this.handleSizeGuidePopup\n      }, \"View size guide\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"description\"\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: classnames(\"detail show\")\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        className: \"tit\"\n      }, gettext(\"Description\")), /*#__PURE__*/React.createElement(\"div\", {\n        dangerouslySetInnerHTML: {\n          __html: sales.description\n        }\n      }))));\n    }\n  }]);\n\n  return SalesOverview;\n}(Component);","import _extends from \"@babel/runtime/helpers/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport React, { Component, lazy, Suspense } from \"react\";\nimport SaleItem from \"./SaleItem\";\n\nvar SidebarHead = /*#__PURE__*/function (_Component) {\n  _inherits(SidebarHead, _Component);\n\n  function SidebarHead() {\n    _classCallCheck(this, SidebarHead);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(SidebarHead).apply(this, arguments));\n  }\n\n  _createClass(SidebarHead, [{\n    key: \"getHead\",\n    value: function getHead(META) {\n      if (META.type === \"SaleItem\") {\n        return SaleItem;\n      } else {\n        if (META.type === \"PlainThing\") {\n          return /*#__PURE__*/lazy(function () {\n            return import(\n            /* webpackChunkName: \"OverlayThing.extras\" */\n            \"./PlainThing\");\n          });\n        } else if (META.type === \"Giftcard\") {\n          return /*#__PURE__*/lazy(function () {\n            return import(\n            /* webpackChunkName: \"OverlayThing.extras\" */\n            \"./Giftcard\");\n          });\n        } else if (META.type === \"Vanity\") {\n          return /*#__PURE__*/lazy(function () {\n            return import(\n            /* webpackChunkName: \"OverlayThing.extras\" */\n            \"./Vanity\");\n          });\n        } else if (META.type === \"Hotel\") {\n          return /*#__PURE__*/lazy(function () {\n            return import(\n            /* webpackChunkName: \"OverlayThing.extras\" */\n            \"./Hotel\");\n          });\n        } else if (META.type === \"LaunchApp\") {\n          return /*#__PURE__*/lazy(function () {\n            return import(\n            /* webpackChunkName: \"OverlayThing.extras\" */\n            \"./LaunchApp\");\n          });\n        }\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          META = _this$props.thing.META,\n          viewer = _this$props.appContext.viewer;\n\n      if (!viewer.is_admin_any && META.type === 'PlainThing') {\n        location.href = '/';\n        return null;\n      }\n\n      var Head = this.getHead(META);\n\n      if (META.type === \"SaleItem\") {\n        return /*#__PURE__*/React.createElement(Head, _extends({}, this.props, {\n          fallback: /*#__PURE__*/React.createElement(\"div\", {\n            className: \"wrapper figure-info\"\n          })\n        }));\n      } else {\n        return /*#__PURE__*/React.createElement(Suspense, {\n          fallback: /*#__PURE__*/React.createElement(\"div\", null)\n        }, /*#__PURE__*/React.createElement(Head, _extends({}, this.props, {\n          fallback: /*#__PURE__*/React.createElement(\"div\", {\n            className: \"wrapper figure-info\"\n          })\n        })));\n      }\n    }\n  }]);\n\n  return SidebarHead;\n}(Component);\n\nexport { SidebarHead as default };","import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from \"react\";\nimport classnames from \"classnames\";\nimport { isEmpty, cdnUtils, didClickOn, renderPopup, getConciseNumberString } from \"fancyutils\";\nimport { BGImage, Display } from \"fancymixin\";\nimport appState from \"../../appstate\";\nimport { toggleFollow } from \"../../action/action-helpers\";\nimport SidebarHead from \"./heads/index\";\nexport var Sidebar = /*#__PURE__*/function (_Component) {\n  _inherits(Sidebar, _Component);\n\n  function Sidebar(props) {\n    var _this;\n\n    _classCallCheck(this, Sidebar);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Sidebar).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleRequestSaleOpen\", function (event) {\n      event.preventDefault();\n      var thing = _this.props.thing;\n      import(\n      /* webpackChunkName: \"OverlayThing.popup\" */\n      \"../popup/index\").then(function (_ref) {\n        var RequestSalePopup = _ref.RequestSalePopup;\n        renderPopup(RequestSalePopup, {\n          thing: thing\n        });\n      });\n      return false;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleReport\", function (event) {\n      event.preventDefault();\n\n      if (!appState.loggedIn) {\n        window.require_login();\n        return;\n      }\n\n      var self = _assertThisInitialized(_this);\n\n      if (self.state.reported) {\n        window.alertify.confirm(window.gettext(\"Cancel Report this?\"), function (e) {\n          if (e) {\n            $.ajax({\n              type: \"post\",\n              url: \"/cancel_report_thing.xml\",\n              data: {\n                tid: self.props.thing.id\n              },\n              dataType: \"xml\",\n              success: function success(xml) {\n                var $xml = $(xml);\n                var $st = $xml.find(\"status_code\");\n\n                if ($st.length && $st.text() === \"1\") {\n                  window.alertify.alert(window.gettext(\"Cancelled your report.\"));\n                  self.setState({\n                    reported: false\n                  });\n                }\n              }\n            });\n          }\n        });\n      } else {\n        window.alertify.confirm(window.gettext(\"Report this as inappropriate or broken?\"), function (e) {\n          if (e) {\n            $.ajax({\n              type: \"post\",\n              url: \"/report_thing.xml\",\n              data: {\n                tid: self.props.thing.id\n              },\n              dataType: \"xml\",\n              success: function success(xml) {\n                var $xml = $(xml);\n                var $st = $xml.find(\"status_code\");\n\n                if ($st.length && $st.text() === \"1\") {\n                  window.alertify.alert(window.gettext(\"Reported. We'll look into it.\"));\n                  self.setState({\n                    reported: true\n                  });\n                }\n              }\n            });\n          }\n        });\n      }\n    });\n\n    _this.state = {\n      reported: props.thing.reported_by_viewer,\n      showQuestion: false\n    };\n    return _this;\n  }\n\n  _createClass(Sidebar, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var nextProps = this.props;\n\n      if (nextProps.thing.id !== prevProps.thing.id) {\n        this.setState({\n          reported: nextProps.thing.reported_by_viewer\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          thing = _this$props.thing,\n          _this$props$thing = _this$props.thing,\n          META = _this$props$thing.META,\n          from_list = _this$props$thing.from_list,\n          sales = _this$props$thing.sales,\n          sales_available = _this$props$thing.sales_available; // Should we display 'Request for sale' button?\n\n      var requestSale = !(sales_available || META.Giftcard || META.Hotel || META.LaunchApp); // Should we show merchant information?\n\n      var sidebarMerchantInfo;\n\n      if (sales_available && sales.seller.is_seller && thing.type !== \"fancybox\" && thing.type !== \"vanity_number\") {\n        sidebarMerchantInfo = /*#__PURE__*/React.createElement(SidebarMerchantInfo, this.props);\n      }\n\n      var reported = appState.loggedIn && this.state.reported;\n      var reportLabel = reported ? gettext(\"Undo Reporting\") : gettext(\"Report as inappropriate\");\n      return /*#__PURE__*/React.createElement(\"aside\", {\n        className: \"sidebar\"\n      }, /*#__PURE__*/React.createElement(SidebarHead, this.props), sidebarMerchantInfo, thing && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"flagged\"\n      }, requestSale && /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handleRequestSaleOpen\n      }, gettext(\"Request for sale\")), /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handleReport,\n        className: classnames(\"report-link\", {\n          reported: reported\n        })\n      }, reportLabel)));\n    }\n  }]);\n\n  return Sidebar;\n}(Component);\n\nvar SidebarMerchantInfo = /*#__PURE__*/function (_Component2) {\n  _inherits(SidebarMerchantInfo, _Component2);\n\n  function SidebarMerchantInfo() {\n    var _getPrototypeOf2;\n\n    var _this2;\n\n    _classCallCheck(this, SidebarMerchantInfo);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this2 = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(SidebarMerchantInfo)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this2), \"handleFollowToggle\", function (event) {\n      event.preventDefault();\n\n      if (!appState.loggedIn) {\n        return window.require_login();\n      }\n\n      var _this2$props = _this2.props,\n          sales = _this2$props.thing.sales,\n          dispatch = _this2$props.dispatch;\n      dispatch(toggleFollow({\n        seller_id: sales.seller.id\n      }));\n    });\n\n    return _this2;\n  }\n\n  _createClass(SidebarMerchantInfo, [{\n    key: \"isFollowingStore\",\n    value: function isFollowingStore(sales, followContext) {\n      var precondition = sales.seller.id !== appState.viewer.id && sales.seller.profile_is_private !== 1;\n      var following = followContext.followStore.following === true;\n      return precondition && following;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          viewer = _this$props2.appContext.viewer,\n          thing = _this$props2.thing,\n          _this$props2$thing = _this$props2.thing,\n          sales = _this$props2$thing.sales,\n          popular_seller_saleitems = _this$props2$thing.sales.popular_seller_saleitems,\n          followContext = _this$props2.followContext;\n      var following = this.isFollowingStore(sales, followContext);\n      var sellerImageAttrs = {}; // FIXME: check serialization\n\n      if (sales.saleitem_seller && sales.saleitem_seller.logo_type) {\n        if (sales.saleitem_seller.logo_type.indexOf(\"resize-ec.thefancy.com/letters\") == -1) {\n          sellerImageAttrs.url = cdnUtils.resizedSchemelessImage(sales.saleitem_seller.logo_type, 360, \"crop\");\n        } else {\n          sellerImageAttrs.url = sales.saleitem_seller.logo_type.replace(/letters\\/[0-9]+\\//, \"letters/360/\");\n        }\n\n        sellerImageAttrs.schemeless = true;\n        sellerImageAttrs.alt = \"\".concat(sales.seller.brand_name, \" logo image\");\n      }\n\n      var pops = _.uniq(popular_seller_saleitems, false, function (e) {\n        return e.thing_id;\n      }).filter(function (_, idx) {\n        return idx < 4;\n      }); // fill blanks\n\n\n      while (pops.length < 4) {\n        pops.push(null);\n      }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: classnames(\"wrapper from thing-more merchant-info\", {\n          loading: thing.loading\n        })\n      }, __Config.nostore ? /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          display: \"flex\"\n        }\n      }, /*#__PURE__*/React.createElement(\"h3\", {\n        className: \"tit\"\n      }, gettext(\"You may also like\")), /*#__PURE__*/React.createElement(\"h3\", {\n        className: \"tit\",\n        style: {\n          position: \"absolute\",\n          right: 0,\n          fontSize: \"14px\",\n          textDecoration: \"underline\"\n        }\n      }, /*#__PURE__*/React.createElement(\"a\", {\n        href: \"/shop/\".concat(sales.seller.username),\n        style: {\n          color: \"#373d48\"\n        }\n      }, gettext(\"See more\")))) : /*#__PURE__*/React.createElement(\"a\", {\n        href: \"/shop/\".concat(sales.seller.username),\n        className: \"tit\"\n      }, /*#__PURE__*/React.createElement(BGImage, sellerImageAttrs), /*#__PURE__*/React.createElement(\"small\", null, gettext(\"More from\")), /*#__PURE__*/React.createElement(\"b\", null, sales.discount_percentage > 0 && sales.seller.id === 616001 ? \"Fancy Sales\" : sales.seller.brand_name)), !isEmpty(popular_seller_saleitems) && /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"after\"\n      }, pops.map(function (si, idx) {\n        return /*#__PURE__*/React.createElement(\"li\", {\n          key: \"popular_seller_saleitems-\".concat(idx)\n        }, /*#__PURE__*/React.createElement(\"a\", {\n          \"data-idx\": idx,\n          className: \"figure-img\",\n          rel: si ? \"thing-\".concat(si.thing_id) : \"thing\",\n          href: si ? si.html_url : \"#\",\n          onClick: si ? null : function (e) {\n            e.preventDefault();\n          }\n        }, /*#__PURE__*/React.createElement(\"span\", {\n          className: \"price\",\n          style: si ? {\n            backgroundImage: \"url(\".concat(cdnUtils.resizedSchemelessImage(si.image, 160, \"crop\"), \")\")\n          } : null\n        })));\n      })), !__Config.nostore && /*#__PURE__*/React.createElement(\"button\", {\n        className: classnames(\"btns-gray-embo\", following ? \"following\" : \"follow\"),\n        onClick: this.handleFollowToggle,\n        style: Display.NoneIf(viewer.id === sales.seller.id)\n      }, following ? gettext(\"Following\") : gettext(\"Follow\"), /*#__PURE__*/React.createElement(\"small\", null, getConciseNumberString(sales.seller.seller_followed_count || 0))), /*#__PURE__*/React.createElement(AskQuestionPopover, this.props));\n    }\n  }]);\n\n  return SidebarMerchantInfo;\n}(Component);\n\nvar AskQuestionPopover = /*#__PURE__*/function (_Component3) {\n  _inherits(AskQuestionPopover, _Component3);\n\n  function AskQuestionPopover() {\n    var _getPrototypeOf3;\n\n    var _this3;\n\n    _classCallCheck(this, AskQuestionPopover);\n\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    _this3 = _possibleConstructorReturn(this, (_getPrototypeOf3 = _getPrototypeOf(AskQuestionPopover)).call.apply(_getPrototypeOf3, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this3), \"state\", {\n      sending: false,\n      showQuestion: false,\n      showQuestionSuccess: false,\n      questionFile: null,\n      questionFileValue: \"\",\n      question: \"\",\n      threadUrl: \"\"\n    });\n\n    _defineProperty(_assertThisInitialized(_this3), \"handleQuestionClose\", function (e) {\n      if (e) {\n        e.preventDefault();\n      }\n\n      _this3.setState({\n        sending: false,\n        showQuestion: false,\n        showQuestionSuccess: false,\n        questionFile: null,\n        questionFileValue: \"\",\n        question: \"\",\n        threadUrl: \"\"\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this3), \"handleQuestionFileChange\", function (e) {\n      var questionFile, questionFileValue;\n\n      if (e.target.files) {\n        questionFile = e.target.files[0];\n        questionFileValue = e.target.value;\n      } else {\n        questionFile = null;\n      }\n\n      _this3.setState({\n        questionFile: questionFile,\n        questionFileValue: questionFileValue\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this3), \"handleQuestionFileDelete\", function (e) {\n      e.preventDefault();\n\n      _this3.setState({\n        questionFile: null\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this3), \"handleQuestionChange\", function (event) {\n      _this3.setState({\n        question: event.target.value\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this3), \"handleQuestionFileSend\", function () {\n      var _this3$state = _this3.state,\n          sending = _this3$state.sending,\n          question = _this3$state.question,\n          questionFile = _this3$state.questionFile;\n      var _this3$props = _this3.props,\n          thing = _this3$props.thing,\n          sales = _this3$props.thing.sales;\n\n      if (sending) {\n        return;\n      }\n\n      if (appState.loggedIn !== true) {\n        window.require_login();\n        return;\n      }\n\n      if ($.trim(question).length > 2048) {\n        window.alertify.alert(\"Sorry, message is too long. Please write less than 2048 characters.\");\n        return;\n      }\n\n      _this3.setState({\n        sending: true\n      }, function () {\n        var formData = new window.FormData();\n        formData.append(\"seller_id\", sales.seller.id);\n        formData.append(\"things\", thing.id);\n        formData.append(\"message\", question);\n        formData.append(\"attachments\", questionFile);\n        $.ajax({\n          url: \"/messages/send-message.json\",\n          processData: false,\n          contentType: false,\n          type: \"POST\",\n          data: formData\n        }).done(function (res) {\n          if (!res.status_code) {\n            window.alertify.alert(res.message || \"Sorry, we couldn't send your message right now. Please try again later.\");\n          } else {\n            _this3.setState({\n              showQuestionSuccess: true,\n              threadUrl: res.thread.url\n            });\n          }\n        }).fail(function () {\n          window.alertify.alert(\"Failed to send question. Please try again\");\n        }).always(function () {\n          _this3.setState({\n            sending: false\n          });\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this3), \"handleAsking\", function () {\n      _this3.setState({\n        showQuestion: true\n      }, function () {\n        $(\"#overlay-thing\").on(\"click.showQuestion\", function (event) {\n          if (!didClickOn($(event.target), \".ask_seller\") && !didClickOn($(event.target), \".ask\")) {\n            $(\"#overlay-thing\").off(\"click.showQuestion\");\n\n            _this3.setState({\n              showQuestion: false\n            });\n\n            return false;\n          }\n        }); // due to preact behavior, need timeout. otherwise close popup right after opening\n      });\n\n      return false;\n    });\n\n    return _this3;\n  }\n\n  _createClass(AskQuestionPopover, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var nextProps = this.props;\n\n      if (nextProps.thing.id !== prevProps.thing.id) {\n        this.handleQuestionClose();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var sales = this.props.thing.sales;\n      var _this$state = this.state,\n          showQuestion = _this$state.showQuestion,\n          showQuestionSuccess = _this$state.showQuestionSuccess,\n          questionFile = _this$state.questionFile,\n          sending = _this$state.sending,\n          threadUrl = _this$state.threadUrl;\n      var sellerImageAttrs = {}; // FIXME: check serialization\n\n      if (sales.saleitem_seller && sales.saleitem_seller.logo_type) {\n        sellerImageAttrs.url = cdnUtils.resizedSchemelessImage(sales.saleitem_seller.logo_type, 80, \"crop\");\n        sellerImageAttrs.schemeless = true;\n        sellerImageAttrs.alt = \"\".concat(sales.seller.brand_name, \" logo image\");\n      }\n\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"a\", {\n        className: \"ask\",\n        onClick: this.handleAsking\n      }, gettext(\"Ask a Question\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"ask_seller\",\n        style: Display.NoneIf(!showQuestion)\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        className: \"title\"\n      }, /*#__PURE__*/React.createElement(BGImage, sellerImageAttrs), \" \", sales.seller.brand_name), /*#__PURE__*/React.createElement(\"fieldset\", null, /*#__PURE__*/React.createElement(\"p\", null, /*#__PURE__*/React.createElement(\"textarea\", {\n        className: \"text\",\n        placeholder: \"Ask a question about \".concat(sales.title),\n        onChange: this.handleQuestionChange\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"file\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"uploader\",\n        style: Display.NoneIf(questionFile)\n      }, \"Add Attachment\", /*#__PURE__*/React.createElement(\"input\", {\n        type: \"file\",\n        onClick: this.handleQuestionAddFile,\n        onChange: this.handleQuestionFileChange,\n        value: this.state.questionFileValue,\n        accept: \"image/*\"\n      })), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"uploaded\",\n        style: Display.BlockIf(questionFile)\n      }, questionFile ? questionFile.name : \"\", /*#__PURE__*/React.createElement(\"a\", {\n        href: \"#\",\n        className: \"delete\",\n        onClick: this.handleQuestionFileDelete\n      }))), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btns-blue-embo _send\",\n        onClick: this.handleQuestionFileSend,\n        disabled: sending\n      }, \"Send\")), /*#__PURE__*/React.createElement(\"a\", {\n        href: \"#\",\n        className: \"close\",\n        onClick: this.handleQuestionClose\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"success\",\n        style: Display.BlockIf(showQuestion && showQuestionSuccess)\n      }, /*#__PURE__*/React.createElement(\"p\", null, \"Message sent \", /*#__PURE__*/React.createElement(\"a\", {\n        href: threadUrl\n      }, \"View message\")), /*#__PURE__*/React.createElement(\"a\", {\n        href: \"#\",\n        className: \"close\",\n        onClick: this.handleQuestionClose\n      }, \"Close\"))));\n    }\n  }]);\n\n  return AskQuestionPopover;\n}(Component);","import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nvar _Countries;\n\nexport var Countries = (_Countries = {\n  'AE': 'United Arab Emirates',\n  'AF': 'Afghanistan',\n  'AG': 'Antigua And Barbuda',\n  'AI': 'Anguilla',\n  'AL': 'Albania',\n  'AM': 'Armenia',\n  'AN': 'Netherlands Antilles',\n  'AO': 'Angola',\n  'AQ': 'Antarctica',\n  'AR': 'Argentina',\n  'AS': 'American Samoa',\n  'AT': 'Austria',\n  'AU': 'Australia',\n  'AW': 'Aruba',\n  'AX': 'Aaland Islands',\n  'AZ': 'Azerbaijan',\n  'BA': 'Bosnia And Herzegowina',\n  'BB': 'Barbados',\n  'BD': 'Bangladesh',\n  'BE': 'Belgium',\n  'BF': 'Burkina Faso',\n  'BG': 'Bulgaria',\n  'BH': 'Bahrain',\n  'BI': 'Burundi',\n  'BJ': 'Benin',\n  'BM': 'Bermuda',\n  'BN': 'Brunei Darussalam',\n  'BO': 'Bolivia',\n  'BR': 'Brazil',\n  'BS': 'Bahamas',\n  'BT': 'Bhutan',\n  'BV': 'Bouvet Island',\n  'BW': 'Botswana',\n  'BY': 'Belarus',\n  'BZ': 'Belize',\n  'CA': 'Canada',\n  'CC': 'Cocos (keeling) Islands',\n  'CD': 'Congo, Democratic Republic Of (was Zaire)',\n  'CF': 'Central African Republic',\n  'CG': 'Congo, Republic Of',\n  'CH': 'Switzerland',\n  'CI': \"Cote D'ivoire\",\n  'CK': 'Cook Islands',\n  'CL': 'Chile',\n  'CM': 'Cameroon',\n  'CN': 'China',\n  'CO': 'Colombia',\n  'CR': 'Costa Rica',\n  'CU': 'Cuba',\n  'CV': 'Cape Verde',\n  'CX': 'Christmas Island',\n  'CY': 'Cyprus',\n  'CZ': 'Czech Republic',\n  'DE': 'Germany',\n  'DJ': 'Djibouti',\n  'DK': 'Denmark',\n  'DM': 'Dominica',\n  'DO': 'Dominican Republic',\n  'DZ': 'Algeria',\n  'EC': 'Ecuador',\n  'EE': 'Estonia',\n  'EG': 'Egypt',\n  'EH': 'Western Sahara',\n  'ES': 'Spain',\n  'ET': 'Ethiopia',\n  'FI': 'Finland',\n  'FJ': 'Fiji',\n  'FK': 'Falkland Islands (malvinas)',\n  'FM': 'Micronesia, Federated States Of',\n  'FO': 'Faroe Islands',\n  'FR': 'France',\n  'GA': 'Gabon',\n  'GB': 'United Kingdom',\n  'GD': 'Grenada',\n  'GE': 'Georgia',\n  'GF': 'French Guiana',\n  'GH': 'Ghana',\n  'GI': 'Gibraltar',\n  'GL': 'Greenland',\n  'GM': 'Gambia',\n  'GN': 'Guinea',\n  'GP': 'Guadeloupe',\n  'GQ': 'Equatorial Guinea',\n  'GR': 'Greece',\n  'GS': 'South Georgia And The South Sandwich Islands',\n  'GT': 'Guatemala',\n  'GU': 'Guam',\n  'GW': 'Guinea-bissau',\n  'GY': 'Guyana',\n  'HK': 'Hong Kong',\n  'HM': 'Heard And Mc Donald Islands',\n  'HN': 'Honduras',\n  'HR': 'Croatia (local Name: Hrvatska)',\n  'HT': 'Haiti',\n  'HU': 'Hungary',\n  'ID': 'Indonesia',\n  'IE': 'Ireland',\n  'IL': 'Israel',\n  'IN': 'India',\n  'IO': 'British Indian Ocean Territory',\n  'IQ': 'Iraq',\n  'IR': 'Iran (islamic Republic Of)',\n  'IS': 'Iceland',\n  'IT': 'Italy',\n  'JM': 'Jamaica',\n  'JO': 'Jordan',\n  'JP': 'Japan',\n  'KE': 'Kenya',\n  'KG': 'Kyrgyzstan',\n  'KH': 'Cambodia',\n  'KI': 'Kiribati',\n  'KM': 'Comoros',\n  'KN': 'Saint Kitts And Nevis',\n  'KP': 'Korea, North',\n  'KR': 'Korea, Republic Of',\n  'KW': 'Kuwait',\n  'KY': 'Cayman Islands',\n  'KZ': 'Kazakhstan',\n  'LA': \"Lao People's Democratic Republic\",\n  'LB': 'Lebanon',\n  'LC': 'Saint Lucia',\n  'LI': 'Liechtenstein',\n  'LK': 'Sri Lanka',\n  'LR': 'Liberia',\n  'LS': 'Lesotho',\n  'LT': 'Lithuania',\n  'LU': 'Luxembourg',\n  'LV': 'Latvia',\n  'LY': 'Libyan Arab Jamahiriya',\n  'MA': 'Morocco',\n  'MC': 'Monaco',\n  'MD': 'Moldova, Republic Of',\n  'ME': 'Montenegro',\n  'MG': 'Madagascar',\n  'MH': 'Marshall Islands',\n  'MK': 'Macedonia, The Former Yugoslav Republic Of',\n  'ML': 'Mali',\n  'MM': 'Myanmar',\n  'MN': 'Mongolia',\n  'MO': 'Macau',\n  'MP': 'Northern Mariana Islands',\n  'MQ': 'Martinique',\n  'MR': 'Mauritania',\n  'MS': 'Montserrat',\n  'MT': 'Malta',\n  'MU': 'Mauritius',\n  'MV': 'Maldives',\n  'MW': 'Malawi',\n  'MX': 'Mexico',\n  'MY': 'Malaysia',\n  'MZ': 'Mozambique',\n  'NA': 'Namibia',\n  'NC': 'New Caledonia',\n  'NE': 'Niger',\n  'NF': 'Norfolk Island',\n  'NG': 'Nigeria',\n  'NI': 'Nicaragua',\n  'NL': 'Netherlands',\n  'NO': 'Norway',\n  'NP': 'Nepal',\n  'NR': 'Nauru',\n  'NU': 'Niue',\n  'NZ': 'New Zealand',\n  'OM': 'Oman',\n  'PA': 'Panama',\n  'PE': 'Peru',\n  'PF': 'French Polynesia',\n  'PG': 'Papua New Guinea',\n  'PH': 'Philippines',\n  'PK': 'Pakistan',\n  'PL': 'Poland',\n  'PM': 'Saint Pierre And Miquelon',\n  'PN': 'Pitcairn',\n  'PR': 'Puerto Rico',\n  'PS': 'Palestinian Territory',\n  'PT': 'Portugal',\n  'PW': 'Palau',\n  'PY': 'Paraguay',\n  'QA': 'Qatar',\n  'RE': 'Reunion',\n  'RO': 'Romania',\n  'RS': 'Serbia',\n  'RU': 'Russian Federation',\n  'RW': 'Rwanda',\n  'SA': 'Saudi Arabia',\n  'SB': 'Solomon Islands',\n  'SC': 'Seychelles',\n  'SD': 'Sudan'\n}, _defineProperty(_Countries, \"SD\", 'Sudan'), _defineProperty(_Countries, 'SE', 'Sweden'), _defineProperty(_Countries, 'SG', 'Singapore'), _defineProperty(_Countries, 'SH', 'Saint Helena'), _defineProperty(_Countries, 'SI', 'Slovenia'), _defineProperty(_Countries, 'SJ', 'Svalbard And Jan Mayen Islands'), _defineProperty(_Countries, 'SK', 'Slovakia'), _defineProperty(_Countries, 'SL', 'Sierra Leone'), _defineProperty(_Countries, 'SM', 'San Marino'), _defineProperty(_Countries, 'SN', 'Senegal'), _defineProperty(_Countries, 'SO', 'Somalia'), _defineProperty(_Countries, 'SR', 'Suriname'), _defineProperty(_Countries, 'SS', 'South Sudan'), _defineProperty(_Countries, 'ST', 'Sao Tome And Principe'), _defineProperty(_Countries, 'SV', 'El Salvador'), _defineProperty(_Countries, 'SY', 'Syrian Arab Republic'), _defineProperty(_Countries, 'SZ', 'Swaziland'), _defineProperty(_Countries, 'TC', 'Turks And Caicos Islands'), _defineProperty(_Countries, 'TD', 'Chad'), _defineProperty(_Countries, 'TF', 'French Southern Territories'), _defineProperty(_Countries, 'TG', 'Togo'), _defineProperty(_Countries, 'TH', 'Thailand'), _defineProperty(_Countries, 'TJ', 'Tajikistan'), _defineProperty(_Countries, 'TK', 'Tokelau'), _defineProperty(_Countries, 'TL', 'Timor-leste'), _defineProperty(_Countries, 'TM', 'Turkmenistan'), _defineProperty(_Countries, 'TN', 'Tunisia'), _defineProperty(_Countries, 'TO', 'Tonga'), _defineProperty(_Countries, 'TR', 'Turkey'), _defineProperty(_Countries, 'TT', 'Trinidad And Tobago'), _defineProperty(_Countries, 'TV', 'Tuvalu'), _defineProperty(_Countries, 'TW', 'Taiwan'), _defineProperty(_Countries, 'TZ', 'Tanzania, United Republic Of'), _defineProperty(_Countries, 'UA', 'Ukraine'), _defineProperty(_Countries, 'UG', 'Uganda'), _defineProperty(_Countries, 'UM', 'United States Minor Outlying Islands'), _defineProperty(_Countries, 'US', 'USA'), _defineProperty(_Countries, 'UY', 'Uruguay'), _defineProperty(_Countries, 'UZ', 'Uzbekistan'), _defineProperty(_Countries, 'VA', 'Vatican City State (holy See)'), _defineProperty(_Countries, 'VC', 'Saint Vincent And The Grenadines'), _defineProperty(_Countries, 'VE', 'Venezuela'), _defineProperty(_Countries, 'VG', 'Virgin Islands (british)'), _defineProperty(_Countries, 'VI', 'Virgin Islands (u.s.)'), _defineProperty(_Countries, 'VN', 'Viet Nam'), _defineProperty(_Countries, 'VU', 'Vanuatu'), _defineProperty(_Countries, 'WF', 'Wallis And Futuna Islands'), _defineProperty(_Countries, 'WS', 'Samoa'), _defineProperty(_Countries, 'YE', 'Yemen'), _defineProperty(_Countries, 'YT', 'Mayotte'), _defineProperty(_Countries, 'ZA', 'South Africa'), _defineProperty(_Countries, 'ZM', 'Zambia'), _defineProperty(_Countries, 'ZW', 'Zimbabwe'), _Countries);\nexport function getCountryByCode(code) {\n  return Countries[code];\n}\nexport var CountriesPair = _.pairs(Countries).sort(function (a, b) {\n  return a[0].localeCompare(b[0]);\n}); // {code: name, ...} => [[code, name], ...]"],"mappings":";;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;ACxJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1eA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9mBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;ACvSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;ACvgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;A","sourceRoot":""}