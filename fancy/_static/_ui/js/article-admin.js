!function(n){var i={};function o(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=n,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=63)}([function(e,t){e.exports=__F.React},function(o,a,r){(function(n){var i;
/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */"classList"in document.createElement("_")||function(e){"use strict";if("Element"in e){var t="classList",n="prototype",i=e.Element[n],o=Object,a=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},r=Array[n].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},s=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},l=function(e,t){if(""===t)throw new s("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new s("INVALID_CHARACTER_ERR","String contains an invalid character");return r.call(e,t)},c=function(e){for(var t=a.call(e.getAttribute("class")||""),n=t?t.split(/\s+/):[],i=0,o=n.length;i<o;i++)this.push(n[i]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},u=c[n]=[],d=function(){return new c(this)};if(s[n]=Error[n],u.item=function(e){return this[e]||null},u.contains=function(e){return-1!==l(this,e+="")},u.add=function(){for(var e,t=arguments,n=0,i=t.length,o=!1;e=t[n]+"",-1===l(this,e)&&(this.push(e),o=!0),++n<i;);o&&this._updateClassName()},u.remove=function(){var e,t,n=arguments,i=0,o=n.length,a=!1;do{for(e=n[i]+"",t=l(this,e);-1!==t;)this.splice(t,1),a=!0,t=l(this,e)}while(++i<o);a&&this._updateClassName()},u.toggle=function(e,t){e+="";var n=this.contains(e),i=n?!0!==t&&"remove":!1!==t&&"add";return i&&this[i](e),!0===t||!1===t?t:!n},u.toString=function(){return this.join(" ")},o.defineProperty){var h={get:d,enumerable:!0,configurable:!0};try{o.defineProperty(i,t,h)}catch(e){-2146823252===e.number&&(h.enumerable=!1,o.defineProperty(i,t,h))}}else o[n].__defineGetter__&&i.__defineGetter__(t,d)}}(self)
/*! @source http://purl.eligrey.com/github/Blob.js/blob/master/Blob.js */,
/*! @source http://purl.eligrey.com/github/Blob.js/blob/master/Blob.js */
function(e){"use strict";if(e.URL=e.URL||e.webkitURL,e.Blob&&e.URL)try{return new Blob}catch(e){}var s=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){function s(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]}function t(){this.data=[]}function l(e,t,n){this.data=e,this.size=e.length,this.type=t,this.encoding=n}function c(e){this.code=this[this.name=e]}var n=t.prototype,i=l.prototype,u=e.FileReaderSync,o="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),a=o.length,r=e.URL||e.webkitURL||e,d=r.createObjectURL,h=r.revokeObjectURL,p=r,m=e.btoa,f=e.atob,g=e.ArrayBuffer,v=e.Uint8Array,b=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(l.fake=i.fake=!0;a--;)c.prototype[o[a]]=a+1;return r.createObjectURL||(p=e.URL=function(e){var t,n=document.createElementNS("http://www.w3.org/1999/xhtml","a");return n.href=e,"origin"in n||("data:"===n.protocol.toLowerCase()?n.origin=null:(t=e.match(b),n.origin=t&&t[1])),n}),p.createObjectURL=function(e){var t,n=e.type;return null===n&&(n="application/octet-stream"),e instanceof l?(t="data:"+n,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):m?t+";base64,"+m(e.data):t+","+encodeURIComponent(e.data)):d?d.call(r,e):void 0},p.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&h&&h.call(r,e)},n.append=function(e){var t=this.data;if(v&&(e instanceof g||e instanceof v)){for(var n="",i=new v(e),o=0,a=i.length;o<a;o++)n+=String.fromCharCode(i[o]);t.push(n)}else if("Blob"===s(e)||"File"===s(e)){if(!u)throw new c("NOT_READABLE_ERR");var r=new u;t.push(r.readAsBinaryString(e))}else e instanceof l?"base64"===e.encoding&&f?t.push(f(e.data)):"URI"===e.encoding?t.push(decodeURIComponent(e.data)):"raw"===e.encoding&&t.push(e.data):("string"!=typeof e&&(e+=""),t.push(unescape(encodeURIComponent(e))))},n.getBlob=function(e){return arguments.length||(e=null),new l(this.data.join(""),e,"raw")},n.toString=function(){return"[object BlobBuilder]"},i.slice=function(e,t,n){var i=arguments.length;return i<3&&(n=null),new l(this.data.slice(e,1<i?t:this.data.length),n,this.encoding)},i.toString=function(){return"[object Blob]"},i.close=function(){this.size=0,delete this.data},t}(e);e.Blob=function(e,t){var n=t&&t.type||"",i=new s;if(e)for(var o=0,a=e.length;o<a;o++)Uint8Array&&e[o]instanceof Uint8Array?i.append(e[o].buffer):i.append(e[o]);var r=i.getBlob(n);return!r.slice&&r.webkitSlice&&(r.slice=r.webkitSlice),r};var t=Object.getPrototypeOf||function(e){return e.__proto__};e.Blob.prototype=t(new e.Blob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this),function(e,t){"use strict";void 0!==n&&n&&n.versions&&n.versions.electron||"object"!=typeof o?void 0===(i=function(){return t}.call(a,r,a,o))||(o.exports=i):o.exports=t}(0,function(){"use strict";function v(e,t){return this.init(e,t)}function t(e){v.util.extend(this,e)}function u(e){return v.util.isBlockContainer(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}var e,n,i,o,a,r,s,l,c,d,h,p,m,f,g,b,y,w;function C(e,n){return!!e&&e.some(function(e){if("function"!=typeof e.getInteractionElements)return!1;var t=e.getInteractionElements();return!!t&&(Array.isArray(t)||(t=[t]),t.some(function(e){return v.util.isDescendant(e,n,!0)}))})}function E(e){this.base=e,this.options=this.base.options,this.events=[],this.disabledEvents={},this.customEvents={},this.listeners={}}function x(e){var t=v.util.getContainerEditorElement(e);Array.prototype.slice.call(t.parentElement.querySelectorAll("."+r)).forEach(function(e){e.classList.remove(r)})}function _(e){e.stopPropagation()}function k(e,t,n){var i=e.clipboardData||t.clipboardData||n.dataTransfer,o={};if(!i)return o;if(i.getData){var a=i.getData("Text");a&&0<a.length&&(o["text/plain"]=a)}if(i.types)for(var r=0;r<i.types.length;r++){var s=i.types[r];o[s]=i.getData(s)}return o}function T(e,t){if(this.options.disableReturn||t.getAttribute("data-disable-return"))e.preventDefault();else if(this.options.disableDoubleReturn||t.getAttribute("data-disable-double-return")){var n=v.selection.getSelectionStart(this.options.ownerDocument);(n&&""===n.textContent.trim()&&"li"!==n.nodeName.toLowerCase()||n.previousElementSibling&&"br"!==n.previousElementSibling.nodeName.toLowerCase()&&""===n.previousElementSibling.textContent.trim())&&e.preventDefault()}}function S(e){var t,n=v.selection.getSelectionStart(this.options.ownerDocument),i=n.nodeName.toLowerCase(),o=/^(\s+|<br\/?>)?$/i,a=/h\d/i;v.util.isKey(e,[v.util.keyCode.BACKSPACE,v.util.keyCode.ENTER])&&n.previousElementSibling&&a.test(i)&&0===v.selection.getCaretOffsets(n).left?v.util.isKey(e,v.util.keyCode.BACKSPACE)&&o.test(n.previousElementSibling.innerHTML)?(n.previousElementSibling.parentNode.removeChild(n.previousElementSibling),e.preventDefault()):!this.options.disableDoubleReturn&&v.util.isKey(e,v.util.keyCode.ENTER)&&((t=this.options.ownerDocument.createElement("p")).innerHTML="<br>",n.previousElementSibling.parentNode.insertBefore(t,n),e.preventDefault()):v.util.isKey(e,v.util.keyCode.DELETE)&&n.nextElementSibling&&n.previousElementSibling&&!a.test(i)&&o.test(n.innerHTML)&&a.test(n.nextElementSibling.nodeName.toLowerCase())?(v.selection.moveCursor(this.options.ownerDocument,n.nextElementSibling),n.previousElementSibling.parentNode.removeChild(n),e.preventDefault()):v.util.isKey(e,v.util.keyCode.BACKSPACE)&&"li"===i&&o.test(n.innerHTML)&&!n.previousElementSibling&&!n.parentElement.previousElementSibling&&n.nextElementSibling&&"li"===n.nextElementSibling.nodeName.toLowerCase()?((t=this.options.ownerDocument.createElement("p")).innerHTML="<br>",n.parentElement.parentElement.insertBefore(t,n.parentElement),v.selection.moveCursor(this.options.ownerDocument,t),n.parentElement.removeChild(n),e.preventDefault()):v.util.isKey(e,v.util.keyCode.BACKSPACE)&&!1!==v.util.getClosestTag(n,"blockquote")&&0===v.selection.getCaretOffsets(n).left?(e.preventDefault(),v.util.execFormatBlock(this.options.ownerDocument,"p")):v.util.isKey(e,v.util.keyCode.ENTER)&&!1!==v.util.getClosestTag(n,"blockquote")&&0===v.selection.getCaretOffsets(n).right?((t=this.options.ownerDocument.createElement("p")).innerHTML="<br>",n.parentElement.insertBefore(t,n.nextSibling),v.selection.moveCursor(this.options.ownerDocument,t),e.preventDefault()):v.util.isKey(e,v.util.keyCode.BACKSPACE)&&v.util.isMediumEditorElement(n.parentElement)&&!n.previousElementSibling&&n.nextElementSibling&&o.test(n.innerHTML)&&(e.preventDefault(),v.selection.moveCursor(this.options.ownerDocument,n.nextSibling),n.parentElement.removeChild(n))}function A(e,t,n){var i=[];if(e||(e=[]),"string"==typeof e&&(e=t.querySelectorAll(e)),v.util.isElement(e)&&(e=[e]),n)for(var o=0;o<e.length;o++){var a=e[o];!v.util.isElement(a)||a.getAttribute("data-medium-editor-element")||a.getAttribute("medium-editor-textarea-id")||i.push(a)}else i=Array.prototype.slice.apply(e);return i}function P(e){var t=e.parentNode.querySelector('textarea[medium-editor-textarea-id="'+e.getAttribute("medium-editor-textarea-id")+'"]');t&&(t.classList.remove("medium-editor-hidden"),t.removeAttribute("medium-editor-textarea-id")),e.parentNode&&e.parentNode.removeChild(e)}function D(e,t,n){return"function"==typeof(e=function(t,n){return Object.keys(n).forEach(function(e){void 0===t[e]&&(t[e]=n[e])}),t}(e,{window:n.options.contentWindow,document:n.options.ownerDocument,base:n})).init&&e.init(),e.name||(e.name=t),e}function N(){return!this.elements.every(function(e){return!!e.getAttribute("data-disable-toolbar")})&&!1!==this.options.toolbar}function I(e,t){if(!e.getAttribute("data-medium-editor-element")){"textarea"===e.nodeName.toLowerCase()&&(e=function(e){for(var t=this.options.ownerDocument.createElement("div"),n=Date.now(),i="medium-editor-"+n,o=e.attributes;this.options.ownerDocument.getElementById(i);)i="medium-editor-"+ ++n;t.className=e.className,t.id=i,t.innerHTML=e.value,e.setAttribute("medium-editor-textarea-id",i);for(var a=0,r=o.length;a<r;a++)t.hasAttribute(o[a].nodeName)||t.setAttribute(o[a].nodeName,o[a].value);return e.form&&this.on(e.form,"reset",function(e){e.defaultPrevented||this.resetContent(this.options.ownerDocument.getElementById(i))}.bind(this)),e.classList.add("medium-editor-hidden"),e.parentNode.insertBefore(t,e),t}.call(this,e),this.instanceHandleEditableInput||(this.instanceHandleEditableInput=function(e,t){var n=t.parentNode.querySelector('textarea[medium-editor-textarea-id="'+t.getAttribute("medium-editor-textarea-id")+'"]');n&&(n.value=t.innerHTML.trim())}.bind(this),this.subscribe("editableInput",this.instanceHandleEditableInput))),this.options.disableEditing||e.getAttribute("data-disable-editing")||(e.setAttribute("contentEditable",!0),e.setAttribute("spellcheck",this.options.spellcheck)),this.instanceHandleEditableKeydownEnter||(e.getAttribute("data-disable-return")||e.getAttribute("data-disable-double-return"))&&(this.instanceHandleEditableKeydownEnter=T.bind(this),this.subscribe("editableKeydownEnter",this.instanceHandleEditableKeydownEnter)),this.options.disableReturn||e.getAttribute("data-disable-return")||this.on(e,"keyup",function(e){var t=v.selection.getSelectionStart(this.options.ownerDocument);t&&(v.util.isMediumEditorElement(t)&&0===t.children.length&&!v.util.isBlockContainer(t)&&this.options.ownerDocument.execCommand("formatBlock",!1,"p"),!v.util.isKey(e,v.util.keyCode.ENTER)||v.util.isListItem(t)||v.util.isBlockContainer(t)||("a"===t.nodeName.toLowerCase()?this.options.ownerDocument.execCommand("unlink",!1,null):e.shiftKey||e.ctrlKey||this.options.ownerDocument.execCommand("formatBlock",!1,"p")))}.bind(this));var n=v.util.guid();e.setAttribute("data-medium-editor-element",!0),e.classList.add("medium-editor-element"),e.setAttribute("role","textbox"),e.setAttribute("aria-multiline",!0),e.setAttribute("data-medium-editor-editor-index",t),e.setAttribute("medium-editor-index",n),w[n]=e.innerHTML,this.events.attachAllEventsToElement(e)}return e}function O(){this.subscribe("editableKeydownTab",function(e){var t=v.selection.getSelectionStart(this.options.ownerDocument);"pre"===(t&&t.nodeName.toLowerCase())&&(e.preventDefault(),v.util.insertHTMLCommand(this.options.ownerDocument,"    ")),v.util.isListItem(t)&&(e.preventDefault(),e.shiftKey?this.options.ownerDocument.execCommand("outdent",!1,null):this.options.ownerDocument.execCommand("indent",!1,null))}.bind(this)),this.subscribe("editableKeydownDelete",S.bind(this)),this.subscribe("editableKeydownEnter",S.bind(this)),this.options.disableExtraSpaces&&this.subscribe("editableKeydownSpace",function(e){var t=v.selection.getSelectionStart(this.options.ownerDocument),n=t.textContent,i=v.selection.getCaretOffsets(t);(void 0===n[i.left-1]||""===n[i.left-1].trim()||void 0!==n[i.left]&&""===n[i.left].trim())&&e.preventDefault()}.bind(this)),this.instanceHandleEditableKeydownEnter||(this.options.disableReturn||this.options.disableDoubleReturn)&&(this.instanceHandleEditableKeydownEnter=T.bind(this),this.subscribe("editableKeydownEnter",this.instanceHandleEditableKeydownEnter))}function L(){if(this.extensions=[],Object.keys(this.options.extensions).forEach(function(e){"toolbar"!==e&&this.options.extensions[e]&&this.extensions.push(D(this.options.extensions[e],e,this))},this),function(){return!this.options.extensions.imageDragging}.call(this)){var e=this.options.fileDragging;e||(e={},function(){return!1!==this.options.imageDragging}.call(this)||(e.allowedTypes=[])),this.addBuiltInExtension("fileDragging",e)}var t={paste:!0,"anchor-preview":function(){return!!N.call(this)&&!1!==this.options.anchorPreview}.call(this),autoLink:function(){return!1!==this.options.autoLink}.call(this),keyboardCommands:function(){return!1!==this.options.keyboardCommands}.call(this),placeholder:function(){return!1!==this.options.placeholder}.call(this)};Object.keys(t).forEach(function(e){t[e]&&this.addBuiltInExtension(e)},this);var n=this.options.extensions.toolbar;if(!n&&N.call(this)){var i=v.util.extend({},this.options.toolbar,{allowMultiParagraphSelection:this.options.allowMultiParagraphSelection});n=new v.extensions.toolbar(i)}n&&this.extensions.push(D(n,"toolbar",this))}function F(e,t){var n,i;if(n=/^append-(.+)$/gi.exec(e))return v.util.execFormatBlock(this.options.ownerDocument,n[1]);if("fontSize"===e)return t.size&&v.util.deprecated(".size option for fontSize command",".value","6.0.0"),i=t.value||t.size,this.options.ownerDocument.execCommand("fontSize",!1,i);if("fontName"===e)return t.name&&v.util.deprecated(".name option for fontName command",".value","6.0.0"),i=t.value||t.name,this.options.ownerDocument.execCommand("fontName",!1,i);if("createLink"===e)return this.createLink(t);if("image"===e){var o=this.options.contentWindow.getSelection().toString().trim();return this.options.ownerDocument.execCommand("insertImage",!1,o)}if("html"===e){var a=this.options.contentWindow.getSelection().toString().trim();return v.util.insertHTMLCommand(this.options.ownerDocument,a)}if(/justify([A-Za-z]*)$/g.exec(e)){var r=this.options.ownerDocument.execCommand(e,!1,null),s=v.selection.getSelectedParentElement(v.selection.getSelectionRange(this.options.ownerDocument));return s&&function(e){if(!e)return;var i,t=Array.prototype.slice.call(e.childNodes).filter(function(e){var t="div"===e.nodeName.toLowerCase();return t&&!i&&(i=e.style.textAlign),t});t.length&&(this.saveSelection(),t.forEach(function(e){if(e.style.textAlign===i){var t=e.lastChild;if(t){v.util.unwrap(e,this.options.ownerDocument);var n=this.options.ownerDocument.createElement("BR");t.parentNode.insertBefore(n,t.nextSibling)}}},this),e.style.textAlign=i,this.restoreSelection())}.call(this,v.util.getTopBlockContainer(s)),r}return i=t&&t.value,this.options.ownerDocument.execCommand(e,!1,i)}return v.extensions={},function(e){function t(e,t){var n,i=Array.prototype.slice.call(arguments,2);t=t||{};for(var o=0;o<i.length;o++){var a=i[o];if(a)for(n in a)a.hasOwnProperty(n)&&void 0!==a[n]&&(e||!1===t.hasOwnProperty(n))&&(t[n]=a[n])}return t}var o=!1;try{var n=document.createElement("div"),i=document.createTextNode(" ");n.appendChild(i),o=n.contains(i)}catch(e){}var p={isIE:"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent),isEdge:null!==/Edge\/\d+/.exec(navigator.userAgent),isFF:-1<navigator.userAgent.toLowerCase().indexOf("firefox"),isMac:0<=e.navigator.platform.toUpperCase().indexOf("MAC"),keyCode:{BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,DELETE:46,K:75,M:77,V:86},isMetaCtrlKey:function(e){return!!(p.isMac&&e.metaKey||!p.isMac&&e.ctrlKey)},isKey:function(e,t){var n=p.getKeyCode(e);return!1===Array.isArray(t)?n===t:-1!==t.indexOf(n)},getKeyCode:function(e){var t=e.which;return null===t&&(t=null!==e.charCode?e.charCode:e.keyCode),t},blockContainerElementNames:["p","h1","h2","h3","h4","h5","h6","blockquote","pre","ul","li","ol","address","article","aside","audio","canvas","dd","dl","dt","fieldset","figcaption","figure","footer","form","header","hgroup","main","nav","noscript","output","section","video","table","thead","tbody","tfoot","tr","th","td"],emptyElementNames:["br","col","colgroup","hr","img","input","source","wbr"],extend:function(){var e=[!0].concat(Array.prototype.slice.call(arguments));return t.apply(this,e)},defaults:function(){var e=[!1].concat(Array.prototype.slice.call(arguments));return t.apply(this,e)},createLink:function(e,t,n,i){var o=e.createElement("a");return p.moveTextRangeIntoElement(t[0],t[t.length-1],o),o.setAttribute("href",n),i&&("_blank"===i&&o.setAttribute("rel","noopener noreferrer"),o.setAttribute("target",i)),o},findOrCreateMatchingTextNodes:function(e,t,n){for(var i=e.createTreeWalker(t,NodeFilter.SHOW_ALL,null,!1),o=[],a=0,r=!1,s=null,l=null;null!==(s=i.nextNode());)if(!(3<s.nodeType))if(3===s.nodeType){if(!r&&n.start<a+s.nodeValue.length&&(r=!0,l=p.splitStartNodeIfNeeded(s,n.start,a)),r&&p.splitEndNodeIfNeeded(s,l,n.end,a),r&&a===n.end)break;if(r&&a>n.end+1)throw new Error("PerformLinking overshot the target!");r&&o.push(l||s),a+=s.nodeValue.length,null!==l&&(a+=l.nodeValue.length,i.nextNode()),l=null}else"img"===s.tagName.toLowerCase()&&(!r&&n.start<=a&&(r=!0),r&&o.push(s));return o},splitStartNodeIfNeeded:function(e,t,n){return t!==n?e.splitText(t-n):null},splitEndNodeIfNeeded:function(e,t,n,i){var o,a;o=i+e.nodeValue.length+(t?t.nodeValue.length:0)-1,a=n-i-(t?e.nodeValue.length:0),n<=o&&i!==o&&0!=a&&(t||e).splitText(a)},splitByBlockElements:function(e){if(3!==e.nodeType&&1!==e.nodeType)return[];var t=[],n=v.util.blockContainerElementNames.join(",");if(3===e.nodeType||0===e.querySelectorAll(n).length)return[e];for(var i=0;i<e.childNodes.length;i++){var o=e.childNodes[i];if(3===o.nodeType)t.push(o);else if(1===o.nodeType){0===o.querySelectorAll(n).length?t.push(o):t=t.concat(v.util.splitByBlockElements(o))}}return t},findAdjacentTextNodeWithContent:function(e,t,n){var i,o=!1,a=n.createNodeIterator(e,NodeFilter.SHOW_TEXT,null,!1);for(i=a.nextNode();i;){if(i===t)o=!0;else if(o&&3===i.nodeType&&i.nodeValue&&0<i.nodeValue.trim().length)break;i=a.nextNode()}return i},findPreviousSibling:function(e){if(!e||p.isMediumEditorElement(e))return!1;for(var t=e.previousSibling;!t&&!p.isMediumEditorElement(e.parentNode);)t=(e=e.parentNode).previousSibling;return t},isDescendant:function(e,t,n){if(!e||!t)return!1;if(e===t)return!!n;if(1!==e.nodeType)return!1;if(o||3!==t.nodeType)return e.contains(t);for(var i=t.parentNode;null!==i;){if(i===e)return!0;i=i.parentNode}return!1},isElement:function(e){return!(!e||1!==e.nodeType)},throttle:function(n,i){function o(){c=Date.now(),l=null,s=n.apply(a,r),l||(a=r=null)}var a,r,s,l=null,c=0;return i||0===i||(i=50),function(){var e=Date.now(),t=i-(e-c);return a=this,r=arguments,t<=0||i<t?(l&&(clearTimeout(l),l=null),c=e,s=n.apply(a,r),l||(a=r=null)):l||(l=setTimeout(o,t)),s}},traverseUp:function(e,t){if(!e)return!1;do{if(1===e.nodeType){if(t(e))return e;if(p.isMediumEditorElement(e))return!1}e=e.parentNode}while(e);return!1},htmlEntities:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},insertHTMLCommand:function(e,t){var n,i,o,a,r,s,l,c=!1,u=["insertHTML",!1,t];if(!v.util.isEdge&&e.queryCommandSupported("insertHTML"))try{return e.execCommand.apply(e,u)}catch(e){}if((n=e.getSelection()).rangeCount){if(l=(i=n.getRangeAt(0)).commonAncestorContainer,p.isMediumEditorElement(l)&&!l.firstChild)i.selectNode(l.appendChild(e.createTextNode("")));else if(3===l.nodeType&&0===i.startOffset&&i.endOffset===l.nodeValue.length||3!==l.nodeType&&l.innerHTML===i.toString()){for(;!p.isMediumEditorElement(l)&&l.parentNode&&1===l.parentNode.childNodes.length&&!p.isMediumEditorElement(l.parentNode);)l=l.parentNode;i.selectNode(l)}for(i.deleteContents(),(o=e.createElement("div")).innerHTML=t,a=e.createDocumentFragment();o.firstChild;)r=o.firstChild,s=a.appendChild(r);i.insertNode(a),s&&((i=i.cloneRange()).setStartAfter(s),i.collapse(!0),v.selection.selectRange(e,i)),c=!0}return e.execCommand.callListeners&&e.execCommand.callListeners(u,c),c},execFormatBlock:function(e,t){var n=p.getTopBlockContainer(v.selection.getSelectionStart(e));if("blockquote"===t){if(n&&Array.prototype.slice.call(n.childNodes).some(function(e){return p.isBlockContainer(e)}))return e.execCommand("outdent",!1,null);if(p.isIE)return e.execCommand("indent",!1,t)}if(n&&t===n.nodeName.toLowerCase()&&(t="p"),p.isIE&&(t="<"+t+">"),n&&"blockquote"===n.nodeName.toLowerCase()){if(p.isIE&&"<p>"===t)return e.execCommand("outdent",!1,t);if((p.isFF||p.isEdge)&&"p"===t)return Array.prototype.slice.call(n.childNodes).some(function(e){return!p.isBlockContainer(e)})&&e.execCommand("formatBlock",!1,t),e.execCommand("outdent",!1,t)}return e.execCommand("formatBlock",!1,t)},setTargetBlank:function(e,t){var n,i=t||!1;if("a"===e.nodeName.toLowerCase())e.target="_blank",e.rel="noopener noreferrer";else for(e=e.getElementsByTagName("a"),n=0;n<e.length;n+=1)!1!==i&&i!==e[n].attributes.href.value||(e[n].target="_blank",e[n].rel="noopener noreferrer")},removeTargetBlank:function(e,t){var n;if("a"===e.nodeName.toLowerCase())e.removeAttribute("target"),e.removeAttribute("rel");else for(e=e.getElementsByTagName("a"),n=0;n<e.length;n+=1)t===e[n].attributes.href.value&&(e[n].removeAttribute("target"),e[n].removeAttribute("rel"))},addClassToAnchors:function(e,t){var n,i,o=t.split(" ");if("a"===e.nodeName.toLowerCase())for(i=0;i<o.length;i+=1)e.classList.add(o[i]);else{var a=e.getElementsByTagName("a");if(0===a.length){var r=p.getClosestTag(e,"a");e=r?[r]:[]}else e=a;for(n=0;n<e.length;n+=1)for(i=0;i<o.length;i+=1)e[n].classList.add(o[i])}},isListItem:function(e){if(!e)return!1;if("li"===e.nodeName.toLowerCase())return!0;for(var t=e.parentNode,n=t.nodeName.toLowerCase();"li"===n||!p.isBlockContainer(t)&&"div"!==n;){if("li"===n)return!0;if(!(t=t.parentNode))return!1;n=t.nodeName.toLowerCase()}return!1},cleanListDOM:function(e,t){if("li"===t.nodeName.toLowerCase()){var n=t.parentElement;"p"===n.parentElement.nodeName.toLowerCase()&&(p.unwrap(n.parentElement,e),v.selection.moveCursor(e,t.firstChild,t.firstChild.textContent.length))}},splitOffDOMTree:function(e,t,n){for(var i=t,o=null,a=!n;i!==e;){var r,s=i.parentNode,l=s.cloneNode(!1),c=a?i:s.firstChild;for(o&&(a?l.appendChild(o):r=o),o=l;c;){var u=c.nextSibling;c=c===i?(c.hasChildNodes()?c=c.cloneNode(!1):c.parentNode.removeChild(c),c.textContent&&o.appendChild(c),a?u:null):(c.parentNode.removeChild(c),(c.hasChildNodes()||c.textContent)&&o.appendChild(c),u)}r&&o.appendChild(r),i=s}return o},moveTextRangeIntoElement:function(e,t,n){if(!e||!t)return!1;var i=p.findCommonRoot(e,t);if(!i)return!1;if(t===e){var o=e.parentNode,a=e.nextSibling;return o.removeChild(e),n.appendChild(e),a?o.insertBefore(n,a):o.appendChild(n),n.hasChildNodes()}for(var r,s,l,c=[],u=0;u<i.childNodes.length;u++)if(l=i.childNodes[u],r){if(p.isDescendant(l,t,!0)){s=l;break}c.push(l)}else p.isDescendant(l,e,!0)&&(r=l);var d=s.nextSibling,h=i.ownerDocument.createDocumentFragment();return r===e?(r.parentNode.removeChild(r),h.appendChild(r)):h.appendChild(p.splitOffDOMTree(r,e)),c.forEach(function(e){e.parentNode.removeChild(e),h.appendChild(e)}),s===t?(s.parentNode.removeChild(s),h.appendChild(s)):h.appendChild(p.splitOffDOMTree(s,t,!0)),n.appendChild(h),s.parentNode===i?i.insertBefore(n,s):d?i.insertBefore(n,d):i.appendChild(n),n.hasChildNodes()},depthOfNode:function(e){for(var t=0,n=e;null!==n.parentNode;)n=n.parentNode,t++;return t},findCommonRoot:function(e,t){for(var n=p.depthOfNode(e),i=p.depthOfNode(t),o=e,a=t;n!==i;)i<n?(o=o.parentNode,n-=1):(a=a.parentNode,i-=1);for(;o!==a;)o=o.parentNode,a=a.parentNode;return o},isElementAtBeginningOfBlock:function(e){for(var t;!p.isBlockContainer(e)&&!p.isMediumEditorElement(e);){for(t=e;t=t.previousSibling;)if(0<(3===t.nodeType?t.nodeValue:t.textContent).length)return!1;e=e.parentNode}return!0},isMediumEditorElement:function(e){return e&&e.getAttribute&&!!e.getAttribute("data-medium-editor-element")},getContainerEditorElement:function(e){return p.traverseUp(e,function(e){return p.isMediumEditorElement(e)})},isBlockContainer:function(e){return e&&3!==e.nodeType&&-1!==p.blockContainerElementNames.indexOf(e.nodeName.toLowerCase())},getClosestBlockContainer:function(e){return p.traverseUp(e,function(e){return p.isBlockContainer(e)||p.isMediumEditorElement(e)})},getTopBlockContainer:function(e){var t=!!p.isBlockContainer(e)&&e;return p.traverseUp(e,function(e){return p.isBlockContainer(e)&&(t=e),!(t||!p.isMediumEditorElement(e))&&(t=e,!0)}),t},getFirstSelectableLeafNode:function(e){for(;e&&e.firstChild;)e=e.firstChild;if("table"===(e=p.traverseUp(e,function(e){return-1===p.emptyElementNames.indexOf(e.nodeName.toLowerCase())})).nodeName.toLowerCase()){var t=e.querySelector("th, td");t&&(e=t)}return e},getFirstTextNode:function(e){return p.warn("getFirstTextNode is deprecated and will be removed in version 6.0.0"),p._getFirstTextNode(e)},_getFirstTextNode:function(e){if(3===e.nodeType)return e;for(var t=0;t<e.childNodes.length;t++){var n=p._getFirstTextNode(e.childNodes[t]);if(null!==n)return n}return null},ensureUrlHasProtocol:function(e){return-1===e.indexOf("://")?"http://"+e:e},warn:function(){void 0!==e.console&&"function"==typeof e.console.warn&&e.console.warn.apply(e.console,arguments)},deprecated:function(e,t,n){var i=e+" is deprecated, please use "+t+" instead.";n&&(i+=" Will be removed in "+n),p.warn(i)},deprecatedMethod:function(e,t,n,i){p.deprecated(e,t,i),"function"==typeof this[t]&&this[t].apply(this,n)},cleanupAttrs:function(t,e){e.forEach(function(e){t.removeAttribute(e)})},cleanupTags:function(e,t){-1!==t.indexOf(e.nodeName.toLowerCase())&&e.parentNode.removeChild(e)},unwrapTags:function(e,t){-1!==t.indexOf(e.nodeName.toLowerCase())&&v.util.unwrap(e,document)},getClosestTag:function(e,t){return p.traverseUp(e,function(e){return e.nodeName.toLowerCase()===t.toLowerCase()})},unwrap:function(e,t){for(var n=t.createDocumentFragment(),i=Array.prototype.slice.call(e.childNodes),o=0;o<i.length;o++)n.appendChild(i[o]);n.childNodes.length?e.parentNode.replaceChild(n,e):e.parentNode.removeChild(e)},guid:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}};v.util=p}(window),t.extend=function(e){var t,n=this;function i(){this.constructor=t}return t=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return n.apply(this,arguments)},v.util.extend(t,n),i.prototype=n.prototype,t.prototype=new i,e&&v.util.extend(t.prototype,e),t},t.prototype={init:function(){},base:void 0,name:void 0,checkState:void 0,destroy:void 0,queryCommandState:void 0,isActive:void 0,isAlreadyApplied:void 0,setActive:void 0,setInactive:void 0,getInteractionElements:void 0,window:void 0,document:void 0,getEditorElements:function(){return this.base.elements},getEditorId:function(){return this.base.id},getEditorOption:function(e){return this.base.options[e]}},["execAction","on","off","subscribe","trigger"].forEach(function(e){t.prototype[e]=function(){return this.base[e].apply(this.base,arguments)}}),v.Extension=t,e={findMatchingSelectionParent:function(e,t){var n,i=t.getSelection();return 0!==i.rangeCount&&(n=i.getRangeAt(0).commonAncestorContainer,v.util.traverseUp(n,e))},getSelectionElement:function(e){return this.findMatchingSelectionParent(function(e){return v.util.isMediumEditorElement(e)},e)},exportSelection:function(e,t){if(!e)return null;var n=null,i=t.getSelection();if(0<i.rangeCount){var o,a=i.getRangeAt(0),r=a.cloneRange();r.selectNodeContents(e),r.setEnd(a.startContainer,a.startOffset),n={start:o=r.toString().length,end:o+a.toString().length},this.doesRangeStartWithImages(a,t)&&(n.startsWithImage=!0);var s=this.getTrailingImageCount(e,n,a.endContainer,a.endOffset);if(s&&(n.trailingImageCount=s),0!==o){var l=this.getIndexRelativeToAdjacentEmptyBlocks(t,e,a.startContainer,a.startOffset);-1!==l&&(n.emptyBlocksIndex=l)}}return n},importSelection:function(e,t,n,i){if(e&&t){var o=n.createRange();o.setStart(t,0),o.collapse(!0);var a,r=t,s=[],l=0,c=!1,u=!1,d=0,h=!1,p=!1,m=null;for((i||e.startsWithImage||void 0!==e.emptyBlocksIndex)&&(p=!0);!h&&r;)if(3<r.nodeType)r=s.pop();else{if(3!==r.nodeType||u){if(e.trailingImageCount&&u&&("img"===r.nodeName.toLowerCase()&&d++,d===e.trailingImageCount)){for(var f=0;r.parentNode.childNodes[f]!==r;)f++;o.setEnd(r.parentNode,f+1),h=!0}if(!h&&1===r.nodeType)for(var g=r.childNodes.length-1;0<=g;)s.push(r.childNodes[g]),g-=1}else a=l+r.length,!c&&e.start>=l&&e.start<=a&&(p||e.start<a?(o.setStart(r,e.start-l),c=!0):m=r),c&&e.end>=l&&e.end<=a&&(e.trailingImageCount?u=!0:(o.setEnd(r,e.end-l),h=!0)),l=a;h||(r=s.pop())}!c&&m&&(o.setStart(m,m.length),o.setEnd(m,m.length)),void 0!==e.emptyBlocksIndex&&(o=this.importSelectionMoveCursorPastBlocks(n,t,e.emptyBlocksIndex,o)),i&&(o=this.importSelectionMoveCursorPastAnchor(e,o)),this.selectRange(n,o)}},importSelectionMoveCursorPastAnchor:function(e,t){if(e.start===e.end&&3===t.startContainer.nodeType&&t.startOffset===t.startContainer.nodeValue.length&&v.util.traverseUp(t.startContainer,function(e){return"a"===e.nodeName.toLowerCase()})){for(var n=t.startContainer,i=t.startContainer.parentNode;null!==i&&"a"!==i.nodeName.toLowerCase();)i=i.childNodes[i.childNodes.length-1]!==n?null:(n=i).parentNode;if(null!==i&&"a"===i.nodeName.toLowerCase()){for(var o=null,a=0;null===o&&a<i.parentNode.childNodes.length;a++)i.parentNode.childNodes[a]===i&&(o=a);t.setStart(i.parentNode,o+1),t.collapse(!0)}}return t},importSelectionMoveCursorPastBlocks:function(e,t,n,i){var o,a,r=e.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,u,!1),s=i.startContainer,l=0;for(n=n||1,o=3===s.nodeType&&v.util.isBlockContainer(s.previousSibling)?s.previousSibling:v.util.getClosestBlockContainer(s);r.nextNode();)if(a){if(a=r.currentNode,++l===n)break;if(0<a.textContent.length)break}else o===r.currentNode&&(a=r.currentNode);return a||(a=o),i.setStart(v.util.getFirstSelectableLeafNode(a),0),i},getIndexRelativeToAdjacentEmptyBlocks:function(e,t,n,i){if(0<n.textContent.length&&0<i)return-1;var o=n;if(3!==o.nodeType&&(o=n.childNodes[i]),o){if(!v.util.isElementAtBeginningOfBlock(o))return-1;var a=v.util.findPreviousSibling(o);if(!a)return-1;if(a.nodeValue)return-1}for(var r=v.util.getClosestBlockContainer(n),s=e.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,u,!1),l=0;s.nextNode();){var c=""===s.currentNode.textContent;if((c||0<l)&&(l+=1),s.currentNode===r)return l;c||(l=0)}return l},doesRangeStartWithImages:function(e,t){if(0!==e.startOffset||1!==e.startContainer.nodeType)return!1;if("img"===e.startContainer.nodeName.toLowerCase())return!0;var n=e.startContainer.querySelector("img");if(!n)return!1;for(var i=t.createTreeWalker(e.startContainer,NodeFilter.SHOW_ALL,null,!1);i.nextNode();){var o=i.currentNode;if(o===n)break;if(o.nodeValue)return!1}return!0},getTrailingImageCount:function(e,t,n,i){if(0===i||1!==n.nodeType)return 0;if("img"!==n.nodeName.toLowerCase()&&!n.querySelector("img"))return 0;for(var o=n.childNodes[i-1];o.hasChildNodes();)o=o.lastChild;for(var a,r=e,s=[],l=0,c=!1,u=!1,d=!1,h=0;!d&&r;)if(3<r.nodeType)r=s.pop();else{if(3!==r.nodeType||u){if("img"===r.nodeName.toLowerCase()&&h++,r===o)d=!0;else if(1===r.nodeType)for(var p=r.childNodes.length-1;0<=p;)s.push(r.childNodes[p]),p-=1}else h=0,a=l+r.length,!c&&t.start>=l&&t.start<=a&&(c=!0),c&&t.end>=l&&t.end<=a&&(u=!0),l=a;d||(r=s.pop())}return h},selectionContainsContent:function(e){var t=e.getSelection();if(!t||t.isCollapsed||!t.rangeCount)return!1;if(""!==t.toString().trim())return!0;var n=this.getSelectedParentElement(t.getRangeAt(0));return!(!n||!("img"===n.nodeName.toLowerCase()||1===n.nodeType&&n.querySelector("img")))},selectionInContentEditableFalse:function(e){var n,t=this.findMatchingSelectionParent(function(e){var t=e&&e.getAttribute("contenteditable");return"true"===t&&(n=!0),"#text"!==e.nodeName&&"false"===t},e);return!n&&t},getSelectionHtml:function(e){var t,n,i,o="",a=e.getSelection();if(a.rangeCount){for(i=e.createElement("div"),t=0,n=a.rangeCount;t<n;t+=1)i.appendChild(a.getRangeAt(t).cloneContents());o=i.innerHTML}return o},getCaretOffsets:function(e,t){var n,i;return t||(t=window.getSelection().getRangeAt(0)),n=t.cloneRange(),i=t.cloneRange(),n.selectNodeContents(e),n.setEnd(t.endContainer,t.endOffset),i.selectNodeContents(e),i.setStart(t.endContainer,t.endOffset),{left:n.toString().length,right:i.toString().length}},rangeSelectsSingleNode:function(e){var t=e.startContainer;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===e.startOffset+1},getSelectedParentElement:function(e){return e?this.rangeSelectsSingleNode(e)&&3!==e.startContainer.childNodes[e.startOffset].nodeType?e.startContainer.childNodes[e.startOffset]:3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer:null},getSelectedElements:function(e){var t,n,i,o=e.getSelection();if(!o.rangeCount||o.isCollapsed||!o.getRangeAt(0).commonAncestorContainer)return[];if(3!==(t=o.getRangeAt(0)).commonAncestorContainer.nodeType)return[].filter.call(t.commonAncestorContainer.getElementsByTagName("*"),function(e){return"function"!=typeof o.containsNode||o.containsNode(e,!0)});for(n=[],i=t.commonAncestorContainer;i.parentNode&&1===i.parentNode.childNodes.length;)n.push(i.parentNode),i=i.parentNode;return n},selectNode:function(e,t){var n=t.createRange();n.selectNodeContents(e),this.selectRange(t,n)},select:function(e,t,n,i,o){var a=e.createRange();return a.setStart(t,n),i?a.setEnd(i,o):a.collapse(!0),this.selectRange(e,a),a},clearSelection:function(e,t){t?e.getSelection().collapseToStart():e.getSelection().collapseToEnd()},moveCursor:function(e,t,n){this.select(e,t,n)},getSelectionRange:function(e){var t=e.getSelection();return 0===t.rangeCount?null:t.getRangeAt(0)},selectRange:function(e,t){var n=e.getSelection();n.removeAllRanges(),n.addRange(t)},getSelectionStart:function(e){var t=e.getSelection().anchorNode;return t&&3===t.nodeType?t.parentNode:t}},v.selection=e,E.prototype={InputEventOnContenteditableSupported:!v.util.isIE&&!v.util.isEdge,attachDOMEvent:function(e,t,n,i){var o=this.base.options.contentWindow,a=this.base.options.ownerDocument;e=v.util.isElement(e)||-1<[o,a].indexOf(e)?[e]:e,Array.prototype.forEach.call(e,function(e){e.addEventListener(t,n,i),this.events.push([e,t,n,i])}.bind(this))},detachDOMEvent:function(e,t,n,i){var o,a,r=this.base.options.contentWindow,s=this.base.options.ownerDocument;e&&(e=v.util.isElement(e)||-1<[r,s].indexOf(e)?[e]:e,Array.prototype.forEach.call(e,function(e){-1!==(o=this.indexOfListener(e,t,n,i))&&(a=this.events.splice(o,1)[0])[0].removeEventListener(a[1],a[2],a[3])}.bind(this)))},indexOfListener:function(e,t,n,i){var o,a,r;for(o=0,a=this.events.length;o<a;o+=1)if((r=this.events[o])[0]===e&&r[1]===t&&r[2]===n&&r[3]===i)return o;return-1},detachAllDOMEvents:function(){for(var e=this.events.pop();e;)e[0].removeEventListener(e[1],e[2],e[3]),e=this.events.pop()},detachAllEventsFromElement:function(t){for(var e=this.events.filter(function(e){return e&&e[0].getAttribute&&e[0].getAttribute("medium-editor-index")===t.getAttribute("medium-editor-index")}),n=0,i=e.length;n<i;n++){var o=e[n];this.detachDOMEvent(o[0],o[1],o[2],o[3])}},attachAllEventsToElement:function(t){this.listeners.editableInput&&(this.contentCache[t.getAttribute("medium-editor-index")]=t.innerHTML),this.eventsCache&&this.eventsCache.forEach(function(e){this.attachDOMEvent(t,e.name,e.handler.bind(this))},this)},enableCustomEvent:function(e){void 0!==this.disabledEvents[e]&&delete this.disabledEvents[e]},disableCustomEvent:function(e){this.disabledEvents[e]=!0},attachCustomEvent:function(e,t){this.setupListener(e),this.customEvents[e]||(this.customEvents[e]=[]),this.customEvents[e].push(t)},detachCustomEvent:function(e,t){var n=this.indexOfCustomListener(e,t);-1!==n&&this.customEvents[e].splice(n,1)},indexOfCustomListener:function(e,t){return this.customEvents[e]&&this.customEvents[e].length?this.customEvents[e].indexOf(t):-1},detachAllCustomEvents:function(){this.customEvents={}},triggerCustomEvent:function(e,t,n){this.customEvents[e]&&!this.disabledEvents[e]&&this.customEvents[e].forEach(function(e){e(t,n)})},destroy:function(){this.detachAllDOMEvents(),this.detachAllCustomEvents(),this.detachExecCommand(),this.base.elements&&this.base.elements.forEach(function(e){e.removeAttribute("data-medium-focused")})},attachToExecCommand:function(){this.execCommandListener||(this.execCommandListener=function(e){this.handleDocumentExecCommand(e)}.bind(this),this.wrapExecCommand(),this.options.ownerDocument.execCommand.listeners.push(this.execCommandListener))},detachExecCommand:function(){var e=this.options.ownerDocument;if(this.execCommandListener&&e.execCommand.listeners){var t=e.execCommand.listeners.indexOf(this.execCommandListener);-1!==t&&e.execCommand.listeners.splice(t,1),e.execCommand.listeners.length||this.unwrapExecCommand()}},wrapExecCommand:function(){var i=this.options.ownerDocument;if(!i.execCommand.listeners){var n=function(t,n){i.execCommand.listeners&&i.execCommand.listeners.forEach(function(e){e({command:t[0],value:t[2],args:t,result:n})})},e=function(){var e=i.execCommand.orig.apply(this,arguments);if(!i.execCommand.listeners)return e;var t=Array.prototype.slice.call(arguments);return n(t,e),e};e.orig=i.execCommand,e.listeners=[],e.callListeners=n,i.execCommand=e}},unwrapExecCommand:function(){var e=this.options.ownerDocument;e.execCommand.orig&&(e.execCommand=e.execCommand.orig)},setupListener:function(e){if(!this.listeners[e]){switch(e){case"externalInteraction":this.attachDOMEvent(this.options.ownerDocument.body,"mousedown",this.handleBodyMousedown.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"click",this.handleBodyClick.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"focus",this.handleBodyFocus.bind(this),!0);break;case"blur":case"focus":this.setupListener("externalInteraction");break;case"editableInput":this.contentCache={},this.base.elements.forEach(function(e){this.contentCache[e.getAttribute("medium-editor-index")]=e.innerHTML},this),this.InputEventOnContenteditableSupported&&this.attachToEachElement("input",this.handleInput),this.InputEventOnContenteditableSupported||(this.setupListener("editableKeypress"),this.keypressUpdateInput=!0,this.attachDOMEvent(document,"selectionchange",this.handleDocumentSelectionChange.bind(this)),this.attachToExecCommand());break;case"editableClick":this.attachToEachElement("click",this.handleClick);break;case"editableBlur":this.attachToEachElement("blur",this.handleBlur);break;case"editableKeypress":this.attachToEachElement("keypress",this.handleKeypress);break;case"editableKeyup":this.attachToEachElement("keyup",this.handleKeyup);break;case"editableKeydown":this.attachToEachElement("keydown",this.handleKeydown);break;case"editableKeydownSpace":case"editableKeydownEnter":case"editableKeydownTab":case"editableKeydownDelete":this.setupListener("editableKeydown");break;case"editableMouseover":this.attachToEachElement("mouseover",this.handleMouseover);break;case"editableDrag":this.attachToEachElement("dragover",this.handleDragging),this.attachToEachElement("dragleave",this.handleDragging);break;case"editableDrop":this.attachToEachElement("drop",this.handleDrop);break;case"editablePaste":this.attachToEachElement("paste",this.handlePaste)}this.listeners[e]=!0}},attachToEachElement:function(t,n){this.eventsCache||(this.eventsCache=[]),this.base.elements.forEach(function(e){this.attachDOMEvent(e,t,n.bind(this))},this),this.eventsCache.push({name:t,handler:n})},cleanupElement:function(e){var t=e.getAttribute("medium-editor-index");t&&(this.detachAllEventsFromElement(e),this.contentCache&&delete this.contentCache[t])},focusElement:function(e){e.focus(),this.updateFocus(e,{target:e,type:"focus"})},updateFocus:function(t,e){var n,i=this.base.getFocusedElement();i&&"click"===e.type&&this.lastMousedownTarget&&(v.util.isDescendant(i,this.lastMousedownTarget,!0)||C(this.base.extensions,this.lastMousedownTarget))&&(n=i),n||this.base.elements.some(function(e){return!n&&v.util.isDescendant(e,t,!0)&&(n=e),!!n},this);var o=!v.util.isDescendant(i,t,!0)&&!C(this.base.extensions,t);n!==i&&(i&&o&&(i.removeAttribute("data-medium-focused"),this.triggerCustomEvent("blur",e,i)),n&&(n.setAttribute("data-medium-focused",!0),this.triggerCustomEvent("focus",e,n))),o&&this.triggerCustomEvent("externalInteraction",e)},updateInput:function(e,t){if(this.contentCache){var n=e.getAttribute("medium-editor-index"),i=e.innerHTML;i!==this.contentCache[n]&&this.triggerCustomEvent("editableInput",t,e),this.contentCache[n]=i}},handleDocumentSelectionChange:function(e){if(e.currentTarget&&e.currentTarget.activeElement){var t,n=e.currentTarget.activeElement;this.base.elements.some(function(e){return!!v.util.isDescendant(e,n,!0)&&(t=e,!0)},this),t&&this.updateInput(t,{target:n,currentTarget:t})}},handleDocumentExecCommand:function(){var e=this.base.getFocusedElement();e&&this.updateInput(e,{target:e,currentTarget:e})},handleBodyClick:function(e){this.updateFocus(e.target,e)},handleBodyFocus:function(e){this.updateFocus(e.target,e)},handleBodyMousedown:function(e){this.lastMousedownTarget=e.target},handleInput:function(e){this.updateInput(e.currentTarget,e)},handleClick:function(e){this.triggerCustomEvent("editableClick",e,e.currentTarget)},handleBlur:function(e){this.triggerCustomEvent("editableBlur",e,e.currentTarget)},handleKeypress:function(e){if(this.triggerCustomEvent("editableKeypress",e,e.currentTarget),this.keypressUpdateInput){var t={target:e.target,currentTarget:e.currentTarget};setTimeout(function(){this.updateInput(t.currentTarget,t)}.bind(this),0)}},handleKeyup:function(e){this.triggerCustomEvent("editableKeyup",e,e.currentTarget)},handleMouseover:function(e){this.triggerCustomEvent("editableMouseover",e,e.currentTarget)},handleDragging:function(e){this.triggerCustomEvent("editableDrag",e,e.currentTarget)},handleDrop:function(e){this.triggerCustomEvent("editableDrop",e,e.currentTarget)},handlePaste:function(e){this.triggerCustomEvent("editablePaste",e,e.currentTarget)},handleKeydown:function(e){return this.triggerCustomEvent("editableKeydown",e,e.currentTarget),v.util.isKey(e,v.util.keyCode.SPACE)?this.triggerCustomEvent("editableKeydownSpace",e,e.currentTarget):v.util.isKey(e,v.util.keyCode.ENTER)||e.ctrlKey&&v.util.isKey(e,v.util.keyCode.M)?this.triggerCustomEvent("editableKeydownEnter",e,e.currentTarget):v.util.isKey(e,v.util.keyCode.TAB)?this.triggerCustomEvent("editableKeydownTab",e,e.currentTarget):v.util.isKey(e,[v.util.keyCode.DELETE,v.util.keyCode.BACKSPACE])?this.triggerCustomEvent("editableKeydownDelete",e,e.currentTarget):void 0}},v.Events=E,(n=v.Extension.extend({action:void 0,aria:void 0,tagNames:void 0,style:void 0,useQueryState:void 0,contentDefault:void 0,contentFA:void 0,classList:void 0,attrs:void 0,constructor:function(e){n.isBuiltInButton(e)?v.Extension.call(this,this.defaults[e]):v.Extension.call(this,e)},init:function(){v.Extension.prototype.init.apply(this,arguments),this.button=this.createButton(),this.on(this.button,"click",this.handleClick.bind(this))},getButton:function(){return this.button},getAction:function(){return"function"==typeof this.action?this.action(this.base.options):this.action},getAria:function(){return"function"==typeof this.aria?this.aria(this.base.options):this.aria},getTagNames:function(){return"function"==typeof this.tagNames?this.tagNames(this.base.options):this.tagNames},createButton:function(){var t=this.document.createElement("button"),e=this.contentDefault,n=this.getAria(),i=this.getEditorOption("buttonLabels");return t.classList.add("medium-editor-action"),t.classList.add("medium-editor-action-"+this.name),this.classList&&this.classList.forEach(function(e){t.classList.add(e)}),t.setAttribute("data-action",this.getAction()),n&&(t.setAttribute("title",n),t.setAttribute("aria-label",n)),this.attrs&&Object.keys(this.attrs).forEach(function(e){t.setAttribute(e,this.attrs[e])},this),"fontawesome"===i&&this.contentFA&&(e=this.contentFA),t.innerHTML=e,t},handleClick:function(e){e.preventDefault(),e.stopPropagation();var t=this.getAction();t&&this.execAction(t)},isActive:function(){return this.button.classList.contains(this.getEditorOption("activeButtonClass"))},setInactive:function(){this.button.classList.remove(this.getEditorOption("activeButtonClass")),delete this.knownState},setActive:function(){this.button.classList.add(this.getEditorOption("activeButtonClass")),delete this.knownState},queryCommandState:function(){var e=null;return this.useQueryState&&(e=this.base.queryCommandState(this.getAction())),e},isAlreadyApplied:function(e){var t,n,i=!1,o=this.getTagNames();return!1===this.knownState||!0===this.knownState?this.knownState:(o&&0<o.length&&(i=-1!==o.indexOf(e.nodeName.toLowerCase())),!i&&this.style&&(t=this.style.value.split("|"),n=this.window.getComputedStyle(e,null).getPropertyValue(this.style.prop),t.forEach(function(e){this.knownState||!(i=-1!==n.indexOf(e))&&"text-decoration"===this.style.prop||(this.knownState=i)},this)),i)}})).isBuiltInButton=function(e){return"string"==typeof e&&v.extensions.button.prototype.defaults.hasOwnProperty(e)},v.extensions.button=n,v.extensions.button.prototype.defaults={bold:{name:"bold",action:"bold",aria:"bold",tagNames:["b","strong"],style:{prop:"font-weight",value:"700|bold"},useQueryState:!0,contentDefault:"<b>B</b>",contentFA:'<i class="fa fa-bold"></i>'},italic:{name:"italic",action:"italic",aria:"italic",tagNames:["i","em"],style:{prop:"font-style",value:"italic"},useQueryState:!0,contentDefault:"<b><i>I</i></b>",contentFA:'<i class="fa fa-italic"></i>'},underline:{name:"underline",action:"underline",aria:"underline",tagNames:["u"],style:{prop:"text-decoration",value:"underline"},useQueryState:!0,contentDefault:"<b><u>U</u></b>",contentFA:'<i class="fa fa-underline"></i>'},strikethrough:{name:"strikethrough",action:"strikethrough",aria:"strike through",tagNames:["strike"],style:{prop:"text-decoration",value:"line-through"},useQueryState:!0,contentDefault:"<s>A</s>",contentFA:'<i class="fa fa-strikethrough"></i>'},superscript:{name:"superscript",action:"superscript",aria:"superscript",tagNames:["sup"],contentDefault:"<b>x<sup>1</sup></b>",contentFA:'<i class="fa fa-superscript"></i>'},subscript:{name:"subscript",action:"subscript",aria:"subscript",tagNames:["sub"],contentDefault:"<b>x<sub>1</sub></b>",contentFA:'<i class="fa fa-subscript"></i>'},image:{name:"image",action:"image",aria:"image",tagNames:["img"],contentDefault:"<b>image</b>",contentFA:'<i class="fa fa-picture-o"></i>'},html:{name:"html",action:"html",aria:"evaluate html",tagNames:["iframe","object"],contentDefault:"<b>html</b>",contentFA:'<i class="fa fa-code"></i>'},orderedlist:{name:"orderedlist",action:"insertorderedlist",aria:"ordered list",tagNames:["ol"],useQueryState:!0,contentDefault:"<b>1.</b>",contentFA:'<i class="fa fa-list-ol"></i>'},unorderedlist:{name:"unorderedlist",action:"insertunorderedlist",aria:"unordered list",tagNames:["ul"],useQueryState:!0,contentDefault:"<b>&bull;</b>",contentFA:'<i class="fa fa-list-ul"></i>'},indent:{name:"indent",action:"indent",aria:"indent",tagNames:[],contentDefault:"<b>&rarr;</b>",contentFA:'<i class="fa fa-indent"></i>'},outdent:{name:"outdent",action:"outdent",aria:"outdent",tagNames:[],contentDefault:"<b>&larr;</b>",contentFA:'<i class="fa fa-outdent"></i>'},justifyCenter:{name:"justifyCenter",action:"justifyCenter",aria:"center justify",tagNames:[],style:{prop:"text-align",value:"center"},contentDefault:"<b>C</b>",contentFA:'<i class="fa fa-align-center"></i>'},justifyFull:{name:"justifyFull",action:"justifyFull",aria:"full justify",tagNames:[],style:{prop:"text-align",value:"justify"},contentDefault:"<b>J</b>",contentFA:'<i class="fa fa-align-justify"></i>'},justifyLeft:{name:"justifyLeft",action:"justifyLeft",aria:"left justify",tagNames:[],style:{prop:"text-align",value:"left"},contentDefault:"<b>L</b>",contentFA:'<i class="fa fa-align-left"></i>'},justifyRight:{name:"justifyRight",action:"justifyRight",aria:"right justify",tagNames:[],style:{prop:"text-align",value:"right"},contentDefault:"<b>R</b>",contentFA:'<i class="fa fa-align-right"></i>'},removeFormat:{name:"removeFormat",aria:"remove formatting",action:"removeFormat",contentDefault:"<b>X</b>",contentFA:'<i class="fa fa-eraser"></i>'},quote:{name:"quote",action:"append-blockquote",aria:"blockquote",tagNames:["blockquote"],contentDefault:"<b>&ldquo;</b>",contentFA:'<i class="fa fa-quote-right"></i>'},pre:{name:"pre",action:"append-pre",aria:"preformatted text",tagNames:["pre"],contentDefault:"<b>0101</b>",contentFA:'<i class="fa fa-code fa-lg"></i>'},h1:{name:"h1",action:"append-h1",aria:"header type one",tagNames:["h1"],contentDefault:"<b>H1</b>",contentFA:'<i class="fa fa-header"><sup>1</sup>'},h2:{name:"h2",action:"append-h2",aria:"header type two",tagNames:["h2"],contentDefault:"<b>H2</b>",contentFA:'<i class="fa fa-header"><sup>2</sup>'},h3:{name:"h3",action:"append-h3",aria:"header type three",tagNames:["h3"],contentDefault:"<b>H3</b>",contentFA:'<i class="fa fa-header"><sup>3</sup>'},h4:{name:"h4",action:"append-h4",aria:"header type four",tagNames:["h4"],contentDefault:"<b>H4</b>",contentFA:'<i class="fa fa-header"><sup>4</sup>'},h5:{name:"h5",action:"append-h5",aria:"header type five",tagNames:["h5"],contentDefault:"<b>H5</b>",contentFA:'<i class="fa fa-header"><sup>5</sup>'},h6:{name:"h6",action:"append-h6",aria:"header type six",tagNames:["h6"],contentDefault:"<b>H6</b>",contentFA:'<i class="fa fa-header"><sup>6</sup>'}},i=v.extensions.button.extend({init:function(){v.extensions.button.prototype.init.apply(this,arguments)},formSaveLabel:"&#10003;",formCloseLabel:"&times;",activeClass:"medium-editor-toolbar-form-active",hasForm:!0,getForm:function(){},isDisplayed:function(){return!!this.hasForm&&this.getForm().classList.contains(this.activeClass)},showForm:function(){this.hasForm&&this.getForm().classList.add(this.activeClass)},hideForm:function(){this.hasForm&&this.getForm().classList.remove(this.activeClass)},showToolbarDefaultActions:function(){var e=this.base.getExtensionByName("toolbar");e&&e.showToolbarDefaultActions()},hideToolbarDefaultActions:function(){var e=this.base.getExtensionByName("toolbar");e&&e.hideToolbarDefaultActions()},setToolbarPosition:function(){var e=this.base.getExtensionByName("toolbar");e&&e.setToolbarPosition()}}),v.extensions.form=i,o=v.extensions.form.extend({customClassOption:null,customClassOptionText:"Button",linkValidation:!1,placeholderText:"Paste or type a link",targetCheckbox:!1,targetCheckboxText:"Open in new window",name:"anchor",action:"createLink",aria:"link",tagNames:["a"],contentDefault:"<b>#</b>",contentFA:'<i class="fa fa-link"></i>',init:function(){v.extensions.form.prototype.init.apply(this,arguments),this.subscribe("editableKeydown",this.handleKeydown.bind(this))},handleClick:function(e){e.preventDefault(),e.stopPropagation();var t=v.selection.getSelectionRange(this.document);return"a"===t.startContainer.nodeName.toLowerCase()||"a"===t.endContainer.nodeName.toLowerCase()||v.util.getClosestTag(v.selection.getSelectedParentElement(t),"a")?this.execAction("unlink"):(this.isDisplayed()||this.showForm(),!1)},handleKeydown:function(e){v.util.isKey(e,v.util.keyCode.K)&&v.util.isMetaCtrlKey(e)&&!e.shiftKey&&this.handleClick(e)},getForm:function(){return this.form||(this.form=this.createForm()),this.form},getTemplate:function(){var e=['<input type="text" class="medium-editor-toolbar-input" placeholder="',this.placeholderText,'">'];return e.push('<a href="#" class="medium-editor-toolbar-save">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':this.formSaveLabel,"</a>"),e.push('<a href="#" class="medium-editor-toolbar-close">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':this.formCloseLabel,"</a>"),this.targetCheckbox&&e.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-target" id="medium-editor-toolbar-anchor-target-field-'+this.getEditorId()+'">','<label for="medium-editor-toolbar-anchor-target-field-'+this.getEditorId()+'">',this.targetCheckboxText,"</label>","</div>"),this.customClassOption&&e.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-button">',"<label>",this.customClassOptionText,"</label>","</div>"),e.join("")},isDisplayed:function(){return v.extensions.form.prototype.isDisplayed.apply(this)},hideForm:function(){v.extensions.form.prototype.hideForm.apply(this),this.getInput().value=""},showForm:function(e){var t=this.getInput(),n=this.getAnchorTargetCheckbox(),i=this.getAnchorButtonCheckbox();if("string"==typeof(e=e||{value:""})&&(e={value:e}),this.base.saveSelection(),this.hideToolbarDefaultActions(),v.extensions.form.prototype.showForm.apply(this),this.setToolbarPosition(),t.value=e.value,t.focus(),n&&(n.checked="_blank"===e.target),i){var o=e.buttonClass?e.buttonClass.split(" "):[];i.checked=-1!==o.indexOf(this.customClassOption)}},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},getFormOpts:function(){var e=this.getAnchorTargetCheckbox(),t=this.getAnchorButtonCheckbox(),n={value:this.getInput().value.trim()};return this.linkValidation&&(n.value=this.checkLinkFormat(n.value)),n.target="_self",e&&e.checked&&(n.target="_blank"),t&&t.checked&&(n.buttonClass=this.customClassOption),n},doFormSave:function(){var e=this.getFormOpts();this.completeFormSave(e)},completeFormSave:function(e){this.base.restoreSelection(),this.execAction(this.action,e),this.base.checkSelection()},ensureEncodedUri:function(e){return e===decodeURI(e)?encodeURI(e):e},ensureEncodedUriComponent:function(e){return e===decodeURIComponent(e)?encodeURIComponent(e):e},ensureEncodedParam:function(e){var t=e.split("="),n=t[0],i=t[1];return n+(void 0===i?"":"="+this.ensureEncodedUriComponent(i))},ensureEncodedQuery:function(e){return e.split("&").map(this.ensureEncodedParam.bind(this)).join("&")},checkLinkFormat:function(e){var t=/^([a-z]+:)?\/\/|^(mailto|tel|maps):|^\#/i.test(e),n="",i=e.match(/^(.*?)(?:\?(.*?))?(?:#(.*))?$/),o=i[1],a=i[2],r=i[3];if(/^\+?\s?\(?(?:\d\s?\-?\)?){3,20}$/.test(e))return"tel:"+e;if(!t){var s=o.split("/")[0];!s.match(/.+(\.|:).+/)&&"localhost"!==s||(n="http://")}return n+this.ensureEncodedUri(o)+(void 0===a?"":"?"+this.ensureEncodedQuery(a))+(void 0===r?"":"#"+r)},doFormCancel:function(){this.base.restoreSelection(),this.base.checkSelection()},attachFormEvents:function(e){var t=e.querySelector(".medium-editor-toolbar-close"),n=e.querySelector(".medium-editor-toolbar-save"),i=e.querySelector(".medium-editor-toolbar-input");this.on(e,"click",this.handleFormClick.bind(this)),this.on(i,"keyup",this.handleTextboxKeyup.bind(this)),this.on(t,"click",this.handleCloseClick.bind(this)),this.on(n,"click",this.handleSaveClick.bind(this),!0)},createForm:function(){var e=this.document.createElement("div");return e.className="medium-editor-toolbar-form",e.id="medium-editor-toolbar-form-anchor-"+this.getEditorId(),e.innerHTML=this.getTemplate(),this.attachFormEvents(e),e},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},getAnchorTargetCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-target")},getAnchorButtonCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-button")},handleTextboxKeyup:function(e){if(e.keyCode===v.util.keyCode.ENTER)return e.preventDefault(),void this.doFormSave();e.keyCode===v.util.keyCode.ESCAPE&&(e.preventDefault(),this.doFormCancel())},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()},handleCloseClick:function(e){e.preventDefault(),this.doFormCancel()}}),v.extensions.anchor=o,a=v.Extension.extend({name:"anchor-preview",hideDelay:500,previewValueSelector:"a",showWhenToolbarIsVisible:!1,showOnEmptyLinks:!0,init:function(){this.anchorPreview=this.createPreview(),this.getEditorOption("elementsContainer").appendChild(this.anchorPreview),this.attachToEditables()},getInteractionElements:function(){return this.getPreviewElement()},getPreviewElement:function(){return this.anchorPreview},createPreview:function(){var e=this.document.createElement("div");return e.id="medium-editor-anchor-preview-"+this.getEditorId(),e.className="medium-editor-anchor-preview",e.innerHTML=this.getTemplate(),this.on(e,"click",this.handleClick.bind(this)),e},getTemplate:function(){return'<div class="medium-editor-toolbar-anchor-preview" id="medium-editor-toolbar-anchor-preview">    <a class="medium-editor-toolbar-anchor-preview-inner"></a></div>'},destroy:function(){this.anchorPreview&&(this.anchorPreview.parentNode&&this.anchorPreview.parentNode.removeChild(this.anchorPreview),delete this.anchorPreview)},hidePreview:function(){this.anchorPreview&&this.anchorPreview.classList.remove("medium-editor-anchor-preview-active"),this.activeAnchor=null},showPreview:function(e){return!(!this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")&&!e.getAttribute("data-disable-preview"))||(this.previewValueSelector&&(this.anchorPreview.querySelector(this.previewValueSelector).textContent=e.attributes.href.value,this.anchorPreview.querySelector(this.previewValueSelector).href=e.attributes.href.value),this.anchorPreview.classList.add("medium-toolbar-arrow-over"),this.anchorPreview.classList.remove("medium-toolbar-arrow-under"),this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")||this.anchorPreview.classList.add("medium-editor-anchor-preview-active"),this.activeAnchor=e,this.positionPreview(),this.attachPreviewHandlers(),this)},positionPreview:function(e){e=e||this.activeAnchor;var t,n,i,o,a,r=this.window.innerWidth,s=this.anchorPreview.offsetHeight,l=e.getBoundingClientRect(),c=this.diffLeft,u=this.diffTop,d=this.getEditorOption("elementsContainer"),h=-1<["absolute","fixed"].indexOf(window.getComputedStyle(d).getPropertyValue("position")),p={};t=this.anchorPreview.offsetWidth/2;var m=this.base.getExtensionByName("toolbar");m&&(c=m.diffLeft,u=m.diffTop),n=c-t,a=h?(o=d.getBoundingClientRect(),["top","left"].forEach(function(e){p[e]=l[e]-o[e]}),p.width=l.width,p.height=l.height,l=p,r=o.width,d.scrollTop):this.window.pageYOffset,i=l.left+l.width/2,a+=s+l.top+l.height-u-this.anchorPreview.offsetHeight,this.anchorPreview.style.top=Math.round(a)+"px",this.anchorPreview.style.right="initial",i<t?(this.anchorPreview.style.left=n+t+"px",this.anchorPreview.style.right="initial"):r-i<t?(this.anchorPreview.style.left="auto",this.anchorPreview.style.right=0):(this.anchorPreview.style.left=n+i+"px",this.anchorPreview.style.right="initial")},attachToEditables:function(){this.subscribe("editableMouseover",this.handleEditableMouseover.bind(this)),this.subscribe("positionedToolbar",this.handlePositionedToolbar.bind(this))},handlePositionedToolbar:function(){this.showWhenToolbarIsVisible||this.hidePreview()},handleClick:function(e){var t=this.base.getExtensionByName("anchor"),n=this.activeAnchor;t&&n&&(e.preventDefault(),this.base.selectElement(this.activeAnchor),this.base.delay(function(){if(n){var e={value:n.attributes.href.value,target:n.getAttribute("target"),buttonClass:n.getAttribute("class")};t.showForm(e),n=null}}.bind(this))),this.hidePreview()},handleAnchorMouseout:function(){this.anchorToPreview=null,this.off(this.activeAnchor,"mouseout",this.instanceHandleAnchorMouseout),this.instanceHandleAnchorMouseout=null},handleEditableMouseover:function(e){var t=v.util.getClosestTag(e.target,"a");if(!1!==t){if(!this.showOnEmptyLinks&&(!/href=["']\S+["']/.test(t.outerHTML)||/href=["']#\S+["']/.test(t.outerHTML)))return!0;var n=this.base.getExtensionByName("toolbar");if(!this.showWhenToolbarIsVisible&&n&&n.isDisplayed&&n.isDisplayed())return!0;this.activeAnchor&&this.activeAnchor!==t&&this.detachPreviewHandlers(),this.anchorToPreview=t,this.instanceHandleAnchorMouseout=this.handleAnchorMouseout.bind(this),this.on(this.anchorToPreview,"mouseout",this.instanceHandleAnchorMouseout),this.base.delay(function(){this.anchorToPreview&&this.showPreview(this.anchorToPreview)}.bind(this))}},handlePreviewMouseover:function(){this.lastOver=(new Date).getTime(),this.hovering=!0},handlePreviewMouseout:function(e){e.relatedTarget&&/anchor-preview/.test(e.relatedTarget.className)||(this.hovering=!1)},updatePreview:function(){if(this.hovering)return!0;(new Date).getTime()-this.lastOver>this.hideDelay&&this.detachPreviewHandlers()},detachPreviewHandlers:function(){clearInterval(this.intervalTimer),this.instanceHandlePreviewMouseover&&(this.off(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.off(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.activeAnchor&&(this.off(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.off(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout))),this.hidePreview(),this.hovering=this.instanceHandlePreviewMouseover=this.instanceHandlePreviewMouseout=null},attachPreviewHandlers:function(){this.lastOver=(new Date).getTime(),this.hovering=!0,this.instanceHandlePreviewMouseover=this.handlePreviewMouseover.bind(this),this.instanceHandlePreviewMouseout=this.handlePreviewMouseout.bind(this),this.intervalTimer=setInterval(this.updatePreview.bind(this),200),this.on(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.on(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.on(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.on(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout)}}),v.extensions.anchorPreview=a,function(){var a,e,r,s;a=[" ","\t","\n","\r","","","","","","\u2028","\u2029"],e="com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw",r=new RegExp("^("+e+")$","i"),s=new RegExp("(((?:(https?://|ftps?://|nntp://)|www\\d{0,3}[.]|[a-z0-9.\\-]+[.](com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw)\\/)\\S+(?:[^\\s`!\\[\\]{};:'\".,?])))|(([a-z0-9\\-]+\\.)?[a-z0-9\\-]+\\.(com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw))","gi");var t=v.Extension.extend({init:function(){v.Extension.prototype.init.apply(this,arguments),this.disableEventHandling=!1,this.subscribe("editableKeypress",this.onKeypress.bind(this)),this.subscribe("editableBlur",this.onBlur.bind(this)),this.document.execCommand("AutoUrlDetect",!1,!1)},isLastInstance:function(){for(var e=0,t=0;t<this.window._mediumEditors.length;t++){var n=this.window._mediumEditors[t];null!==n&&void 0!==n.getExtensionByName("autoLink")&&e++}return 1===e},destroy:function(){this.document.queryCommandSupported("AutoUrlDetect")&&this.isLastInstance()&&this.document.execCommand("AutoUrlDetect",!1,!0)},onBlur:function(e,t){this.performLinking(t)},onKeypress:function(t){this.disableEventHandling||v.util.isKey(t,[v.util.keyCode.SPACE,v.util.keyCode.ENTER])&&(clearTimeout(this.performLinkingTimeout),this.performLinkingTimeout=setTimeout(function(){try{var e=this.base.exportSelection();this.performLinking(t.target)&&this.base.importSelection(e,!0)}catch(e){window.console&&window.console.error("Failed to perform linking",e),this.disableEventHandling=!0}}.bind(this),0))},performLinking:function(e){var t=v.util.splitByBlockElements(e),n=!1;0===t.length&&(t=[e]);for(var i=0;i<t.length;i++)n=this.removeObsoleteAutoLinkSpans(t[i])||n,n=this.performLinkingWithinElement(t[i])||n;return this.base.events.updateInput(e,{target:e,currentTarget:e}),n},removeObsoleteAutoLinkSpans:function(e){if(!e||3===e.nodeType)return!1;for(var t,n=e.querySelectorAll('span[data-auto-link="true"]'),i=!1,o=0;o<n.length;o++){var a=n[o].textContent;if(-1===a.indexOf("://")&&(a=v.util.ensureUrlHasProtocol(a)),n[o].getAttribute("data-href")!==a&&(t=n[o],!v.util.getClosestTag(t,"a"))){i=!0;var r=a.replace(/\s+$/,"");if(n[o].getAttribute("data-href")===r){var s=a.length-r.length,l=v.util.splitOffDOMTree(n[o],this.splitTextBeforeEnd(n[o],s));n[o].parentNode.insertBefore(l,n[o].nextSibling)}else v.util.unwrap(n[o],this.document)}}return i},splitTextBeforeEnd:function(e,t){for(var n,i,o,a=this.document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),r=!0;r;)r=null!==a.lastChild();for(;0<t&&null!==o;)(i=(n=a.currentNode).nodeValue).length>t?(o=n.splitText(i.length-t),t=0):(o=a.previousNode(),t-=i.length);return o},performLinkingWithinElement:function(e){for(var t=this.findLinkableText(e),n=0;n<t.length;n++){var i=v.util.findOrCreateMatchingTextNodes(this.document,e,t[n]);this.shouldNotLink(i)||this.createAutoLink(i,t[n].href)}return!1},shouldNotLink:function(e){for(var t=!1,n=0;n<e.length&&!1===t;n++)t=!!v.util.traverseUp(e[n],function(e){return"a"===e.nodeName.toLowerCase()||e.getAttribute&&"true"===e.getAttribute("data-auto-link")});return t},findLinkableText:function(e){for(var t=e.textContent,n=null,i=[];null!==(n=s.exec(t));){var o=n.index+n[0].length;!(0!==n.index&&-1===a.indexOf(t[n.index-1])||o!==t.length&&-1===a.indexOf(t[o]))&&(-1!==n[0].indexOf("/")||r.test(n[0].split(".").pop().split("?").shift()))&&i.push({href:n[0],start:n.index,end:o})}return i},createAutoLink:function(e,t){t=v.util.ensureUrlHasProtocol(t);var n=v.util.createLink(this.document,e,t,this.getEditorOption("targetBlank")?"_blank":null),i=this.document.createElement("span");for(i.setAttribute("data-auto-link","true"),i.setAttribute("data-href",t),n.insertBefore(i,n.firstChild);1<n.childNodes.length;)i.appendChild(n.childNodes[1])}});v.extensions.autoLink=t}(),r="medium-editor-dragover",s=v.Extension.extend({name:"fileDragging",allowedTypes:["image"],init:function(){v.Extension.prototype.init.apply(this,arguments),this.subscribe("editableDrag",this.handleDrag.bind(this)),this.subscribe("editableDrop",this.handleDrop.bind(this))},handleDrag:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy";var t=e.target.classList?e.target:e.target.parentElement;x(t),"dragover"===e.type&&t.classList.add(r)},handleDrop:function(e){e.preventDefault(),e.stopPropagation(),this.base.selectElement(e.target);var t=this.base.exportSelection();t.start=t.end,this.base.importSelection(t),e.dataTransfer.files&&Array.prototype.slice.call(e.dataTransfer.files).forEach(function(e){this.isAllowedFile(e)&&e.type.match("image")&&this.insertImageFile(e)},this),x(e.target)},isAllowedFile:function(t){return this.allowedTypes.some(function(e){return!!t.type.match(e)})},insertImageFile:function(e){if("function"==typeof FileReader){var t=new FileReader;t.readAsDataURL(e),t.addEventListener("load",function(e){var t=this.document.createElement("img");t.src=e.target.result,v.util.insertHTMLCommand(this.document,t.outerHTML)}.bind(this))}}}),v.extensions.fileDragging=s,l=v.Extension.extend({name:"keyboard-commands",commands:[{command:"bold",key:"B",meta:!0,shift:!1,alt:!1},{command:"italic",key:"I",meta:!0,shift:!1,alt:!1},{command:"underline",key:"U",meta:!0,shift:!1,alt:!1}],init:function(){v.Extension.prototype.init.apply(this,arguments),this.subscribe("editableKeydown",this.handleKeydown.bind(this)),this.keys={},this.commands.forEach(function(e){var t=e.key.charCodeAt(0);this.keys[t]||(this.keys[t]=[]),this.keys[t].push(e)},this)},handleKeydown:function(t){var e=v.util.getKeyCode(t);if(this.keys[e]){var n=v.util.isMetaCtrlKey(t),i=!!t.shiftKey,o=!!t.altKey;this.keys[e].forEach(function(e){e.meta!==n||e.shift!==i||e.alt!==o&&void 0!==e.alt||(t.preventDefault(),t.stopPropagation(),"function"==typeof e.command?e.command.apply(this):!1!==e.command&&this.execAction(e.command))},this)}}}),v.extensions.keyboardCommands=l,c=v.extensions.form.extend({name:"fontname",action:"fontName",aria:"change font name",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-font"></i>',fonts:["","Arial","Verdana","Times New Roman"],init:function(){v.extensions.form.prototype.init.apply(this,arguments)},handleClick:function(e){if(e.preventDefault(),e.stopPropagation(),!this.isDisplayed()){var t=this.document.queryCommandValue("fontName")+"";this.showForm(t)}return!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getSelect().value=""},showForm:function(e){var t=this.getSelect();this.base.saveSelection(),this.hideToolbarDefaultActions(),this.getForm().style.display="block",this.setToolbarPosition(),t.value=e||"",t.focus()},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},doFormSave:function(){this.base.restoreSelection(),this.base.checkSelection()},doFormCancel:function(){this.base.restoreSelection(),this.clearFontName(),this.base.checkSelection()},createForm:function(){var e,t=this.document,n=t.createElement("div"),i=t.createElement("select"),o=t.createElement("a"),a=t.createElement("a");n.className="medium-editor-toolbar-form",n.id="medium-editor-toolbar-form-fontname-"+this.getEditorId(),this.on(n,"click",this.handleFormClick.bind(this));for(var r=0;r<this.fonts.length;r++)(e=t.createElement("option")).innerHTML=this.fonts[r],e.value=this.fonts[r],i.appendChild(e);return i.className="medium-editor-toolbar-select",n.appendChild(i),this.on(i,"change",this.handleFontChange.bind(this)),a.setAttribute("href","#"),a.className="medium-editor-toobar-save",a.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':"&#10003;",n.appendChild(a),this.on(a,"click",this.handleSaveClick.bind(this),!0),o.setAttribute("href","#"),o.className="medium-editor-toobar-close",o.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':"&times;",n.appendChild(o),this.on(o,"click",this.handleCloseClick.bind(this)),n},getSelect:function(){return this.getForm().querySelector("select.medium-editor-toolbar-select")},clearFontName:function(){v.selection.getSelectedElements(this.document).forEach(function(e){"font"===e.nodeName.toLowerCase()&&e.hasAttribute("face")&&e.removeAttribute("face")})},handleFontChange:function(){var e=this.getSelect().value;""===e?this.clearFontName():this.execAction("fontName",{value:e})},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()},handleCloseClick:function(e){e.preventDefault(),this.doFormCancel()}}),v.extensions.fontName=c,d=v.extensions.form.extend({name:"fontsize",action:"fontSize",aria:"increase/decrease font size",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-text-height"></i>',init:function(){v.extensions.form.prototype.init.apply(this,arguments)},handleClick:function(e){if(e.preventDefault(),e.stopPropagation(),!this.isDisplayed()){var t=this.document.queryCommandValue("fontSize")+"";this.showForm(t)}return!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getInput().value=""},showForm:function(e){var t=this.getInput();this.base.saveSelection(),this.hideToolbarDefaultActions(),this.getForm().style.display="block",this.setToolbarPosition(),t.value=e||"",t.focus()},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},doFormSave:function(){this.base.restoreSelection(),this.base.checkSelection()},doFormCancel:function(){this.base.restoreSelection(),this.clearFontSize(),this.base.checkSelection()},createForm:function(){var e=this.document,t=e.createElement("div"),n=e.createElement("input"),i=e.createElement("a"),o=e.createElement("a");return t.className="medium-editor-toolbar-form",t.id="medium-editor-toolbar-form-fontsize-"+this.getEditorId(),this.on(t,"click",this.handleFormClick.bind(this)),n.setAttribute("type","range"),n.setAttribute("min","1"),n.setAttribute("max","7"),n.className="medium-editor-toolbar-input",t.appendChild(n),this.on(n,"change",this.handleSliderChange.bind(this)),o.setAttribute("href","#"),o.className="medium-editor-toobar-save",o.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':"&#10003;",t.appendChild(o),this.on(o,"click",this.handleSaveClick.bind(this),!0),i.setAttribute("href","#"),i.className="medium-editor-toobar-close",i.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':"&times;",t.appendChild(i),this.on(i,"click",this.handleCloseClick.bind(this)),t},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},clearFontSize:function(){v.selection.getSelectedElements(this.document).forEach(function(e){"font"===e.nodeName.toLowerCase()&&e.hasAttribute("size")&&e.removeAttribute("size")})},handleSliderChange:function(){var e=this.getInput().value;"4"===e?this.clearFontSize():this.execAction("fontSize",{value:e})},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()},handleCloseClick:function(e){e.preventDefault(),this.doFormCancel()}}),v.extensions.fontSize=d,h="%ME_PASTEBIN%",m=p=null,f=v.Extension.extend({forcePlainText:!0,cleanPastedHTML:!1,preCleanReplacements:[],cleanReplacements:[],cleanAttrs:["class","style","dir"],cleanTags:["meta"],unwrapTags:[],init:function(){v.Extension.prototype.init.apply(this,arguments),(this.forcePlainText||this.cleanPastedHTML)&&(this.subscribe("editableKeydown",this.handleKeydown.bind(this)),this.getEditorElements().forEach(function(e){this.on(e,"paste",this.handlePaste.bind(this))},this),this.subscribe("addElement",this.handleAddElement.bind(this)))},handleAddElement:function(e,t){this.on(t,"paste",this.handlePaste.bind(this))},destroy:function(){(this.forcePlainText||this.cleanPastedHTML)&&this.removePasteBin()},handlePaste:function(e,t){if(!e.defaultPrevented){var n=k(e,this.window,this.document),i=n["text/html"],o=n["text/plain"];this.window.clipboardData&&void 0===e.clipboardData&&!i&&(i=o),(i||o)&&(e.preventDefault(),this.doPaste(i,o,t))}},doPaste:function(e,t,n){var i,o,a="";if(this.cleanPastedHTML&&e)return this.cleanPaste(e);if(t){if(this.getEditorOption("disableReturn")||n&&n.getAttribute("data-disable-return"))a=v.util.htmlEntities(t);else if(1<(i=t.split(/[\r\n]+/g)).length)for(o=0;o<i.length;o+=1)""!==i[o]&&(a+="<p>"+v.util.htmlEntities(i[o])+"</p>");else a=v.util.htmlEntities(i[0]);v.util.insertHTMLCommand(this.document,a)}},handlePasteBinPaste:function(e){if(e.defaultPrevented)this.removePasteBin();else{var t=k(e,this.window,this.document),n=t["text/html"],i=t["text/plain"],o=m;if(!this.cleanPastedHTML||n)return e.preventDefault(),this.removePasteBin(),this.doPaste(n,i,o),void this.trigger("editablePaste",{currentTarget:o,target:o},o);setTimeout(function(){this.cleanPastedHTML&&(n=this.getPasteBinHtml()),this.removePasteBin(),this.doPaste(n,i,o),this.trigger("editablePaste",{currentTarget:o,target:o},o)}.bind(this),0)}},handleKeydown:function(e,t){v.util.isKey(e,v.util.keyCode.V)&&v.util.isMetaCtrlKey(e)&&(e.stopImmediatePropagation(),this.removePasteBin(),this.createPasteBin(t))},createPasteBin:function(e){var t,n=v.selection.getSelectionRange(this.document),i=this.window.pageYOffset;m=e,n&&((t=n.getClientRects()).length?i+=t[0].top:void 0!==n.startContainer.getBoundingClientRect?i+=n.startContainer.getBoundingClientRect().top:i+=n.getBoundingClientRect().top),p=n;var o=this.document.createElement("div");o.id=this.pasteBinId="medium-editor-pastebin-"+ +Date.now(),o.setAttribute("style","border: 1px red solid; position: absolute; top: "+i+"px; width: 10px; height: 10px; overflow: hidden; opacity: 0"),o.setAttribute("contentEditable",!0),o.innerHTML=h,this.document.body.appendChild(o),this.on(o,"focus",_),this.on(o,"focusin",_),this.on(o,"focusout",_),o.focus(),v.selection.selectNode(o,this.document),this.boundHandlePaste||(this.boundHandlePaste=this.handlePasteBinPaste.bind(this)),this.on(o,"paste",this.boundHandlePaste)},removePasteBin:function(){null!==p&&(v.selection.selectRange(this.document,p),p=null),null!==m&&(m=null);var e=this.getPasteBin();e&&e&&(this.off(e,"focus",_),this.off(e,"focusin",_),this.off(e,"focusout",_),this.off(e,"paste",this.boundHandlePaste),e.parentElement.removeChild(e))},getPasteBin:function(){return this.document.getElementById(this.pasteBinId)},getPasteBinHtml:function(){var e=this.getPasteBin();if(!e)return!1;if(e.firstChild&&"mcepastebin"===e.firstChild.id)return!1;var t=e.innerHTML;return!(!t||t===h)&&t},cleanPaste:function(e){var t,n,i,o,a=/<p|<br|<div/.test(e),r=[].concat(this.preCleanReplacements||[],[[new RegExp(/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g),""],[new RegExp(/<!--StartFragment-->|<!--EndFragment-->/g),""],[new RegExp(/<br>$/i),""],[new RegExp(/<[^>]*docs-internal-guid[^>]*>/gi),""],[new RegExp(/<\/b>(<br[^>]*>)?$/gi),""],[new RegExp(/<span class="Apple-converted-space">\s+<\/span>/g)," "],[new RegExp(/<br class="Apple-interchange-newline">/g),"<br>"],[new RegExp(/<span[^>]*(font-style:italic;font-weight:(bold|700)|font-weight:(bold|700);font-style:italic)[^>]*>/gi),'<span class="replace-with italic bold">'],[new RegExp(/<span[^>]*font-style:italic[^>]*>/gi),'<span class="replace-with italic">'],[new RegExp(/<span[^>]*font-weight:(bold|700)[^>]*>/gi),'<span class="replace-with bold">'],[new RegExp(/&lt;(\/?)(i|b|a)&gt;/gi),"<$1$2>"],[new RegExp(/&lt;a(?:(?!href).)+href=(?:&quot;|&rdquo;|&ldquo;|"||)(((?!&quot;|&rdquo;|&ldquo;|"||).)*)(?:&quot;|&rdquo;|&ldquo;|"||)(?:(?!&gt;).)*&gt;/gi),'<a href="$1">'],[new RegExp(/<\/p>\n+/gi),"</p>"],[new RegExp(/\n+<p/gi),"<p"],[new RegExp(/<\/?o:[a-z]*>/gi),""],[new RegExp(/<!\[if !supportLists\]>(((?!<!).)*)<!\[endif]\>/gi),"$1"]],this.cleanReplacements||[]);for(t=0;t<r.length;t+=1)e=e.replace(r[t][0],r[t][1]);if(!a)return this.pasteHTML(e);for((i=this.document.createElement("div")).innerHTML="<p>"+e.split("<br><br>").join("</p><p>")+"</p>",n=i.querySelectorAll("a,p,div,br"),t=0;t<n.length;t+=1)switch((o=n[t]).innerHTML=o.innerHTML.replace(/\n/gi," "),o.nodeName.toLowerCase()){case"p":case"div":this.filterCommonBlocks(o);break;case"br":this.filterLineBreak(o)}this.pasteHTML(i.innerHTML)},pasteHTML:function(e,t){t=v.util.defaults({},t,{cleanAttrs:this.cleanAttrs,cleanTags:this.cleanTags,unwrapTags:this.unwrapTags});var n,i,o,a,r=this.document.createDocumentFragment();for(r.appendChild(this.document.createElement("body")),(a=r.querySelector("body")).innerHTML=e,this.cleanupSpans(a),n=a.querySelectorAll("*"),o=0;o<n.length;o+=1)"a"===(i=n[o]).nodeName.toLowerCase()&&this.getEditorOption("targetBlank")&&v.util.setTargetBlank(i),v.util.cleanupAttrs(i,t.cleanAttrs),v.util.cleanupTags(i,t.cleanTags),v.util.unwrapTags(i,t.unwrapTags);v.util.insertHTMLCommand(this.document,a.innerHTML.replace(/&nbsp;/g," "))},isCommonBlock:function(e){return e&&("p"===e.nodeName.toLowerCase()||"div"===e.nodeName.toLowerCase())},filterCommonBlocks:function(e){/^\s*$/.test(e.textContent)&&e.parentNode&&e.parentNode.removeChild(e)},filterLineBreak:function(e){this.isCommonBlock(e.previousElementSibling)?this.removeWithParent(e):!this.isCommonBlock(e.parentNode)||e.parentNode.firstChild!==e&&e.parentNode.lastChild!==e?e.parentNode&&1===e.parentNode.childElementCount&&""===e.parentNode.textContent&&this.removeWithParent(e):this.removeWithParent(e)},removeWithParent:function(e){e&&e.parentNode&&(e.parentNode.parentNode&&1===e.parentNode.childElementCount?e.parentNode.parentNode.removeChild(e.parentNode):e.parentNode.removeChild(e))},cleanupSpans:function(e){function t(e){return e&&"#text"!==e.nodeName&&"false"===e.getAttribute("contenteditable")}var n,i,o,a=e.querySelectorAll(".replace-with");for(n=0;n<a.length;n+=1)i=a[n],o=this.document.createElement(i.classList.contains("bold")?"b":"i"),i.classList.contains("bold")&&i.classList.contains("italic")?o.innerHTML="<i>"+i.innerHTML+"</i>":o.innerHTML=i.innerHTML,i.parentNode.replaceChild(o,i);for(a=e.querySelectorAll("span"),n=0;n<a.length;n+=1){if(i=a[n],v.util.traverseUp(i,t))return!1;v.util.unwrap(i,this.document)}}}),v.extensions.paste=f,g=v.Extension.extend({name:"placeholder",text:"Type your text",hideOnClick:!0,init:function(){v.Extension.prototype.init.apply(this,arguments),this.initPlaceholders(),this.attachEventHandlers()},initPlaceholders:function(){this.getEditorElements().forEach(this.initElement,this)},handleAddElement:function(e,t){this.initElement(t)},initElement:function(e){e.getAttribute("data-placeholder")||e.setAttribute("data-placeholder",this.text),this.updatePlaceholder(e)},destroy:function(){this.getEditorElements().forEach(this.cleanupElement,this)},handleRemoveElement:function(e,t){this.cleanupElement(t)},cleanupElement:function(e){e.getAttribute("data-placeholder")===this.text&&e.removeAttribute("data-placeholder")},showPlaceholder:function(e){e&&(v.util.isFF&&0===e.childNodes.length?(e.classList.add("medium-editor-placeholder-relative"),e.classList.remove("medium-editor-placeholder")):(e.classList.add("medium-editor-placeholder"),e.classList.remove("medium-editor-placeholder-relative")))},hidePlaceholder:function(e){e&&(e.classList.remove("medium-editor-placeholder"),e.classList.remove("medium-editor-placeholder-relative"))},updatePlaceholder:function(e,t){if(e.querySelector("img, blockquote, ul, ol, table")||""!==e.textContent.replace(/^\s+|\s+$/g,""))return this.hidePlaceholder(e);t||this.showPlaceholder(e)},attachEventHandlers:function(){this.hideOnClick&&this.subscribe("focus",this.handleFocus.bind(this)),this.subscribe("editableInput",this.handleInput.bind(this)),this.subscribe("blur",this.handleBlur.bind(this)),this.subscribe("addElement",this.handleAddElement.bind(this)),this.subscribe("removeElement",this.handleRemoveElement.bind(this))},handleInput:function(e,t){var n=this.hideOnClick&&t===this.base.getFocusedElement();this.updatePlaceholder(t,n)},handleFocus:function(e,t){this.hidePlaceholder(t)},handleBlur:function(e,t){this.updatePlaceholder(t)}}),v.extensions.placeholder=g,b=v.Extension.extend({name:"toolbar",align:"center",allowMultiParagraphSelection:!0,buttons:["bold","italic","underline","anchor","h2","h3","quote"],diffLeft:0,diffTop:-10,firstButtonClass:"medium-editor-button-first",lastButtonClass:"medium-editor-button-last",standardizeSelectionStart:!1,static:!1,sticky:!1,stickyTopOffset:0,updateOnEmptySelection:!1,relativeContainer:null,init:function(){v.Extension.prototype.init.apply(this,arguments),this.initThrottledMethods(),this.relativeContainer?this.relativeContainer.appendChild(this.getToolbarElement()):this.getEditorOption("elementsContainer").appendChild(this.getToolbarElement())},forEachExtension:function(t,n){return this.base.extensions.forEach(function(e){if(e!==this)return t.apply(n||this,arguments)},this)},createToolbar:function(){var t=this.document.createElement("div");return t.id="medium-editor-toolbar-"+this.getEditorId(),t.className="medium-editor-toolbar",this.static?t.className+=" static-toolbar":this.relativeContainer?t.className+=" medium-editor-relative-toolbar":t.className+=" medium-editor-stalker-toolbar",t.appendChild(this.createToolbarButtons()),this.forEachExtension(function(e){e.hasForm&&t.appendChild(e.getForm())}),this.attachEventHandlers(),t},createToolbarButtons:function(){var t,n,e,i,o,a,r=this.document.createElement("ul");return r.id="medium-editor-toolbar-actions"+this.getEditorId(),r.className="medium-editor-toolbar-actions",r.style.display="block",this.buttons.forEach(function(e){a="string"==typeof e?(o=e,null):(o=e.name,e),(i=this.base.addBuiltInExtension(o,a))&&"function"==typeof i.getButton&&(n=i.getButton(this.base),t=this.document.createElement("li"),v.util.isElement(n)?t.appendChild(n):t.innerHTML=n,r.appendChild(t))},this),0<(e=r.querySelectorAll("button")).length&&(e[0].classList.add(this.firstButtonClass),e[e.length-1].classList.add(this.lastButtonClass)),r},destroy:function(){this.toolbar&&(this.toolbar.parentNode&&this.toolbar.parentNode.removeChild(this.toolbar),delete this.toolbar)},getInteractionElements:function(){return this.getToolbarElement()},getToolbarElement:function(){return this.toolbar||(this.toolbar=this.createToolbar()),this.toolbar},getToolbarActionsElement:function(){return this.getToolbarElement().querySelector(".medium-editor-toolbar-actions")},initThrottledMethods:function(){this.throttledPositionToolbar=v.util.throttle(function(){this.base.isActive&&this.positionToolbarIfShown()}.bind(this))},attachEventHandlers:function(){this.subscribe("blur",this.handleBlur.bind(this)),this.subscribe("focus",this.handleFocus.bind(this)),this.subscribe("editableClick",this.handleEditableClick.bind(this)),this.subscribe("editableKeyup",this.handleEditableKeyup.bind(this)),this.on(this.document.documentElement,"mouseup",this.handleDocumentMouseup.bind(this)),this.static&&this.sticky&&this.on(this.window,"scroll",this.handleWindowScroll.bind(this),!0),this.on(this.window,"resize",this.handleWindowResize.bind(this))},handleWindowScroll:function(){this.positionToolbarIfShown()},handleWindowResize:function(){this.throttledPositionToolbar()},handleDocumentMouseup:function(e){if(e&&e.target&&v.util.isDescendant(this.getToolbarElement(),e.target))return!1;this.checkState()},handleEditableClick:function(){setTimeout(function(){this.checkState()}.bind(this),0)},handleEditableKeyup:function(){this.checkState()},handleBlur:function(){clearTimeout(this.hideTimeout),clearTimeout(this.delayShowTimeout),this.hideTimeout=setTimeout(function(){this.hideToolbar()}.bind(this),1)},handleFocus:function(){this.checkState()},isDisplayed:function(){return this.getToolbarElement().classList.contains("medium-editor-toolbar-active")},showToolbar:function(){clearTimeout(this.hideTimeout),this.isDisplayed()||(this.getToolbarElement().classList.add("medium-editor-toolbar-active"),this.trigger("showToolbar",{},this.base.getFocusedElement()))},hideToolbar:function(){this.isDisplayed()&&(this.getToolbarElement().classList.remove("medium-editor-toolbar-active"),this.trigger("hideToolbar",{},this.base.getFocusedElement()))},isToolbarDefaultActionsDisplayed:function(){return"block"===this.getToolbarActionsElement().style.display},hideToolbarDefaultActions:function(){this.isToolbarDefaultActionsDisplayed()&&(this.getToolbarActionsElement().style.display="none")},showToolbarDefaultActions:function(){this.hideExtensionForms(),this.isToolbarDefaultActionsDisplayed()||(this.getToolbarActionsElement().style.display="block"),this.delayShowTimeout=this.base.delay(function(){this.showToolbar()}.bind(this))},hideExtensionForms:function(){this.forEachExtension(function(e){e.hasForm&&e.isDisplayed()&&e.hideForm()})},multipleBlockElementsSelected:function(){var e=new RegExp("<("+v.util.blockContainerElementNames.join("|")+")[^>]*>","g"),t=v.selection.getSelectionHtml(this.document).replace(/<[^\/>][^>]*><\/[^>]+>/gim,"").match(e);return!!t&&1<t.length},modifySelection:function(){var e=this.window.getSelection().getRangeAt(0);if(this.standardizeSelectionStart&&e.startContainer.nodeValue&&e.startOffset===e.startContainer.nodeValue.length){var t=v.util.findAdjacentTextNodeWithContent(v.selection.getSelectionElement(this.window),e.startContainer,this.document);if(t){for(var n=0;0===t.nodeValue.substr(n,1).trim().length;)n+=1;e=v.selection.select(this.document,t,n,e.endContainer,e.endOffset)}}},checkState:function(){if(!this.base.preventSelectionUpdates){if(!this.base.getFocusedElement()||v.selection.selectionInContentEditableFalse(this.window))return this.hideToolbar();var e=v.selection.getSelectionElement(this.window);return!e||-1===this.getEditorElements().indexOf(e)||e.getAttribute("data-disable-toolbar")?this.hideToolbar():this.updateOnEmptySelection&&this.static?this.showAndUpdateToolbar():!v.selection.selectionContainsContent(this.document)||!1===this.allowMultiParagraphSelection&&this.multipleBlockElementsSelected()?this.hideToolbar():void this.showAndUpdateToolbar()}},showAndUpdateToolbar:function(){this.modifySelection(),this.setToolbarButtonStates(),this.trigger("positionToolbar",{},this.base.getFocusedElement()),this.showToolbarDefaultActions(),this.setToolbarPosition()},setToolbarButtonStates:function(){this.forEachExtension(function(e){"function"==typeof e.isActive&&"function"==typeof e.setInactive&&e.setInactive()}),this.checkActiveButtons()},checkActiveButtons:function(){function e(e){"function"==typeof e.checkState?e.checkState(t):"function"==typeof e.isActive&&"function"==typeof e.isAlreadyApplied&&"function"==typeof e.setActive&&!e.isActive()&&e.isAlreadyApplied(t)&&e.setActive()}var t,n=[],i=null,o=v.selection.getSelectionRange(this.document);if(o&&(this.forEachExtension(function(e){"function"!=typeof e.queryCommandState||null===(i=e.queryCommandState())?n.push(e):i&&"function"==typeof e.setActive&&e.setActive()}),t=v.selection.getSelectedParentElement(o),this.getEditorElements().some(function(e){return v.util.isDescendant(e,t,!0)})))for(;t&&(n.forEach(e),!v.util.isMediumEditorElement(t));)t=t.parentNode},positionToolbarIfShown:function(){this.isDisplayed()&&this.setToolbarPosition()},setToolbarPosition:function(){var e=this.base.getFocusedElement(),t=this.window.getSelection();if(!e)return this;!this.static&&t.isCollapsed||(this.showToolbar(),this.relativeContainer||(this.static?this.positionStaticToolbar(e):this.positionToolbar(t)),this.trigger("positionedToolbar",{},this.base.getFocusedElement()))},positionStaticToolbar:function(e){this.getToolbarElement().style.left="0";var t,n=this.document.documentElement&&this.document.documentElement.scrollTop||this.document.body.scrollTop,i=this.window.innerWidth,o=this.getToolbarElement(),a=e.getBoundingClientRect(),r=a.top+n,s=a.left+a.width/2,l=o.offsetHeight,c=o.offsetWidth,u=c/2;switch(this.sticky?n>r+e.offsetHeight-l-this.stickyTopOffset?(o.style.top=r+e.offsetHeight-l+"px",o.classList.remove("medium-editor-sticky-toolbar")):n>r-l-this.stickyTopOffset?(o.classList.add("medium-editor-sticky-toolbar"),o.style.top=this.stickyTopOffset+"px"):(o.classList.remove("medium-editor-sticky-toolbar"),o.style.top=r-l+"px"):o.style.top=r-l+"px",this.align){case"left":t=a.left;break;case"right":t=a.right-c;break;case"center":t=s-u}t<0?t=0:i<t+c&&(t=i-Math.ceil(c)-1),o.style.left=t+"px"},positionToolbar:function(e){this.getToolbarElement().style.left="0",this.getToolbarElement().style.right="initial";var t=e.getRangeAt(0),n=t.getBoundingClientRect();n&&(0!==n.height||0!==n.width||t.startContainer!==t.endContainer)||(n=1===t.startContainer.nodeType&&t.startContainer.querySelector("img")?t.startContainer.querySelector("img").getBoundingClientRect():t.startContainer.getBoundingClientRect());var i,o,a=this.window.innerWidth,r=this.getToolbarElement(),s=r.offsetHeight,l=r.offsetWidth/2,c=this.diffLeft-l,u=this.getEditorOption("elementsContainer"),d=-1<["absolute","fixed"].indexOf(window.getComputedStyle(u).getPropertyValue("position")),h={},p={};d?(o=u.getBoundingClientRect(),["top","left"].forEach(function(e){p[e]=n[e]-o[e]}),p.width=n.width,p.height=n.height,n=p,a=o.width,h.top=u.scrollTop):h.top=this.window.pageYOffset,i=n.left+n.width/2,h.top+=n.top-s,n.top<50?(r.classList.add("medium-toolbar-arrow-over"),r.classList.remove("medium-toolbar-arrow-under"),h.top+=50+n.height-this.diffTop):(r.classList.add("medium-toolbar-arrow-under"),r.classList.remove("medium-toolbar-arrow-over"),h.top+=this.diffTop),i<l?(h.left=c+l,h.right="initial"):a-i<l?(h.left="auto",h.right=0):(h.left=c+i,h.right="initial"),["top","left","right"].forEach(function(e){r.style[e]=h[e]+(isNaN(h[e])?"":"px")})}}),v.extensions.toolbar=b,y=v.Extension.extend({init:function(){v.Extension.prototype.init.apply(this,arguments),this.subscribe("editableDrag",this.handleDrag.bind(this)),this.subscribe("editableDrop",this.handleDrop.bind(this))},handleDrag:function(e){var t="medium-editor-dragover";e.preventDefault(),e.dataTransfer.dropEffect="copy","dragover"===e.type?e.target.classList.add(t):"dragleave"===e.type&&e.target.classList.remove(t)},handleDrop:function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.files&&Array.prototype.slice.call(e.dataTransfer.files,0).some(function(e){var t,n;e.type.match("image")&&((t=new FileReader).readAsDataURL(e),n="medium-img-"+ +new Date,v.util.insertHTMLCommand(this.document,'<img class="medium-editor-image-loading" id="'+n+'" />'),t.onload=function(){var e=this.document.getElementById(n);e&&(e.removeAttribute("id"),e.removeAttribute("class"),e.src=t.result)}.bind(this))}.bind(this)),e.target.classList.remove("medium-editor-dragover")}}),v.extensions.imageDragging=y,w={},v.prototype={init:function(e,t){return this.options=function(e,t){return t&&[["allowMultiParagraphSelection","toolbar.allowMultiParagraphSelection"]].forEach(function(e){t.hasOwnProperty(e[0])&&void 0!==t[e[0]]&&v.util.deprecated(e[0],e[1],"v6.0.0")}),v.util.defaults({},t,e)}.call(this,this.defaults,t),this.origElements=e,this.options.elementsContainer||(this.options.elementsContainer=this.options.ownerDocument.body),this.setup()},setup:function(){this.isActive||(function(e){e._mediumEditors||(e._mediumEditors=[null]),this.id||(this.id=e._mediumEditors.length),e._mediumEditors[this.id]=this}.call(this,this.options.contentWindow),this.events=new v.Events(this),this.elements=[],this.addElements(this.origElements),0!==this.elements.length&&(this.isActive=!0,L.call(this),O.call(this)))},destroy:function(){this.isActive&&(this.isActive=!1,this.extensions.forEach(function(e){"function"==typeof e.destroy&&e.destroy()},this),this.events.destroy(),this.elements.forEach(function(e){this.options.spellcheck&&(e.innerHTML=e.innerHTML),e.removeAttribute("contentEditable"),e.removeAttribute("spellcheck"),e.removeAttribute("data-medium-editor-element"),e.classList.remove("medium-editor-element"),e.removeAttribute("role"),e.removeAttribute("aria-multiline"),e.removeAttribute("medium-editor-index"),e.removeAttribute("data-medium-editor-editor-index"),e.getAttribute("medium-editor-textarea-id")&&P(e)},this),this.elements=[],this.instanceHandleEditableKeydownEnter=null,this.instanceHandleEditableInput=null,function(e){e._mediumEditors&&e._mediumEditors[this.id]&&(e._mediumEditors[this.id]=null)}.call(this,this.options.contentWindow))},on:function(e,t,n,i){return this.events.attachDOMEvent(e,t,n,i),this},off:function(e,t,n,i){return this.events.detachDOMEvent(e,t,n,i),this},subscribe:function(e,t){return this.events.attachCustomEvent(e,t),this},unsubscribe:function(e,t){return this.events.detachCustomEvent(e,t),this},trigger:function(e,t,n){return this.events.triggerCustomEvent(e,t,n),this},delay:function(e){var t=this;return setTimeout(function(){t.isActive&&e()},this.options.delay)},serialize:function(){var e,t={},n=this.elements.length;for(e=0;e<n;e+=1)t[""!==this.elements[e].id?this.elements[e].id:"element-"+e]={value:this.elements[e].innerHTML.trim()};return t},getExtensionByName:function(t){var n;return this.extensions&&this.extensions.length&&this.extensions.some(function(e){return e.name===t&&(n=e,!0)}),n},addBuiltInExtension:function(e,t){var n,i=this.getExtensionByName(e);if(i)return i;switch(e){case"anchor":n=v.util.extend({},this.options.anchor,t),i=new v.extensions.anchor(n);break;case"anchor-preview":i=new v.extensions.anchorPreview(this.options.anchorPreview);break;case"autoLink":i=new v.extensions.autoLink;break;case"fileDragging":i=new v.extensions.fileDragging(t);break;case"fontname":i=new v.extensions.fontName(this.options.fontName);break;case"fontsize":i=new v.extensions.fontSize(t);break;case"keyboardCommands":i=new v.extensions.keyboardCommands(this.options.keyboardCommands);break;case"paste":i=new v.extensions.paste(this.options.paste);break;case"placeholder":i=new v.extensions.placeholder(this.options.placeholder);break;default:v.extensions.button.isBuiltInButton(e)&&(i=t?(n=v.util.defaults({},t,v.extensions.button.prototype.defaults[e]),new v.extensions.button(n)):new v.extensions.button(e))}return i&&this.extensions.push(D(i,e,this)),i},stopSelectionUpdates:function(){this.preventSelectionUpdates=!0},startSelectionUpdates:function(){this.preventSelectionUpdates=!1},checkSelection:function(){var e=this.getExtensionByName("toolbar");return e&&e.checkState(),this},queryCommandState:function(e){var t,n=null;(t=/^full-(.+)$/gi.exec(e))&&(e=t[1]);try{n=this.options.ownerDocument.queryCommandState(e)}catch(e){n=null}return n},execAction:function(e,t){var n,i;return(n=/^full-(.+)$/gi.exec(e))?(this.saveSelection(),this.selectAllContents(),i=F.call(this,n[1],t),this.restoreSelection()):i=F.call(this,e,t),"insertunorderedlist"!==e&&"insertorderedlist"!==e||v.util.cleanListDOM(this.options.ownerDocument,this.getSelectedParentElement()),this.checkSelection(),i},getSelectedParentElement:function(e){return void 0===e&&(e=this.options.contentWindow.getSelection().getRangeAt(0)),v.selection.getSelectedParentElement(e)},selectAllContents:function(){var e=v.selection.getSelectionElement(this.options.contentWindow);if(e){for(;1===e.children.length;)e=e.children[0];this.selectElement(e)}},selectElement:function(e){v.selection.selectNode(e,this.options.ownerDocument);var t=v.selection.getSelectionElement(this.options.contentWindow);t&&this.events.focusElement(t)},getFocusedElement:function(){var t;return this.elements.some(function(e){return!t&&e.getAttribute("data-medium-focused")&&(t=e),!!t},this),t},exportSelection:function(){var e=v.selection.getSelectionElement(this.options.contentWindow),t=this.elements.indexOf(e),n=null;return 0<=t&&(n=v.selection.exportSelection(e,this.options.ownerDocument)),null!==n&&0!==t&&(n.editableElementIndex=t),n},saveSelection:function(){this.selectionState=this.exportSelection()},importSelection:function(e,t){if(e){var n=this.elements[e.editableElementIndex||0];v.selection.importSelection(e,n,this.options.ownerDocument,t)}},restoreSelection:function(){this.importSelection(this.selectionState)},createLink:function(e){var t,n=v.selection.getSelectionElement(this.options.contentWindow),i={};if(-1!==this.elements.indexOf(n)){try{if(this.events.disableCustomEvent("editableInput"),e.url&&v.util.deprecated(".url option for createLink",".value","6.0.0"),(t=e.url||e.value)&&0<t.trim().length){var o=this.options.contentWindow.getSelection();if(o){var a,r,s,l,c=o.getRangeAt(0),u=c.commonAncestorContainer;if(3===c.endContainer.nodeType&&3!==c.startContainer.nodeType&&0===c.startOffset&&c.startContainer.firstChild===c.endContainer&&(u=c.endContainer),r=v.util.getClosestBlockContainer(c.startContainer),s=v.util.getClosestBlockContainer(c.endContainer),3!==u.nodeType&&0!==u.textContent.length&&r===s){var d=r||n,h=this.options.ownerDocument.createDocumentFragment();this.execAction("unlink"),a=this.exportSelection(),h.appendChild(d.cloneNode(!0)),n===d?v.selection.select(this.options.ownerDocument,d.firstChild,0,d.lastChild,3===d.lastChild.nodeType?d.lastChild.nodeValue.length:d.lastChild.childNodes.length):v.selection.select(this.options.ownerDocument,d,0,d,d.childNodes.length);var p=this.exportSelection();0===(l=v.util.findOrCreateMatchingTextNodes(this.options.ownerDocument,h,{start:a.start-p.start,end:a.end-p.start,editableElementIndex:a.editableElementIndex})).length&&((h=this.options.ownerDocument.createDocumentFragment()).appendChild(u.cloneNode(!0)),l=[h.firstChild.firstChild,h.firstChild.lastChild]),v.util.createLink(this.options.ownerDocument,l,t.trim());var m=(h.firstChild.innerHTML.match(/^\s+/)||[""])[0].length;v.util.insertHTMLCommand(this.options.ownerDocument,h.firstChild.innerHTML.replace(/^\s+/,"")),a.start-=m,a.end-=m,this.importSelection(a)}else this.options.ownerDocument.execCommand("createLink",!1,t);this.options.targetBlank||"_blank"===e.target?v.util.setTargetBlank(v.selection.getSelectionStart(this.options.ownerDocument),t):v.util.removeTargetBlank(v.selection.getSelectionStart(this.options.ownerDocument),t),e.buttonClass&&v.util.addClassToAnchors(v.selection.getSelectionStart(this.options.ownerDocument),e.buttonClass)}}if(this.options.targetBlank||"_blank"===e.target||e.buttonClass){(i=this.options.ownerDocument.createEvent("HTMLEvents")).initEvent("input",!0,!0,this.options.contentWindow);for(var f=0,g=this.elements.length;f<g;f+=1)this.elements[f].dispatchEvent(i)}}finally{this.events.enableCustomEvent("editableInput")}this.events.triggerCustomEvent("editableInput",i,n)}},cleanPaste:function(e){this.getExtensionByName("paste").cleanPaste(e)},pasteHTML:function(e,t){this.getExtensionByName("paste").pasteHTML(e,t)},setContent:function(e,t){if(t=t||0,this.elements[t]){var n=this.elements[t];n.innerHTML=e,this.checkContentChanged(n)}},getContent:function(e){return e=e||0,this.elements[e]?this.elements[e].innerHTML.trim():null},checkContentChanged:function(e){e=e||v.selection.getSelectionElement(this.options.contentWindow),this.events.updateInput(e,{target:e,currentTarget:e})},resetContent:function(e){if(e){var t=this.elements.indexOf(e);-1!==t&&this.setContent(w[e.getAttribute("medium-editor-index")],t)}else this.elements.forEach(function(e,t){this.setContent(w[e.getAttribute("medium-editor-index")],t)},this)},addElements:function(e){var t=A(e,this.options.ownerDocument,!0);if(0===t.length)return!1;t.forEach(function(e){e=I.call(this,e,this.id),this.elements.push(e),this.trigger("addElement",{target:e,currentTarget:e},e)},this)},removeElements:function(e){var t=A(e,this.options.ownerDocument).map(function(e){return e.getAttribute("medium-editor-textarea-id")&&e.parentNode?e.parentNode.querySelector('div[medium-editor-textarea-id="'+e.getAttribute("medium-editor-textarea-id")+'"]'):e});this.elements=this.elements.filter(function(e){return-1===t.indexOf(e)||(this.events.cleanupElement(e),e.getAttribute("medium-editor-textarea-id")&&P(e),this.trigger("removeElement",{target:e,currentTarget:e},e),!1)},this)}},v.getEditorFromElement=function(e){var t=e.getAttribute("data-medium-editor-editor-index"),n=e&&e.ownerDocument&&(e.ownerDocument.defaultView||e.ownerDocument.parentWindow);return n&&n._mediumEditors&&n._mediumEditors[t]?n._mediumEditors[t]:null},v.prototype.defaults={activeButtonClass:"medium-editor-button-active",buttonLabels:!1,delay:0,disableReturn:!1,disableDoubleReturn:!1,disableExtraSpaces:!1,disableEditing:!1,autoLink:!1,elementsContainer:!1,contentWindow:window,ownerDocument:document,targetBlank:!1,extensions:{},spellcheck:!0},v.version=(v.parseVersionString=function(e){var t=e.split("-"),n=t[0].split("."),i=1<t.length?t[1]:"";return{major:parseInt(n[0],10),minor:parseInt(n[1],10),revision:parseInt(n[2],10),preRelease:i,toString:function(){return[n[0],n[1],n[2]].join(".")+(i?"-"+i:"")}}}).call(this,"5.23.3"),v}())}).call(this,r(21))},function(e,t){e.exports=__F.classnames},function(e,t){e.exports=__F.FancyMixin},function(e,t){e.exports=__F.FancyUtils},function(e,t){e.exports=__F.ReactDOM},function(e,t,n){"use strict";t.__esModule=!0,t.extend=s,t.indexOf=function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},t.escapeExpression=function(e){if("string"!=typeof e){if(e&&e.toHTML)return e.toHTML();if(null==e)return"";if(!e)return e+"";e=""+e}return a.test(e)?e.replace(o,r):e},t.isEmpty=function(e){return!e&&0!==e||!(!u(e)||0!==e.length)},t.createFrame=function(e){var t=s({},e);return t._parent=e,t},t.blockParams=function(e,t){return e.path=t,e},t.appendContextPath=function(e,t){return(e?e+".":"")+t};var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},o=/[&<>"'`=]/g,a=/[&<>"'`=]/;function r(e){return i[e]}function s(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&(e[n]=arguments[t][n]);return e}var l=Object.prototype.toString;t.toString=l;var c=function(e){return"function"==typeof e};c(/x/)&&(t.isFunction=c=function(e){return"function"==typeof e&&"[object Function]"===l.call(e)}),t.isFunction=c;var u=Array.isArray||function(e){return!(!e||"object"!=typeof e)&&"[object Array]"===l.call(e)};t.isArray=u},function(e,t,n){var u=n(11),d=36e5,h=6e4,p=/[T ]/,m=/:/,f=/^(\d{2})$/,g=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],v=/^(\d{4})/,b=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],y=/^-(\d{2})$/,w=/^-?(\d{3})$/,C=/^-?(\d{2})-?(\d{2})$/,E=/^-?W(\d{2})$/,x=/^-?W(\d{2})-?(\d{1})$/,_=/^(\d{2}([.,]\d*)?)$/,k=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,T=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,S=/([Z+-].*)$/,A=/^(Z)$/,P=/^([+-])(\d{2})$/,D=/^([+-])(\d{2}):?(\d{2})$/;function N(e,t,n){t=t||0,n=n||0;var i=new Date(0);i.setUTCFullYear(e,0,4);var o=7*t+n+1-(i.getUTCDay()||7);return i.setUTCDate(i.getUTCDate()+o),i}e.exports=function(e,t){if(u(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?2:Number(n);var i=function(e){var t,n={},i=e.split(p);if(t=m.test(i[0])?(n.date=null,i[0]):(n.date=i[0],i[1])){var o=S.exec(t);o?(n.time=t.replace(o[1],""),n.timezone=o[1]):n.time=t}return n}(e),o=function(e,t){var n,i=g[t],o=b[t];if(n=v.exec(e)||o.exec(e)){var a=n[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(n=f.exec(e)||i.exec(e)){var r=n[1];return{year:100*parseInt(r,10),restDateString:e.slice(r.length)}}return{year:null}}(i.date,n),a=o.year,r=function(e,t){if(null===t)return null;var n,i,o,a;if(0===e.length)return(i=new Date(0)).setUTCFullYear(t),i;if(n=y.exec(e))return i=new Date(0),o=parseInt(n[1],10)-1,i.setUTCFullYear(t,o),i;if(n=w.exec(e)){i=new Date(0);var r=parseInt(n[1],10);return i.setUTCFullYear(t,0,r),i}if(n=C.exec(e)){i=new Date(0),o=parseInt(n[1],10)-1;var s=parseInt(n[2],10);return i.setUTCFullYear(t,o,s),i}if(n=E.exec(e))return a=parseInt(n[1],10)-1,N(t,a);if(n=x.exec(e)){a=parseInt(n[1],10)-1;var l=parseInt(n[2],10)-1;return N(t,a,l)}return null}(o.restDateString,a);if(r){var s,l=r.getTime(),c=0;return i.time&&(c=function(e){var t,n,i;if(t=_.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*d;if(t=k.exec(e))return n=parseInt(t[1],10),i=parseFloat(t[2].replace(",",".")),n%24*d+i*h;if(t=T.exec(e)){n=parseInt(t[1],10),i=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*d+i*h+1e3*o}return null}(i.time)),s=i.timezone?function(e){var t,n;return(t=A.exec(e))?0:(t=P.exec(e))?(n=60*parseInt(t[2],10),"+"===t[1]?-n:n):(t=D.exec(e))?(n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n):0}(i.timezone):(s=new Date(l+c).getTimezoneOffset(),new Date(l+c+s*h).getTimezoneOffset()),new Date(l+c+s*h)}return new Date(e)}},function(e,t,n){"use strict";t.__esModule=!0;var s=["description","fileName","lineNumber","message","name","number","stack"];function l(e,t){var n=t&&t.loc,i=void 0,o=void 0;n&&(e+=" - "+(i=n.start.line)+":"+(o=n.start.column));for(var a=Error.prototype.constructor.call(this,e),r=0;r<s.length;r++)this[s[r]]=a[s[r]];Error.captureStackTrace&&Error.captureStackTrace(this,l);try{n&&(this.lineNumber=i,Object.defineProperty?Object.defineProperty(this,"column",{value:o,enumerable:!0}):this.column=o)}catch(e){}}l.prototype=new Error,t.default=l,e.exports=t.default},function(e,t,n){var i,o,a;
/*!
	autosize 4.0.2
	license: MIT
	http://www.jacklmoore.com/autosize
*/o=[e,t],void 0===(a="function"==typeof(i=function(e,t){"use strict";var u="function"==typeof Map?new Map:function(){var n=[],i=[];return{has:function(e){return-1<n.indexOf(e)},get:function(e){return i[n.indexOf(e)]},set:function(e,t){-1===n.indexOf(e)&&(n.push(e),i.push(t))},delete:function(e){var t=n.indexOf(e);-1<t&&(n.splice(t,1),i.splice(t,1))}}}(),d=function(e){return new Event(e,{bubbles:!0})};try{new Event("test")}catch(e){d=function(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!1),t}}function n(o){if(o&&o.nodeName&&"TEXTAREA"===o.nodeName&&!u.has(o)){var n=null,i=null,a=null,e=function(){o.clientWidth!==i&&c()},r=function(t){window.removeEventListener("resize",e,!1),o.removeEventListener("input",c,!1),o.removeEventListener("keyup",c,!1),o.removeEventListener("autosize:destroy",r,!1),o.removeEventListener("autosize:update",c,!1),Object.keys(t).forEach(function(e){o.style[e]=t[e]}),u.delete(o)}.bind(o,{height:o.style.height,resize:o.style.resize,overflowY:o.style.overflowY,overflowX:o.style.overflowX,wordWrap:o.style.wordWrap});o.addEventListener("autosize:destroy",r,!1),"onpropertychange"in o&&"oninput"in o&&o.addEventListener("keyup",c,!1),window.addEventListener("resize",e,!1),o.addEventListener("input",c,!1),o.addEventListener("autosize:update",c,!1),o.style.overflowX="hidden",o.style.wordWrap="break-word",u.set(o,{destroy:r,update:c}),function(){var e=window.getComputedStyle(o,null);"vertical"===e.resize?o.style.resize="none":"both"===e.resize&&(o.style.resize="horizontal"),n="content-box"===e.boxSizing?-(parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)):parseFloat(e.borderTopWidth)+parseFloat(e.borderBottomWidth),isNaN(n)&&(n=0),c()}()}function s(e){var t=o.style.width;o.style.width="0px",o.offsetWidth,o.style.width=t,o.style.overflowY=e}function l(){if(0!==o.scrollHeight){var e=function(e){for(var t=[];e&&e.parentNode&&e.parentNode instanceof Element;)e.parentNode.scrollTop&&t.push({node:e.parentNode,scrollTop:e.parentNode.scrollTop}),e=e.parentNode;return t}(o),t=document.documentElement&&document.documentElement.scrollTop;o.style.height="",o.style.height=o.scrollHeight+n+"px",i=o.clientWidth,e.forEach(function(e){e.node.scrollTop=e.scrollTop}),t&&(document.documentElement.scrollTop=t)}}function c(){l();var e=Math.round(parseFloat(o.style.height)),t=window.getComputedStyle(o,null),n="content-box"===t.boxSizing?Math.round(parseFloat(t.height)):o.offsetHeight;if(n<e?"hidden"===t.overflowY&&(s("scroll"),l(),n="content-box"===t.boxSizing?Math.round(parseFloat(window.getComputedStyle(o,null).height)):o.offsetHeight):"hidden"!==t.overflowY&&(s("hidden"),l(),n="content-box"===t.boxSizing?Math.round(parseFloat(window.getComputedStyle(o,null).height)):o.offsetHeight),a!==n){a=n;var i=d("autosize:resized");try{o.dispatchEvent(i)}catch(e){}}}}function i(e){var t=u.get(e);t&&t.destroy()}function o(e){var t=u.get(e);t&&t.update()}var a=null;"undefined"==typeof window||"function"!=typeof window.getComputedStyle?((a=function(e){return e}).destroy=function(e){return e},a.update=function(e){return e}):((a=function(e,t){return e&&Array.prototype.forEach.call(e.length?e:[e],function(e){return n(e)}),e}).destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],i),e},a.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],o),e}),t.default=a,e.exports=t.default})?i.apply(t,o):i)||(e.exports=a)},function(e,t,n){var i=n(27);e.exports=function(e){return i(e,{weekStartsOn:1})}},function(e,t){e.exports=function(e){return e instanceof Date}},function(e,t,n){var s=n(7),l=n(10);e.exports=function(e){var t=s(e),n=t.getFullYear(),i=new Date(0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);var o=l(i),a=new Date(0);a.setFullYear(n,0,4),a.setHours(0,0,0,0);var r=l(a);return t.getTime()>=o.getTime()?n+1:t.getTime()>=r.getTime()?n:n-1}},function(e,t,n){e.exports=n(35)()},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.HandlebarsEnvironment=u;var o=n(6),a=i(n(8)),r=n(45),s=n(53),l=i(n(55));t.VERSION="4.0.11";t.COMPILER_REVISION=7;t.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0"};var c="[object Object]";function u(e,t,n){this.helpers=e||{},this.partials=t||{},this.decorators=n||{},r.registerDefaultHelpers(this),s.registerDefaultDecorators(this)}u.prototype={constructor:u,logger:l.default,log:l.default.log,registerHelper:function(e,t){if(o.toString.call(e)===c){if(t)throw new a.default("Arg not supported with multiple helpers");o.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if(o.toString.call(e)===c)o.extend(this.partials,e);else{if(void 0===t)throw new a.default('Attempting to register a partial called "'+e+'" as undefined');this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]},registerDecorator:function(e,t){if(o.toString.call(e)===c){if(t)throw new a.default("Arg not supported with multiple decorators");o.extend(this.decorators,e)}else this.decorators[e]=t},unregisterDecorator:function(e){delete this.decorators[e]}};var d=l.default.log;t.log=d,t.createFrame=o.createFrame,t.logger=l.default},function(e,t){e.exports=jQuery},function(e,t){e.exports=__F.CommonComponents},function(e,t,n){var i=n(22),o=n(26),a=n(12),l=n(7),c=n(29),u=n(30);var d={M:function(e){return e.getMonth()+1},MM:function(e){return s(e.getMonth()+1,2)},Q:function(e){return Math.ceil((e.getMonth()+1)/3)},D:function(e){return e.getDate()},DD:function(e){return s(e.getDate(),2)},DDD:function(e){return i(e)},DDDD:function(e){return s(i(e),3)},d:function(e){return e.getDay()},E:function(e){return e.getDay()||7},W:function(e){return o(e)},WW:function(e){return s(o(e),2)},YY:function(e){return s(e.getFullYear(),4).substr(2)},YYYY:function(e){return s(e.getFullYear(),4)},GG:function(e){return String(a(e)).substr(2)},GGGG:function(e){return a(e)},H:function(e){return e.getHours()},HH:function(e){return s(e.getHours(),2)},h:function(e){var t=e.getHours();return 0===t?12:12<t?t%12:t},hh:function(e){return s(d.h(e),2)},m:function(e){return e.getMinutes()},mm:function(e){return s(e.getMinutes(),2)},s:function(e){return e.getSeconds()},ss:function(e){return s(e.getSeconds(),2)},S:function(e){return Math.floor(e.getMilliseconds()/100)},SS:function(e){return s(Math.floor(e.getMilliseconds()/10),2)},SSS:function(e){return s(e.getMilliseconds(),3)},Z:function(e){return r(e.getTimezoneOffset(),":")},ZZ:function(e){return r(e.getTimezoneOffset())},X:function(e){return Math.floor(e.getTime()/1e3)},x:function(e){return e.getTime()}};function r(e,t){t=t||"";var n=0<e?"-":"+",i=Math.abs(e),o=i%60;return n+s(Math.floor(i/60),2)+t+s(o,2)}function s(e,t){for(var n=Math.abs(e).toString();n.length<t;)n="0"+n;return n}e.exports=function(e,t,n){var i=t?String(t):"YYYY-MM-DDTHH:mm:ss.SSSZ",o=(n||{}).locale,a=u.format.formatters,r=u.format.formattingTokensRegExp;o&&o.format&&o.format.formatters&&(a=o.format.formatters,o.format.formattingTokensRegExp&&(r=o.format.formattingTokensRegExp));var s=l(e);return c(s)?function(e,t,n){var i,o,a,r=e.match(n),s=r.length;for(i=0;i<s;i++)o=t[r[i]]||d[r[i]],r[i]=o||((a=r[i]).match(/\[[\s\S]/)?a.replace(/^\[|]$/g,""):a.replace(/\\/g,""));return function(e){for(var t="",n=0;n<s;n++)r[n]instanceof Function?t+=r[n](e,d):t+=r[n];return t}}(i,a,r)(s):"Invalid Date"}},function(e,t,n){"use strict";var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=this&&this.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&(n[i[o]]=e[i[o]])}return n},s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=s(n(0)),u=l(n(34)),d=s(n(13));function h(e){return e&&e.replace(/&nbsp;|\u202F|\u00A0/g," ")}function p(e){var t=function e(t){if(t.nodeType===Node.TEXT_NODE)return t;for(var n=t.childNodes,i=n.length-1;0<=i;i--){var o=e(n[i]);if(null!==o)return o}return null}(e);if(null!==t&&null!==t.nodeValue){var n=document.createRange(),i=window.getSelection();n.setStart(t,t.nodeValue.length),n.collapse(!0),i.removeAllRanges(),i.addRange(n),e instanceof HTMLElement&&e.focus()}}var m,f=(m=c.Component,o(g,m),g.prototype.render=function(){var t=this,e=this.props,n=e.tagName,i=e.html,o=r(e,["tagName","html"]);return c.createElement(n||"div",a({},o,{ref:function(e){return t.htmlEl=e},onInput:this.emitChange,onBlur:this.props.onBlur||this.emitChange,contentEditable:!this.props.disabled,dangerouslySetInnerHTML:{__html:i}}),this.props.children)},g.prototype.shouldComponentUpdate=function(e){var t=this.props,n=this.htmlEl;return!n||h(e.html)!==h(n.innerHTML)||t.disabled!==e.disabled||t.tagName!==e.tagName||t.className!==e.className||!u.default(t.style,e.style)},g.prototype.componentDidUpdate=function(){null!==this.htmlEl&&(this.props.html!==this.htmlEl.innerHTML&&(this.htmlEl.innerHTML=this.lastHtml=this.props.html),p(this.htmlEl))},g.prototype.emitChange=function(e){if(this.htmlEl){var t=this.htmlEl.innerHTML;if(this.props.onChange&&t!==this.lastHtml){var n=Object.assign({},e,{target:{value:t}});this.props.onChange(n)}this.lastHtml=t}},g.propTypes={html:d.string.isRequired,onChange:d.func,onBlur:d.func,disabled:d.bool,tagName:d.string,className:d.string,style:d.object},g);function g(e){var t=m.call(this,e)||this;return t.htmlEl=null,t.emitChange=t.emitChange.bind(t),t.lastHtml=e.html,t}t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(39);Object.defineProperty(t,"sortable",{enumerable:!0,get:function(){return i.SortableComposition}}),Object.defineProperty(t,"Sortable",{enumerable:!0,get:function(){return i.SortableComposition}}),Object.defineProperty(t,"HORIZONTAL",{enumerable:!0,get:function(){return i.HORIZONTAL}}),Object.defineProperty(t,"VERTICAL",{enumerable:!0,get:function(){return i.VERTICAL}})},function(e,t){e.exports=__F.DOMHelper},function(e,t){var n,i,o=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{i="function"==typeof clearTimeout?clearTimeout:r}catch(e){i=r}}();var l,c=[],u=!1,d=-1;function h(){u&&l&&(u=!1,l.length?c=l.concat(c):d=-1,c.length&&p())}function p(){if(!u){var e=s(h);u=!0;for(var t=c.length;t;){for(l=c,c=[];++d<t;)l&&l[d].run();d=-1,t=c.length}l=null,u=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===r||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function f(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new m(e,t)),1!==c.length||u||s(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=f,o.addListener=f,o.once=f,o.off=f,o.removeListener=f,o.removeAllListeners=f,o.emit=f,o.prependListener=f,o.prependOnceListener=f,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){var i=n(7),o=n(23),a=n(24);e.exports=function(e){var t=i(e);return a(t,o(t))+1}},function(e,t,n){var i=n(7);e.exports=function(e){var t=i(e),n=new Date(0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}},function(e,t,n){var r=n(25);e.exports=function(e,t){var n=r(e),i=r(t),o=n.getTime()-6e4*n.getTimezoneOffset(),a=i.getTime()-6e4*i.getTimezoneOffset();return Math.round((o-a)/864e5)}},function(e,t,n){var i=n(7);e.exports=function(e){var t=i(e);return t.setHours(0,0,0,0),t}},function(e,t,n){var i=n(7),o=n(10),a=n(28);e.exports=function(e){var t=i(e),n=o(t).getTime()-a(t).getTime();return Math.round(n/6048e5)+1}},function(e,t,n){var r=n(7);e.exports=function(e,t){var n=t&&Number(t.weekStartsOn)||0,i=r(e),o=i.getDay(),a=(o<n?7:0)+o-n;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}},function(e,t,n){var i=n(12),o=n(10);e.exports=function(e){var t=i(e),n=new Date(0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),o(n)}},function(e,t,n){var i=n(11);e.exports=function(e){if(i(e))return!isNaN(e);throw new TypeError(toString.call(e)+" is not an instance of Date")}},function(e,t,n){var i=n(31),o=n(32);e.exports={distanceInWords:i(),format:o()}},function(e,t){e.exports=function(){var o={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};return{localize:function(e,t,n){var i;return n=n||{},i="string"==typeof o[e]?o[e]:1===t?o[e].one:o[e].other.replace("{{count}}",t),n.addSuffix?0<n.comparison?"in "+i:i+" ago":i}}}},function(e,t,n){var c=n(33);e.exports=function(){var t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=["January","February","March","April","May","June","July","August","September","October","November","December"],i=["Su","Mo","Tu","We","Th","Fr","Sa"],o=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],r=["AM","PM"],s=["am","pm"],l=["a.m.","p.m."],e={MMM:function(e){return t[e.getMonth()]},MMMM:function(e){return n[e.getMonth()]},dd:function(e){return i[e.getDay()]},ddd:function(e){return o[e.getDay()]},dddd:function(e){return a[e.getDay()]},A:function(e){return 1<=e.getHours()/12?r[1]:r[0]},a:function(e){return 1<=e.getHours()/12?s[1]:s[0]},aa:function(e){return 1<=e.getHours()/12?l[1]:l[0]}};return["M","D","DDD","d","Q","W"].forEach(function(n){e[n+"o"]=function(e,t){return function(e){var t=e%100;if(20<t||t<10)switch(t%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"}(t[n](e))}}),{formatters:e,formattingTokensRegExp:c(e)}}},function(e,t){var o=["M","MM","Q","D","DD","DDD","DDDD","d","E","W","WW","YY","YYYY","GG","GGGG","H","HH","h","hh","m","mm","s","ss","S","SS","SSS","Z","ZZ","X","x"];e.exports=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);var i=o.concat(t).sort().reverse();return new RegExp("(\\[[^\\[]*\\])|(\\\\)?("+i.join("|")+"|.)","g")}},function(e,t,n){"use strict";var p=Array.isArray,m=Object.keys,f=Object.prototype.hasOwnProperty;e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){var i,o,a,r=p(t),s=p(n);if(r&&s){if((o=t.length)!=n.length)return!1;for(i=o;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(r!=s)return!1;var l=t instanceof Date,c=n instanceof Date;if(l!=c)return!1;if(l&&c)return t.getTime()==n.getTime();var u=t instanceof RegExp,d=n instanceof RegExp;if(u!=d)return!1;if(u&&d)return t.toString()==n.toString();var h=m(t);if((o=h.length)!==m(n).length)return!1;for(i=o;0!=i--;)if(!f.call(n,h[i]))return!1;for(i=o;0!=i--;)if(!e(t[a=h[i]],n[a]))return!1;return!0}return t!=t&&n!=n}},function(e,t,n){"use strict";var i=n(36),r=n(37),s=n(38);e.exports=function(){function e(e,t,n,i,o,a){a!==s&&r(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}var n={array:e.isRequired=e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return n.checkPropTypes=i,n.PropTypes=n}},function(e,t,n){"use strict";function i(e){return function(){return e}}function o(){}o.thatReturns=i,o.thatReturnsFalse=i(!1),o.thatReturnsTrue=i(!0),o.thatReturnsNull=i(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(e){return e},e.exports=o},function(e,t,n){"use strict";e.exports=function(e,t,n,i,o,a,r,s){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,i,o,a,r,s],u=0;(l=new Error(t.replace(/%s/g,function(){return c[u++]}))).name="Invariant Violation"}throw l.framesToPop=1,l}}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HORIZONTAL=t.VERTICAL=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},r=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}t.SortableComposition=function(i){var f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:v;return function(e){function a(){var e,t,m;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];return m=l(this,(e=a.__proto__||Object.getPrototypeOf(a)).call.apply(e,[this].concat(i))),(t=m).sortEnd=function(e){e.preventDefault(),y=null},m.sortStart=function(e){y=e.currentTarget.dataset.id;var t=e.dataTransfer;void 0!==t&&(e.dataTransfer.setData("text",e.target.innerHTML),t.setDragImage&&"a"===e.currentTarget.tagName.toLowerCase()&&t.setDragImage(e.target,0,0))},m.dragOver=function(e){e.preventDefault();var t=m.props,n=t.moveInMiddle,i=(t.sortId,e.currentTarget),o=Number(i.dataset.id),a=Number(y),r=i.getBoundingClientRect().height,s=i.getBoundingClientRect().width,l=e.clientX,c=e.clientY,u=i.getBoundingClientRect().top,d=i.getBoundingClientRect().left,h=void 0,p=m.props.items;f===v&&(h=(0,g.isMouseBeyond)(c,u,r,n)),f===b&&(h=(0,g.isMouseBeyond)(l,d,s,n));g.isMouseBeyond;o!==a&&h&&(p=(0,g.swapArrayElements)(p,a,o),y=o,m.props.onSortItems(p))},l(m,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,e),r(a,[{key:"render",value:function(){var e=Object.assign({},this.props);delete e.onSortItems;var t=e.sortId,n=function(e,t){var n={};for(var i in e)0<=t.indexOf(i)||Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n}(e,["sortId"]);return s.default.createElement(i,o({draggable:!0,onDragOver:this.dragOver,onDragStart:this.sortStart,onDragEnd:this.sortEnd,onTouchStart:this.sortStart,onTouchMove:this.dragOver,onTouchEnd:this.sortEnd,"data-id":t},n))}}]),a}(s.default.Component)};var s=a(n(0)),g=(a(n(13)),n(40));function a(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var v=t.VERTICAL="VERTICAL",b=t.HORIZONTAL="HORIZONTAL",y=null},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.swapArrayElements=function(e,t,n){var i=e[n];return e[n]=e[t],e[t]=i,e},t.isMouseBeyond=function(e,t,n,i){var o;o=i?n/2:0;return o<e-t}},function(e,t,n){(function(e){function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/*! 
 * medium-editor-insert-plugin v2.4.0 - jQuery insert plugin for MediumEditor
 *
 * http://linkesch.com/medium-editor-insert-plugin
 * 
 * Copyright (c) 2014 Pavel Linkesch (http://linkesch.com)
 * Released under the MIT license
 */var t;t=function(e,t,g){this.MediumInsert=this.MediumInsert||{},this.MediumInsert.Templates=this.MediumInsert.Templates||{},this.MediumInsert.Templates["src/js/templates/core-buttons-gear.hbs"]=t.template({compiler:[7,">= 4.0.0"],main:function(e,t,n,i,o){return'<div class="add_option medium-insert-buttons whitelabel-gear" contenteditable="false">\n  <small class="add_option_tools" style="display: none;">\n    <span class="insert-option" style="display: block;">\n      <label class="label">INSERT</label>\n      <a class="insert-action-text">\n        <i></i> Text</a>\n      <a class="insert-action-media">\n        <i></i> Media</a>\n      <a class="insert-action-product">\n        <i></i> Products</a>\n    </span>\n    <span class="insert-text" style="display: none;">\n      <a href="#" class="label">TEXT</a>\n      <a class="insert-action-text-body">\n        <i></i> Body</a>\n      <a class="insert-action-text-quote">\n        <i></i> Quote</a>\n    </span>\n    <span class="insert-media" style="display: none;">\n      <a href="#" class="label">MEDIA</a>\n      <a class="insert-action-image">\n        <i></i> Images</a>\n      <a class="insert-action-youtube">\n        <i></i> Youtube</a>\n    </span>\n    <span class="insert-image" style="display: none;">\n      <a href="#" class="label">IMAGE</a>\n      <a class="insert-action-image-single medium-insert-action" data-addon="images" data-action="add" data-image-insert-type="single">\n        <i></i> Single</a>\n      <a class="insert-action-image-slideshow gallery-insert-action">\n        <i></i> Slideshow</a>\n      <a class="insert-action-image-grid medium-insert-action" data-addon="images" data-action="add" data-meta=\'{ "type": "grid" }\'>\n        <i></i> Grid</a>\n    </span>\n    <span class="insert-product" style="display: none;">\n      <a href="#" class="label">PRODUCT</a>\n      <a class="insert-action-product-card">\n        <i></i> Cards</a>\n      <a class="insert-action-product-slideshow">\n        <i></i> Slideshow</a>\n    </span>\n    <span class="insert-youtube" style="display: none;">\n      <a href="#" class="label">YOUTUBE</a>\n      <input class="extempt-dis-select" type="text" placeholder="Paste video link">\n      <button class="btns-green-embo">Insert</button>\n    </span>\n    <span class="editable_tools" style="display:none;">\n      <label class="label">IMAGE STYLE</label>\n      <a class="edit_full">\n        <i></i>\n      </a>\n      <a class="edit_normal">\n        <i></i>\n      </a>\n      <a class="edit_with_quote">\n        <i></i>\n      </a>\n    </span>\n  </small>\n  <button class="medium-insert-buttons-show show_option" type="button"></button>\n</div>\n'},useData:!0}),this.MediumInsert.Templates["src/js/templates/core-buttons.hbs"]=t.template({compiler:[7,">= 4.0.0"],main:function(e,t,n,i,o){return'<div class="add_option medium-insert-buttons" contenteditable="false" style="display: none">\n    <small class="add_option_tools" style="display: none;">\n        <div class="trick"></div>\n        <a class="medium-insert-action" data-addon="images" data-action="add">Insert Image</a>\n        <a class="video-insert-action">Insert Video</a>\n        <a class="gallery-insert-action">Insert Gallery</a>\n    </small>\n    <button class="medium-insert-buttons-show show_option" type="button"></button>\n</div>\n'},useData:!0}),this.MediumInsert.Templates["src/js/templates/core-caption.hbs"]=t.template({compiler:[7,">= 4.0.0"],main:function(e,t,n,i,o){var a;return'<figcaption contenteditable="true" class="medium-insert-caption-placeholder" data-placeholder="'+e.escapeExpression("function"==typeof(a=null!=(a=n.placeholder||(null!=t?t.placeholder:t))?a:n.helperMissing)?a.call(null!=t?t:e.nullContext||{},{name:"placeholder",hash:{},data:o}):a)+'"></figcaption>'},useData:!0}),this.MediumInsert.Templates["src/js/templates/core-empty-line.hbs"]=t.template({compiler:[7,">= 4.0.0"],main:function(e,t,n,i,o){return"<p><br></p>\n"},useData:!0}),this.MediumInsert.Templates["src/js/templates/embeds-toolbar.hbs"]=t.template({1:function(e,t,n,i,o){var a;return'    <div class="medium-insert-embeds-toolbar medium-editor-toolbar medium-toolbar-arrow-under medium-editor-toolbar-active">\n        <ul class="medium-editor-toolbar-actions clearfix">\n'+(null!=(a=n.each.call(null!=t?t:e.nullContext||{},null!=t?t.styles:t,{name:"each",hash:{},fn:e.program(2,o,0),inverse:e.noop,data:o}))?a:"")+"        </ul>\n    </div>\n"},2:function(e,t,n,i,o){var a;return null!=(a=n.if.call(null!=t?t:e.nullContext||{},null!=t?t.label:t,{name:"if",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o}))?a:""},3:function(e,t,n,i,o){var a,r,s=null!=t?t:e.nullContext||{},l=n.helperMissing,c="function";return'                    <li>\n                        <button class="medium-editor-action" data-action="'+e.escapeExpression(v(r=null!=(r=n.key||o&&o.key)?r:l)===c?r.call(s,{name:"key",hash:{},data:o}):r)+'">'+(null!=(r=null!=(r=n.label||(null!=t?t.label:t))?r:l,a=v(r)===c?r.call(s,{name:"label",hash:{},data:o}):r)?a:"")+"</button>\n                    </li>\n"},5:function(e,t,n,i,o){var a;return'    <div class="medium-insert-embeds-toolbar2 medium-editor-toolbar medium-editor-toolbar-active">\n        <ul class="medium-editor-toolbar-actions clearfix">\n'+(null!=(a=n.each.call(null!=t?t:e.nullContext||{},null!=t?t.actions:t,{name:"each",hash:{},fn:e.program(2,o,0),inverse:e.noop,data:o}))?a:"")+"        </ul>\n    </div>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,i,o){var a,r=null!=t?t:e.nullContext||{};return(null!=(a=n.if.call(r,null!=t?t.styles:t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o}))?a:"")+"\n"+(null!=(a=n.if.call(r,null!=t?t.actions:t,{name:"if",hash:{},fn:e.program(5,o,0),inverse:e.noop,data:o}))?a:"")},useData:!0}),this.MediumInsert.Templates["src/js/templates/embeds-wrapper.hbs"]=t.template({compiler:[7,">= 4.0.0"],main:function(e,t,n,i,o){var a,r;return'<div class="medium-insert-embeds" contenteditable="false">\n\t<figure>\n\t\t<div class="medium-insert-embed">\n\t\t\t'+(null!=(r=null!=(r=n.html||(null!=t?t.html:t))?r:n.helperMissing,a="function"==typeof r?r.call(null!=t?t:e.nullContext||{},{name:"html",hash:{},data:o}):r)?a:"")+'\n\t\t</div>\n\t</figure>\n\t<div class="medium-insert-embeds-overlay"></div>\n</div>'},useData:!0}),this.MediumInsert.Templates["src/js/templates/images-fileupload.hbs"]=t.template({compiler:[7,">= 4.0.0"],main:function(e,t,n,i,o){return'<input type="file" multiple>'},useData:!0}),this.MediumInsert.Templates["src/js/templates/images-grid-each.hbs"]=t.template({1:function(e,t,n,i,o){return'        <div class="medium-insert-images-progress"></div>\n'},compiler:[7,">= 4.0.0"],main:function(e,t,n,i,o){var a,r,s=null!=t?t:e.nullContext||{},l=n.helperMissing,c="function",u=e.escapeExpression;return'<div class="grid" contenteditable="false">\n    <img src="/_ui/images/common/blank.gif" data-src="'+u(v(r=null!=(r=n.img||(null!=t?t.img:t))?r:l)===c?r.call(s,{name:"img",hash:{},data:o}):r)+'" alt="" class="" style="background-image:url(\''+u(v(r=null!=(r=n.img||(null!=t?t.img:t))?r:l)===c?r.call(s,{name:"img",hash:{},data:o}):r)+'\');">\n    <a href="#" class="remove">Remove</a>\n    <a href="#" class="btn-caption">Add Caption</a>\n    <figcaption contenteditable="true" class="text-placeholder" data-placeholder="Type an image caption">'+u(v(r=null!=(r=n.caption||(null!=t?t.caption:t))?r:l)===c?r.call(s,{name:"caption",hash:{},data:o}):r)+"</figcaption>\n"+(null!=(a=n.if.call(s,null!=t?t.progress:t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o}))?a:"")+"</div>\n"},useData:!0}),this.MediumInsert.Templates["src/js/templates/images-grid-popup.hbs"]=t.template({compiler:[7,">= 4.0.0"],main:function(e,t,n,i,o){return'<small contenteditable="false" class="add_option_tools _grid" style="display:none;">\n    <a data-action="add">Add images</a>\n    <a data-action="organize">Organize images</a>\n    <a data-action="delete">Delete Grid</a>\n</small>\n'},useData:!0}),this.MediumInsert.Templates["src/js/templates/images-image.hbs"]=t.template({1:function(e,t,n,i,o){return'        <div class="medium-insert-images-progress"></div>\n'},compiler:[7,">= 4.0.0"],main:function(e,t,n,i,o){var a,r,s=null!=t?t:e.nullContext||{};return'<figure contenteditable="false">\n    <img src="'+e.escapeExpression("function"==typeof(r=null!=(r=n.img||(null!=t?t.img:t))?r:n.helperMissing)?r.call(s,{name:"img",hash:{},data:o}):r)+'" alt="" />\n'+(null!=(a=n.if.call(s,null!=t?t.progress:t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o}))?a:"")+"</figure>\n"},useData:!0}),this.MediumInsert.Templates["src/js/templates/images-progressbar.hbs"]=t.template({compiler:[7,">= 4.0.0"],main:function(e,t,n,i,o){return'<progress min="0" max="100" value="0">0</progress>'},useData:!0}),this.MediumInsert.Templates["src/js/templates/images-toolbar-gear.hbs"]=t.template({compiler:[7,">= 4.0.0"],main:function(e,t,n,i,o){return'<div class="medium-insert-images-toolbar medium-editor-toolbar medium-toolbar-arrow-under medium-editor-toolbar-active">\n    <label class="label">IMAGE STYLE</label>\n    <div class="editable_tools">\n        <a class="edit_full">Full</a>\n        <a class="edit_normal">Normal</a>\n    </div>\n</div>\n'},useData:!0}),this.MediumInsert.Templates["src/js/templates/images-toolbar.hbs"]=t.template({compiler:[7,">= 4.0.0"],main:function(e,t,n,i,o){return'<div class="medium-insert-images-toolbar medium-editor-toolbar medium-toolbar-arrow-under medium-editor-toolbar-active">\n    <div class="editable_tools">\n        <a class="edit_full">Full</a>\n        <a class="edit_normal">Normal</a>\n        <a class="edit_with_quote">With Quote</a>\n    </div>\n</div>\n'},useData:!0}),this.MediumInsert.Templates["src/js/templates/product-card.hbs"]=t.template({compiler:[7,">= 4.0.0"],main:function(e,t,n,i,o){return'<ul class="itemList product" contenteditable="false">\n  <% items.forEach(function(item, idx) { %>\n  <li class="itemListElement" data-id="<%= item.id %>" data-idx="<%= idx %>">\n    <span class="figure <% if (item.image_fit_to_bounds) { %>fit<% } %>">\n      <img src="/_ui/images/common/blank.gif" style="background-image:url(<%= item.image %>)">\n    </span>\n    <span class="figcaption">\n      <span class="title"><%= item.title %></span>\n      <% if (item.retail_price != null) { %>\n      <b class="price sales">$<%= item.price %> <small class="before">$<%= item.retail_price %></small></b>\n      <% } else { %>\n      <b class="price">$<%= item.price %></b>\n      <% } %>\n    </span>\n    <a class="remove">Remove</a>\n  </li>\n  <% }); %>\n  <small class="add_option_tools" style="display:none;">\n    <a class="add-product">Organize Products</a>\n    <a class="delete-slideshow">Delete Grid</a>\n  </small>\n</ul>\n'},useData:!0}),this.MediumInsert.Templates["src/js/templates/product-slideshow.hbs"]=t.template({compiler:[7,">= 4.0.0"],main:function(e,t,n,i,o){return'<div class="itemSlide product" contenteditable="false">\n  <div class="itemSlideWrap">\n    <ul class="stream after">\n      <% items.forEach(function(item, idx) { %>\n      <li class="itemSlideElement" data-id="<%= item.id %>" data-idx="<%= idx %>">\n        <div class="figure-item">\n          <figure <% if (item.image_fit_to_bounds) { %>class="fit"<% } %>>\n            <a href="<% if (item.html_url) { %><%= item.html_url %><% } else { %>/sales/<%= item.id %>?utm=article<% } %>?utm=article"><span\n                class="back"></span><img class="figure" src="/_ui/images/common/blank.gif" style="background-image: url(<%= item.image %>);"></a>\n          </figure>\n          <figcaption>\n            <span class="show_cart">\n              <button class="btn-cart nopopup soldout">\n                <% if (item.retail_price != null) { %><b class="price sales">$<%= item.price %> <small class="before">$<%= item.retail_price %></small></b><% } else { %><b class="price">$<%= item.price %></b><% } %>\n              </button>\n            </span>\n            <a href="<%= item.html_url %>?utm=article" class="title"><%= item.title %></a>\n          </figcaption>\n          <a class="delete"></a>\n        </div>\n      </li>\n      <% }); %>\n    </ul>\n  </div>\n  <a href="#" class="prev">Prev</a>\n  <a href="#" class="next">Next</a>\n  <small class="add_option_tools" style="display:none;">\n    <a class="add-product">Organize Products</a>\n    <a class="delete-slideshow">Delete Slideshow</a>\n  </small>\n</div>\n'},useData:!0}),function(p,m,r,f){"use strict";var a="mediumInsert",i={editor:null,enabled:!0,addons:{images:!0,embeds:!0}};function s(e){return e.charAt(0).toUpperCase()+e.slice(1)}function l(e){if(e.match(/(http:|https:|)\/\/(player.|www.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/),-1<RegExp.$3.indexOf("youtu"))var t="youtube";else if(-1<RegExp.$3.indexOf("vimeo"))var t="vimeo";return{type:t,id:RegExp.$6}}function o(e,t){var n;this.el=e,this.$el=p(e),this.templates=m.MediumInsert.Templates,t&&(n=t.editor,t.editor=null),this.options=p.extend(!0,{},i,t),this.options.editor=n,this._defaults=i,this._name=a,this.options&&this.options.editor&&(this.options.editor._serialize===f&&(this.options.editor._serialize=this.options.editor.serialize),this.options.editor._destroy===f&&(this.options.editor._destroy=this.options.editor.destroy),this.options.editor._setup===f&&(this.options.editor._setup=this.options.editor.setup),this.options.editor._hideInsertButtons=this.hideButtons,this.options.editor.serialize=this.editorSerialize,this.options.editor.destroy=this.editorDestroy,this.options.editor.setup=this.editorSetup,this.options.editor.getExtensionByName("placeholder")!==f&&(this.options.editor.getExtensionByName("placeholder").updatePlaceholder=this.editorUpdatePlaceholder))}function c(e){p(".description.more");var t=e.is(":first-child");return t?{recoveryMode:"insert-first"}:{recoveryMode:"insert-next",cursor:e.is(".description.more > *")?e.before():e.closest(".description.more > *").before()}}o.prototype.init=function(){if(this.$el.addClass("medium-editor-insert-plugin"),"object"===v(this.options.addons)&&0!==Object.keys(this.options.addons).length||this.disable(),this.initAddons(),this.clean(),this.events(),m.isWhitelabelV2){var s=_.template(this.templates["src/js/templates/product-card.hbs"]().trim()),l=_.template(this.templates["src/js/templates/product-slideshow.hbs"]().trim()),c=p.dialog("insert_product").$obj,i=_.template(c.find("#popup-tpl-selected").html()),o=_.template(c.find("#popup-tpl-searched").html()),a=c.find(".suggest"),u=c.find(".featured");Sortable.create(u.find("ul").get(0),{handle:".btn-move"}),c.data("productCardTemplate",s).data("productSlideshowTemplate",l);var d={};m.ThingCache=d;var r={},h={selectedItemIds:[]};c.find("input.text").on("keyup",_.debounce(function(e){var t,n=e.target.value.trim();""!==n?(r[n]?(t=p.Deferred()).resolve(r[n]):t=p.get(m.REST_API_ENDPOINT,{keyword:n}),t.then(function(e){r[n]||(r[n]=e),a.empty(),0<e.products.length?(a.show(),e.products.forEach(function(t){var e=_.find(h.selectedItemIds,function(e){return t.id===e})!==f;e||(a.append(p(o(t)).data("thing",t)),null==d[t.id]&&(t.cached=!0,d[t.id]=t))})):a.hide()}).fail(function(e){404===e.status&&alertify.alert("Product not found.")})):a.hide()},500)).on("focus",function(){p(this).trigger("keyup")}),p(".popup.insert_product .btn-save").on("click",function(){var e,t=u.find("li").map(function(e,t){return Number(p(t).attr("data-sid")||0)}).toArray(),n=t.map(function(e){return d[e]}),i=c.data("type");"card"===i?e=s:"slideshow"===i&&(e=l);var o=p(e({items:n}));o.data("selectedItemIds",_.clone(t));var a=p(this).data("updatingRoot");if(a)a.replaceWith(o),p(this).data("updatingRoot",null);else{var r=function(e){var t=p("<p />");"insert-first"===e.recoveryMode?p(".description.more").prepend(t):"insert-next"===e.recoveryMode?t.insertAfter(e.cursor):console.warn("restoreCursor(): ?");return t}(c.data("cursor"));r.replaceWith(o)}p.dialog("insert_product").close()}),a.on("click","li",function(){a.hide();var e=p(this).data("thing");u.show();var t=u.find('ul li[data-sid="'+e.id+'"]');if(!(0<t.length)){h.selectedItemIds.push(e.id),u.find("ul").prepend(i(e));var n=h.selectedItemIds.length;c.find(".btn-save").attr("disabled",!1).text("Insert "+n+(1===n?" Item":" Items"))}}),u.on("click","li .btn-del",function(){var t=Number(p(this).closest("li").data("sid"));p(this).closest("li").remove(),h.selectedItemIds=h.selectedItemIds.filter(function(e){return e!==t}),0===h.selectedItemIds.length&&(c.find(".btn-save").attr("disabled",!0).text("Insert Items"),u.hide());var e=h.selectedItemIds.length;return c.find(".btn-save").attr("disabled",!1).text("Insert "+e+(1===e?" Item":" Items")),!1}),c.data("setSaved",function(e,t){if(0<t.length){h.selectedItemIds=t,__F.FancyUtils.jQueryPromiseAll(t.map(function(t){var i=p.Deferred();return d[t]?i.resolve(d[t]):p.get("/rest-api/v1/things/"+t+"?sales=true").then(function(e){var t;try{var n=e.sales.images[0]&&e.sales.images[0].src||e.image.src;t={id:e.sales.id,brand_name:e.sales.seller.brand_name,title:e.sales.title,price:e.sales.price,thumbnail:n,image:n},d[e.sales.id]=t}catch(e){t={id:"0",brand_name:"UNABLE_TO_LOAD",title:"UNABLE_TO_LOAD",price:0,thumbnail:"/_ui/images/common/blank.gif"}}i.resolve(t)}).fail(function(e){console.warn("failed to load",t,e),i.resolve({id:"0",brand_name:"UNABLE_TO_LOAD",title:"UNABLE_TO_LOAD",price:0,thumbnail:"/_ui/images/common/blank.gif"})}),i})).then(function(e){e.forEach(function(e){u.find("ul").append(i(e))})}),u.show();var n=t.length;c.find(".btn-save").attr("disabled",!1).text("Insert "+n+(1===n?" Item":" Items")),c.find(".btn-save").data("updatingRoot",e)}}),c.on("open",function(){h.selectedItemIds=[],c.find("input.text").val(""),u.find("ul").empty().end().hide(),a.empty().hide(),p(this).find(".btn-save").attr("disabled",!0).text("Insert Items")}),setTimeout(function(e){if(e.clean(),e.positionButtons(),e.showButtons(),0===e.$el.find(".medium-insert-active").length){var n=!1;e.$el.find("> p").each(function(e,t){n||""===p(t).text().trim()&&(p(t).addClass("medium-insert-active"),n=!0)})}},50,this)}},o.prototype.resetOptionV2=function(){p(".add_option").hide(),p(".add_option_tools .insert-product, .add_option_tools .insert-text, .add_option_tools .insert-image, .add_option_tools .insert-media, .add_option_tools .insert-youtube").hide(),p(".add_option .insert-option").show()},o.prototype.hideOptionPopupV2=function(){p(".medium-insert-buttons .add_option_tools").hide(),p(".medium-insert-buttons .add_option_tools .insert-product, .medium-insert-buttons .add_option_tools .insert-text, .medium-insert-buttons .add_option_tools .insert-image, .add_option_tools .insert-media, .add_option_tools .insert-youtube").hide(),p(".add_option .insert-option").show()},o.prototype.events=function(){var n=this;function i(e){var t=e.$el.find(".medium-insert-active");return t.is("p")&&(e.migrateExistingContent(t),t.replaceWith('<div class="medium-insert-active">'+t.html()+"</div>"),(t=e.$el.find(".medium-insert-active")).next().is("p")||t.after("<p><br></p>"),e.moveCaret(t.next())),t}function t(){if(0===n.$el.find("> .medium-insert-active").length){var e=p(r.getSelection().anchorNode);e.is(".description.more > *")&&e.addClass("medium-insert-active")}}function o(e){var t=p(".insert-youtube input").val();if(t){var n=l(t.trim());if("youtube"===n.type){var i=e.$el.find(".medium-insert-active"),o=p('<p class="article-media media-youtube media-youtube-with-wrap" data-service="youtube" data-service-id="'.concat(n.id,'" style="text-align: center;"><span class="article-media-youtube-wrap"><iframe src="https://www.youtube.com/embed/').concat(n.id,'?" width="100%" height="100%" frameborder="0" allowfullscreen="allowfullscreen"></iframe></span></p>')),i=e.$el.find(".medium-insert-active");i.is("p")&&(e.migrateExistingContent(i),i.replaceWith('<div class="medium-insert-active">'+i.html()+"</div>"),(i=e.$el.find(".medium-insert-active")).next().is("p")||i.after("<p><br></p>"),e.moveCaret(i.next()),i.replaceWith(o),m.EditorControl.refresh())}else m.alert("Video service other than youtube is not supported.")}}this.$el.on("dragover drop",function(e){e.preventDefault()}).on("keyup click focusout",p.proxy(this,"toggleButtons")).on("selectstart mousedown",".medium-insert, .medium-insert-buttons",p.proxy(this,"disableSelection")).on("click","> p",function(){t()}).on("click",".medium-insert-buttons-show",function(e){var t=p(".medium-insert-buttons .add_option_tools").is(":visible");n.toggleAddons.call(n,e),t||setTimeout(function(){var e=n.getEditor(),t=e.getExtensionByName("toolbar");t&&t.isDisplayed()&&t.hideToolbar()},50)}).on("click",".medium-insert-action",p.proxy(this,"addonAction")).on("click",".gallery-insert-action",function(){t();var e=i(this);e.get(0)&&m.GalleryControl.uploadImages(function(t){!1!==t?m.GalleryControl.renderTo(e,null,function(e){e.instance.addImages(t.filter(function(e){return e})),n.hideOptionPopupV2()}):alert("Failed to upload images, please try again")})}.bind(this)).on("click",".video-insert-action",function(){var e=m.prompt("Please put youtube address");if(null!=e){var t=l(e.trim());if("youtube"===t.type){var n=p('<p class="article-media media-youtube" data-service="youtube" data-service-id="'.concat(t.id,'" style="text-align: center;"><iframe src="https://www.youtube.com/embed/').concat(t.id,'?" width="560" height="315" frameborder="0" allowfullscreen="allowfullscreen"></iframe></p>')),i=this.$el.find(".medium-insert-active");i.is("p")&&(this.migrateExistingContent(i),i.replaceWith('<div class="medium-insert-active">'+i.html()+"</div>"),(i=this.$el.find(".medium-insert-active")).next().is("p")||i.after("<p><br></p>"),this.moveCaret(i.next()),i.replaceWith(n),m.EditorControl.refresh())}else m.alert("Video service other than youtube is not supported.")}}.bind(this)).on("click",".medium-insert-buttons .trick",function(e){m.isWhitelabelV2||this.$el.find(".add_option_tools").hide()}.bind(this)).on("paste",".medium-insert-caption-placeholder",function(e){p.proxy(n,"removeCaptionPlaceholder")(p(e.target))}),isWhitelabelV2&&(this.$el.on("click",".insert-option .insert-action-text",function(){return p(".add_option .insert-option").hide(),p(".add_option_tools .insert-text").show(),!1}).on("click",".insert-option .insert-action-media",function(){return p(".add_option .insert-option").hide(),p(".add_option_tools .insert-media").show(),!1}).on("click",".insert-media .insert-action-image",function(){return p(".add_option .insert-media").hide(),p(".add_option_tools .insert-image").show(),!1}).on("click",".insert-media .insert-action-youtube",function(){return p(".add_option .insert-media").hide(),p(".add_option_tools .insert-youtube").show(),setTimeout(function(){p(".add_option_tools .insert-youtube input").focus()},350),!1}).on("click",".insert-youtube input",function(){return p(this).focus(),!0}).on("focus",".insert-youtube input",function(){return!0}).on("mouseover",".media-youtube",function(){0<p(this).find("a.remove").length?p(this).find("a.remove").show():p(this).append('<a class="remove" />')}).on("mouseout",".media-youtube",function(){0<p(this).find("a.remove").length&&p(this).find("a.remove").hide()}).on("click",".media-youtube .remove",function(){return p(this).closest(".media-youtube").remove(),!1}).on("keydown",".insert-youtube input",function(e){return 13!==e.which||(o(this),!1)}.bind(this)).on("click",".insert-youtube button",function(e){return o(this),!0}.bind(this)).on("click",".insert-option .insert-action-product",function(){return p(".add_option .insert-option").hide(),p(".add_option_tools .insert-product").show(),!1}).on("click",".insert-text .label",function(){return p(".add_option_tools .insert-text").hide(),p(".add_option .insert-option").show(),!1}).on("click",".insert-media .label",function(){return p(".add_option_tools .insert-media").hide(),p(".add_option .insert-option").show(),!1}).on("click",".insert-image .label",function(){return p(".add_option_tools .insert-image").hide(),p(".add_option .insert-media").show(),!1}).on("click",".insert-youtube .label",function(){return p(".add_option_tools .insert-youtube").hide(),p(".add_option .insert-media").show(),!1}).on("click",".insert-product .label",function(){return p(".add_option_tools .insert-product").hide(),p(".add_option .insert-option").show(),!1}).on("click",".insert-action-text-body",function(){var e=i(this),t=p('<p class="medium-insert-active">Enter Body Text</p>');return e.replaceWith(t),this.moveCaret(t,t.text().length),n.hideOptionPopupV2(),!1}.bind(this)).on("click",".insert-action-text-quote",function(){var e=i(this),t=p('<blockquote class="medium-insert-active"><span>Enter Quote Text</span></blockquote>');return e.replaceWith(t),this.moveCaret(t.find("span"),t.find("span").text().length),n.hideOptionPopupV2(),!1}.bind(this)).on("click",".insert-action-image-single",function(){return n.hideOptionPopupV2(),!1}).on("click",".insert-action-image-grid",function(){return n.hideOptionPopupV2(),!1}).on("click",".insert-action-image-slideshow",function(){return n.hideOptionPopupV2(),!1}).on("click",".insert-action-product-card",function(){var e=i(this);return p.dialog("insert_product").$obj.data("cursor",c(e)),p.dialog("insert_product").$obj.data("type","card"),p.dialog("insert_product").open(),n.hideOptionPopupV2(),!1}.bind(this)).on("click",".insert-action-product-slideshow",function(){var e=i(this);return p.dialog("insert_product").$obj.data("cursor",c(e)),p.dialog("insert_product").$obj.data("type","slideshow"),p.dialog("insert_product").open(),n.hideOptionPopupV2(),!1}.bind(this)).on("mouseover",".product, .medium-insert-images",function(){p(this).find(".add_option_tools").show()}).on("mouseout",".product, .medium-insert-images",function(){p(this).find(".add_option_tools").hide()}).on("click",".product .figure-item.add",function(){p(this).find("input").click()}).on("click",".product .figure-item.add input, .product .add-product",function(){p.dialog("insert_product").open();var e=p(this).closest(".product").hasClass("itemSlide"),t=p(this).closest(".product").hasClass("itemList");e?p.dialog("insert_product").$obj.data("type","slideshow"):t&&p.dialog("insert_product").$obj.data("type","card");var n=p(this);return setTimeout(function(){var e=n.closest(".product").find("li").toArray().sort(function(e,t){return p(e).data("idx")-p(t).data("idx")}).map(function(e){return p(e).data("id")});n.closest(".product").data("selectedItemIds",e),p.dialog("insert_product").$obj.data("setSaved")(n.closest(".product"),e)},50),!1}).one("click.initializeSlide",".itemSlide .prev, .itemSlide .next",function(){var e=p(this),t=e.closest(".product");return t.find(".itemSlide .prev, .itemSlide .next").off("click.initializeSlide"),t.productSlide({itemPerSlide:4,center:!0}),setTimeout(function(){e.click()},500),!1}).on("click","ul.itemList .itemListElement .remove",function(){var e=p(this).closest(".product"),t=e.data("selectedItemIds");if(null==t&&(t=p(this).closest(".product").find("li").map(function(e,t){return p(t).data("id")}).toArray()),t.length<=1)p(this).closest(".itemList").remove(),e.data("selectedItemIds",[]);else{var n=p(this).closest(".itemListElement"),i=n.data("id"),o=t.filter(function(e){return e!==i});e.data("selectedItemIds",o),n.remove()}}).on("click",".itemSlide li.itemSlideElement .delete",function(){var e=p(this).closest(".product"),t=e.data("selectedItemIds");if(null==t&&(t=p(this).closest(".product").find("li").map(function(e,t){return p(t).data("id")}).toArray()),t.length<=1)p(this).closest(".itemSlide").remove();else{var n=p(this).closest(".itemSlideElement"),i=n.data("id"),o=t.filter(function(e){return e!==i});e.data("selectedItemIds",o),n.remove()}}).on("click",".itemList li.itemListElement .figure, .itemList li.itemListElement .figcaption",function(){m.open("/sales/"+p(this).closest(".itemListElement").data("id"))}).on("click","> p > a:not(.remove)",function(){n.getEditor().selectElement(this),n.getEditor().getExtensionByName("toolbar").showAndUpdateToolbar(),setTimeout(function(){p(".medium-editor-action-anchor2").click()},50)}).on("click",".product .delete-slideshow",function(){p(this).closest(".product").remove()}),p(r.body).on("click",function(e){0!==p(".medium-insert-buttons .add_option_tools:visible").length&&0===p(e.target).closest(".add_option_tools, .show_option").length&&n.hideOptionPopupV2()})),p(m).on("resize",p.proxy(this,"positionButtons",null))},o.prototype.getEditor=function(){return this.options.editor},o.prototype.editorSerialize=function(){var n=this._serialize();return p.each(n,function(e){var t=p("<div />").html(n[e].value);t.find(".medium-insert-buttons").remove(),t.find(".medium-insert-active").removeClass("medium-insert-active"),t.find("[data-embed-code]").each(function(){var e=p(this),t=p("<div />").html(e.attr("data-embed-code")).text();e.html(t)}),n[e].value=t.html()}),n},o.prototype.editorDestroy=function(){p.each(this.elements,function(e,t){p(t).data("plugin_"+a)instanceof o&&p(t).data("plugin_"+a).disable()}),this._destroy()},o.prototype.editorSetup=function(){this._setup(),p.each(this.elements,function(e,t){p(t).data("plugin_"+a)instanceof o&&p(t).data("plugin_"+a).enable()})},o.prototype.editorUpdatePlaceholder=function(e,t){var n=p(e).children().not(".medium-insert-buttons, iframe").contents();t||1!==n.length||"br"!==n[0].nodeName.toLowerCase()?this.hidePlaceholder(e):(this.showPlaceholder(e),this.base._hideInsertButtons(p(e)))},o.prototype.triggerInput=function(){this.getEditor()&&this.getEditor().trigger("editableInput",null,this.el)},o.prototype.deselect=function(){r.getSelection().removeAllRanges()},o.prototype.disable=function(){this.options.enabled=!1,this.$el.find(".medium-insert-buttons").addClass("hide")},o.prototype.enable=function(){this.options.enabled=!0,this.$el.find(".medium-insert-buttons").removeClass("hide")},o.prototype.disableSelection=function(e){var t=p(e.target);!1!==t.is("img")&&!t.hasClass("medium-insert-buttons-show")||t.hasClass("extempt-dis-select")||e.preventDefault()},o.prototype.initAddons=function(){var i=this;this.options.addons&&0!==this.options.addons.length&&p.each(this.options.addons,function(e,t){var n=a+s(e);!1!==t?(i.$el[n](t),i.options.addons[e]=i.$el.data("plugin_"+n).options):delete i.options.addons[e]})},o.prototype.clean=function(){var e,t,n=this;!1!==this.options.enabled&&(0===this.$el.children().length&&this.$el.html(this.templates["src/js/templates/core-empty-line.hbs"]().trim()),this.$el.contents().filter(function(){return"#text"===this.nodeName&&""!==p.trim(p(this).text())||"br"===this.nodeName.toLowerCase()}).each(function(){p(this).wrap("<p />"),n.moveCaret(p(this).parent(),p(this).text().length)}),this.addButtons(),e=this.$el.find(".medium-insert-buttons"),(t=e.prev()).attr("class")&&t.attr("class").match(/medium\-insert(?!\-active)/)&&e.before(this.templates["src/js/templates/core-empty-line.hbs"]().trim()))},o.prototype.getButtons=function(){var e;if(!1!==this.options.enabled)return e=m.isWhitelabelV2?"src/js/templates/core-buttons-gear.hbs":"src/js/templates/core-buttons.hbs",this.templates[e]({addons:this.options.addons}).trim()},o.prototype.addButtons=function(){if(0===this.$el.find(".medium-insert-buttons").length){var e=this.getButtons();e=0<this.$el.find(".gallery-container").length?(e=p(e),m.isWhitelabelV2||e.find(".gallery-insert-action").hide().end(),e.prop("outerHTML")):p(e).find(".gallery-insert-action").css("display","block").end().prop("outerHTML"),this.$el.append(e)}},o.prototype.toggleButtons=function(e){var t,n,i,o,a=p(e.target),r=m.getSelection(),s=this;!1!==this.options.enabled&&((n=r&&0!==r.rangeCount?(t=r.getRangeAt(0),p(t.commonAncestorContainer)):a).hasClass("medium-editor-insert-plugin")&&(n=n.find("p:first")),i=n.is("p")?n:n.closest("p"),this.clean(),!1===a.hasClass("medium-editor-placeholder")&&0===a.closest(".medium-insert-buttons").length&&0===n.closest(".medium-insert-buttons").length&&(this.$el.find(".medium-insert-active").removeClass("medium-insert-active"),p.each(this.options.addons,function(e){if(a.closest(".medium-insert-"+e).length&&(n=a),n.closest(".medium-insert-"+e).length)return i=n.closest(".medium-insert-"+e),void(o=e)}),!i.length||o&&"images"!==o?this.hideButtons():(i.addClass("medium-insert-active"),"images"===o?this.$el.find(".medium-insert-buttons").attr("data-active-addon",o):this.$el.find(".medium-insert-buttons").removeAttr("data-active-addon"),setTimeout(function(){s.positionButtons(o),s.showButtons(o)},o?100:0))))},o.prototype.showButtons=function(e){var t=this.$el.find(".medium-insert-buttons");t.show(),t.find("li").show(),e&&(t.find("li").hide(),t.find('button[data-addon="'+e+'"]').parent().show())},o.prototype.hideButtons=function(e){},o.prototype.positionButtons=function(e){var t=this.$el.find(".medium-insert-buttons"),n=this.$el.find(".medium-insert-active"),i=n.hasClass("medium-insert-images-grid")?[]:n.find("figure:last figcaption"),o=this.getEditor()?this.getEditor().options.elementsContainer:p("body").get(0),a=-1<["absolute","fixed"].indexOf(m.getComputedStyle(o).getPropertyValue("position")),r={left:75};n.length&&(r.top=n.position().top,e?r.top+=n.height()-20+(i.length?-i.height()-parseInt(i.css("margin-top"),10):10):(r.top+=parseInt(n.css("margin-top"),10),r.top+=parseInt(n.css("padding-top"),10)),a&&(r.top+=o.scrollTop),t.css(r))},o.prototype.toggleAddons=function(){var e=this.$el.find(".add_option_tools");e.toggle();e.is(":visible");"images"!==this.$el.find(".medium-insert-buttons").attr("data-active-addon")||this.$el.find(".medium-insert-buttons").find('button[data-addon="images"]').click()},o.prototype.hideAddons=function(){this.$el.find(".medium-insert-buttons-addons").hide(),this.$el.find(".medium-insert-buttons-show").removeClass("medium-insert-buttons-rotate")},o.prototype.addonAction=function(e){var t=p(e.currentTarget),n=t.data("addon"),i=t.data("action"),o=t.data("meta");this.$el.data("plugin_"+a+s(n))[i](o)},o.prototype.moveCaret=function(e,t){var n,i,o,a;t=t||0,n=r.createRange(),i=m.getSelection(),(o=e.get(0)).childNodes.length||(a=r.createTextNode(" "),o.appendChild(a)),n.setStart(o.childNodes[0],t),n.collapse(!0),i.removeAllRanges(),i.addRange(n)},o.prototype.addCaption=function(e,t,n){var i=e.find("figcaption");if(0===i.length){var o=p(this.templates["src/js/templates/core-caption.hbs"]({placeholder:t}));n&&(o.removeAttr("data-placeholder"),o.attr("class",""),o.text(n)),e.append(o)}},o.prototype.removeCaptions=function(e){var t=this.$el.find("figcaption");e&&(t=t.not(e)),t.each(function(){!p(this).hasClass("medium-insert-caption-placeholder")&&""!==p(this).text().trim()||p(this).remove()})},o.prototype.removeCaptionPlaceholder=function(e){var t=e.is("figcaption")?e:e.find("figcaption");t.length&&t.removeClass("medium-insert-caption-placeholder").removeAttr("data-placeholder")},o.prototype.migrateExistingContent=function(e){if(0<e.text().length){var t=e.clone();t.insertBefore(e),t.removeClass("medium-insert-active"),e.html("")}},p.fn[a]=function(n){return this.each(function(){var e,t=this;p(t).is("textarea")&&(e=p(t).attr("medium-editor-textarea-id"),t=p(t).siblings('[medium-editor-textarea-id="'+e+'"]').get(0)),p.data(t,"plugin_"+a)?"string"==typeof n&&p.data(t,"plugin_"+a)[n]&&p.data(t,"plugin_"+a)[n]():(p.data(t,"plugin_"+a,new o(t,n)),p.data(t,"plugin_"+a).init())})}}(jQuery,window,document),function(l,c,t,e){"use strict";var n="mediumInsert",i="Embeds",o={label:'<span class="fa fa-youtube-play"></span>',placeholder:"Paste a YouTube, Vimeo, Facebook, Twitter or Instagram link and press Enter",oembedProxy:"https://medium.iframe.ly/api/oembed?iframe=1",captions:!0,captionPlaceholder:"Type caption (optional)",storeMeta:!1,styles:{wide:{label:'<span class="fa fa-align-justify"></span>'},left:{label:'<span class="fa fa-align-left"></span>'},right:{label:'<span class="fa fa-align-right"></span>'}},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(){var e=l.Event("keydown");e.which=8,l(t).trigger(e)}}},parseOnPaste:!1};function a(e,t){this.el=e,this.$el=l(e),this.templates=c.MediumInsert.Templates,this.core=this.$el.data("plugin_"+n),this.options=l.extend(!0,{},o,t),this._defaults=o,this._name=n,this.core.getEditor()&&(this.core.getEditor()._serializePreEmbeds=this.core.getEditor().serialize,this.core.getEditor().serialize=this.editorSerialize),this.init()}a.prototype.init=function(){var e=this.$el.find(".medium-insert-embeds");e.attr("contenteditable",!1),e.each(function(){0===l(this).find(".medium-insert-embeds-overlay").length&&l(this).append(l("<div />").addClass("medium-insert-embeds-overlay"))}),this.events(),this.backwardsCompatibility()},a.prototype.events=function(){l(t).on("click",l.proxy(this,"unselectEmbed")).on("keydown",l.proxy(this,"removeEmbed")).on("click",".medium-insert-embeds-toolbar .medium-editor-action",l.proxy(this,"toolbarAction")).on("click",".medium-insert-embeds-toolbar2 .medium-editor-action",l.proxy(this,"toolbar2Action")),this.$el.on("keyup click paste",l.proxy(this,"togglePlaceholder")).on("keydown",l.proxy(this,"processLink")).on("click",".medium-insert-embeds-overlay",l.proxy(this,"selectEmbed")).on("contextmenu",".medium-insert-embeds-placeholder",l.proxy(this,"fixRightClickOnPlaceholder")),this.options.parseOnPaste&&this.$el.on("paste",l.proxy(this,"processPasted")),l(c).on("resize",l.proxy(this,"autoRepositionToolbars"))},a.prototype.backwardsCompatibility=function(){var e=this;this.$el.find(".mediumInsert-embeds").removeClass("mediumInsert-embeds").addClass("medium-insert-embeds"),this.$el.find(".medium-insert-embeds").each(function(){0===l(this).find(".medium-insert-embed").length&&(l(this).after(e.templates["src/js/templates/embeds-wrapper.hbs"]({html:l(this).html()})),l(this).remove())})},a.prototype.editorSerialize=function(){var n=this._serializePreEmbeds();return l.each(n,function(e){var t=l("<div />").html(n[e].value);t.find(".medium-insert-embeds").removeAttr("contenteditable"),t.find(".medium-insert-embeds-overlay").remove(),n[e].value=t.html()}),n},a.prototype.add=function(){var e=this.$el.find(".medium-insert-active");e.html(this.templates["src/js/templates/core-empty-line.hbs"]().trim()),e.is("p")&&(e.replaceWith('<div class="medium-insert-active">'+e.html()+"</div>"),e=this.$el.find(".medium-insert-active"),this.core.moveCaret(e)),e.addClass("medium-insert-embeds medium-insert-embeds-input medium-insert-embeds-active"),this.togglePlaceholder({target:e.get(0)}),e.click(),this.core.hideButtons()},a.prototype.togglePlaceholder=function(e){var t,n,i,o=l(e.target),a=c.getSelection();a&&0!==a.rangeCount&&(t=a.getRangeAt(0),(n=l(t.commonAncestorContainer)).hasClass("medium-insert-embeds-active")?o=n:n.closest(".medium-insert-embeds-active").length&&(o=n.closest(".medium-insert-embeds-active")),o.hasClass("medium-insert-embeds-active")?""===(i=o.text().trim())&&!1===o.hasClass("medium-insert-embeds-placeholder")?o.addClass("medium-insert-embeds-placeholder").attr("data-placeholder",this.options.placeholder):""!==i&&o.hasClass("medium-insert-embeds-placeholder")&&o.removeClass("medium-insert-embeds-placeholder").removeAttr("data-placeholder"):this.$el.find(".medium-insert-embeds-active").remove())},a.prototype.fixRightClickOnPlaceholder=function(e){this.core.moveCaret(l(e.target))},a.prototype.processLink=function(e){var t,n=this.$el.find(".medium-insert-embeds-active");n.length&&(""!==(t=n.text().trim())||-1===[8,46,13].indexOf(e.which)?13===e.which&&(e.preventDefault(),e.stopPropagation(),this.options.oembedProxy?this.oembed(t):this.parseUrl(t)):n.remove())},a.prototype.processPasted=function(e){var t;l(".medium-insert-embeds-active").length||(t=e.originalEvent.clipboardData.getData("text"),new RegExp("^(http(s?):)?//","i").test(t)&&(this.options.oembedProxy?this.oembed(t,!0):this.parseUrl(t,!0)))},a.prototype.oembed=function(o,n){var a=this;l.support.cors=!0,l.ajax({crossDomain:!0,cache:!1,url:this.options.oembedProxy,dataType:"json",data:{url:o},success:function(e){var t=e&&e.html;a.options.storeMeta&&(t+='<div class="medium-insert-embeds-meta"><script type="text/json">'+JSON.stringify(e)+"<\/script></div>"),e&&!t&&"photo"===e.type&&e.url&&(t='<img src="'+e.url+'" alt="">'),t?n?l.proxy(a,"embed",t,o)():l.proxy(a,"embed",t)():l.proxy(a,"convertBadEmbed",o)()},error:function(e,t,n){var i=function(){try{return JSON.parse(e.responseText)}catch(e){}}();void 0!==c.console?c.console.log(i&&i.error||e.status||n.message):c.alert("Error requesting media from "+a.options.oembedProxy+" to insert: "+n+" (response status: "+e.status+")"),l.proxy(a,"convertBadEmbed",o)()}})},a.prototype.parseUrl=function(e,t){var n;return new RegExp(["youtube","youtu.be","vimeo","instagram","twitter","facebook"].join("|")).test(e)?(n=e.replace(/\n?/g,"").replace(/^((http(s)?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/(watch\?v=|v\/)?)([a-zA-Z0-9\-_]+)(.*)?$/,'<div class="video video-youtube"><iframe width="420" height="315" src="//www.youtube.com/embed/$7" frameborder="0" allowfullscreen></iframe></div>').replace(/^https?:\/\/vimeo\.com(\/.+)?\/([0-9]+)$/,'<div class="video video-vimeo"><iframe src="//player.vimeo.com/video/$2" width="500" height="281" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>').replace(/^https:\/\/twitter\.com\/(\w+)\/status\/(\d+)\/?$/,'<blockquote class="twitter-tweet" align="center" lang="en"><a href="https://twitter.com/$1/statuses/$2"></a></blockquote><script async src="//platform.twitter.com/widgets.js" charset="utf-8"><\/script>').replace(/^(https:\/\/www\.facebook\.com\/(.*))$/,'<script src="//connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v2.2" async><\/script><div class="fb-post" data-href="$1"><div class="fb-xfbml-parse-ignore"><a href="$1">Loading Facebook post...</a></div></div>').replace(/^https?:\/\/instagram\.com\/p\/(.+)\/?$/,'<span class="instagram"><iframe src="//instagram.com/p/$1/embed/" width="612" height="710" frameborder="0" scrolling="no" allowtransparency="true"></iframe></span>'),this.options.storeMeta&&(n+='<div class="medium-insert-embeds-meta"><script type="text/json">'+JSON.stringify({})+"<\/script></div>"),!1===/<("[^"]*"|'[^']*'|[^'">])*>/.test(n)?(l.proxy(this,"convertBadEmbed",e)(),!1):void(t?this.embed(n,e):this.embed(n))):(l.proxy(this,"convertBadEmbed",e)(),!1)},a.prototype.embed=function(e,t){var n,i=this.$el.find(".medium-insert-embeds-active");if(!e)return alert("Incorrect URL format specified"),!1;-1<e.indexOf("<\/script>")&&(n=l("<div>").attr("data-embed-code",l("<div />").text(e).html()).html(e),e=l("<div>").append(n).html()),t?((i=this.$el.find(":not(iframe, script, style)").contents().filter(function(){return 3===this.nodeType&&-1<this.textContent.indexOf(t)}).parent()).after(this.templates["src/js/templates/embeds-wrapper.hbs"]({html:e})),i.text(i.text().replace(t,""))):(i.after(this.templates["src/js/templates/embeds-wrapper.hbs"]({html:e})),i.remove()),this.core.triggerInput(),-1!==e.indexOf("facebook")&&"undefined"!=typeof FB&&setTimeout(function(){FB.XFBML.parse()},2e3)},a.prototype.convertBadEmbed=function(e){var t,n,i,o=this.templates["src/js/templates/core-empty-line.hbs"]().trim();t=this.$el.find(".medium-insert-embeds-active"),i=l(o),t.before(i),t.remove(),i.html(e),n=l(o),i.after(n),this.core.triggerInput(),this.core.moveCaret(n)},a.prototype.selectEmbed=function(e){var t,n=this;this.core.options.enabled&&((t=l(e.target).hasClass("medium-insert-embeds")?l(e.target):l(e.target).closest(".medium-insert-embeds")).addClass("medium-insert-embeds-selected"),setTimeout(function(){n.addToolbar(),n.options.captions&&n.core.addCaption(t.find("figure"),n.options.captionPlaceholder)},50))},a.prototype.unselectEmbed=function(e){var t=l(e.target).hasClass("medium-insert-embeds")?l(e.target):l(e.target).closest(".medium-insert-embeds"),n=this.$el.find(".medium-insert-embeds-selected");if(t.hasClass("medium-insert-embeds-selected"))return n.not(t).removeClass("medium-insert-embeds-selected"),l(".medium-insert-embeds-toolbar, .medium-insert-embeds-toolbar2").remove(),this.core.removeCaptions(t.find("figcaption")),void((l(e.target).is(".medium-insert-caption-placeholder")||l(e.target).is("figcaption"))&&(t.removeClass("medium-insert-embeds-selected"),this.core.removeCaptionPlaceholder(t.find("figure"))));n.removeClass("medium-insert-embeds-selected"),l(".medium-insert-embeds-toolbar, .medium-insert-embeds-toolbar2").remove(),l(e.target).is(".medium-insert-caption-placeholder")?this.core.removeCaptionPlaceholder(t.find("figure")):!1===l(e.target).is("figcaption")&&this.core.removeCaptions()},a.prototype.removeEmbed=function(e){var t,n;8!==e.which&&46!==e.which||(t=this.$el.find(".medium-insert-embeds-selected")).length&&(e.preventDefault(),l(".medium-insert-embeds-toolbar, .medium-insert-embeds-toolbar2").remove(),n=l(this.templates["src/js/templates/core-empty-line.hbs"]().trim()),t.before(n),t.remove(),this.core.hideAddons(),this.core.moveCaret(n),this.core.triggerInput())},a.prototype.addToolbar=function(){var e,t,n,i,o=this.$el.find(".medium-insert-embeds-selected"),a=!1;0!==o.length&&(n=this.core.getEditor(),i=n.options.elementsContainer||"body",l(i).append(this.templates["src/js/templates/embeds-toolbar.hbs"]({styles:this.options.styles,actions:this.options.actions}).trim()),e=l(".medium-insert-embeds-toolbar"),t=l(".medium-insert-embeds-toolbar2"),e.find("button").each(function(){o.hasClass("medium-insert-embeds-"+l(this).data("action"))&&(l(this).addClass("medium-editor-button-active"),a=!0)}),!1===a&&e.find("button").first().addClass("medium-editor-button-active"),this.repositionToolbars(),e.fadeIn(),t.fadeIn())},a.prototype.autoRepositionToolbars=function(){setTimeout(function(){this.repositionToolbars(),this.repositionToolbars()}.bind(this),0)},a.prototype.repositionToolbars=function(){var e=l(".medium-insert-embeds-toolbar"),t=l(".medium-insert-embeds-toolbar2"),n=this.$el.find(".medium-insert-embeds-selected"),i=this.core.getEditor().options.elementsContainer,o=-1<["absolute","fixed"].indexOf(c.getComputedStyle(i).getPropertyValue("position")),a=o?i.getBoundingClientRect():null,r=l(c).width(),s={};t.length&&(s.top=n.offset().top+2,s.left=n.offset().left+n.width()-t.width()-4,o&&(s.top+=i.scrollTop-a.top,s.left-=a.left,r=l(i).width()),s.left+t.width()>r&&(s.left=r-t.width()),t.css(s)),e.length&&(s.left=n.offset().left+n.width()/2-e.width()/2,s.top=n.offset().top-e.height()-8-2-5,o&&(s.top+=i.scrollTop-a.top,s.left-=a.left),s.top<0&&(s.top=0),e.css(s))},a.prototype.toolbarAction=function(e){var t=l(e.target).is("button")?l(e.target):l(e.target).closest("button"),n=t.closest("li"),i=n.closest("ul"),o=i.find("li"),a=this.$el.find(".medium-insert-embeds-selected"),r=this;t.addClass("medium-editor-button-active"),n.siblings().find(".medium-editor-button-active").removeClass("medium-editor-button-active"),o.find("button").each(function(){var e="medium-insert-embeds-"+l(this).data("action");l(this).hasClass("medium-editor-button-active")?(a.addClass(e),r.options.styles[l(this).data("action")].added&&r.options.styles[l(this).data("action")].added(a)):(a.removeClass(e),r.options.styles[l(this).data("action")].removed&&r.options.styles[l(this).data("action")].removed(a))}),this.core.triggerInput()},a.prototype.toolbar2Action=function(e){var t=l(e.target).is("button")?l(e.target):l(e.target).closest("button"),n=this.options.actions[t.data("action")].clicked;n&&n(this.$el.find(".medium-insert-embeds-selected")),this.core.triggerInput()},l.fn[n+i]=function(e){return this.each(function(){l.data(this,"plugin_"+n+i)||l.data(this,"plugin_"+n+i,new a(this,e))})}}(jQuery,window,document);var d={Full:"Full",Normal:"Normal",Quoted:"Quoted",Grid:"Grid"},h={Full:"edit_full",Normal:"edit_normal",Quoted:"edit_with_quote"},l={Full:"mode-full",Normal:"mode-normal",Quoted:"mode-quoted",Grid:"mode-grid"},c="Start typing or paste article text...";!function(p,m,f,e,t){"use strict";var n="mediumInsert",i="Images",o={label:'<span class="fa fa-camera"></span>',deleteMethod:"POST",deleteScript:"delete.php",preview:!0,captions:!0,captionPlaceholder:"Type caption for image (optional)",autoGrid:3,fileUploadOptions:{url:null,acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i},fileDeleteOptions:{},styles:{wide:{label:'<span class="fa fa-align-justify"></span>'},left:{label:'<span class="fa fa-align-left"></span>'},right:{label:'<span class="fa fa-align-right"></span>'},grid:{label:'<span class="fa fa-th"></span>'}},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(){var e=p.Event("keydown");e.which=8,p(f).trigger(e)}}},sorting:function(){var e=this;p(".medium-insert-images").sortable({group:"medium-insert-images",containerSelector:".medium-insert-images",itemSelector:"figure",placeholder:'<figure class="placeholder">',handle:"img",nested:!1,vertical:!1,afterMove:function(){e.core.triggerInput()}})},messages:{acceptFileTypesError:"This file is not in a supported format: ",maxFileSizeError:"This file is too big: "}};function a(e,t){this.el=e,this.$el=p(e),this.$currentImage=null,this.templates=m.MediumInsert.Templates,this.core=this.$el.data("plugin_"+n),this.options=p.extend(!0,{},o,t),this._defaults=o,this._name=n,this.meta=null,this.options.preview&&!m.FileReader&&(this.options.preview=!1),this.core.getEditor()&&(this.core.getEditor()._serializePreImages=this.core.getEditor().serialize,this.core.getEditor().serialize=this.editorSerialize),this.init()}function u(e){return e.closest("figure").attr("data-mode")}function r(e,t,n,i){e.attr("class",""),e.addClass(l[n]),e.attr("data-mode",n),e.attr("contenteditable","false");var o=e.find("figcaption"),a="";if(""!==o.text().trim())a=o.text();else if(t===d.Quoted){var r=e.find(".textarea").text().trim();r&&(a=r)}if(""===a&&e.find("figcaption").remove(),n===d.Quoted)e.find("figcaption").remove(),e.find("img").wrap("<p />").wrap('<span class="image" />'),e.append('<p contenteditable="true" class="textarea" data-changed="false">'+c+"</p>"),a&&e.find(".textarea").text(a).attr("data-changed","true");else if(t===d.Quoted){var s=e.find("img");e.html(""),e.append(s),a&&i&&i(a)}}a.prototype.init=function(){var e=this.$el.find(".medium-insert-images");e.find("figcaption").attr("contenteditable",!0),e.find("figure").attr("contenteditable",!1),this.events(),this.backwardsCompatibility(),this.sorting()},m.ReactMediumEditor__changeMode=r,a.prototype.handleModeChange=function(e){var t=u(this.$currentImage);if(t!==e){var n=this.$currentImage.closest("figure");r(n,t,e,function(e){this.core.addCaption(n,this.options.captionPlaceholder,e)}.bind(this))}},a.prototype.events=function(){var i=this;p(f).on("click",p.proxy(this,"unselectImage")).on("keydown",p.proxy(this,"removeImage")).on("click",".medium-insert-images.medium-insert-active .remove",function(e){e.preventDefault();var t=p(e.currentTarget),n=t.closest(".medium-insert-images figure");n.attr("data-mode")===d.Grid?t.closest(".grid").remove():n.remove()}.bind(this)).on("click",".medium-insert-images-toolbar .edit_full",function(e){this.handleModeChange(d.Full)}.bind(this)).on("click",".medium-insert-images-toolbar .edit_normal",function(e){this.handleModeChange(d.Normal)}.bind(this)).on("click",".medium-insert-images-toolbar .edit_with_quote",function(e){this.handleModeChange(d.Quoted)}.bind(this)).on("change",".medium-insert-images figure textarea",function(e){var t=p(e.target);t.text(t.val())}.bind(this)).on("focusin",".medium-editor-insert-plugin .medium-insert-images",function(e){var t=e.target;"textarea"===e.target.className&&("false"===t.getAttribute("data-changed")&&(t.textContent=""),p(".description.more").attr("data-disable-toolbar","true"))}).on("keydown",".medium-editor-insert-plugin .medium-insert-images",function(e){var t=e.target;"textarea"===e.target.className&&"true"!==t.getAttribute("data-changed")&&t.setAttribute("data-changed","true")}).on("focusout",".medium-editor-insert-plugin .medium-insert-images",function(e){var t=e.target;"textarea"===t.className&&(p(".description.more").attr("data-disable-toolbar",null),""===t.textContent.trim()&&(t.textContent=c,t.setAttribute("data-changed","false")))}).on("load",".popup.insert_caption .figure img",function(){p.dialog("insert_caption").center()}).on("click",".medium-insert-images .grid .btn-caption",function(e){var t="gridimage-"+String(+new Date),n=p.dialog("insert_caption"),i=p(this).closest(".grid");i.attr("id",t);var o=i.find("img").attr("data-src");n.$obj.find(".figure img").attr("src",o),n.$obj.data("workingImage",t);var a=i.find("figcaption").text();return n.$obj.find("textarea").val(a),n.$obj.data("original",a),a?n.$obj.find(".btn-remove").show():n.$obj.find(".btn-remove").hide(),n.open(),!1}).on("click",".medium-insert-images .add_option_tools._grid a",function(){var e=p(this).data("action"),n=p(this).closest(".medium-insert-images");if("add"===e)m.GalleryControl.uploadImages(function(e){!1!==e?e.forEach(function(e){var t=p(i.templates["src/js/templates/images-grid-each.hbs"]({img:e.image_url,progress:!1,caption:""}));n.find("figure").append(t)}):alert("Failed to upload images, please try again")});else if("organize"===e){var t=n.find(".grid").map(function(e,t){return{id:e,url:p(t).find("img").data("src"),caption:p(t).find("figcaption").text()}}).toArray();organizeImageService.open(t,function(e){n.find("div.grid").remove(),e.forEach(function(e){var t=p(i.templates["src/js/templates/images-grid-each.hbs"]({img:e.url,progress:!1,caption:e.caption}));n.find("figure").append(t)})})}else"delete"===e&&n.remove()}).on("click",".popup.insert_caption .btn-save",function(){var e=p.dialog("insert_caption"),t=e.$obj.data("workingImage"),n=e.$obj.data("original"),i=e.$obj.find("textarea").val(),o=p("#"+t),a=o.find("figcaption");return i!==n&&(0===a.length&&(a=p('<figcaption contenteditable="true" class="text-placeholder" data-placeholder="Type caption for image (optional)" />'),o.append(a)),a.text(i)),""!==a.text()?o.find(".btn-caption").text("Edit Caption"):o.find(".btn-caption").text("Add Caption"),e.close(),!1}).on("click",".popup.insert_caption .btn-remove",function(){var e=p.dialog("insert_caption"),t=e.$obj.data("workingImage"),n=p("#"+t);return n.find("figcaption").text(""),n.find(".btn-caption").text("Add Caption"),e.close(),!1}),this.$el.on("click",".medium-insert-images img",p.proxy(this,"selectImage")),p(m).on("resize",p.proxy(this,"autoRepositionToolbars"))},a.prototype.backwardsCompatibility=function(){this.$el.find(".mediumInsert").removeClass("mediumInsert").addClass("medium-insert-images"),this.$el.find(".medium-insert-images.small").removeClass("small").addClass("medium-insert-images-left")},a.prototype.editorSerialize=function(){var n=this._serializePreImages();return p.each(n,function(e){var t=p("<div />").html(n[e].value);t.find(".medium-insert-images").find("figcaption, figure").removeAttr("contenteditable"),t.find(".medium-insert-images-progress").remove(),n[e].value=t.html()}),n},a.prototype.add=function(e){var n=this,t=p(this.templates["src/js/templates/images-fileupload.hbs"]()),i={dataType:"json",add:function(e,t){p.proxy(n,"uploadAdd",e,t)()},done:function(e,t){p.proxy(n,"uploadDone",e,t)()}};e&&(this.meta=e),(new XMLHttpRequest).upload&&(i.progress=function(e,t){p.proxy(n,"uploadProgress",e,t)()},i.progressall=function(e,t){p.proxy(n,"uploadProgressall",e,t)()}),t.fileupload(p.extend(!0,{},this.options.fileUploadOptions,i)),t.click()},a.prototype.uploadAdd=function(e,t){var n,i=this.$el.find(".medium-insert-active"),o=this,a=[],r=t.files[0],s=this.options.fileUploadOptions.acceptFileTypes,l=this.options.fileUploadOptions.maxFileSize;if(s&&!s.test(r.type)?a.push(this.options.messages.acceptFileTypesError+r.name):l&&r.size>l&&a.push(this.options.messages.maxFileSizeError+r.name),0<a.length)return this.options.uploadFailed&&"function"==typeof this.options.uploadFailed?void this.options.uploadFailed(a,t):void alert(a.join("\n"));this.core.hideButtons(),i.is("p")&&(this.core.migrateExistingContent(i),i.replaceWith('<div class="medium-insert-active">'+i.html()+"</div>"),(i=this.$el.find(".medium-insert-active")).next().is("p")||i.after("<p><br></p>"),this.core.moveCaret(i.next())),i.addClass("medium-insert-images"),!1===this.options.preview&&0===i.find("progress").length&&(new XMLHttpRequest).upload&&i.append(this.templates["src/js/templates/images-progressbar.hbs"]()),(t.autoUpload||!1!==t.autoUpload&&p(e.target).fileupload("option","autoUpload"))&&t.process().done(function(){o.options.preview?((n=new FileReader).onload=function(e){p.proxy(o,"showImage",e.target.result,t)()},n.readAsDataURL(t.files[0])):t.submit()})},a.prototype.uploadProgressall=function(e,t){var n,i;!1===this.options.preview&&(n=parseInt(t.loaded/t.total*100,10),(i=this.$el.find(".medium-insert-active").find("progress")).attr("value",n).text(n),100===n&&i.remove())},a.prototype.uploadProgress=function(e,t){var n,i;this.options.preview&&(n=100-parseInt(t.loaded/t.total*100,10),(i=t.context.find(".medium-insert-images-progress")).css("width",n+"%"),0==n&&i.remove())},a.prototype.uploadDone=function(e,t){p.proxy(this,"showImage",t.result.image_url,t,{uiid:t.result.id})(),this.core.clean(),this.sorting()},a.prototype.showImage=function(t,n,e){m.__SECRET__=m.__SECRET__||{},m.__SECRET__.data=n;var i,o,a=this.$el.find(".medium-insert-active");a.click();var r=(o=this).options.autoGrid&&a.find("figure").length>=this.options.autoGrid||this.meta&&"grid"===this.meta.type;if(this.options.preview&&n.context)i=this.getDOMImage(),p(i).one("load",function(){var e;e=r?"data-src":"src",n.context.find("img").attr(e,t),this.options.uploadCompleted&&this.options.uploadCompleted(n.context,n),o.core.triggerInput()}.bind(this)),r?(i.src=m.blankUrl,p(i).css("background-image","url("+t+")"),-1===t.indexOf("data:")&&p(i).attr("data-src",t),p(i).load()):i.src=t;else{var s;r?(s=p(this.templates["src/js/templates/images-grid-each.hbs"]({img:t,progress:this.options.preview,caption:""})),0===a.find("figure").length&&a.append("<figure />"),n.context=s.appendTo(a.find("figure")),a.find("figure").attr("data-mode",d.Grid)):(s=p(this.templates["src/js/templates/images-image.hbs"]({img:t,progress:this.options.preview})),n.context=s.appendTo(a),n.context.attr("data-mode",d.Normal));var l=n.context.find("img");if(e&&e.uiid&&l.attr("data-uiid",e.uiid),a.find("br").remove(),r&&(p.each(this.options.styles,function(e,t){var n="medium-insert-images-"+e;a.removeClass(n),t.removed&&t.removed(a)}),m.isWhitelabelV2||a.addClass("medium-insert-images-grid"),this.options.styles.grid.added&&this.options.styles.grid.added(a),0===a.find(".add_option_tools").length)){var c=this.templates["src/js/templates/images-grid-popup.hbs"];a.find("figure").prepend(c)}this.options.preview?n.submit():this.options.uploadCompleted&&this.options.uploadCompleted(n.context,n)}return this.core.triggerInput(),n.context},a.prototype.getDOMImage=function(){return new m.Image},a.prototype.selectImage=function(e){var t,n=this;if(this.core.options.enabled){var i=0<(t=p(e.target)).closest(".grid").length;this.$currentImage=t,this.$el.blur(),t.addClass("medium-insert-image-active"),t.closest(".medium-insert-images").addClass("medium-insert-active"),i||p('<a href="#" class="remove">Remove</a>').insertAfter(t),setTimeout(function(){if(i){if(n.options.captions)t.closest("div.grid")}else n.addToolbar(),n.options.captions&&u(n.$currentImage)!==d.Quoted&&n.core.addCaption(t.closest("figure"),n.options.captionPlaceholder)},50)}},a.prototype.unselectImage=function(e){if(null!=this.$currentImage){var t;t=e?p(e.target):this.$currentImage.parent();var n=this.$el.find(".medium-insert-image-active");if(!t.is(this.$currentImage)){if(t.is("img")&&t.hasClass("medium-insert-image-active"))return n.not(t).removeClass("medium-insert-image-active"),p(".medium-insert-images-toolbar, .medium-insert-images-toolbar2").remove(),void this.core.removeCaptions(t);n.removeClass("medium-insert-image-active"),n.parent().find(".remove").remove(),p(".medium-insert-images-toolbar, .medium-insert-images-toolbar2").remove(),t.is(".medium-insert-caption-placeholder")?this.core.removeCaptionPlaceholder(n.closest("figure")):!1===t.is("figcaption")&&this.$el.closest("figure").find("figcaption").text().trim()&&this.core.removeCaptions(),this.$currentImage=null}}},a.prototype.removeImage=function(e){var t,n,i,o,a,r,s,l,c,u,d=[],h=this.$el.find(".medium-insert-image-active");if((8===e.which||46===e.which)&&(h.length&&d.push(h),(i=m.getSelection())&&i.rangeCount&&(o=i.getRangeAt(0),a=o.commonAncestorContainer,s="#text"===a.nodeName?p(a).parent():p(a),r=g.selection.getCaretOffsets(a).left,8===e.which&&0===r?l=s.prev():46===e.which&&r===s.text().length&&(l=s.next()),l&&l.hasClass("medium-insert-images")&&d.push(l.find("img")),(c=g.selection.getSelectionHtml(f))&&p("<div></div>").html(c).find(".medium-insert-images img").each(function(){d.push(p(this))})),d.length)){for(u=0;u<d.length;u++)t=d[u].closest(".medium-insert-images"),d[u].closest("figure").remove(),0===t.find("figure").length&&(!1!==(n=t.next()).is("p")&&""===n.text()||(n=p(this.templates["src/js/templates/core-empty-line.hbs"]().trim()),t.before(n)),t.remove());this.core.hideAddons(),!c&&n&&(e.preventDefault(),this.core.moveCaret(n)),p(".medium-insert-images-toolbar, .medium-insert-images-toolbar2").remove(),this.core.triggerInput()}},a.prototype.deleteFile=function(e){this.options.deleteScript&&p.ajax(p.extend(!0,{},{url:this.options.deleteScript,type:this.options.deleteMethod||"POST",data:{file:e}},this.options.fileDeleteOptions))},a.prototype.addToolbar=function(){var e,t,n=this.$el.find(".medium-insert-image-active"),i=n.closest(".medium-insert-images"),o=!1,a=this.core.getEditor(),r=a.options.elementsContainer||"body",s=n.closest("figure"),l=m.isWhitelabelV2?"src/js/templates/images-toolbar-gear.hbs":"src/js/templates/images-toolbar.hbs",c=this.templates[l]({styles:this.options.styles,actions:this.options.actions}).trim();p(r).append(p(c).find("."+h[u(s)]).addClass("selected").end()),e=p(".medium-insert-images-toolbar"),t=p(".medium-insert-images-toolbar2"),e.find("button").each(function(){i.hasClass("medium-insert-images-"+p(this).data("action"))&&(p(this).addClass("medium-editor-button-active"),o=!0)}),!1===o&&e.find("button").first().addClass("medium-editor-button-active"),this.repositionToolbars(),this.core.getEditor().getExtensionByName("toolbar").hideToolbar(),e.fadeIn(),t.fadeIn()},a.prototype.autoRepositionToolbars=function(){setTimeout(function(){this.repositionToolbars()}.bind(this),0)},a.prototype.repositionToolbars=function(){var e=p(".medium-insert-images-toolbar"),t=p(".medium-insert-images-toolbar2"),n=this.$el.find(".medium-insert-image-active"),i=this.core.getEditor().options.elementsContainer,o=-1<["absolute","fixed"].indexOf(m.getComputedStyle(i).getPropertyValue("position")),a=o?i.getBoundingClientRect():null,r=p(m).width(),s={};t.length&&(s.top=n.offset().top+2,s.left=n.offset().left+n.width()-t.width()-4,o&&(s.top+=i.scrollTop-a.top,s.left-=a.left,r=p(i).width()),s.left+t.width()>r&&(s.left=r-t.width()),t.css(s)),e.length&&(n.closest(".medium-insert-images-grid-active").length&&(n=n.closest(".medium-insert-images-grid-active")),s.top=n.offset().top-e.height()-8-2-5,s.left=n.offset().left+n.width()/2-e.width()/2,o&&(s.top+=i.scrollTop-a.top,s.left-=a.left),s.top<0&&(s.top=0),e.css(s))},a.prototype.toolbarAction=function(e){var t,n,i,o,a,r=this;null!==this.$currentImage&&(t=p(e.target).is("button")?p(e.target):p(e.target).closest("button"),n=t.closest("li"),i=n.closest("ul"),o=i.find("li"),a=this.$el.find(".medium-insert-active"),t.addClass("medium-editor-button-active"),n.siblings().find(".medium-editor-button-active").removeClass("medium-editor-button-active"),o.find("button").each(function(){var e="medium-insert-images-"+p(this).data("action");p(this).hasClass("medium-editor-button-active")?(a.addClass(e),r.options.styles[p(this).data("action")].added&&r.options.styles[p(this).data("action")].added(a)):(a.removeClass(e),r.options.styles[p(this).data("action")].removed&&r.options.styles[p(this).data("action")].removed(a))}),this.core.hideButtons(),this.core.triggerInput())},a.prototype.toolbar2Action=function(e){var t,n;null!==this.$currentImage&&(t=p(e.target).is("button")?p(e.target):p(e.target).closest("button"),(n=this.options.actions[t.data("action")].clicked)&&n(this.$el.find(".medium-insert-image-active")),this.core.hideButtons(),this.core.triggerInput())},a.prototype.sorting=function(){p.proxy(this.options.sorting,this)()},p.fn[n+i]=function(e){return this.each(function(){p.data(this,"plugin_"+n+i)||p.data(this,"plugin_"+n+i,new a(this,e))})}}(jQuery,window,document,g.util)}.bind(window),"object"===v(e)&&e.exports?e.exports=function(e){if("undefined"==typeof window)throw new Error("medium-editor-insert-plugin runs only in a browser.");return window.Handlebars=n(43),window.MediumEditor=n(1),n(60),n(61),t(e,Handlebars,MediumEditor),e}:t(jQuery,Handlebars,MediumEditor)}).call(this,n(42)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){e.exports=n(44).default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}t.__esModule=!0;var a=o(n(14)),r=i(n(56)),s=i(n(8)),l=o(n(6)),c=o(n(57)),u=i(n(58));function d(){var t=new a.HandlebarsEnvironment;return l.extend(t,a),t.SafeString=r.default,t.Exception=s.default,t.Utils=l,t.escapeExpression=l.escapeExpression,t.VM=c,t.template=function(e){return c.template(e,t)},t}var h=d();h.create=d,u.default(h),h.default=h,t.default=h,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.registerDefaultHelpers=function(e){o.default(e),a.default(e),r.default(e),s.default(e),l.default(e),c.default(e),u.default(e)};var o=i(n(46)),a=i(n(47)),r=i(n(48)),s=i(n(49)),l=i(n(50)),c=i(n(51)),u=i(n(52))},function(e,t,n){"use strict";t.__esModule=!0;var r=n(6);t.default=function(a){a.registerHelper("blockHelperMissing",function(e,t){var n=t.inverse,i=t.fn;if(!0===e)return i(this);if(!1===e||null==e)return n(this);if(r.isArray(e))return 0<e.length?(t.ids&&(t.ids=[t.name]),a.helpers.each(e,t)):n(this);if(t.data&&t.ids){var o=r.createFrame(t.data);o.contextPath=r.appendContextPath(t.data.contextPath,t.name),t={data:o}}return i(e,t)})},e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0;var i,h=n(6),o=n(8),p=(i=o)&&i.__esModule?i:{default:i};t.default=function(e){e.registerHelper("each",function(i,e){if(!e)throw new p.default("Must pass iterator to #each");var o=e.fn,t=e.inverse,n=0,a="",r=void 0,s=void 0;function l(e,t,n){r&&(r.key=e,r.index=t,r.first=0===t,r.last=!!n,s&&(r.contextPath=s+e)),a+=o(i[e],{data:r,blockParams:h.blockParams([i[e],e],[s+e,null])})}if(e.data&&e.ids&&(s=h.appendContextPath(e.data.contextPath,e.ids[0])+"."),h.isFunction(i)&&(i=i.call(this)),e.data&&(r=h.createFrame(e.data)),i&&"object"==typeof i)if(h.isArray(i))for(var c=i.length;n<c;n++)n in i&&l(n,n,n===i.length-1);else{var u=void 0;for(var d in i)i.hasOwnProperty(d)&&(void 0!==u&&l(u,n-1),u=d,n++);void 0!==u&&l(u,n-1,!0)}return 0===n&&(a=t(this)),a})},e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0;var i,o=n(8),a=(i=o)&&i.__esModule?i:{default:i};t.default=function(e){e.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new a.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0;var i=n(6);t.default=function(n){n.registerHelper("if",function(e,t){return i.isFunction(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||i.isEmpty(e)?t.inverse(this):t.fn(this)}),n.registerHelper("unless",function(e,t){return n.helpers.if.call(this,e,{fn:t.inverse,inverse:t.fn,hash:t.hash})})},e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(o){o.registerHelper("log",function(){for(var e=[void 0],t=arguments[arguments.length-1],n=0;n<arguments.length-1;n++)e.push(arguments[n]);var i=1;null!=t.hash.level?i=t.hash.level:t.data&&null!=t.data.level&&(i=t.data.level),e[0]=i,o.log.apply(o,e)})},e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e){e.registerHelper("lookup",function(e,t){return e&&e[t]})},e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0;var o=n(6);t.default=function(e){e.registerHelper("with",function(e,t){o.isFunction(e)&&(e=e.call(this));var n=t.fn;if(o.isEmpty(e))return t.inverse(this);var i=t.data;return t.data&&t.ids&&((i=o.createFrame(t.data)).contextPath=o.appendContextPath(t.data.contextPath,t.ids[0])),n(e,{data:i,blockParams:o.blockParams([e],[i&&i.contextPath])})})},e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0,t.registerDefaultDecorators=function(e){a.default(e)};var i,o=n(54),a=(i=o)&&i.__esModule?i:{default:i}},function(e,t,n){"use strict";t.__esModule=!0;var s=n(6);t.default=function(e){e.registerDecorator("inline",function(o,a,r,e){var t=o;return a.partials||(a.partials={},t=function(e,t){var n=r.partials;r.partials=s.extend({},n,a.partials);var i=o(e,t);return r.partials=n,i}),a.partials[e.args[0]]=e.fn,t})},e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0;var i=n(6),a={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(e){if("string"==typeof e){var t=i.indexOf(a.methodMap,e.toLowerCase());e=0<=t?t:parseInt(e,10)}return e},log:function(e){if(e=a.lookupLevel(e),"undefined"!=typeof console&&a.lookupLevel(a.level)<=e){var t=a.methodMap[e];console[t]||(t="log");for(var n=arguments.length,i=Array(1<n?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];console[t].apply(console,i)}}};t.default=a,e.exports=t.default},function(e,t,n){"use strict";function i(e){this.string=e}t.__esModule=!0,i.prototype.toString=i.prototype.toHTML=function(){return""+this.string},t.default=i,e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0,t.checkRevision=function(e){var t=e&&e[0]||1,n=h.COMPILER_REVISION;if(t!==n){if(t<n){var i=h.REVISION_CHANGES[n],o=h.REVISION_CHANGES[t];throw new d.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+i+") or downgrade your runtime to an older version ("+o+").")}throw new d.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}},t.template=function(s,l){if(!l)throw new d.default("No environment passed to template");if(!s||!s.main)throw new d.default("Unknown template object: "+typeof s);s.main.decorator=s.main_d,l.VM.checkRevision(s.compiler);var r={strict:function(e,t){if(!(t in e))throw new d.default('"'+t+'" not defined in '+e);return e[t]},lookup:function(e,t){for(var n=e.length,i=0;i<n;i++)if(e[i]&&null!=e[i][t])return e[i][t]},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:u.escapeExpression,invokePartial:function(e,t,n){n.hash&&(t=u.extend({},t,n.hash),n.ids&&(n.ids[0]=!0));e=l.VM.resolvePartial.call(this,e,t,n);var i=l.VM.invokePartial.call(this,e,t,n);null==i&&l.compile&&(n.partials[n.name]=l.compile(e,s.compilerOptions,l),i=n.partials[n.name](t,n));{if(null==i)throw new d.default("The partial "+n.name+" could not be compiled when running in runtime-only mode");if(n.indent){for(var o=i.split("\n"),a=0,r=o.length;a<r&&(o[a]||a+1!==r);a++)o[a]=n.indent+o[a];i=o.join("\n")}return i}},fn:function(e){var t=s[e];return t.decorator=s[e+"_d"],t},programs:[],program:function(e,t,n,i,o){var a=this.programs[e],r=this.fn(e);return t||o||i||n?a=p(this,e,r,t,n,i,o):a||(a=this.programs[e]=p(this,e,r)),a},data:function(e,t){for(;e&&t--;)e=e._parent;return e},merge:function(e,t){var n=e||t;return e&&t&&e!==t&&(n=u.extend({},t,e)),n},nullContext:Object.seal({}),noop:l.VM.noop,compilerInfo:s.compiler};function c(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=t.data;c._setup(t),!t.partial&&s.useData&&(n=function(e,t){t&&"root"in t||((t=t?h.createFrame(t):{}).root=e);return t}(e,n));var i=void 0,o=s.useBlockParams?[]:void 0;function a(e){return""+s.main(r,e,r.helpers,r.partials,n,o,i)}return s.useDepths&&(i=t.depths?e!=t.depths[0]?[e].concat(t.depths):t.depths:[e]),(a=m(s.main,a,r,t.depths||[],n,o))(e,t)}return c.isTop=!0,c._setup=function(e){e.partial?(r.helpers=e.helpers,r.partials=e.partials,r.decorators=e.decorators):(r.helpers=r.merge(e.helpers,l.helpers),s.usePartial&&(r.partials=r.merge(e.partials,l.partials)),(s.usePartial||s.useDecorators)&&(r.decorators=r.merge(e.decorators,l.decorators)))},c._child=function(e,t,n,i){if(s.useBlockParams&&!n)throw new d.default("must pass block params");if(s.useDepths&&!i)throw new d.default("must pass parent depths");return p(r,e,s[e],t,0,n,i)},c},t.wrapProgram=p,t.resolvePartial=function(e,t,n){e?e.call||n.name||(n.name=e,e=n.partials[e]):e="@partial-block"===n.name?n.data["partial-block"]:n.partials[n.name];return e},t.invokePartial=function(e,t,i){var o=i.data&&i.data["partial-block"];i.partial=!0,i.ids&&(i.data.contextPath=i.ids[0]||i.data.contextPath);var a=void 0;i.fn&&i.fn!==r&&function(){i.data=h.createFrame(i.data);var n=i.fn;a=i.data["partial-block"]=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return t.data=h.createFrame(t.data),t.data["partial-block"]=o,n(e,t)},n.partials&&(i.partials=u.extend({},i.partials,n.partials))}();void 0===e&&a&&(e=a);{if(void 0===e)throw new d.default("The partial "+i.name+" could not be found");if(e instanceof Function)return e(t,i)}},t.noop=r;var i,u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(6)),o=n(8),d=(i=o)&&i.__esModule?i:{default:i},h=n(14);function p(i,e,o,a,t,r,s){function n(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=s;return!s||e==s[0]||e===i.nullContext&&null===s[0]||(n=[e].concat(s)),o(i,e,i.helpers,i.partials,t.data||a,r&&[t.blockParams].concat(r),n)}return(n=m(o,n,i,s,a,r)).program=e,n.depth=s?s.length:0,n.blockParams=t||0,n}function r(){return""}function m(e,t,n,i,o,a){if(e.decorator){var r={};t=e.decorator(t,r,n,i&&i[0],o,a,i),u.extend(t,r)}return t}},function(e,t,n){"use strict";(function(i){t.__esModule=!0,t.default=function(e){var t=void 0!==i?i:window,n=t.Handlebars;e.noConflict=function(){return t.Handlebars===e&&(t.Handlebars=n),e}},e.exports=t.default}).call(this,n(59))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){!function(d,e,o,s){var i={drag:!0,drop:!0,exclude:"",nested:!0,vertical:!0},a={afterMove:function(e,t,n){},containerPath:"",containerSelector:"ol, ul",distance:0,delay:0,handle:"",itemPath:"",itemSelector:"li",bodyClass:"dragging",draggedClass:"dragged",isValidTarget:function(e,t){return!0},onCancel:function(e,t,n,i){},onDrag:function(e,t,n,i){e.css(t)},onDragStart:function(e,t,n,i){e.css({height:e.outerHeight(),width:e.outerWidth()}),e.addClass(t.group.options.draggedClass),d("body").addClass(t.group.options.bodyClass)},onDrop:function(e,t,n,i){e.removeClass(t.group.options.draggedClass).removeAttr("style"),d("body").removeClass(t.group.options.bodyClass)},onMousedown:function(e,t,n){if(!n.target.nodeName.match(/^(input|select|textarea)$/i))return n.preventDefault(),!0},placeholderClass:"placeholder",placeholder:'<li class="placeholder"></li>',pullPlaceholder:!0,serialize:function(e,t,n){var i=d.extend({},e.data());return n?[t]:(t[0]&&(i.children=t),delete i.subContainers,delete i.sortable,i)},tolerance:0},t={},r=0,h={left:0,top:0,bottom:0,right:0},l={start:"touchstart.sortable mousedown.sortable",drop:"touchend.sortable touchcancel.sortable mouseup.sortable",drag:"touchmove.sortable mousemove.sortable",scroll:"scroll.sortable"},c="subContainers";function u(e,t){return Math.max(0,e[0]-t[0],t[0]-e[1])+Math.max(0,e[2]-t[1],t[1]-e[3])}function n(e,t,n,i){var o=e.length,a=i?"offset":"position";for(n=n||0;o--;){var r=e[o].el?e[o].el:d(e[o]),s=r[a]();s.left+=parseInt(r.css("margin-left"),10),s.top+=parseInt(r.css("margin-top"),10),t[o]=[s.left-n,s.left+r.outerWidth()+n,s.top-n,s.top+r.outerHeight()+n]}}function p(e,t){var n=t.offset();return{left:e.left-n.left,top:e.top-n.top}}function m(e,t,n){t=[t.left,t.top],n=n&&[n.left,n.top];for(var i,o=e.length,a=[];o--;)i=e[o],a[o]=[o,u(i,t),n&&u(i,n)];return a=a.sort(function(e,t){return t[1]-e[1]||t[2]-e[2]||t[0]-e[0]})}function f(e){this.options=d.extend({},a,e),this.containers=[],this.options.rootGroup||(this.scrollProxy=d.proxy(this.scroll,this),this.dragProxy=d.proxy(this.drag,this),this.dropProxy=d.proxy(this.drop,this),this.placeholder=d(this.options.placeholder),e.isValidTarget||(this.options.isValidTarget=s))}function g(e,t){this.el=e,this.options=d.extend({},i,t),this.group=f.get(this.options),this.rootGroup=this.options.rootGroup||this.group,this.handle=this.rootGroup.options.handle||this.rootGroup.options.itemSelector;var n=this.rootGroup.options.itemPath;this.target=n?this.el.find(n):this.el,this.target.on(l.start,this.handle,d.proxy(this.dragInit,this)),this.options.drop&&this.group.containers.push(this)}f.get=function(e){return t[e.group]||(e.group===s&&(e.group=r++),t[e.group]=new f(e)),t[e.group]},f.prototype={dragInit:function(e,t){this.$document=d(t.el[0].ownerDocument);var n=d(e.target).closest(this.options.itemSelector);if(n.length){if(this.item=n,this.itemContainer=t,this.item.is(this.options.exclude)||!this.options.onMousedown(this.item,a.onMousedown,e))return;this.setPointer(e),this.toggleListeners("on"),this.setupDelayTimer(),this.dragInitDone=!0}},drag:function(e){if(!this.dragging){if(!this.distanceMet(e)||!this.delayMet)return;this.options.onDragStart(this.item,this.itemContainer,a.onDragStart,e),this.item.before(this.placeholder),this.dragging=!0}this.setPointer(e),this.options.onDrag(this.item,p(this.pointer,this.item.offsetParent()),a.onDrag,e);var t=this.getPointer(e),n=this.sameResultBox,i=this.options.tolerance;(!n||n.top-i>t.top||n.bottom+i<t.top||n.left-i>t.left||n.right+i<t.left)&&(this.searchValidTarget()||(this.placeholder.detach(),this.lastAppendedItem=s))},drop:function(e){this.toggleListeners("off"),this.dragInitDone=!1,this.dragging&&(this.placeholder.closest("html")[0]?this.placeholder.before(this.item).detach():this.options.onCancel(this.item,this.itemContainer,a.onCancel,e),this.options.onDrop(this.item,this.getContainer(this.item),a.onDrop,e),this.clearDimensions(),this.clearOffsetParent(),this.lastAppendedItem=this.sameResultBox=s,this.dragging=!1)},searchValidTarget:function(e,t){e||(e=this.relativePointer||this.pointer,t=this.lastRelativePointer||this.lastPointer);for(var n=m(this.getContainerDimensions(),e,t),i=n.length;i--;){var o=n[i][0];if(!n[i][1]||this.options.pullPlaceholder){var a=this.containers[o];if(!a.disabled){if(!this.$getOffsetParent()){var r=a.getItemOffsetParent();e=p(e,r),t=p(t,r)}if(a.searchValidTarget(e,t))return!0}}}this.sameResultBox&&(this.sameResultBox=s)},movePlaceholder:function(e,t,n,i){var o=this.lastAppendedItem;!i&&o&&o[0]===t[0]||(t[n](this.placeholder),this.lastAppendedItem=t,this.sameResultBox=i,this.options.afterMove(this.placeholder,e,t))},getContainerDimensions:function(){return this.containerDimensions||n(this.containers,this.containerDimensions=[],this.options.tolerance,!this.$getOffsetParent()),this.containerDimensions},getContainer:function(e){return e.closest(this.options.containerSelector).data(o)},$getOffsetParent:function(){if(this.offsetParent===s){var e=this.containers.length-1,t=this.containers[e].getItemOffsetParent();if(!this.options.rootGroup)for(;e--;)if(t[0]!=this.containers[e].getItemOffsetParent()[0]){t=!1;break}this.offsetParent=t}return this.offsetParent},setPointer:function(e){var t=this.getPointer(e);if(this.$getOffsetParent()){var n=p(t,this.$getOffsetParent());this.lastRelativePointer=this.relativePointer,this.relativePointer=n}this.lastPointer=this.pointer,this.pointer=t},distanceMet:function(e){var t=this.getPointer(e);return Math.max(Math.abs(this.pointer.left-t.left),Math.abs(this.pointer.top-t.top))>=this.options.distance},getPointer:function(e){var t=e.originalEvent||e.originalEvent.touches&&e.originalEvent.touches[0];return{left:e.pageX||t.pageX,top:e.pageY||t.pageY}},setupDelayTimer:function(){var e=this;this.delayMet=!this.options.delay,this.delayMet||(clearTimeout(this._mouseDelayTimer),this._mouseDelayTimer=setTimeout(function(){e.delayMet=!0},this.options.delay))},scroll:function(e){this.clearDimensions(),this.clearOffsetParent()},toggleListeners:function(n){var i=this;d.each(["drag","drop","scroll"],function(e,t){i.$document[n](l[t],i[t+"Proxy"])})},clearOffsetParent:function(){this.offsetParent=s},clearDimensions:function(){this.traverse(function(e){e._clearDimensions()})},traverse:function(e){e(this);for(var t=this.containers.length;t--;)this.containers[t].traverse(e)},_clearDimensions:function(){this.containerDimensions=s},_destroy:function(){t[this.options.group]=s}},g.prototype={dragInit:function(e){var t=this.rootGroup;!this.disabled&&!t.dragInitDone&&this.options.drag&&this.isValidDrag(e)&&t.dragInit(e,this)},isValidDrag:function(e){return 1==e.which||"touchstart"==e.type&&1==e.originalEvent.touches.length},searchValidTarget:function(e,t){var n=m(this.getItemDimensions(),e,t),i=n.length,o=this.rootGroup,a=!o.options.isValidTarget||o.options.isValidTarget(o.item,this);if(!i&&a)return o.movePlaceholder(this,this.target,"append"),!0;for(;i--;){var r=n[i][0];if(!n[i][1]&&this.hasChildGroup(r)){if(this.getContainerGroup(r).searchValidTarget(e,t))return!0}else if(a)return this.movePlaceholder(r,e),!0}},movePlaceholder:function(e,t){var n=d(this.items[e]),i=this.itemDimensions[e],o="after",a=n.outerWidth(),r=n.outerHeight(),s=n.offset(),l={left:s.left,right:s.left+a,top:s.top,bottom:s.top+r};if(this.options.vertical){var c=(i[2]+i[3])/2;t.top<=c?(o="before",l.bottom-=r/2):l.top+=r/2}else{var u=(i[0]+i[1])/2;t.left<=u?(o="before",l.right-=a/2):l.left+=a/2}this.hasChildGroup(e)&&(l=h),this.rootGroup.movePlaceholder(this,n,o,l)},getItemDimensions:function(){return this.itemDimensions||(this.items=this.$getChildren(this.el,"item").filter(":not(."+this.group.options.placeholderClass+", ."+this.group.options.draggedClass+")").get(),n(this.items,this.itemDimensions=[],this.options.tolerance)),this.itemDimensions},getItemOffsetParent:function(){var e=this.el;return"relative"===e.css("position")||"absolute"===e.css("position")||"fixed"===e.css("position")?e:e.offsetParent()},hasChildGroup:function(e){return this.options.nested&&this.getContainerGroup(e)},getContainerGroup:function(e){var t=d.data(this.items[e],c);if(t===s){var n=this.$getChildren(this.items[e],"container");if(t=!1,n[0]){var i=d.extend({},this.options,{rootGroup:this.rootGroup,group:r++});t=n[o](i).data(o).group}d.data(this.items[e],c,t)}return t},$getChildren:function(e,t){var n=this.rootGroup.options,i=n[t+"Path"],o=n[t+"Selector"];return e=d(e),i&&(e=e.find(i)),e.children(o)},_serialize:function(e,t){var n=this,i=t?"item":"container",o=this.$getChildren(e,i).not(this.options.exclude).map(function(){return n._serialize(d(this),!t)}).get();return this.rootGroup.options.serialize(e,o,t)},traverse:function(n){d.each(this.items||[],function(e){var t=d.data(this,c);t&&t.traverse(n)}),n(this)},_clearDimensions:function(){this.itemDimensions=s},_destroy:function(){var t=this;this.target.off(l.start,this.handle),this.el.removeData(o),this.options.drop&&(this.group.containers=d.grep(this.group.containers,function(e){return e!=t})),d.each(this.items||[],function(){d.removeData(this,c)})}};var v={enable:function(){this.traverse(function(e){e.disabled=!1})},disable:function(){this.traverse(function(e){e.disabled=!0})},serialize:function(){return this._serialize(this.el,!0)},refresh:function(){this.traverse(function(e){e._clearDimensions()})},destroy:function(){this.traverse(function(e){e._destroy()})}};d.extend(g.prototype,v),d.fn[o]=function(n){var i=Array.prototype.slice.call(arguments,1);return this.map(function(){var e=d(this),t=e.data(o);return t&&v[n]?v[n].apply(t,i)||this:(t||n!==s&&"object"!=typeof n||e.data(o,new g(e,n)),this)})}}(jQuery,window,"sortable")},function(e,t,n){!function(e){"use strict";e(window.jQuery)}(function(v){"use strict";function e(n){var i="dragover"===n;return function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var t=e.dataTransfer;t&&-1!==v.inArray("Files",t.types)&&!1!==this._trigger(n,v.Event(n,{delegatedEvent:e}))&&(e.preventDefault(),i&&(t.dropEffect="copy"))}}v.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||v('<input type="file">').prop("disabled")),v.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),v.support.xhrFormDataFileUpload=!!window.FormData,v.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),v.widget("blueimp.fileupload",{options:{dropZone:v(document),pasteZone:void 0,fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(n,e){return n=this.messages[n]||n.toString(),e&&v.each(e,function(e,t){n=n.replace("{"+e+"}",t)}),n},formData:function(e){return e.serializeArray()},add:function(e,t){if(e.isDefaultPrevented())return!1;(t.autoUpload||!1!==t.autoUpload&&v(this).fileupload("option","autoUpload"))&&t.process().done(function(){t.submit()})},processData:!1,contentType:!1,cache:!1,timeout:0},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:v.support.blobSlice&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,n){var i=e-this.timestamp;return this.bitrate&&n&&!(n<i)||(this.bitrate=(t-this.loaded)*(1e3/i)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(e){return!e.forceIframeTransport&&(!e.multipart&&v.support.xhrFileUpload||v.support.xhrFormDataFileUpload)},_getFormData:function(e){var n;return"function"===v.type(e.formData)?e.formData(e.form):v.isArray(e.formData)?e.formData:"object"===v.type(e.formData)?(n=[],v.each(e.formData,function(e,t){n.push({name:e,value:t})}),n):[]},_getTotal:function(e){var n=0;return v.each(e,function(e,t){n+=t.size||1}),n},_initProgressObject:function(e){var t={loaded:0,total:0,bitrate:0};e._progress?v.extend(e._progress,t):e._progress=t},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)e._response.hasOwnProperty(t)&&delete e._response[t];else e._response={}},_onProgress:function(e,t){if(e.lengthComputable){var n,i=Date.now?Date.now():(new Date).getTime();if(t._time&&t.progressInterval&&i-t._time<t.progressInterval&&e.loaded!==e.total)return;t._time=i,n=Math.floor(e.loaded/e.total*(t.chunkSize||t._progress.total))+(t.uploadedBytes||0),this._progress.loaded+=n-t._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(i,this._progress.loaded,t.bitrateInterval),t._progress.loaded=t.loaded=n,t._progress.bitrate=t.bitrate=t._bitrateTimer.getBitrate(i,n,t.bitrateInterval),this._trigger("progress",v.Event("progress",{delegatedEvent:e}),t),this._trigger("progressall",v.Event("progressall",{delegatedEvent:e}),this._progress)}},_initProgressListener:function(n){var i=this,e=n.xhr?n.xhr():v.ajaxSettings.xhr();e.upload&&(v(e.upload).bind("progress",function(e){var t=e.originalEvent;e.lengthComputable=t.lengthComputable,e.loaded=t.loaded,e.total=t.total,i._onProgress(e,n)}),n.xhr=function(){return e})},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(n){var i,o=this,e=n.files[0],t=n.multipart||!v.support.xhrFileUpload,a="array"===v.type(n.paramName)?n.paramName[0]:n.paramName;n.headers=v.extend({},n.headers),n.contentRange&&(n.headers["Content-Range"]=n.contentRange),t&&!n.blob&&this._isInstanceOf("File",e)||(n.headers["Content-Disposition"]='attachment; filename="'+encodeURI(e.name)+'"'),t?v.support.xhrFormDataFileUpload&&(n.postMessage?(i=this._getFormData(n),n.blob?i.push({name:a,value:n.blob}):v.each(n.files,function(e,t){i.push({name:"array"===v.type(n.paramName)&&n.paramName[e]||a,value:t})})):(o._isInstanceOf("FormData",n.formData)?i=n.formData:(i=new FormData,v.each(this._getFormData(n),function(e,t){i.append(t.name,t.value)})),n.blob?i.append(a,n.blob,e.name):v.each(n.files,function(e,t){(o._isInstanceOf("File",t)||o._isInstanceOf("Blob",t))&&i.append("array"===v.type(n.paramName)&&n.paramName[e]||a,t,t.uploadName||t.name)})),n.data=i):(n.contentType=e.type||"application/octet-stream",n.data=n.blob||e),n.blob=null},_initIframeSettings:function(e){var t=v("<a></a>").prop("href",e.url).prop("host");e.dataType="iframe "+(e.dataType||""),e.formData=this._getFormData(e),e.redirect&&t&&t!==location.host&&e.formData.push({name:e.redirectParamName||"redirect",value:e.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(e){var t=v(e.fileInput),i=e.paramName;return i?v.isArray(i)||(i=[i]):(i=[],t.each(function(){for(var e=v(this),t=e.prop("name")||"files[]",n=(e.prop("files")||[1]).length;n;)i.push(t),n-=1}),i.length||(i=[t.prop("name")||"files[]"])),i},_initFormSettings:function(e){e.form&&e.form.length||(e.form=v(e.fileInput.prop("form")),e.form.length||(e.form=v(this.options.fileInput.prop("form")))),e.paramName=this._getParamName(e),e.url||(e.url=e.form.prop("action")||location.href),e.type=(e.type||"string"===v.type(e.form.prop("method"))&&e.form.prop("method")||"").toUpperCase(),"POST"!==e.type&&"PUT"!==e.type&&"PATCH"!==e.type&&(e.type="POST"),e.formAcceptCharset||(e.formAcceptCharset=e.form.attr("accept-charset"))},_getAJAXSettings:function(e){var t=v.extend({},this.options,e);return this._initFormSettings(t),this._initDataSettings(t),t},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(e,t,n){var i=v.Deferred(),o=i.promise();return t=t||this.options.context||o,!0===e?i.resolveWith(t,n):!1===e&&i.rejectWith(t,n),o.abort=i.promise,this._enhancePromise(o)},_addConvenienceMethods:function(e,n){function i(e){return v.Deferred().resolveWith(o,e).promise()}var o=this;n.process=function(e,t){return(e||t)&&(n._processQueue=this._processQueue=(this._processQueue||i([this])).then(function(){return n.errorThrown?v.Deferred().rejectWith(o,[n]).promise():i(arguments)}).then(e,t)),this._processQueue||i([this])},n.submit=function(){return"pending"!==this.state()&&(n.jqXHR=this.jqXHR=!1!==o._trigger("submit",v.Event("submit",{delegatedEvent:e}),this)&&o._onSend(e,this)),this.jqXHR||o._getXHRPromise()},n.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",o._trigger("fail",null,this),o._getXHRPromise(!1))},n.state=function(){return this.jqXHR?o._getDeferredState(this.jqXHR):this._processQueue?o._getDeferredState(this._processQueue):void 0},n.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===o._getDeferredState(this._processQueue)},n.progress=function(){return this._progress},n.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),n=t&&t.split("-"),i=n&&1<n.length&&parseInt(n[1],10);return i&&i+1},_chunkedUpload:function(a,e){a.uploadedBytes=a.uploadedBytes||0;var t,r,s=this,n=a.files[0],l=n.size,c=a.uploadedBytes,u=a.maxChunkSize||l,d=this._blobSlice,h=v.Deferred(),i=h.promise();return!(!(this._isXHRUpload(a)&&d&&(c||u<l))||a.data)&&(!!e||(l<=c?(n.error=a.i18n("uploadedBytes"),this._getXHRPromise(!1,a.context,[null,"error",n.error])):(r=function(){var i=v.extend({},a),o=i._progress.loaded;i.blob=d.call(n,c,c+u,n.type),i.chunkSize=i.blob.size,i.contentRange="bytes "+c+"-"+(c+i.chunkSize-1)+"/"+l,s._initXHRData(i),s._initProgressListener(i),t=(!1!==s._trigger("chunksend",null,i)&&v.ajax(i)||s._getXHRPromise(!1,i.context)).done(function(e,t,n){c=s._getUploadedBytes(n)||c+i.chunkSize,o+i.chunkSize-i._progress.loaded&&s._onProgress(v.Event("progress",{lengthComputable:!0,loaded:c-i.uploadedBytes,total:c-i.uploadedBytes}),i),a.uploadedBytes=i.uploadedBytes=c,i.result=e,i.textStatus=t,i.jqXHR=n,s._trigger("chunkdone",null,i),s._trigger("chunkalways",null,i),c<l?r():h.resolveWith(i.context,[e,t,n])}).fail(function(e,t,n){i.jqXHR=e,i.textStatus=t,i.errorThrown=n,s._trigger("chunkfail",null,i),s._trigger("chunkalways",null,i),h.rejectWith(i.context,[e,t,n])})},this._enhancePromise(i),i.abort=function(){return t.abort()},r(),i)))},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(e,t,n,i){var o=i._progress.total,a=i._response;i._progress.loaded<o&&this._onProgress(v.Event("progress",{lengthComputable:!0,loaded:o,total:o}),i),a.result=i.result=e,a.textStatus=i.textStatus=t,a.jqXHR=i.jqXHR=n,this._trigger("done",null,i)},_onFail:function(e,t,n,i){var o=i._response;i.recalculateProgress&&(this._progress.loaded-=i._progress.loaded,this._progress.total-=i._progress.total),o.jqXHR=i.jqXHR=e,o.textStatus=i.textStatus=t,o.errorThrown=i.errorThrown=n,this._trigger("fail",null,i)},_onAlways:function(e,t,n,i){this._trigger("always",null,i)},_onSend:function(e,t){t.submit||this._addConvenienceMethods(e,t);function n(){return s._sending+=1,l._bitrateTimer=new s._BitrateTimer,i=i||((o||!1===s._trigger("send",v.Event("send",{delegatedEvent:e}),l))&&s._getXHRPromise(!1,l.context,o)||s._chunkedUpload(l)||v.ajax(l)).done(function(e,t,n){s._onDone(e,t,n,l)}).fail(function(e,t,n){s._onFail(e,t,n,l)}).always(function(e,t,n){if(s._onAlways(e,t,n,l),s._sending-=1,s._active-=1,l.limitConcurrentUploads&&l.limitConcurrentUploads>s._sending)for(var i=s._slots.shift();i;){if("pending"===s._getDeferredState(i)){i.resolve();break}i=s._slots.shift()}0===s._active&&s._trigger("stop")})}var i,o,a,r,s=this,l=s._getAJAXSettings(t);return this._beforeSend(e,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?((r=1<this.options.limitConcurrentUploads?(a=v.Deferred(),this._slots.push(a),a.then(n)):(this._sequence=this._sequence.then(n,n),this._sequence)).abort=function(){return o=[void 0,"abort","abort"],i?i.abort():(a&&a.rejectWith(l.context,o),n())},this._enhancePromise(r)):n()},_onAdd:function(i,o){var a,e,r,t,s=this,l=!0,n=v.extend({},this.options,o),c=o.files,u=c.length,d=n.limitMultiFileUploads,h=n.limitMultiFileUploadSize,p=n.limitMultiFileUploadSizeOverhead,m=0,f=this._getParamName(n),g=0;if(!u)return!1;if(h&&void 0===c[0].size&&(h=void 0),(n.singleFileUploads||d||h)&&this._isXHRUpload(n))if(n.singleFileUploads||h||!d)if(!n.singleFileUploads&&h)for(r=[],a=[],t=0;t<u;t+=1)m+=c[t].size+p,(t+1===u||m+c[t+1].size+p>h||d&&d<=t+1-g)&&(r.push(c.slice(g,t+1)),(e=f.slice(g,t+1)).length||(e=f),a.push(e),g=t+1,m=0);else a=f;else for(r=[],a=[],t=0;t<u;t+=d)r.push(c.slice(t,t+d)),(e=f.slice(t,t+d)).length||(e=f),a.push(e);else r=[c],a=[f];return o.originalFiles=c,v.each(r||c,function(e,t){var n=v.extend({},o);return n.files=r?t:[t],n.paramName=a[e],s._initResponseObject(n),s._initProgressObject(n),s._addConvenienceMethods(i,n),l=s._trigger("add",v.Event("add",{delegatedEvent:i}),n)}),l},_replaceFileInput:function(e){var n=e.fileInput,i=n.clone(!0),t=n.is(document.activeElement);e.fileInputClone=i,v("<form></form>").append(i)[0].reset(),n.after(i).detach(),t&&i.focus(),v.cleanData(n.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,t){return t===n[0]?i[0]:t}),n[0]===this.element[0]&&(this.element=i)},_handleFileTreeEntry:function(t,n){function i(e){e&&!e.entry&&(e.entry=t),a.resolve([e])}var e,o=this,a=v.Deferred(),r=[],s=function(){e.readEntries(function(e){e.length?(r=r.concat(e),s()):function(e){o._handleFileTreeEntries(e,n+t.name+"/").done(function(e){a.resolve(e)}).fail(i)}(r)},i)};return n=n||"",t.isFile?t._file?(t._file.relativePath=n,a.resolve(t._file)):t.file(function(e){e.relativePath=n,a.resolve(e)},i):t.isDirectory?(e=t.createReader(),s()):a.resolve([]),a.promise()},_handleFileTreeEntries:function(e,t){var n=this;return v.when.apply(v,v.map(e,function(e){return n._handleFileTreeEntry(e,t)})).then(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(e){var t=(e=e||{}).items;return t&&t.length&&(t[0].webkitGetAsEntry||t[0].getAsEntry)?this._handleFileTreeEntries(v.map(t,function(e){var t;return e.webkitGetAsEntry?((t=e.webkitGetAsEntry())&&(t._file=e.getAsFile()),t):e.getAsEntry()})):v.Deferred().resolve(v.makeArray(e.files)).promise()},_getSingleFileInputFiles:function(e){var t,n,i=(e=v(e)).prop("webkitEntries")||e.prop("entries");if(i&&i.length)return this._handleFileTreeEntries(i);if((t=v.makeArray(e.prop("files"))).length)void 0===t[0].name&&t[0].fileName&&v.each(t,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(!(n=e.prop("value")))return v.Deferred().resolve([]).promise();t=[{name:n.replace(/^.*\\/,"")}]}return v.Deferred().resolve(t).promise()},_getFileInputFiles:function(e){return e instanceof v&&1!==e.length?v.when.apply(v,v.map(e,this._getSingleFileInputFiles)).then(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(e)},_onChange:function(t){var n=this,i={fileInput:v(t.target),form:v(t.target.form)};this._getFileInputFiles(i.fileInput).always(function(e){i.files=e,n.options.replaceFileInput&&n._replaceFileInput(i),!1!==n._trigger("change",v.Event("change",{delegatedEvent:t}),i)&&n._onAdd(t,i)})},_onPaste:function(e){var t=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,i={files:[]};t&&t.length&&(v.each(t,function(e,t){var n=t.getAsFile&&t.getAsFile();n&&i.files.push(n)}),!1!==this._trigger("paste",v.Event("paste",{delegatedEvent:e}),i)&&this._onAdd(e,i))},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var n=this,e=t.dataTransfer,i={};e&&e.files&&e.files.length&&(t.preventDefault(),this._getDroppedFiles(e).always(function(e){i.files=e,!1!==n._trigger("drop",v.Event("drop",{delegatedEvent:t}),i)&&n._onAdd(t,i)}))},_onDragOver:e("dragover"),_onDragEnter:e("dragenter"),_onDragLeave:e("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste})),v.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_destroy:function(){this._destroyEventHandlers()},_setOption:function(e,t){var n=-1!==v.inArray(e,this._specialOptions);n&&this._destroyEventHandlers(),this._super(e,t),n&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var e=this.options;void 0===e.fileInput?e.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):e.fileInput instanceof v||(e.fileInput=v(e.fileInput)),e.dropZone instanceof v||(e.dropZone=v(e.dropZone)),e.pasteZone instanceof v||(e.pasteZone=v(e.pasteZone))},_getRegExp:function(e){var t=e.split("/"),n=t.pop();return t.shift(),new RegExp(t.join("/"),n)},_isRegExpOption:function(e,t){return"url"!==e&&"string"===v.type(t)&&/^\/.*\/[igm]{0,3}$/.test(t)},_initDataAttributes:function(){var o=this,a=this.options,r=this.element.data();v.each(this.element[0].attributes,function(e,t){var n,i=t.name.toLowerCase();/^data-/.test(i)&&(i=i.slice(5).replace(/-[a-z]/g,function(e){return e.charAt(1).toUpperCase()}),n=r[i],o._isRegExpOption(i,n)&&(n=o._getRegExp(n)),a[i]=n)})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var n=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,n._onAdd(null,t)}):(t.files=v.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var n,i,o=this,a=v.Deferred(),e=a.promise();return e.abort=function(){return i=!0,n?n.abort():(a.reject(null,"abort","abort"),e)},this._getFileInputFiles(t.fileInput).always(function(e){i||(e.length?(t.files=e,(n=o._onSend(null,t)).then(function(e,t,n){a.resolve(e,t,n)},function(e,t,n){a.reject(e,t,n)})):a.reject())}),this._enhancePromise(e)}if(t.files=v.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})})},function(e,t,n){var i,o,a;
/*! jQuery UI - v1.11.4+CommonJS - 2015-08-28
* http://jqueryui.com
* Includes: widget.js
* Copyright 2015 jQuery Foundation and other contributors; Licensed MIT */o=[n(15)],void 0===(a="function"==typeof(i=function(u){
/*!
 * jQuery UI Widget 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
var n=0,s=Array.prototype.slice;u.cleanData=function(o){return function(e){var t,n,i;for(i=0;null!=(n=e[i]);i++)try{(t=u._data(n,"events"))&&t.remove&&u(n).triggerHandler("remove")}catch(e){}o(e)}}(u.cleanData),u.widget=function(e,n,t){var i,o,a,r,s={},l=e.split(".")[0];return e=e.split(".")[1],i=l+"-"+e,t||(t=n,n=u.Widget),u.expr[":"][i.toLowerCase()]=function(e){return!!u.data(e,i)},u[l]=u[l]||{},o=u[l][e],a=u[l][e]=function(e,t){if(!this._createWidget)return new a(e,t);arguments.length&&this._createWidget(e,t)},u.extend(a,o,{version:t.version,_proto:u.extend({},t),_childConstructors:[]}),(r=new n).options=u.widget.extend({},r.options),u.each(t,function(t,a){u.isFunction(a)?s[t]=function(){var i=function(){return n.prototype[t].apply(this,arguments)},o=function(e){return n.prototype[t].apply(this,e)};return function(){var e,t=this._super,n=this._superApply;return this._super=i,this._superApply=o,e=a.apply(this,arguments),this._super=t,this._superApply=n,e}}():s[t]=a}),a.prototype=u.widget.extend(r,{widgetEventPrefix:o&&r.widgetEventPrefix||e},s,{constructor:a,namespace:l,widgetName:e,widgetFullName:i}),o?(u.each(o._childConstructors,function(e,t){var n=t.prototype;u.widget(n.namespace+"."+n.widgetName,a,t._proto)}),delete o._childConstructors):n._childConstructors.push(a),u.widget.bridge(e,a),a},u.widget.extend=function(e){for(var t,n,i=s.call(arguments,1),o=0,a=i.length;o<a;o++)for(t in i[o])n=i[o][t],i[o].hasOwnProperty(t)&&void 0!==n&&(u.isPlainObject(n)?e[t]=u.isPlainObject(e[t])?u.widget.extend({},e[t],n):u.widget.extend({},n):e[t]=n);return e},u.widget.bridge=function(a,t){var r=t.prototype.widgetFullName||a;u.fn[a]=function(n){var e="string"==typeof n,i=s.call(arguments,1),o=this;return e?this.each(function(){var e,t=u.data(this,r);return"instance"===n?(o=t,!1):t?u.isFunction(t[n])&&"_"!==n.charAt(0)?(e=t[n].apply(t,i))!==t&&void 0!==e?(o=e&&e.jquery?o.pushStack(e.get()):e,!1):void 0:u.error("no such method '"+n+"' for "+a+" widget instance"):u.error("cannot call methods on "+a+" prior to initialization; attempted to call method '"+n+"'")}):(i.length&&(n=u.widget.extend.apply(null,[n].concat(i))),this.each(function(){var e=u.data(this,r);e?(e.option(n||{}),e._init&&e._init()):u.data(this,r,new t(n,this))})),o}},u.Widget=function(){},u.Widget._childConstructors=[],u.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,t){t=u(t||this.defaultElement||this)[0],this.element=u(t),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=u(),this.hoverable=u(),this.focusable=u(),t!==this&&(u.data(t,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===t&&this.destroy()}}),this.document=u(t.style?t.ownerDocument:t.document||t),this.window=u(this.document[0].defaultView||this.document[0].parentWindow)),this.options=u.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:u.noop,_getCreateEventData:u.noop,_create:u.noop,_init:u.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(u.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:u.noop,widget:function(){return this.element},option:function(e,t){var n,i,o,a=e;if(0===arguments.length)return u.widget.extend({},this.options);if("string"==typeof e)if(a={},e=(n=e.split(".")).shift(),n.length){for(i=a[e]=u.widget.extend({},this.options[e]),o=0;o<n.length-1;o++)i[n[o]]=i[n[o]]||{},i=i[n[o]];if(e=n.pop(),1===arguments.length)return void 0===i[e]?null:i[e];i[e]=t}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];a[e]=t}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(r,s,e){var l,c=this;"boolean"!=typeof r&&(e=s,s=r,r=!1),e?(s=l=u(s),this.bindings=this.bindings.add(s)):(e=s,s=this.element,l=this.widget()),u.each(e,function(e,t){function n(){if(r||!0!==c.options.disabled&&!u(this).hasClass("ui-state-disabled"))return("string"==typeof t?c[t]:t).apply(c,arguments)}"string"!=typeof t&&(n.guid=t.guid=t.guid||n.guid||u.guid++);var i=e.match(/^([\w:-]*)\s*(.*)$/),o=i[1]+c.eventNamespace,a=i[2];a?l.delegate(a,o,n):s.bind(o,n)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t),this.bindings=u(this.bindings.not(e).get()),this.focusable=u(this.focusable.not(e).get()),this.hoverable=u(this.hoverable.not(e).get())},_delay:function(e,t){var n=this;return setTimeout(function(){return("string"==typeof e?n[e]:e).apply(n,arguments)},t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){u(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){u(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){u(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){u(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,t,n){var i,o,a=this.options[e];if(n=n||{},(t=u.Event(t)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),t.target=this.element[0],o=t.originalEvent)for(i in o)i in t||(t[i]=o[i]);return this.element.trigger(t,n),!(u.isFunction(a)&&!1===a.apply(this.element[0],[t].concat(n))||t.isDefaultPrevented())}},u.each({show:"fadeIn",hide:"fadeOut"},function(a,r){u.Widget.prototype["_"+a]=function(t,e,n){"string"==typeof e&&(e={effect:e});var i,o=e?!0===e||"number"==typeof e?r:e.effect||r:a;"number"==typeof(e=e||{})&&(e={duration:e}),i=!u.isEmptyObject(e),e.complete=n,e.delay&&t.delay(e.delay),i&&u.effects&&u.effects.effect[o]?t[a](e):o!==a&&t[o]?t[o](e.duration,e.easing,n):t.queue(function(e){u(this)[a](),n&&n.call(t[0]),e()})}}),u.widget})?i.apply(t,o):i)||(e.exports=a)},function(e,t,n){"use strict";n.r(t);var a,i=n(0),x=n.n(i),o=n(5),s=n.n(o),r=n(2),k=n.n(r),T=n(3),l=n(1),c=n.n(l),u=c.a.extensions.form.extend({customClassOption:null,customClassOptionText:"Button",linkValidation:!1,placeholderText:"http://",targetCheckbox:!1,targetCheckboxText:"Open in new window",name:"anchor2",action:"createLink",aria:"link",tagNames:["a"],contentDefault:"<b>#</b>",contentFA:'<i class="fa fa-link"></i>',activeAnchor:null,init:function(){c.a.extensions.form.prototype.init.apply(this,arguments),this.subscribe("editableKeydown",this.handleKeydown.bind(this)),this.subscribe("hideToolbar",this.handleHideToolbar.bind(this))},handleHideToolbar:function(){var e=this.getInput().value;if(""===e.trim()){if(this.activeAnchor){var t=this.activeAnchor.parentElement;t&&($(this.activeAnchor).replaceWith(this.activeAnchor.textContent),t.normalize(),this.activeAnchor.remove()),this.activeAnchor=null}}else this.activeAnchor.setAttribute("href",this.checkLinkFormat(e)),this.activeAnchor.className="",this.activeAnchor=null},handleClick:function(e){if(e.preventDefault(),e.stopPropagation(),0<$(".medium-editor-action-quote2.medium-editor-button-active").length)return!1;var t=c.a.selection.getSelectionRange(this.document);return t.startOffset===t.endOffset&&(this.base.restoreSelection(),t=c.a.selection.getSelectionRange(this.document)),"a"!==t.startContainer.nodeName.toLowerCase()&&"a"!==t.endContainer.nodeName.toLowerCase()&&!c.a.util.getClosestTag(c.a.selection.getSelectedParentElement(t),"a")||this.initiatedFormDisplay(!0),this.isDisplayed()||this.initiatedFormDisplay(!1),!1},initiatedFormDisplay:function(e){if(e){var t=$(".medium-insert-active a");this.showForm({value:t.attr("href")}),this.base.restoreSelection(),t.addClass("active-anchor")}else this.showForm(),this.base.restoreSelection(),this.base.createLink(this.createTempOpt());this.activeAnchor=null,this.activeAnchor=this.getActiveAnchor()},activeAnchorClassName:"active-anchor",createTempOpt:function(){var e=this.getFormOpts("#");return e.buttonClass=this.activeAnchorClassName,e},getActiveAnchor:function(){return this.activeAnchor||this.document.querySelector("."+this.activeAnchorClassName)},handleKeydown:function(e){c.a.util.isKey(e,c.a.util.keyCode.K)&&c.a.util.isMetaCtrlKey(e)&&!e.shiftKey&&this.handleClick(e)},getForm:function(){return this.form||(this.form=this.createForm()),this.form},getTemplate:function(){var e=['<input type="text" class="medium-editor-toolbar-input" placeholder="',this.placeholderText,'">'];return e.push('<a href="#" class="medium-editor-toolbar-save">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':this.formSaveLabel,"</a>"),e.push('<a href="#" class="medium-editor-toolbar-close">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':this.formCloseLabel,"</a>"),this.targetCheckbox&&e.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-target">',"<label>",this.targetCheckboxText,"</label>","</div>"),this.customClassOption&&e.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-button">',"<label>",this.customClassOptionText,"</label>","</div>"),e.join("")},isDisplayed:function(){return c.a.extensions.form.prototype.isDisplayed.apply(this)},hideToolbarDefaultActions:function(){var e=this.base.getExtensionByName("toolbar");e&&e.hideToolbarDefaultActions()},hideForm:function(){c.a.extensions.form.prototype.hideForm.apply(this),this.getInput().value=""},showForm:function(e){var t=this.getInput(),n=this.getAnchorTargetCheckbox(),i=this.getAnchorButtonCheckbox();if("string"==typeof(e=e||{value:""})&&(e={value:e}),this.base.saveSelection(),this.hideToolbarDefaultActions(),c.a.extensions.form.prototype.showForm.apply(this),this.setToolbarPosition(),t.value=e.value,n&&(n.checked="_blank"===e.target),i){var o=e.buttonClass?e.buttonClass.split(" "):[];i.checked=-1!==o.indexOf(this.customClassOption)}t.focus()},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},getFormOpts:function(e){var t=this.getAnchorTargetCheckbox(),n=this.getAnchorButtonCheckbox(),i={value:e||this.getInput().value.trim()};return this.linkValidation&&(i.value=this.checkLinkFormat(i.value)),i.target="_self",t&&t.checked&&(i.target="_blank"),n&&n.checked&&(i.buttonClass=this.customClassOption),i},doFormSave:function(){var e=this.getFormOpts();this.completeFormSave(e)},completeFormSave:function(e){this.base.restoreSelection(),this.execAction(this.action,e),this.base.checkSelection()},ensureEncodedUri:function(e){return e===decodeURI(e)?encodeURI(e):e},ensureEncodedUriComponent:function(e){return e===decodeURIComponent(e)?encodeURIComponent(e):e},ensureEncodedParam:function(e){var t=e.split("="),n=t[0],i=t[1];return n+(void 0===i?"":"="+this.ensureEncodedUriComponent(i))},ensureEncodedQuery:function(e){return e.split("&").map(this.ensureEncodedParam.bind(this)).join("&")},checkLinkFormat:function(e){var t=e.match(/^(.*?)(?:\?(.*?))?(?:#(.*))?$/),n=t[1],i=t[2],o=t[3];return/^\+?\s?\(?(?:\d\s?\-?\)?){3,20}$/.test(e)?"tel:"+e:(/^([a-z]+:)?\/\/|^(mailto|tel|maps):|^\#/i.test(e)?"":"http://")+this.ensureEncodedUri(n)+(void 0===i?"":"?"+this.ensureEncodedQuery(i))+(void 0===o?"":"#"+o)},doFormCancel:function(){this.getInput().value="",this.getInput().focus()},attachFormEvents:function(e){var t=e.querySelector(".medium-editor-toolbar-close"),n=e.querySelector(".medium-editor-toolbar-save"),i=e.querySelector(".medium-editor-toolbar-input");this.on(e,"click",this.handleFormClick.bind(this)),this.on(i,"keyup",this.handleTextboxKeyup.bind(this)),this.on(t,"click",this.handleCloseClick.bind(this)),this.on(n,"click",this.handleSaveClick.bind(this),!0)},createForm:function(){var e=this.document.createElement("div");return e.className="medium-editor-toolbar-form",e.id="medium-editor-toolbar-form-anchor-"+this.getEditorId(),e.innerHTML=this.getTemplate(),this.attachFormEvents(e),e},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},getAnchorTargetCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-target")},getAnchorButtonCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-button")},handleTextboxKeyup:function(e){if(e.keyCode===c.a.util.keyCode.ENTER)return e.preventDefault(),void this.doFormSave();e.keyCode===c.a.util.keyCode.ESCAPE&&(e.preventDefault(),this.doFormCancel())},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()},handleCloseClick:function(e){e.preventDefault(),this.doFormCancel()}});function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b={get:function(){return a},refresh:function(e){this.instance&&this.instance.props.onChange(this.get().serialize().editable.value,null,e)},setInstance:function(e){this.instance=e},instance:null};window.EditorControl=b;var y={toolbar:{buttons:["bold","italic","justifyLeft","justifyCenter","justifyRight",{name:"h2",action:null,aria:"separator",tagNames:["h2"],contentDefault:"<span>|</span>",classList:["seperator"],attrs:{}},"anchor2"]},anchor:{placeholderText:"http://"},anchorPreview:!1,imageDragging:!1,extensions:{imageDragging:function(){},anchor2:new u},placeholder:{text:"Type your text...",hideOnClick:!1},paste:{handleKeydown:function(){return!0}}},w=c.a.extensions.button.extend({name:"quote2",action:"blockquote2",aria:"blockquote",tagNames:["blockquote"],contentDefault:"<b>&ldquo;</b>",contentFA:'<i class="fa fa-quote-right"></i>',init:function(){c.a.extensions.button.prototype.init.call(this)},handleClick:function(e){e.preventDefault(),e.stopPropagation(),this.toggleSelection(),this.base.checkContentChanged()},getWrappingBlock:function(){return $(document.getSelection().baseNode).closest("blockquote")},isActivated:function(){return 0<this.getWrappingBlock().length},toggleSelection:function(){if(this.isActivated()){document.execCommand("formatBlock",!1,"p");var e,t=$(document.getSelection().baseNode);t.is("span")||(e=t.closest("p > span")),e.contents().unwrap(),$('.medium-editor-toolbar-actions .medium-editor-button-active[data-action="blockquote2"], .medium-editor-toolbar-actions .medium-editor-button-active[data-action="italic"]').removeClass("medium-editor-button-active")}else{b.get().execAction("append-blockquote");var n,i=$(document.getSelection().baseNode);(n=i.is("blockquote")?i.prop("firstChild"):$(i.closest("blockquote").prop("firstChild")))&&n.wrap&&n.wrap("<span />")}},useQueryState:!1,queryCommandState:function(){return this.isActivated()}});window.isWhitelabelV2?(y.toolbar.buttons.push("quote2"),y.extensions.quote2=new w):y.toolbar.buttons.push("quote");var C={images:{fileUploadOptions:{url:"/_admin/image-upload-add.json",type:"POST",formData:function(e){return[{name:"file",value:window.__SECRET__.data.files[0]}]}}}},S=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),v(f(t=function(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?f(e):t}(this,m(n).call(this,e))),"change",function(e){t._editorText=e,t.setState({content:e}),t.props.onChange&&t.props.onChange(e,a)}),t.state={content:t.props.content},$(".article.edit").on("click","p a, blockquote a",function(){var e=this.getAttribute("href");""!==e&&"#"!==e&&(c.a.selection.selectNode(this,document),a.getExtensionByName("anchor2").showForm())}),$(document).on("click","#medium-editor-toolbar-1 .medium-editor-toolbar-actions",function(e){if($(e.currentTarget).is(".medium-editor-toolbar-actions")){var t=a.getExtensionByName("toolbar");t&&t.hideToolbar()}}),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(n,x.a.Component),function(e,t,n){t&&p(e.prototype,t),n&&p(e,n)}(n,[{key:"componentDidMount",value:function(){var n=this,i=s.a.findDOMNode(this);function o(e,t,n){var i=document.getSelection().anchorNode,o=$(i).closest("blockquote");return 0!==o.length&&(n=function(e,t,n,i){if(0===i.find("> span").length&&0!==i.text().trim().length){var o=i.text(),a=$("<span />");a.text(o),i.empty(),i.append(a)}return n}(0,0,n,o)),n}b.setInstance(this),a=new c.a(i,y),$(i).mediumInsert({editor:a,addons:C}),a.subscribe("editableInput",function(e,t){n._updated=!0,n.change(o(0,0,i.innerHTML))}),a.subscribe("editableKeydown",function(e){if(8===e.keyCode){var t=document.getSelection(),n=$(t.anchorNode).closest(".description.more >"),i=$(".description.more").children().length<=2,o=""===n.text().trim();i&&o&&(setTimeout(function(){$(".description.more").prepend('<p class="medium-insert-active"><br></p>'),b.refresh()},0),e.preventDefault(),e.stopImmediatePropagation())}}),window.isWhitelabelV2&&a.subscribe("showToolbar",function(e,t){var n=$(".description.more").data("plugin_mediumInsertImages");n&&n.unselectImage(),setTimeout(function(){var e=$(".description.more").data("plugin_mediumInsert"),t=0<$(".insert-text:visible,.insert-image:visible,.insert-product:visible").length;e&&!t&&e.hideOptionPopupV2()},200)})}},{key:"componentDidUpdate",value:function(){a.restoreSelection()}},{key:"componentWillUnmount",value:function(){a.destroy(),this._editorText=null}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.content!==this._editorText&&this.setState({content:e.content}),this._updated&&(this._updated=!1)}},{key:"shouldComponentUpdate",value:function(e,t){return e.style!==this.props.style||this._editorText!==t.content}},{key:"render",value:function(){a&&a.saveSelection();var e=this.props.tag;return x.a.createElement(e,h({},this.props,{dangerouslySetInnerHTML:{__html:this.state.content}}))}}]),n}();v(S,"defaultProps",{tag:"div"});var E=n(4),A=n(16);function P(e){var t=document.createEvent("MouseEvents");t.initEvent("click",!0,!1),e.dispatchEvent(t)}function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function M(e,t,n){return t&&F(e.prototype,t),n&&F(e,n),e}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j=["mp4","avi","mov"],B="Blank",H="Uploading",z="VideoOnProcess",U="UploadCompleted",W="UploadFailed",q=function(){function i(e,t,n){L(this,i),R(this,"videoId",null),R(this,"timeout",1e3),R(this,"callback",null),R(this,"requesting",!1),R(this,"timerId",null),this.videoId=e,this.callback=t,n&&(this.timeout=n),this.start()}return M(i,[{key:"start",value:function(){var t=this;this.requesting||(this.requesting=!0,this.timerId=setInterval(function(){$.get("/rest-api/v1/videos/videocontents/".concat(t.videoId)).then(function(e){t.requesting=!1,console.log("video ready status:",e.status),null!=t.timerId&&"ready"===e.status&&null===e.pending_job&&(t.clear(),(0,t.callback)(e))}).fail(function(e){t.clear(),console.warn("video ready poll error:",e)})},this.timeout))}},{key:"clear",value:function(){clearInterval(this.timerId),this.timerId=null}}]),i}(),V=x.a.createElement("label",{htmlFor:"video-autoplay-value"},"Autoplay"),K=x.a.createElement("label",{htmlFor:"video-loop-value"},"Loop Video"),G=x.a.createElement("div",{className:"video-wait-banner"},"Processing video..."),X=function(e){function o(){var e,r;L(this,o);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return R(I(r=function(e,t){return!t||"object"!==D(t)&&"function"!=typeof t?I(e):t}(this,(e=N(o)).call.apply(e,[this].concat(n)))),"FullWidth",970),R(I(r),"state",{loading:!1,loaderPx:null,videoPlaying:!1}),R(I(r),"handleInsertCoverImage",function(e){P(r.imageUploadInput)}),R(I(r),"handleInsertCoverVideo",function(e){P(r.videoUploadInput)}),R(I(r),"handleImageUpload",function(e){if(!r.state.loading&&0!==e.target.files.length){var t=e.target;r.toggleLoading(!0,function(){r.uploadImage(t)})}}),R(I(r),"baseLoaderPx",-132),R(I(r),"handleProgress",function(e,t){var n=r.baseLoaderPx+-r.baseLoaderPx*e/t;r.setState({loaderPx:n})}),R(I(r),"reset",null),R(I(r),"resetLoader",function(){r.reset||(r.reset=setTimeout(function(){r.setState({loaderPx:0},function(){r.toggleLoading(!1,function(){r.setState({loaderPx:null})})})},300))}),R(I(r),"createXhr",function(){var e=new XMLHttpRequest;return e.upload.addEventListener("load",r.resetLoader),e.upload.addEventListener("error",r.resetLoader),e.upload.addEventListener("abort",r.resetLoader),e.upload.addEventListener("progress",function(e){r.handleProgress(e.loaded,e.total)},!1),e}),R(I(r),"uploadImage",function(e){var t,n=e,i=n.files||(n.value?[{name:n.value}]:[]);if(i&&i.length&&(t=i[0]),!t)return r.toggleLoading(!1),alert(gettext("Please select a file to upload")),!1;if(!/([^\\\/]+\.(jpe?g|png|gif))$/i.test(t.name||t.filename))return r.toggleLoading(!1),alert(gettext("The image must be in one of the following formats: .jpeg, .jpg, .gif or .png.")),!1;var o=RegExp.$1,a=r.createXhr();a.onreadystatechange=function(){if(4===a.readyState&&(4!==a.readyState||null!=a.responseText&&""!==a.responseText))if(200===a.status){var t,n=a.responseText;try{t=window.JSON.parse(n)}catch(e){try{t=new Function("return "+n)()}catch(e){t=null}}r.handleUploadImageComplete(t)}else r.toggleLoading(!1)},a.open("POST","/upload_cover_image.json?max_width=1200&filename="+o,!0),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("X-Filename",encodeURIComponent(o)),a.send(t)}),R(I(r),"videoReadyPoll",null),R(I(r),"createVideoReadyPoll",function(e){r.videoReadyPoll=new q(e,function(e){r.props.setArticleProp("cover_video.thumbnail_url",e.thumbnail),r.props.setArticleProp("cover_video.autoplay",e.autoplay),r.props.setArticleProp("cover_video.loop",e.loop);try{r.props.setArticleProp("cover_video.duration",e.outputs.h264_400k.duration),r.props.setArticleProp("cover_video.url",e.outputs.h264_400k.url),r.props.setArticleProp("cover_video.width",e.outputs.h264_400k.width),r.props.setArticleProp("cover_video.height",e.outputs.h264_400k.height)}catch(e){console.warn(e),window.alertify("unable to set uploaded cover. Please save and reload to see correct result.")}r.setState({tempImage:null,videoStatus:U})})}),R(I(r),"handleVideoUpload",function(e){if(!r.state.loading&&0!==e.target.files.length)return r.videoReadyPoll&&r.videoReadyPoll.clear(),r.toggleLoading(!0,function(){var t=r.videoUploadInput,e=function(e){var t=e.split(".");return t[t.length-1]}(t.value.trim());if(!j.some(function(e){return e==e})&&!window.confirm("Extension '.".concat(e,"' is not allowed. Proceed?")))return!1;r.setState({videoStatus:H},function(){var e=new window.FormData;e.append("video-file",t.files[0]),$.ajax({url:"/rest-api/v1/videos/videocontents",processData:!1,contentType:!1,type:"POST",data:e,xhr:r.createXhr}).success(function(e,t){console.log("handleVideoUpload -> success",e,t),r.setState({videoStatus:z}),r.props.setArticleProp("cover_video.id",e.id),r.props.setArticleProp("remove_video",null),r.createVideoReadyPoll(e.id)}).fail(function(e,t,n){console.warn("handleVideoUpload -> fail",e,t),r.setState({videoStatus:B}),alert("".concat(n,": failed to upload video. Please try again."))}).always(function(){r.toggleLoading(!1)})})}),!1}),R(I(r),"handleRemove",function(e){e.stopPropagation();var t=r.getImageType();"cover_video"===t?(r.props.setArticleProp("cover_video",null),r.props.setArticleProp("remove_video",!0)):"cover_image"===t&&r.props.setArticleProp("cover_image",null)}),R(I(r),"handleLoopChange",function(e){e.stopPropagation(),r.props.setArticleProp("cover_video.loop",e.target.checked)}),R(I(r),"handleAutoplayChange",function(e){e.stopPropagation(),r.props.setArticleProp("cover_video.autoplay",e.target.checked)}),R(I(r),"handleCoverImageRemove",function(e){e.stopPropagation(),r.props.setArticleProp("cover_image",null)}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(o,x.a.Component),M(o,[{key:"componentDidMount",value:function(){if("cover_video"===this.getImageType()){var e,t=this.getCoverObject();switch(t.status){case 0:case 1:e=z,this.createVideoReadyPoll(t.id);break;case 2:e=U;break;case 3:e=W}this.setState({videoStatus:e})}}},{key:"toggleLoading",value:function(e,t){if(e===this.state.loading)t&&t();else{var n={loading:e};!0===e&&(n.tempImage={url:window.blankUrl,width:this.FullWidth,height:246}),t=t||function(){},this.setState(n,t)}}},{key:"handleUploadImageComplete",value:function(e){var t=this,n=e.image;this.toggleLoading(!1,function(){t.setState({tempImage:null}),t.props.setArticleProp("cover_image",n)})}},{key:"getCoverObject",value:function(){var e=this.state,t=this.props;return e.tempImage||t.cover_video&&t.cover_video.thumbnail_url&&t.cover_video||t.cover_image}},{key:"getImage",value:function(){var e=this.getCoverObject();return this.state.tempImage?e.url:this.props.cover_video&&this.props.cover_video.thumbnail_url?e.thumbnail_url:this.props.cover_image?e.url:""}},{key:"getImageType",value:function(){return this.state.loading?"loading":this.state.tempImage?"tempImage":this.props.cover_video&&this.props.cover_video.thumbnail_url?"cover_video":this.props.cover_image?"cover_image":void 0}},{key:"getImageDimension",value:function(){var e,t,n=this.getCoverObject();n&&(e=n.width,t=n.height);var i={width:"".concat(this.FullWidth,"px"),widthNumber:e};if(null!=e&&null!=t){var o=this.FullWidth/e;i.height="".concat(o*t,"px"),i.heightNumber=o*t}else i.height="246px";return i}},{key:"render",value:function(){var t=this,e=this.state,n=e.loading,i=e.videoStatus,o=e.videoPlaying,a=this.props.cover_image,r=this.getImageType(),s=this.getImage(),l=this.getCoverObject(),c={};if(s){var u=this.getImageDimension();c.backgroundImage="url(".concat(s,")"),null!=u.widthNumber&&970<u.widthNumber&&(c.backgroundSize=u.width,c.height=u.height)}var d=null!=this.state.loaderPx?"".concat(this.state.loaderPx,"px"):null,h=!1,p=!1,m=null;l&&(h=!0===l.autoplay,p=!0===l.loop,m="cover_video"===r?Object(E.formatDuration)(l.duration):Object(E.formatDuration)(0));var f,g,v={};return"cover_video"===r&&a?v.backgroundImage="url(".concat(a.url,")"):v.display="none","cover_video"===r&&i===U&&(f={cover_video:{original_url:l.url,thumbnail_url:l.thumbnail_url,loop:l.loop,status:"ready"}}),"cover_image"===r&&(g=x.a.createElement("img",{className:"height-maker",src:s})),x.a.createElement("div",{className:"inner-wrapper",onClick:this.handleClick},x.a.createElement("div",{id:"coverImage",className:"cover purple "+(s?"img-filled":"")},x.a.createElement("div",{className:"cover-image-thumbnail",style:v,title:"Cover image"},x.a.createElement("a",{className:"remove",onClick:this.handleCoverImageRemove,title:"Remove cover image"})),x.a.createElement("div",{className:"add ".concat("loading"!==r&&s?"img-filled":"blank"," ").concat(n?"loading":""),style:c},"cover_video"===r&&[x.a.createElement("span",{key:"video-autoplay",className:"video-autoplay",onClick:function(e){e.stopPropagation()}},x.a.createElement("input",{type:"checkbox",className:"video-autoplay-value",id:"video-autoplay-value",defaultChecked:"checked",checked:h,onChange:this.handleAutoplayChange}),V),x.a.createElement("span",{key:"video-loop",className:"video-loop",onClick:function(e){e.stopPropagation()}},x.a.createElement("input",{type:"checkbox",className:"video-loop-value",id:"video-loop-value",defaultChecked:"checked",checked:p,onChange:this.handleLoopChange}),K),x.a.createElement("span",{key:"video-time",className:"time"},m)],f&&x.a.createElement(A.Video,{object:f,display:!0,autoplay:!1,allow:{showInfoAlways:!0},onPause:function(){t.setState({videoPlaying:!1})},onPlay:function(){t.setState({videoPlaying:!0})}}),i===z&&G,g,x.a.createElement("i",{className:"loader",style:{backgroundPosition:d}}),x.a.createElement("small",{className:"add_option_tools",style:T.Display.NoneIf(o||i===z)},x.a.createElement("a",{onClick:this.handleInsertCoverImage},window.isWhitelabelV2?"Upload article image":"Insert Cover Image"),x.a.createElement("a",{onClick:this.handleInsertCoverVideo},window.isWhitelabelV2?"Upload article video":"Insert Cover Video"),x.a.createElement("input",{type:"file",id:"cover-image",ref:function(e){t.imageUploadInput=e},onChange:this.handleImageUpload,style:T.Display.None,accept:"image/*"}),x.a.createElement("input",{type:"file",id:"cover-video",ref:function(e){t.videoUploadInput=e},onChange:this.handleVideoUpload,style:T.Display.None,accept:"video/*"}))),""!==s&&x.a.createElement("a",{className:"remove",onClick:this.handleRemove})))}}]),o}(),Y=n(9),Q=n.n(Y),Z=n(17),J=n.n(Z),ee=n(18),te=n.n(ee);function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ae(e,t,n){return t&&oe(e.prototype,t),n&&oe(e,n),e}function re(e,t){return!t||"object"!==ne(t)&&"function"!=typeof t?le(e):t}function se(e){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function le(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ce(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ue(e,t)}function ue(e,t){return(ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function de(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var he=function(e){function a(){var e,t;ie(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return de(le(t=re(this,(e=se(a)).call.apply(e,[this].concat(i)))),"handleAuthorChange",function(e){t.props.setArticleProp("authors",e.target.value)}),de(le(t),"handleTitleChange",function(e){t.props.setArticleProp("title",e.target.value)}),de(le(t),"handleTaglineChange",function(e){t.props.setArticleProp("tagline",e.target.value)}),t}return ce(a,x.a.Component),ae(a,[{key:"componentDidMount",value:function(){Q()(this.ta1),Q()(this.ta2)}},{key:"render",value:function(){var t=this,e=this.props,n=e.actionButtonText,i=e.actionButtonLink,o=e.authors,a=e.setArticleProp,r=e.title,s=e.tagline,l=e.dateCreated,c=e.saveCount;return x.a.createElement("div",{className:"info"},x.a.createElement("h2",{className:"title"},x.a.createElement("b",null,x.a.createElement("textarea",{ref:function(e){t.ta1=e},type:"text",placeholder:"Article Title",onChange:this.handleTitleChange,value:r})),x.a.createElement("small",null,x.a.createElement("textarea",{ref:function(e){t.ta2=e},type:"text",placeholder:"Article Tagline",onChange:this.handleTaglineChange,value:s}))),window.isWhitelabelV2?x.a.createElement(te.a,{className:"author",onChange:this.handleAuthorChange,html:o,placeholder:"Type Author"}):x.a.createElement("input",{className:"author-input author",type:"text",placeholder:"TYPE AUTHOR / PHOTOGRAPHER",onChange:this.handleAuthorChange,value:o}),window.isWhitelabelV2&&x.a.createElement("div",{className:"date text-placeholder"},J()(l||new Date,"MMMM DD, YYYY")),x.a.createElement(me,{setArticleProp:a,actionButtonText:n,actionButtonLink:i,saveCount:c}))}}]),a}(),pe=x.a.createElement("span",null,x.a.createElement("i",null)),me=function(e){function a(){var e,t;ie(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return de(le(t=re(this,(e=se(a)).call.apply(e,[this].concat(i)))),"state",{edit:!1}),de(le(t),"handleEdit",function(e){e.target===e.currentTarget&&t.setState({edit:!t.state.edit})}),de(le(t),"handleActionButtonKeyDown",function(e){e.keyCode===E.KEYS.ENTER&&t.setState({edit:!t.state.edit})}),de(le(t),"handleButtonTextChange",function(e){t.props.setArticleProp("actionButtonText",e.target.value)}),de(le(t),"handleButtonURLChange",function(e){t.props.setArticleProp("actionButtonLink",e.target.value)}),de(le(t),"closePopup",function(){t.setState({edit:!1})}),t}return ce(a,x.a.Component),ae(a,[{key:"componentDidMount",value:function(){this.clickOutside=new E.ClickOutside({component:this,popupElementRefKey:"ActionButtonEl"})}},{key:"componentWillUnmount",value:function(){this.clickOutside.destroy()}},{key:"componentDidUpdate",value:function(){this.state.edit&&this.clickOutside.handleAttach(this.closePopup)}},{key:"render",value:function(){var t=this,e=this.state.edit,n=this.props,i=n.actionButtonText,o=n.actionButtonLink,a=n.saveCount,r=x.a.createElement("span",{className:"btn-shop",onClick:this.handleEdit,ref:function(e){t.ActionButtonEl=e}},i||(window.isWhitelabelV2?"Click to set action":"Article Button"),x.a.createElement("small",{className:"button_option",style:T.Display.NoneIf(!e)},x.a.createElement("input",{type:"text",placeholder:"Button Text",onChange:this.handleButtonTextChange,value:i,onKeyDown:this.handleActionButtonKeyDown}),x.a.createElement("input",{type:"text",placeholder:"Button URL",onChange:this.handleButtonURLChange,value:o,onKeyDown:this.handleActionButtonKeyDown})));return window.isWhitelabelV2?x.a.createElement("div",{className:"interaction"},x.a.createElement("ul",{className:"share"},x.a.createElement("li",null,x.a.createElement("a",{className:"fb",onClick:function(e){return e.preventDefault()}})),x.a.createElement("li",null,x.a.createElement("a",{className:"tw",onClick:function(e){return e.preventDefault()}})),x.a.createElement("li",null,x.a.createElement("a",{className:"email",onClick:function(e){return e.preventDefault()}})),x.a.createElement("li",null,x.a.createElement("a",{className:"link",onClick:function(e){return e.preventDefault()}}))),r,x.a.createElement("div",{className:"like"},x.a.createElement("a",{className:"button button-static fancy _count"},pe,a||"0"))):r}}]),a}(),fe=n(19);function ge(e){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t){return!t||"object"!==ge(t)&&"function"!=typeof t?ye(e):t}function be(e){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ye(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function we(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ce(e,t)}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ee(){return(Ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function xe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ke(e,t,n){return t&&_e(e.prototype,t),n&&_e(e,n),e}function Te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}window.onerror=function(e,t,n,i,o){alert("".concat(e," - line:").concat(n," col:").concat(i," error:").concat(o))};var Se={};window.Galleries=Se;var Ae=function(){function r(e){xe(this,r),Te(this,"container",null),Te(this,"$container",null),Te(this,"instance",null),Te(this,"id",null),Te(this,"data",{images:[],title:"",tagline:""}),e&&(this.data=e),this.id=(""+Math.random()).substr(2,10);var t=$('<div class="gallery-container" style="display:none;" data-id="'.concat(this.id,'"/>'));$(".gallery-container-pool").append(t),this.$container=t,this.container=this.$container[0]}return ke(r,[{key:"render",value:function(e){var t=this,n=s.a.render(x.a.createElement(De,Ee({},this.data,{control:this})),this.container,function(){t.instance=this,Se[t.id]={instance:this,control:t},e.apply(void 0,arguments)});t.instance=n}},{key:"processGallery",value:function(){var e=$(this.container).closest(".description.more > div");e.attr("contenteditable","false").addClass("gallery-container-wrapper"),e.find("br").remove()}},{key:"setData",value:function(e,t){e?this.instance.setState(e,t):t()}},{key:"getDOM",value:function(){if(this.instance)return s.a.findDOMNode(this.instance)}},{key:"setState",value:function(e){this.instance&&this.instance.setState(e)}},{key:"revert",value:function(){this.container&&($(this.container).hide(),$(this.container).insertAfter($("#article-container")),window.EditorControl.refresh(),$(".add_option_tools .gallery-insert-action").css("display","block"))}}],[{key:"renderTo",value:function(e,t,i){var o=new r(t),n=$(e),a="shortcode-".concat(o.id);return n.attr("id",a),o.render(function(){var n=$(o.container);o.setData(t,function(e){$("#".concat(a)).replaceWith(n),o.processGallery(),n.show(),i&&i(o);var t=document.getSelection().anchorNode;$(t).closest("p").click()}),window.isWhitelabelV2||$(".add_option_tools .gallery-insert-action").hide()}),o}},{key:"uploadImages",value:function(t){var n=$("#image-fileupload");0===n.length&&(n=$('<input id="image-fileupload" type="file" multiple style="opacity:0.01;" />'),$(document.body).append(n)),n.one("change",function(){console.log("change");var e=[].slice.call(n.get(0).files);Promise.all(e.map(function(i){return new Promise(function(t,e){var n=new FormData;n.append("file",i),$.ajax({url:"/_admin/image-upload-add.json",processData:!1,contentType:!1,type:"POST",data:n}).done(function(e){console.log("done"),t(e)}).fail(function(e){alert("[Gallery] : addimage fail",e.responseText),t()})})})).then(function(e){t(e)}).catch(function(e){console.log("failure",e),t(!1)})}),n.one("click",function(){$(this).val(null)}),n.click()}}]),r}(),Pe=x.a.createElement("li",null,x.a.createElement("div",{className:"placeholder"})),De=function(e){function n(e){var r;xe(this,n),Te(ye(r=ve(this,be(n).call(this,e))),"state",{draggingIndex:null,loaderPx:null,paging:0,images:[]}),Te(ye(r),"handleTitleChange",function(e){r.setState({title:e.target.value})}),Te(ye(r),"handleTaglineChange",function(e){r.setState({tagline:e.target.value})}),Te(ye(r),"loading",!1),Te(ye(r),"handleAddImage",function(e){var t=[].slice.call(e.target.files);0<t.length&&r.toggleLoading(!0,function(){Promise.all(t.map(function(i){return new Promise(function(t,n){var e=new FormData;e.append("file",i),$.ajax({url:"/_admin/image-upload-add.json",processData:!1,contentType:!1,type:"POST",data:e,xhr:this.createXhr}).done(function(e){t(e)}).fail(function(e){alert("[Gallery] : addimage fail",e.responseText),n()})})})).then(function(e){r.addImages(e),r.toggleLoading(!1),r.toggleAdding(!1)}).catch(function(){r.toggleLoading(!1),r.toggleAdding(!1)})})}),Te(ye(r),"baseLoaderPx",-132),Te(ye(r),"handleProgress",function(e,t){var n=r.baseLoaderPx+-r.baseLoaderPx*e/t;r.setState({loaderPx:n})}),Te(ye(r),"reset",null),Te(ye(r),"resetLoader",function(){r.reset||(r.reset=setTimeout(function(e){r.setState({loaderPx:0},function(e){r.setState({adding:!1},function(){r.setState({loaderPx:null}),r.reset=null})})},300))}),Te(ye(r),"createXhr",function(){var e=new XMLHttpRequest;return e.upload.addEventListener("load",r.resetLoader),e.upload.addEventListener("error",r.resetLoader),e.upload.addEventListener("abort",r.resetLoader),e.upload.addEventListener("progress",function(e){r.handleProgress(e.loaded,e.total)},!1),e}),Te(ye(r),"handleAddImageClick",function(e){r.adding?(e.preventDefault(),e.stopPropagation()):r.toggleAdding(!0)}),Te(ye(r),"handleAddImageFocus",function(){r.adding&&!r.loading&&r.toggleAdding(!1)}),Te(ye(r),"handlePagingClick",function(e){var t=e.currentTarget.getAttribute("data-idx");r.setState({paging:Number(t)});var n=$(e.target);if(n.is(".gallery .paging a")){e.preventDefault();var i=n.closest(".gallery"),o=n.index(),a=0;a=0==o?0:o==i.find("li").length-1?i.width()-i.find(".photo-list").width():(i.width()-i.find("li:eq("+o+")").width())/2-i.find("li:eq("+o+")").position().left,i.find(".photo-list").css("left",a+"px")}}),Te(ye(r),"handleCaptionChange",function(e,t){var n=r.state.images.map(function(e){return e});n[e].caption=t,r.setState({images:n})}),Te(ye(r),"handlePagingPrevNextClick",function(e){var t;if(0!==r.state.images.length){var n=e.currentTarget.className;"prev"===n?(t=Math.max(r.state.paging-1,0),r.state.paging===t&&(t=r.state.images.length-1)):"next"===n&&(t=Math.min(r.state.paging+1,r.state.images.length-1),r.state.paging===t&&(t=0));var i=$(r.galleryEl).find(".paging a.pager").eq(t).get(0);Object(E.triggerEvent)(i,"click")}}),Te(ye(r),"handleImageRemoval",function(e){var t=r.state,n=t.paging,i=t.images.map(function(e){return e});!function(e,t,n){e.splice(n,0,e.splice(t,1)[0])}(i,e,i.length-1),i.pop();var o={images:i};n<e||e<=n&&(0===n&&0===e&&(window.isWhitelabelV2||$(r.photoList).css("left",0)),o.paging=Math.max(n-1,0)),window.isWhitelabelV2&&0===i.length&&r.control.revert(),r.setState(o)}),Te(ye(r),"handleImagePagingChange",function(e){var t=$(r.galleryEl).find(".paging a").eq(e).get(0);Object(E.triggerEvent)(t,"click")}),Te(ye(r),"handleImageLinkChange",function(e,t){var n=r.state.images.map(function(e){return e});n[e].link=t,r.setState({images:n})}),Te(ye(r),"updateState",function(e){r.setState(e)}),Te(ye(r),"handleAddImageClick2",function(){window.GalleryControl.uploadImages(function(e){e&&r.addImages(e)})}),Te(ye(r),"handleMouseOverGallery",function(){window.isWhitelabelV2&&r.setState({showToolbar:!0})}),Te(ye(r),"handleMouseOutGallery",function(){window.isWhitelabelV2&&r.setState({showToolbar:!1})}),Te(ye(r),"handleRemoveSlideshow",function(){r.control.revert()}),Te(ye(r),"handleOrganizeImages",function(){var e=r.state.images.map(function(e){return{url:e.src,id:e.uiid,caption:e.caption||""}});organizeImageService.open(e,function(e){r.setState({images:e.map(function(e){return{src:e.url,uiid:e.id,caption:e.caption}})})})});var t=e.control;return r.control=t,r}return we(n,x.a.Component),ke(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.images,n=e.title,i=e.tagline;this.setState({images:t||[],title:n||"",tagline:i||""})}},{key:"handleRemove",value:function(e){this.control.revert()}},{key:"serialize",value:function(){var e=this.state;return{name:"fancy-article-gallery",images:e.images,title:e.title,tagline:e.tagline}}},{key:"toggleAdding",value:function(e){this.adding=e,this.setState({adding:e})}},{key:"toggleLoading",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(e){return e};this.loading=e,this.setState({loading:e},t)}},{key:"addImages",value:function(e){var a=this.state.images.map(function(e){return e});e.forEach(function(e){var t=e.image_url,n=e.id,i=e.width,o=e.height;null==i||null==o?alert("[warning] ".concat(n,": There is possibility that the image is not uploaded correctly, or uploaded one is not an image.")):a.push({uiid:n,src:t,caption:""})}),this.setState({images:a})}},{key:"getPaging",value:function(){var e=this.state.images;return e?_.range(0,e.length):[0]}},{key:"render",value:function(){var n=this,e=this.state,t=e.adding,i=e.paging,o=e.images,a=e.title,r=e.tagline,s=e.draggingIndex,l=e.loading,c=e.showToolbar,u=null!=this.state.loaderPx?"".concat(this.state.loaderPx,"px"):null;return x.a.createElement("div",{className:"gallery",ref:function(e){n.galleryEl=e},onMouseOver:this.handleMouseOverGallery,onMouseOut:this.handleMouseOutGallery},x.a.createElement("h3",null,x.a.createElement("input",{type:"text",placeholder:"Type a Slideshow Title",onChange:this.handleTitleChange,value:a}),!window.isWhitelabelV2&&x.a.createElement("small",{className:"tagline"},x.a.createElement("input",{type:"text",placeholder:"Type a gallery tagline",onChange:this.handleTaglineChange,value:r}))),x.a.createElement("ul",{className:"photo-list",ref:function(e){n.photoList=e}},o.map(function(e,t){return x.a.createElement(Ie,{key:t,items:o,draggingIndex:s,onSortItems:n.updateState,sortId:t,outline:"list",childProps:{image:e,idx:t,selected:i===t,onCaptionChange:n.handleCaptionChange,onImageRemoval:n.handleImageRemoval,onImagePagingChange:n.handleImagePagingChange,onImageLinkChange:n.handleImageLinkChange}})}),x.a.createElement("li",null,x.a.createElement("div",{className:k()("add",{adding:t})},x.a.createElement("i",{className:"loader",style:{backgroundPosition:u,display:t||l?"inline-block":"none"}}),x.a.createElement("input",{type:"file",ref:function(e){n.fileInput=e},onChange:this.handleAddImage,onClick:this.handleAddImageClick,onFocus:this.handleAddImageFocus,multiple:!0}))),Pe),x.a.createElement("div",{className:"paging",style:{visibility:1<o.length?"visible":"hidden"}},window.isWhitelabelV2&&x.a.createElement("div",{className:"btn"},x.a.createElement("a",{className:"prev",onClick:this.handlePagingPrevNextClick}),x.a.createElement("a",{className:"next",onClick:this.handlePagingPrevNextClick})),this.getPaging().map(function(e,t){return x.a.createElement("a",{className:k()("pager",{current:t===i}),"data-idx":t,key:t,onClick:n.handlePagingClick},t+1)})),!window.isWhitelabelV2&&x.a.createElement("a",{className:"remove",onClick:this.handleRemove},"Remove"),window.isWhitelabelV2&&x.a.createElement("small",{className:"add_option_tools",style:{display:c?"block":"none"}},x.a.createElement("a",{onClick:this.handleAddImageClick2},"Add images"),x.a.createElement("a",{onClick:this.handleOrganizeImages},"Organize images"),x.a.createElement("a",{onClick:this.handleRemoveSlideshow},"Remove Slideshow")))}}]),n}(),Ne=function(e){function a(){var e,o;xe(this,a);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return Te(ye(o=ve(this,(e=be(a)).call.apply(e,[this].concat(n)))),"handleCaptionChange",function(e){var t=e.target,n=o.props.childProps,i=n.idx;(0,n.onCaptionChange)(i,t.value)}),Te(ye(o),"handleImageRemoval",function(e){e.preventDefault(),e.stopPropagation();var t=o.props.childProps,n=t.idx;(0,t.onImageRemoval)(n)}),Te(ye(o),"handlePagingClick",function(){if(!window.isWhitelabelV2){var e=o.props.childProps,t=e.idx;(0,e.onImagePagingChange)(t)}}),Te(ye(o),"handleImageLinkChange",function(e){var t=e.target,n=o.props.childProps,i=n.idx;(0,n.onImageLinkChange)(i,t.value)}),o}return we(a,x.a.Component),ke(a,[{key:"componentDidMount",value:function(){window.isWhitelabelV2&&Q()(this.ta1)}},{key:"render",value:function(){var t=this,e=this.props.childProps,n=e.image,i=e.selected,o=x.a.createElement("img",{src:n.src,alt:n.caption,onClick:this.handlePagingClick});return x.a.createElement("li",Ee({},this.props,{"data-uiid":n.uiid,className:i?"active":null}),x.a.createElement("a",null,window.isWhitelabelV2?x.a.createElement("span",{className:"figure"},o):o,x.a.createElement("span",{className:"caption"},window.isWhitelabelV2?x.a.createElement("textarea",{type:"text",placeholder:"Type an image caption",value:n.caption,onChange:this.handleCaptionChange,ref:function(e){t.ta1=e}}):x.a.createElement("input",{type:"text",placeholder:"Type an image caption",value:n.caption,onChange:this.handleCaptionChange})),x.a.createElement("span",{className:"link"},x.a.createElement("input",{type:"text",placeholder:"Type an image link",value:n.link,onChange:this.handleImageLinkChange}))),x.a.createElement("a",{className:"remove",onClick:this.handleImageRemoval},"Remove"))}}]),a}(),Ie=Object(fe.sortable)(Ne),Oe=function(){function t(){var e=this;xe(this,t),Te(this,"data",null),Te(this,"callback",null),$(document).ready(function(){$.dialog("organize_image").$obj.on("click",".btn-cancel",function(){e.cancel()}).on("click",".btn-save",function(){e.complete()})})}return ke(t,[{key:"open",value:function(e,t){this.callback=t,this.data=e;var n=_.template($("#popup-org-img-each").html().trim()),i=$.dialog("organize_image"),o=i.$obj.find("ol");o.empty(),this.data.forEach(function(e){var t=$(n(e));t.data("img",e),o.append(t)}),Sortable.create(i.$obj.find("ol").get(0),{filter:".remove",onFilter:function(e){var t=e.item,n=e.target;Sortable.utils.is(n,".remove")&&$(t).remove()}}),i.open()}},{key:"cancel",value:function(){$.dialog("organize_image").close(),this.clean()}},{key:"complete",value:function(){(0,this.callback)(this.serialize()),$.dialog("organize_image").close(),this.clean()}},{key:"serialize",value:function(){return $.dialog("organize_image").$obj.find("ol li").map(function(e,t){return $(t).data("img")}).toArray()}},{key:"clean",value:function(){this.data=null,this.callback=null}}]),t}();function Le(e){return(Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Me(e){return(Me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Re(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function je(e,t){return(je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Be(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}window.organizeImageService=new Oe;function $e(e){return Ue}var He=x.a.createElement("span",{className:"back"}),ze=function(e){function a(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Be(Re(n=function(e,t){return!t||"object"!==Le(t)&&"function"!=typeof t?Re(e):t}(this,(e=Me(a)).call.apply(e,[this].concat(i)))),"state",{thing:null}),Be(Re(n),"handleRemove",function(){var e=n.props.tid,t=$('.popup.add_thing_item dd li[data-tid="'.concat(e,'"].selected'));t.removeClass("selected"),t.find("input").prop("checked",!1),n.props.onRemove(e)}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&je(e,t)}(a,x.a.Component),function(e,t,n){t&&Fe(e.prototype,t),n&&Fe(e,n)}(a,[{key:"componentDidMount",value:function(){var t=this;$.get("/rest-api/v1/things/".concat(this.props.tid).concat(window.isWhitelabel?"?sales=true":"")).then(function(e){t.setState({thing:e})})}},{key:"getURL",value:function(){var e=this.state.thing;if(window.isWhitelabel&&e.sales)return"".concat(encodeURI(e.name),"/p/").concat(e.sales.id);var t=this.state.thing;return"/things/".concat(t.id)}},{key:"render",value:function(){var e=this.state.thing;return this.state.thing?x.a.createElement("li",null,x.a.createElement("button",{className:"remove",onClick:this.handleRemove}),x.a.createElement("div",{className:"figure-item"},x.a.createElement("figure",null,x.a.createElement("a",{href:this.getURL()},He,x.a.createElement("span",{className:"figure grid",style:{backgroundImage:"url('".concat(e.image.src,"')")}}))),x.a.createElement("figcaption",null,x.a.createElement("a",{href:this.getURL(),className:"title"},e.name),e.sales&&x.a.createElement("em",{className:"figure-detail"},x.a.createElement("span",{className:"price "},"$",e.sales.price," "))))):null}}]),a}(),Ue=x.a.createElement("li",null,x.a.createElement("div",{className:"figure-item placeholder"}));function We(e){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ve(e){return(Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ke(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ge(e,t){return(Ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ye,Qe=x.a.createElement("label",null,"Code View"),Ze=x.a.createElement("label",null,"Featured"),Je=x.a.createElement("label",null,"Live"),et=function(e){function a(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return Xe(Ke(t=function(e,t){return!t||"object"!==We(t)&&"function"!=typeof t?Ke(e):t}(this,(e=Ve(a)).call.apply(e,[this].concat(i)))),"state",{showFeatured:!1}),Xe(Ke(t),"handleSetFeatured",function(e){t.props.setArticleProp("featured",!t.props.featured)}),Xe(Ke(t),"handleSetLive",function(e){t.props.setArticleProp("is_active",!t.props.is_active)}),Xe(Ke(t),"handleToggleCodeview",function(e){$(".description.more .medium-insert-buttons").remove(),window.EditorControl.refresh(),t.props.setArticleProp("codeview",!t.props.codeview)}),Xe(Ke(t),"handlePublishedDatetimeChange",function(e){t.props.setArticleProp("published_datetime",e.target.value)}),Xe(Ke(t),"handlePublishedDatetimeChangeEnd",function(e){t.props.setArticleProp("published_datetime",$.trim(e.target.value))}),Xe(Ke(t),"handleSlugChange",function(e){t.props.setArticleProp("slug",$.trim(e.target.value))}),Xe(Ke(t),"handleFeaturedMouseOver",function(e){t.over=!0,t.state.showFeatured||(console.debug("showFeatured true"),t.setState({showFeatured:!0}))}),Xe(Ke(t),"showFeaturedTimer",null),Xe(Ke(t),"handleFeaturedMouseOut",function(e){t.over=!1,t.state.showFeatured&&null==t.showFeaturedTimer&&(console.debug("showFeatured false"),t.showFeaturedTimer=setTimeout(function(){t.over?t.showFeaturedTimer=null:t.setState({showFeatured:!1},function(){t.showFeaturedTimer=null})},500))}),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ge(e,t)}(a,x.a.Component),function(e,t,n){t&&qe(e.prototype,t),n&&qe(e,n)}(a,[{key:"render",value:function(){var e=this.props,t=e.codeview,n=e.featured,i=e.is_active,o=e.published_datetime;return x.a.createElement("div",{className:"status"},x.a.createElement("p",{className:"url"},x.a.createElement("span",null,window.appRootUrl||"https://fancy.com","/articles/"),x.a.createElement("input",{type:"text",className:"text",placeholder:"article-title",onChange:this.handleSlugChange,value:this.props.slug})),x.a.createElement("ul",null,x.a.createElement("li",null,Qe," ",x.a.createElement("button",{onClick:this.handleToggleCodeview,className:k()("btn-switch",{on:t})},"ON/OFF")),x.a.createElement("li",{className:k()("nested",{"show-featured":this.state.showFeatured}),onMouseOver:this.handleFeaturedMouseOver,onMouseOut:this.handleFeaturedMouseOut},x.a.createElement("div",{className:"featured-control has-arrow",style:T.Display.NoneIf(!n)},x.a.createElement("input",{type:"text",className:"text",value:o,onChange:this.handlePublishedDatetimeChange,onBlur:this.handlePublishedDatetimeChangeEnd})),Ze," ",x.a.createElement("button",{onClick:this.handleSetFeatured,className:k()("btn-switch",{on:n})},"ON/OFF")),x.a.createElement("li",null,Je," ",x.a.createElement("button",{onClick:this.handleSetLive,className:k()("btn-switch",{on:i})},"ON/OFF"))))}}]),a}();function tt(e){if(Ye){if(!e)return Ye;e&&e(Ye)}else console.warn("articleAdmin is not ready")}window.reactBridge=tt;var nt=!1,it=null,ot=_.debounce(function(e,t){(t||!1===nt&&this.scrollHeight-this.scrollTop-10<=this.clientHeight&&null!=it)&&(nt=!0,$.get("/_admin/articles/featured.json?limit=150&cursor="+(it||""),function(e){e.stream&&(function(e){var n=$(".add_thing_item .featured ul");_.each(e,function(e){var t=$('<li><input type="checkbox" /><label></label><img src="/_ui/images/common/blank.gif"></li>');t.attr("data-tid",e.object.id_str),e.object.sales&&e.object.sales[0]&&t.attr("data-sid",e.object.sales[0].sale_id),t.find("img").css("background-image","url("+e.object.thumb_image_url+")"),n.append(t)})}(e.stream),it=e.next_cursor||null),nt=!1}))},250);var at,rt=n(20);function st(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lt(e){return'<p class="shortcode" data-internal=\''.concat(e,"'></p>")}var ct="Normal",ut="Quoted",dt="Grid",ht={Full:"mode-full",Normal:"mode-normal",Quoted:"mode-quoted",Grid:"mode-grid"},pt={FancyArticleProductSlideshow:_.template('<div class="itemSlide product" contenteditable="false">\n            <div class="itemSlideWrap">\n                <ul class="stream after">\n                <% items.forEach(function(item, idx) { %>\n                <li class="itemSlideElement" data-id="<%= item.id %>" data-idx="<%= idx %>">\n                    <div class="figure-item">\n                    <figure <% if (item.image_fit_to_bounds) { %>class="fit"<% } %>>\n                        <a href="<% if (item.html_url) { %><%= item.html_url %><% } else { %>/sales/<%= item.id %>?utm=article<% } %>"><span\n                            class="back"></span><img class="figure" src="/_ui/images/common/blank.gif" style="background-image: url(<%= item.image %>);"></a>\n                    </figure>\n                    <figcaption>\n                        <span class="show_cart">\n                        <button class="btn-cart nopopup soldout">\n                            <% if (item.retail_price != null) { %><b class="price sales">$<%= item.price %> <small class="before">$<%= item.retail_price %></small></b><% } else { %><b class="price">$<%= item.price %></b><% } %>\n                        </button>\n                        </span><a href="<% if (item.html_url) { %><%= item.html_url %><% } else { %>/sales/<%= item.id %>?utm=article<% } %>" class="title"><%= item.title %></a>\n                    </figcaption>\n                    <a class="delete"></a>\n                    </div>\n                </li>\n                <% }); %>\n                </ul>\n            </div>\n            <a href="#" class="prev">Prev</a>\n            <a href="#" class="next">Next</a>\n            <small class="add_option_tools" style="display:none;">\n                <a class="add-product">Organize Products</a>\n                <a class="delete-slideshow">Delete Slideshow</a>\n            </small>\n        </div>'),FancyArticleProductCard:_.template('<ul class="itemList product" contenteditable="false">\n            <% items.forEach(function(item, idx) { %>\n            <li class="itemListElement" data-id="<%= item.id %>" data-idx="<%= idx %>">\n                <span class="figure <% if (item.image_fit_to_bounds) { %>fit<% } %>">\n                    <img src="/_ui/images/common/blank.gif" style="background-image:url(<%= item.image %>)">\n                </span>\n                <span class="figcaption">\n                    <span class="title"><%= item.title %></span>\n                    <% if (item.retail_price != null) { %><b class="price sales">$<%= item.price %> <small class="before">$<%= item.retail_price %></small></b><% } else { %><b class="price">$<%= item.price %></b><% } %>\n                </span>\n                <a class="remove">Remove</a>\n            </li>\n            <% }); %>\n            <small class="add_option_tools" style="display:none;">\n                <a class="add-product">Organize Products</a>\n                <a class="delete-slideshow">Delete Grid</a>\n            </small>\n        </ul>')};function mt(e){var t="shortcode-"+String(Math.random()).substr(2);return e.attr("id",t),function(){return $("#"+t)}}function ft(e,n){0<e.length?Object(E.jQueryPromiseAll)(e.filter(function(e){return e}).map(function(t){var n=$.Deferred();return $.get("/rest-api/v1/things/"+t+"?sales=true&include_every_image=true").then(function(e){n.resolve(e)}).fail(function(e){404===e.status?alertify.alert("Product id "+t+"not found."):console.warn("There was an error whiel fetching sid:",t,e),n.resolve(null)}),n.promise()})).done(function(e){var t={items:e.map(function(e){var t=!1,n=e.image.src;try{t=e.sales.images[0].fit_to_bounds,n=e.sales.images[0].src}catch(e){}return e.sales&&{title:e.sales.emojified_name,price:e.sales.price,retail_price:e.sales.retail_price,image:n,image_fit_to_bounds:t,id:e.sales.id}}).filter(function(e){return e})};n(t)}):console.warn("[ShortCodeTransformers]: Error - product does not exist")}var gt=(st(at={},"fancy-article-gallery",function(e,t){var n=e.images,i=e.title,o=e.tagline;window.GalleryControl.renderTo(t,{images:n,title:i,tagline:o})}),st(at,"fancy-article-img",function(e,t){var n,i=e.images;if(0<i.length){var o='<div class="medium-insert-images" contenteditable="false">';i[0].mode===dt?(o+='<figure data-mode="'.concat(dt,'">'),i.forEach(function(e){o+='<div class="grid">\n                        <img src="'.concat(window.blankUrl,'" style="background-image:url(\'').concat(e.src,'\')" data-src="').concat(e.src,'" />\n                        <a href="#" class="remove">Remove</a>'),e.caption?o+='<figcaption class="text-placeholder" data-placeholder="Type an image caption">'.concat(e.caption,'</figcaption><a href="#" class="btn-caption">Edit Caption</a>'):o+='<a href="#" class="btn-caption">Add Caption</a>',o+="</div>"}),o+="</figure>",n=$(o)):(i.forEach(function(e){var t;t='<figure data-mode="'.concat(ct,'"><img src="').concat(e.src,'" alt="" class="" />'),e.caption&&(t+="<figcaption>".concat(e.caption,"</figcaption>")),t+="</figure>";var n=$(t);e.mode!==ct&&window.ReactMediumEditor__changeMode&&window.ReactMediumEditor__changeMode(n,ct,e.mode),o+=n.prop("outerHTML")}),o+="</div>",(n=$(o)).addClass("medium-insert-images-".concat(ht[i[0].mode])))}else console.warn("[ShortCodeTransformers]: Error - images not exist");t.replaceWith(n)}),st(at,"fancy-article-product",function(e,t){var n=e.products,i=mt(t);ft(n,function(e){var t=pt.FancyArticleProductCard(e);i().replaceWith(t)})}),st(at,"fancy-article-product-slideshow",function(e,t){var n=e.products,i=mt(t);ft(n,function(e){var t=pt.FancyArticleProductSlideshow(e);i().replaceWith(t)})}),at);function vt(i){return function(e){var t=function(e){return $('<div class="singlenode-wrapper">'.concat(e,"</div>"))}(e),n=Object(rt.mountToDisposable)(t);return i(t),n.remove(),t.html()}}function bt(e){return e.replace(/'/g,"&apos;")}var yt={transformFancyArticleImage:function(e){e.find(".medium-insert-images").each(function(e,t){var a=[],n=$(t),i=n.find("figure");if(i.attr("data-mode")===dt?i.find(".grid").each(function(e,t){var n=$(t),i={mode:dt,src:n.find("img").attr("data-src")},o=n.find("figcaption").text();o&&(i.caption=o.replace(/'/g,"&#39;")),a.push(i)}):i.each(function(e,t){var n=$(t),i={mode:n.attr("data-mode")||ct,src:n.find("img").attr("src")},o=i.mode===ut?n.find(".textarea").text():n.find("figcaption").text();o&&(i.caption=o.replace(/'/g,"&#39;")),a.push(i)}),0<a.length){var o=JSON.stringify({name:"fancy-article-img",images:a});n.replaceWith(lt(o))}})},transformFancyArticleGallery:function(e){var t=e.find(".gallery-container");0<t.length&&t.each(function(e,t){var n=$(t),i=Galleries[n.data("id")];if(i){var o=i.instance.serialize();o.title=bt(o.title),o.tagline=bt(o.tagline),0<o.images.length&&o.images.forEach(function(e){e.caption=bt(e.caption)});var a=JSON.stringify(o);n.replaceWith(lt(a))}})},transformFancyArticleProduct:function(e){e.find(".itemList").each(function(e,t){var n=[],i=$(t);i.find(".itemListElement").each(function(e,t){n.push($(t).attr("data-id"))});var o=JSON.stringify({name:"fancy-article-product",products:n});i.replaceWith(lt(o))})},transformFancyArticleProductSlideshow:function(e){e.find(".itemSlide").each(function(e,t){var n=[],i=$(t);i.find(".itemSlideElement").each(function(e,t){n.push($(t).attr("data-id"))});var o=JSON.stringify({name:"fancy-article-product-slideshow",products:n});i.replaceWith(lt(o))})},cleanupContent:function(e){e.children().filter(function(e,t){if("DIV"===t.tagName&&""===t.className&&""===$(t).text().trim())return!0}).remove();var t=e.children().first();null==t.attr("class")&&""===t.text().trim()&&t.remove()}};function wt(e){try{!function(e){$(e).find("p.shortcode").each(function(e,t){var n=$(t);try{var i=JSON.parse(n.attr("data-internal"));gt[i.name](i,n)}catch(e){console.warn(e)}})}(e)}catch(e){console.warn(e)}}function Ct(){$(function(){function t(e,t){var c;(c=e.is(".itemSlide, .slideshow")?e:e.find(".itemSlide, .slideshow")).data("slideInit",!0);var u=e.find("ul"),n=u.find("li"),i=n.width()+20,o=(parseInt(u.css("padding-left")),e.find("a.prev")),a=e.find("a.next"),d=null;function r(e){!function(){var e=u.find("li"),t=Math.abs(parseInt(u.css("left"))),n=c.width(),i=e.width()+20;d&&(n=d);if(t<n){for(var o=Math.ceil(Math.abs(n-t)/i),a=0;a<o;a++){var r=u.find("li:not([_prev])").last();r.clone().insertBefore(u.find("li").first()),r.attr("_prev",!0)}u.css("left",0-t-o*i+"px")}}();var t=Math.abs(parseInt(u.css("left"))),n=c.width();return d&&(n=d),t-n}function s(e){!function(){var e=u.find("li"),t=Math.abs(parseInt(u.css("left"))),n=c.width(),i=e.length*(e.width()+20),o=e.width()+20,a=i-(t+n);d&&(n=d);if(a-n<n)for(var r=Math.ceil(Math.abs(n-(i-(t+n)))/o),s=0;s<r;s++){var l=u.find("li:not([_next])").first();l.clone().insertAfter(u.find("li").last()),l.attr("_next",!0)}}();var t=Math.abs(parseInt(u.css("left"))),n=c.width();return d&&(n=d),t+n}function l(){var e=u.find("li"),t=Math.abs(parseInt(u.css("left"))),n=e.width()+20,i=u.find("li[_next]:not(:in-viewport)"),o=i.length;u.find("li[_prev]:not(:in-viewport)").remove(),i.remove(),u.css("left",0-t+o*n+"px")}t.itemPerSlide&&(d=i*t.itemPerSlide),c&&n&&(d&&d>i*n.length||($(window).width()<920?(t.center&&c.find(".itemList").scrollLeft((147*n.length-$(window).width()+20)/2),o.removeClass("disabled"),a.removeClass("disabled")):c.width()>i*n.length?(o.addClass("disabled"),a.addClass("disabled"),t.center&&c.find(".itemList").css("left","0px")):(t.center&&c.find(".itemList").css("left",-parseInt((285*n.length-$(window).width()+20)/2)+"px"),o.removeClass("disabled"),a.removeClass("disabled")))),e.css("visibility","visible"),d&&d>i*n.length&&(o.hide(),a.hide()),e.on("click","a.prev",function(e){e.preventDefault();var t=$(this);if(!t.hasClass("_disabled")){var n=r();t.addClass("_disabled"),u.animate({left:0-n+"px"},300,"easeInOutExpo",function(){l(),t.removeClass("_disabled")})}}).on("click","a.next",function(e){e.preventDefault();var t=$(this);if(!t.hasClass("_disabled")){var n=s();t.addClass("_disabled"),u.animate({left:0-n+"px"},300,"easeInOutExpo",function(){l(),t.removeClass("_disabled")})}})}$.fn.productSlide=function(e){e=e||{center:!0};return this.each(function(){t($(this),e)})}})}function Et(e){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,o=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function _t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kt(e){return(kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function St(e,t){return(St=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function At(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}yt.transformFancyArticleImage=vt(yt.transformFancyArticleImage),yt.transformFancyArticleGallery=vt(yt.transformFancyArticleGallery),yt.transformFancyArticleProduct=vt(yt.transformFancyArticleProduct),yt.transformFancyArticleProductSlideshow=vt(yt.transformFancyArticleProductSlideshow),yt.cleanupContent=vt(yt.cleanupContent),n.d(t,"default",function(){return Ot});var Pt=window.creating,Dt={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,n,i,o,a,r,s,l="",c=0;for(e=Dt._utf8_encode(e);c<e.length;)o=(t=e.charCodeAt(c++))>>2,a=(3&t)<<4|(n=e.charCodeAt(c++))>>4,r=(15&n)<<2|(i=e.charCodeAt(c++))>>6,s=63&i,isNaN(n)?r=s=64:isNaN(i)&&(s=64),l=l+this._keyStr.charAt(o)+this._keyStr.charAt(a)+this._keyStr.charAt(r)+this._keyStr.charAt(s);return l},decode:function(e){var t,n,i,o,a,r,s="",l=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)t=this._keyStr.indexOf(e.charAt(l++))<<2|(o=this._keyStr.indexOf(e.charAt(l++)))>>4,n=(15&o)<<4|(a=this._keyStr.indexOf(e.charAt(l++)))>>2,i=(3&a)<<6|(r=this._keyStr.indexOf(e.charAt(l++))),s+=String.fromCharCode(t),64!=a&&(s+=String.fromCharCode(n)),64!=r&&(s+=String.fromCharCode(i));return s=Dt._utf8_decode(s)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t+=String.fromCharCode(i):(127<i&&i<2048?t+=String.fromCharCode(i>>6|192):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128)),t+=String.fromCharCode(63&i|128))}return t},_utf8_decode:function(e){for(var t="",n=0,i=c1=c2=0;n<e.length;)(i=e.charCodeAt(n))<128?(t+=String.fromCharCode(i),n++):191<i&&i<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((31&i)<<6|63&c2),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((15&i)<<12|(63&c2)<<6|63&c3),n+=3);return t}},Nt=x.a.createElement("a",{href:"/_admin/articles"},"Articles"),It=x.a.createElement("span",{className:"arrow"},">"),Ot=function(e){function b(e){var s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),At(Tt(s=function(e,t){return!t||"object"!==Et(t)&&"function"!=typeof t?Tt(e):t}(this,kt(b).call(this,e))),"handleChange",function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},i=(t||window.EditorControl.get()).serialize().editable.value;s.setState({content:e},n),s._content=i}),At(Tt(s),"handleCodeviewChange",function(e){var t=e.target.value;s.setState({content:t}),s._content=t}),At(Tt(s),"setArticleProp",function(e,t){if(-1===e.indexOf("."))s.setState(At({},e,t));else{var n=e.split(".");2<n.length&&console.warn("indexing is supported for direct object access only");var i=xt(n,2),o=i[0],a=i[1],r=_.extend({},s.state[o]);r[a]=t,s.setState(At({},o,r))}}),At(Tt(s),"handleSubmission",function(){s.submitArticle()}),At(Tt(s),"submitArticle",function(e){var t=s.convertToSerialized();!0===e?t.is_active=!0:!1===e&&(t.is_active=!1),s.setState({saving:!0},function(){Pt?$.post("/_admin/articles/create.json",t,function(e){var t=e.error,n=e.message,i=e.aid,o=!1;if(t)alertify.alert(t);else{o=!0;var a=function(){!function(e){$(window).off("beforeunload"),location.href=e}("/_admin/articles/edit?id=".concat(i).concat(window.isWhitelabelV2?"&v2":""))};n?alertify.alert(n,a):a()}!1===o&&s.setState({saving:!1})}):$.post("/_admin/articles/update.json",t,function(e){var t=e.error,n=e.message,i=!1;if(t)alertify.alert(t);else{i=!0;var o=function(){$(window).off("beforeunload"),location.reload()};n?alertify.alert(n,o):o()}!1===i&&s.setState({saving:!1})})})}),At(Tt(s),"handleDeleteThing",function(e){e.preventDefault(),$(Tt(s)).closest("li").remove()}),At(Tt(s),"handleAddThing",function(e){e.preventDefault(),$.dialog("add_thing_item").open(),ot(null,!0)}),At(Tt(s),"handleToggleDeveloperMode",function(){s.setState({isDeveloperMode:!s.state.isDeveloperMode})}),At(Tt(s),"handlePreview",function(){Pt||window.open("/articles/".concat(s.state.slug,"?preview").concat(window.isWhitelabelV2?"&v2":""))}),At(Tt(s),"handleThingCardRemove",function(t){s.setState({thing_ids:s.state.thing_ids.filter(function(e){return e!==t})})}),At(Tt(s),"handleItemHeaderChange",function(){s.setState({item_header:event.target.value})}),At(Tt(s),"handleDraftAction",function(){s.submitArticle(!1)}),At(Tt(s),"handlePublish",function(){s.submitArticle(!0)});var t=e.article,n=t.content,i=t.gallery,o=t.slug,a=t.published_datetime,r=t.is_active,l=t.options,c=l.action_button,u=l.authors,d=l.item_header,h=t.tagline,p=t.title,m=t.thing_ids,f=t.featured,g=t.cover_image,v=t.cover_video;return s.state={cover_image:g||null,cover_video:v||null,authors:u,slug:o,content:n,published_datetime:a||null,is_active:r,gallery:i,tagline:h,title:p,thing_ids:m,item_header:d,featured:f,actionButtonText:c.text,actionButtonLink:c.link,remove_video:null,saving:!1,codeview:!1},s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&St(e,t)}(b,x.a.Component),function(e,t,n){t&&_t(e.prototype,t),n&&_t(e,n)}(b,[{key:"componentDidMount",value:function(){!function(e){Ye=e}(this),$(".items ol.additional").sortable({cancel:".add",items:".item.photo",tolerance:"intersect"}),wt(s.a.findDOMNode(this)),window.EditorControl.refresh(function(){Ct()})}},{key:"convertToSerialized",value:function(){var e=this.state,t=e.authors,n=e.slug,i=e.is_active,o=e.gallery,a=e.tagline,r=e.title,s=e.published_datetime,l=e.cover_image,c=e.cover_video,u=e.thing_ids,d=e.actionButtonText,h=e.actionButtonLink,p=e.remove_video,m=e.item_header,f=window.article.article_id,g=function(t){var n;window.EditorControl.refresh();try{tt(function(e){var t=e._content;n=yt.cleanupContent(t),n=yt.transformFancyArticleImage(n),n=yt.transformFancyArticleGallery(n),window.isWhitelabelV2&&(n=yt.transformFancyArticleProduct(n),n=yt.transformFancyArticleProductSlideshow(n))})}catch(e){console.warn(e),n=t}return n}(this._content),v=Dt.encode(g),b=_.extend({authors:t,slug:n,is_active:i,gallery:o,tagline:a,title:r},{thing_ids:u.join(","),article_id:f,content:v,action_button_text:d,action_button_link:h});return l&&(b.cover_image_url=l.url),c?(b.video_id=c.id,b.video_loop=c.loop,b.video_autoplay=c.autoplay):p&&(b.remove_video=!0),this.state.featured&&+new Date(s)?b.published_datetime=s:!1===this.state.featured&&(b.published_datetime=""),null!=m&&"string"==typeof m&&(b.item_header=m.trim()),b}},{key:"updateThingIds",value:function(e){var t=this.state.thing_ids,n=t.concat(e.filter(function(e){return-1===_.indexOf(t,e)}));this.setState({thing_ids:n})}},{key:"render",value:function(){for(var t=this,e=this.state,n=e.authors,i=e.actionButtonText,o=e.actionButtonLink,a=e.cover_image,r=e.cover_video,s=e.is_active,l=e.item_header,c=void 0===l?"":l,u=e.featured,d=e.slug,h=e.title,p=e.tagline,m=e.thing_ids,f=e.codeview,g=e.saving,v=e.published_datetime,b=4-m.length%4-1,y=[],w=0;w<b;w++)y.push(x.a.createElement($e,{key:w}));var C=x.a.createElement(he,{setArticleProp:this.setArticleProp,authors:n,title:h,tagline:p,actionButtonText:i,actionButtonLink:o}),E=x.a.createElement(X,{setArticleProp:this.setArticleProp,cover_image:a,cover_video:r});return x.a.createElement("div",{className:window.isWhitelabel?"_whitelabel whitelabel-article":null},x.a.createElement("h2",{className:"ptit embo"},Nt," ",It," ",x.a.createElement("b",null,Pt?"New Article":"Edit Article")),window.isWhitelabelV2&&x.a.createElement("span",{className:k()("status",{live:s})},s?"This article is live on Gear.com":"This article is a draft and is not visible on Gear.com"),x.a.createElement("div",{id:"summary",className:"wrapper article-wrapper"},window.isWhitelabelV2?null:x.a.createElement(et,{codeview:f,featured:u,is_active:s,slug:d,setArticleProp:this.setArticleProp,published_datetime:v}),window.isWhitelabelV2?C:E,window.isWhitelabelV2?E:C,x.a.createElement("textarea",{id:"editable-codeview",style:T.Display.NoneIf(!f),value:this.state.content,onChange:this.handleCodeviewChange}),x.a.createElement(S,{style:T.Display.NoneIf(f),className:"description more",id:"editable",content:this.state.content,onChange:this.handleChange})),window.isWhitelabelV2?null:x.a.createElement("div",{className:"wrapper-content thing-stream-wrapper"},x.a.createElement("div",{id:"content"},!window.isWhitelabel&&x.a.createElement("input",{className:"item_header",type:"text",value:c,onChange:this.handleItemHeaderChange,placeholder:"Type Item Header..."}),x.a.createElement("ol",{className:"stream after"},m.map(function(e){return x.a.createElement(ze,{key:e,tid:e,onRemove:t.handleThingCardRemove})}),x.a.createElement("li",null,x.a.createElement("div",{className:"figure-item add"},x.a.createElement("input",{type:"file",onClick:this.handleAddThing}))),y))),x.a.createElement("div",{className:"btn-area"},window.isWhitelabelV2&&x.a.createElement("button",{className:k()("btns-gray-embo",{disabled:g}),onClick:this.handleDraftAction,disabled:g},Pt||!s?"Save Draft":"Set as Draft"),!Pt&&x.a.createElement("button",{className:"btns-gray-embo",onClick:this.handlePreview},"Preview"),!window.isWhitelabelV2&&x.a.createElement("button",{className:k()("btns-blue-embo",{disabled:g}),onClick:this.handleSubmission,disabled:g},"Save Changes"),window.isWhitelabelV2&&x.a.createElement("button",{className:k()("btns-green-embo",{disabled:g}),onClick:this.handlePublish,disabled:g},Pt||!s?"Publish":"Update")))}}]),b}();$(function(){$(".popup.add_thing_item").on("click",".btn-save",function(e){var o=$(".popup.add_thing_item .text").val().trim(),a=$(".popup.add_thing_item .featured li.selected");0===a.length&&!o||$.get("/_admin/articles/validate_product_ids.json?ids="+o).then(function(e){e.ids&&(o=e.ids.join(","));var t=_.map(a,function(e){return window.isWhitelabel?$(e).attr("data-sid"):$(e).attr("data-tid")});t=_.without(t,void 0);var n="",i="";0<t.length&&(i=t.join(",")),(n=o?(o=o.split(",").map(function(e){return e.trim()}).join(","),i?o+","+i:o):i)&&tt(function(e){return e.updateThingIds(n.split(","))}),$(".popup.add_thing_item .text").val(""),$.dialog("add-bio-items").close()}).fail(function(){alertify.alert("Failed to validate ID, please try again")})}),$(".popup.add_thing_item .featured").on("click","ul > li:not(.selected)",function(e){$(this).addClass("selected"),$(this).find("input").prop("checked","checked")}),$(".popup.add_thing_item .featured").on("click","ul > li.selected",function(e){$(this).removeClass("selected"),$(this).find("input").prop("checked",!1)}),$(".popup.add_thing_item .search .text").keyup(function(e){13===e.keyCode&&$(".popup.add_thing_item .btn-save").click()}),$(".popup.add_thing_item .featured ul").on("scroll",ot),window.GalleryControl=Ae,n(41)($),window.articleAdmin=s.a.render(x.a.createElement(Ot,{article:window.article}),document.querySelector(".container-2")),$(window).on("beforeunload",function(e){var t="Are you sure you want to leave this page? Your changes may not be saved.";return e.returnValue=t})})}]);