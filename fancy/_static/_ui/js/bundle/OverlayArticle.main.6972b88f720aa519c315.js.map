{"version":3,"file":"OverlayArticle.main.6972b88f720aa519c315.js","sources":["webpack://fancy/./_static/modules/ui/overlay-article/Shortcode.js","webpack://fancy/./_static/modules/ui/overlay-article/SyncedContext.js","webpack://fancy/./_static/modules/ui/overlay-article/action/action-constants.js","webpack://fancy/./_static/modules/ui/overlay-article/action/action-helpers.js","webpack://fancy/./_static/modules/ui/overlay-article/action/actions.js","webpack://fancy/./_static/modules/ui/overlay-article/appstate.js","webpack://fancy/./_static/modules/ui/overlay-article/cache.js","webpack://fancy/./_static/modules/ui/overlay-article/components/ArticleCard.js","webpack://fancy/./_static/modules/ui/overlay-article/components/ArticleFancydUsers.js","webpack://fancy/./_static/modules/ui/overlay-article/components/ArticleWidgets.js","webpack://fancy/./_static/modules/ui/overlay-article/components/ThingCard.js","webpack://fancy/./_static/modules/ui/overlay-article/components/ThingFancydUsers.js","webpack://fancy/./_static/modules/ui/overlay-article/components/article.js","webpack://fancy/./_static/modules/ui/overlay-article/components/map.js","webpack://fancy/./_static/modules/ui/overlay-article/config.js","webpack://fancy/./_static/modules/ui/overlay-article/container/app.js","webpack://fancy/./_static/modules/ui/overlay-article/container/entry-events.js","webpack://fancy/./_static/modules/ui/overlay-article/container/history.js","webpack://fancy/./_static/modules/ui/overlay-article/container/routeutils.js","webpack://fancy/./_static/modules/ui/overlay-article/index.js","webpack://fancy/./_static/modules/ui/overlay-article/reducers.js","webpack://fancy/./_static/modules/ui/overlay-article/shared.js","webpack://fancy/./_static/modules/ui/overlay-article/store/configure-store.js","webpack://fancy/./_static/modules/ui/overlay-article/store/initial-store.js","webpack://fancy/./_static/modules/ui/overlay-article/store/store.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/map.cart.ts"],"sourcesContent":["/* BEWARE: this code is directly imported via mobile article.new.html, use ES5 */\nvar ImageModes = {\n  Full: 'Full',\n  Normal: 'Normal',\n  Quoted: 'Quoted',\n  Grid: 'Grid'\n};\n\nfunction getRandomId() {\n  return 'shortcode-' + String(Math.random()).substr(2);\n}\n\nfunction getJumper($element) {\n  var _id = getRandomId();\n\n  $element.attr('id', _id);\n  return function () {\n    return $('#' + _id);\n  };\n}\n\nfunction jQueryPromiseAll(arrayOfPromises) {\n  return jQuery.when.apply(jQuery, arrayOfPromises).then(function () {\n    return Array.prototype.slice.call(arguments, 0);\n  });\n}\n\nfunction getProductContext(products, callback) {\n  if (products.length > 0) {\n    jQueryPromiseAll(products.filter(function (e) {\n      return e;\n    }).map(function (sid) {\n      var dfd = $.Deferred();\n      $.get('/rest-api/v1/things/' + sid + '?sales=true&include_every_image=true').then(function (thing) {\n        dfd.resolve(thing);\n      }).fail(function (xhr) {\n        if (xhr.status === 404) {\n          alertify.alert('Product id ' + sid + 'not found.');\n        } else {\n          console.warn('There was an error whiel fetching sid:', sid, xhr);\n        }\n\n        dfd.resolve(null);\n      });\n      return dfd.promise();\n    })).done(function (things) {\n      var ctx = {\n        items: things.map(function (thing) {\n          var image_fit_to_bounds = false;\n          var image = thing.image.src;\n\n          try {\n            image_fit_to_bounds = thing.sales.images[0].fit_to_bounds;\n            image = thing.sales.images[0].src;\n          } catch (e) {}\n\n          return thing.sales && {\n            title: thing.sales.emojified_name,\n            price: thing.sales.price,\n            retail_price: thing.sales.retail_price,\n            image: image,\n            image_fit_to_bounds: image_fit_to_bounds,\n            id: thing.sales.id\n          };\n        }).filter(function (e) {\n          return e;\n        })\n      };\n      callback(ctx);\n    });\n  } else {\n    console.warn('[ShortCodeTransformers]: Error - product does not exist');\n  }\n}\n\nfunction getTemplateByImageMode(imageMode) {\n  switch (imageMode) {\n    case ImageModes.Grid:\n      return '<div class=\"grid\"><img src=\"/_ui/images/common/blank.gif\"  alt=\"<%= image.caption %>\" class=\"\" style=\"background-image:url(\\'<%= image.src %>\\');\" data-src=\"<%= image.src %>\"><% if (image.caption) { %><figcaption class=\"text-placeholder\"><%= image.caption %></figcaption><% } %></div>';\n\n    case ImageModes.Full:\n      return '<figure class=\"mode-full\"><img src=\"<%= image.src %>\" alt=\"<%= image.caption %>\"></figure>';\n\n    case ImageModes.Quoted:\n      return '<figure class=\"mode-quoted\"><p><img src=\"<%= image.src %>\" alt=\"<%= image.caption %>\"></p><p class=\"textarea\"><%= image.caption %></p></figure>';\n\n    case ImageModes.Normal:\n    default:\n      return '<figure class=\"mode-normal\"><img src=\"<%= image.src %>\" alt=\"<%= image.caption %>\"></figure>';\n  }\n}\n\nvar ShortCodeTransformers = {};\n/* \n<% {\"name\": fancy-article-gallery,\n    \"images\": [{ src: \"https://img-address-1\", caption: \"An image caption\", uiid: 1 }, ... ],\n    \"title\": \"a gallery title\",\n    \"tagline\": \"a gallery tagline\"} %>\n*/\n\nShortCodeTransformers['fancy-article-gallery'] = function (options, $shortcode) {\n  var images = options.images;\n  var title = options.title;\n  var tagline = options.tagline;\n  var markup = '';\n  markup += '<div class=\"gallery\">';\n  markup += '<h3><span><%= title %></span><small class=\"tagline\"><span><%= tagline %></span></small></h3>';\n  markup += '<ul class=\"photo-list\">';\n  markup += '<% _.each(images, function(image, idx) { %>';\n  markup += '<li class=\"<%= idx === 0 ? \\'active\\' : \\'\\' %>\"><a href=\"<%= image.link %>\" <%= image.link ? \"rel=\\'noopener\\' target=\\'_blank\\' class=\\'linked\\'\" : \"onclick=\\'return false;\\'\" %>><img src=\"<%= image.src %>\"></a><span><%= image.caption %></span></li>';\n  markup += '<% }) %>';\n  markup += '</ul>';\n  markup += '<div class=\"paging\">';\n\n  if (window.isWhitelabelV2) {\n    markup += '<div class=\"btn\"><a class=\"prev\"></a><a class=\"next\"></a></div>';\n  }\n\n  markup += '<% _.each(images, function(e, idx) { %> ';\n  markup += '<a href=\"#\" class=\"<%= idx === 0 ? \\'current\\' : \\'\\' %> pager\"><%= idx + 1 %></a>';\n  markup += '<% }) %>';\n  markup += '</div>';\n  markup += '</div>';\n  var $next = $(_.template(markup)({\n    images: images,\n    title: title,\n    tagline: tagline\n  }));\n\n  if (window.isWhitelabelV2) {\n    $next.find('img').wrap('<span class=\"figure\" />');\n    $next = $('<div class=\"gallery-container\" />').append($next);\n  }\n\n  $shortcode.replaceWith($next.prop('outerHTML'));\n};\n/*\n<% {\"name\": \"fancy-article-img\",\n    \"images\": [{\n        \"mode\": \"Quoted\",\n        \"src\": \"https://img-address\",\n        \"caption\": \"A image caption\",\n    }]\n   } %>\n*/\n\n\nShortCodeTransformers['fancy-article-img'] = function (options, $shortcode) {\n  var images = options.images;\n  var html = images.reduce(function (prev, image) {\n    return prev + _.template(getTemplateByImageMode(image.mode))({\n      image: image\n    });\n  }, '');\n\n  if (images[0] && images[0].mode === ImageModes.Grid) {\n    html = '<figure class=\"mode-grid\">' + html + '</figure>';\n  }\n\n  $shortcode.replaceWith(html);\n};\n\nShortCodeTransformers['fancy-article-product'] = function (options, $shortcode) {\n  var items = options.products;\n  var getIsolatedShortcodeElement = getJumper($shortcode);\n  getProductContext(items, function (ctx) {\n    var markup = '';\n    markup += '<ul class=\"itemList product\">';\n    markup += '<% items.forEach(function(item) { %>';\n    markup += '<li class=\"itemListElement\" data-id=\"<%= item.id %>\">';\n    markup += '<a href=\"<%= item.html_url %>?utm=article\">';\n    markup += '<span class=\"figure <% if (item.image_fit_to_bounds) { %>fit<% } %>\">';\n    markup += '<img src=\"/_ui/images/common/blank.gif\" style=\"background-image:url(<%= item.image %>)\">';\n    markup += '</span>';\n    markup += '<span class=\"figcaption\">';\n    markup += '<span class=\"title\"><%= item.title %></span>';\n    markup += '<% if (item.retail_price != null) { %><b class=\"price sales\">$<%= item.price %> <small class=\"before\">$<%= item.retail_price %></small></b><% } else { %><b class=\"price\">$<%= item.price %></b><% } %>';\n    markup += '</span>';\n    markup += '</li>';\n    markup += '<% }); %>';\n    markup += '</ul>';\n\n    var next = _.template(markup)(ctx);\n\n    getIsolatedShortcodeElement().replaceWith(next);\n  });\n};\n\nShortCodeTransformers['fancy-article-product-slideshow'] = function (options, $shortcode) {\n  var items = options.products;\n  var getIsolatedShortcodeElement = getJumper($shortcode);\n  getProductContext(items, function (ctx) {\n    var markup = '';\n    markup += '<div class=\"itemSlide product\">';\n    markup += '<div class=\"itemSlideWrap\">';\n    markup += '<ul class=\"stream after\">';\n    markup += '<% items.forEach(function(item) { %>';\n    markup += '<li class=\"itemSlideElement\">';\n    markup += '<div class=\"figure-item\">';\n    markup += '<figure <% if (item.image_fit_to_bounds) { %>class=\"fit\"<% } %>><a href=\"<% if (item.html_url) { %><%= item.html_url %><% } else { %>/sales/<%= item.id %>?utm=article<% } %>?utm=article\">';\n    markup += '<span class=\"back\"></span>';\n    markup += '<img class=\"figure\" src=\"/_ui/images/common/blank.gif\"';\n    markup += 'style=\"background-image: url(<%= item.image %>);\">';\n    markup += '</a></figure>';\n    markup += '<figcaption>';\n    markup += '<span class=\"show_cart\">';\n    markup += '<button class=\"btn-cart nopopup soldout\">';\n    markup += '<% if (item.retail_price != null) { %><b class=\"price sales\">$<%= item.price %> <small class=\"before\">$<%= item.retail_price %></small></b><% } else { %><b class=\"price\">$<%= item.price %></b><% } %>';\n    markup += '</button>';\n    markup += '</span>';\n    markup += '<a href=\"<%= item.html_url %>?utm=article\" class=\"title\"><%= item.title %></a>';\n    markup += '</figcaption>';\n    markup += '</div>';\n    markup += '</li>';\n    markup += '<% }); %>';\n    markup += '</ul>';\n    markup += '</div>';\n    markup += '<a href=\"#\" class=\"prev\">Prev</a>';\n    markup += '<a href=\"#\" class=\"next\">Next</a>';\n    markup += '</div>';\n\n    var next = _.template(markup)(ctx);\n\n    getIsolatedShortcodeElement().replaceWith(next);\n  });\n};\n\nfunction getWrappedSingleNode(target) {\n  return $('<div class=\"singlenode-wrapper\">' + target + '</div>');\n}\n\nfunction convertShortcode(content) {\n  var $wrapped = getWrappedSingleNode(content);\n  var $disposable = mountToDisposable($wrapped);\n  $wrapped.find('p.shortcode').each(function (i, shortcode) {\n    var $sc = $(shortcode);\n\n    try {\n      var data = JSON.parse($sc.attr('data-internal'));\n      ShortCodeTransformers[data.name](data, $sc);\n    } catch (e) {\n      console.warn(e);\n    }\n  });\n  $disposable.remove();\n  return $wrapped.html();\n}\n\nwindow.convertArticleShortcode = convertShortcode;\n\nfunction mountToDisposable(unmountedDOM) {\n  // Create/Select disposable mounting DIV to correctly modify a element.\n  var $disposable = $(document.body).find('.disposable');\n\n  if ($disposable.length > 0) {\n    $disposable = $disposable.eq(0).empty();\n  } else {\n    $disposable = $('<div />', {\n      id: 'disposable',\n      style: 'display:none;'\n    }).appendTo(document.body);\n  }\n\n  if (unmountedDOM) {\n    // Append unmounted DOM if exists\n    $disposable.append(unmountedDOM);\n  } // return disposable DOM\n\n\n  return $disposable;\n}","import _typeof from \"@babel/runtime/helpers/typeof\";\n// This module deals with outside of React context (mostly raw DOM) with observing DOM structure and \n// do sub'd actions when React-context actions fires.\nimport { dedupeArray } from 'fancyutils';\n/*\nif (process.env.NODE_ENV !== 'production') {\n    window.__assert = true;\n}\n\nfunction assert(a,b) {\n    if (window.__assert) console.assert(a,b)\n}\n*/\n\nfunction findFancyButton(id)\n/*:jQuery?*/\n{\n  if (typeof id === 'string') {\n    var domCache = thingsDomCache[id];\n\n    if (_typeof(domCache) === 'object') {\n      return $(domCache);\n    } else if (domCache === false) {// NOOP\n    } else {\n      var $query = $(\"#container-wrapper a[href^=\\\"/things/\".concat(id, \"\\\"]:visible\"));\n\n      if ($query.length > 0) {\n        var containers = dedupeArray($query.map(function (i, e) {\n          return $(e).closest('div.figure-item').get(0);\n        }).toArray());\n\n        if (containers && containers.length > 0) {\n          var $btn = $(containers[0]).find('button.fancy, button.fancyd, a.fancyd, a.fancy');\n\n          if ($btn.length > 0) {\n            thingsDomCache[id] = $btn[0];\n            return $btn;\n          }\n        }\n      } // If not returned\n\n\n      thingsDomCache[id] = false;\n    }\n  }\n}\n\nfunction findArticleFancyButton(id)\n/*:jQuery?*/\n{\n  if (typeof id === 'string') {\n    var domCache = thingsDomCache[id];\n\n    if (_typeof(domCache) === 'object') {\n      return $(domCache);\n    } else if (domCache === false) {// NOOP\n    } else {\n      var $query = $(\"#container-wrapper a[href^=\\\"/articles/\".concat(id, \"\\\"]:visible\"));\n\n      if ($query.length > 0) {\n        var containers = dedupeArray($query.map(function (i, e) {\n          return $(e).closest('div.article_item').get(0);\n        }).toArray());\n\n        if (containers && containers.length > 0) {\n          var $btn = $(containers[0]).find('button.fancy, button.fancyd, a.fancyd, a.fancy');\n\n          if ($btn.length > 0) {\n            thingsDomCache[id] = $btn[0];\n            return $btn;\n          }\n        }\n      } // If not returned\n\n\n      thingsDomCache[id] = false;\n    }\n  }\n} // via thing id \n\n\nvar thingsDomCache = {};\n\nfunction toggleFancyButton($btn, fancyd) {\n  $btn.removeClass('fancy').removeClass('fancyd');\n  $btn.addClass(fancyd ? 'fancyd' : 'fancy');\n}\n\nfunction replaceFancyCount($btn, fancyd, fc) {\n  // Fancy | Fancy'd\n  if ($btn.text().toLowerCase().indexOf('fancy') >= 0) {\n    $btn.html(\"<span><i></i></span> \".concat(fancyd ? 'Fancy\\'d' : 'Fancy')); // Fancy count\n  } else {\n    $btn.html(\"<span><i></i></span> \".concat(fc));\n  }\n}\n\nexport function onFancyButtonUpdate(id\n/*:string*/\n, fancyd\n/*:boolean*/\n, fc\n/*:string*/\n) {\n  var $btn = findFancyButton(id);\n\n  if ($btn && $btn.length > 0) {\n    toggleFancyButton($btn, fancyd);\n    replaceFancyCount($btn, fancyd, fc);\n  }\n}\nexport function onArticleFancyButtonUpdate(id\n/*:string*/\n, fancyd\n/*:boolean*/\n, fc\n/*:string*/\n) {\n  var $btn = findArticleFancyButton(id);\n\n  if ($btn && $btn.length > 0) {\n    toggleFancyButton($btn, fancyd);\n    replaceFancyCount($btn, fancyd, fc);\n  }\n}","// Generate `key: String(key)` structure by given string key arguments\nfunction constantGen() {\n  var keys = [].slice.call(arguments);\n  return keys.reduce(function (prev, next) {\n    prev[next] = next;\n    return prev;\n  }, {});\n}\n\nvar C = constantGen('UPDATE_APP_CONTEXT', // Loading\n'REQUEST_ARTICLE', 'REQUEST_ARTICLE_FAILURE', 'LOAD_ARTICLE', // UI Actions\n'OPEN_ARTICLE', 'CLOSE_ARTICLE');\nexport default C;","import { MP, getLocationArgPairs, isStaticPage, stripPathname } from 'fancyutils';\nimport { historyData } from '../container/history';\nimport store from '../store/store';\nimport { closeModal } from '../container/routeutils';\nimport { closeArticle, openArticle, loadArticle, requestArticle, requestArticleFail } from './actions';\nimport { ArticleCache, cache } from '../cache';\nimport { history } from 'common-components';\n\nfunction shouldOpenArticle(state) {\n  return state.appContext.visible !== true;\n} // Blocks illegal requests\n\n\nfunction shouldFetchArticle(state, articleID) {\n  if (state.article.ID === articleID || state.article.isFetching) {\n    return false;\n  } else {\n    return true;\n  }\n}\n\nexport function closeOverlay() {\n  return function (dispatch) {\n    if (isStaticPage()) {\n      return;\n    }\n\n    closeModal();\n    historyData.overlayIsOn = false;\n    history.push(stripPathname(historyData.preservedHref), null);\n    document.title = historyData.initialTitle;\n    dispatch(closeArticle());\n    $(document).off('keydown.overlayArticle');\n    $(window).trigger('scroll');\n  };\n}\nexport function fetchArticle(articleID) {\n  var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ArticleCache.ARTICLES;\n  var killCache = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var queryString = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';\n  return function (dispatch, getState) {\n    if (articleID == null) {\n      console.warn('fetchArticle(): articleID was null.');\n      return;\n    }\n\n    var state = getState();\n\n    if (shouldOpenArticle(state)) {\n      dispatch(openArticle());\n    }\n\n    if (killCache) {\n      cache.remove(articleID, type);\n      delete state.article;\n    }\n\n    if (killCache || shouldFetchArticle(state, articleID)) {\n      if (cache.exists(articleID, type)) {\n        var cac = cache.get(articleID, type);\n        dispatch(loadArticle(articleID, cac));\n        onLoadArticle(cac); // if cache is crawled one, request should continue\n\n        if (!cac.isCrawled) {\n          return;\n        }\n      }\n\n      dispatch(requestArticle(articleID));\n      var options = {\n        saved_users_top: 10,\n        raw_content: 'true',\n        include_viewer: 'true'\n      };\n\n      if (getLocationArgPairs('preview')) {\n        options.preview = true;\n      }\n\n      $.get(\"/rest-api/v1/articles/\".concat(articleID).concat(queryString), options).then(function (article) {\n        cache.add(articleID, article, type);\n        dispatch(loadArticle(articleID, article));\n        onLoadArticle(article);\n      }).fail(function (failureXHR) {\n        // FIXME: This error handling only happens when there's server-side error -\n        //        can't handle client-side ones\n        dispatch(requestArticleFail(articleID));\n\n        if (failureXHR.status === 404) {\n          alertify.alert(\"This page is not available. Please try again later.\"); // } else if (failureXHR.status >= 500) {\n        } else {\n          alertify.alert(\"There was an error while opening the page.<br> Please try again or contact <a mailto=\\\"cs@fancy.com\\\">cs@fancy.com</a>.\");\n        }\n\n        if (historyData.initialPageIsArticlePage) {\n          location.href = '/';\n        } else {\n          dispatch(closeOverlay());\n        }\n      });\n    }\n  };\n} // TODO: make unified eventemitter interface after all\n\nfunction onLoadArticle(article) {\n  var MPArgs = {\n    article_id: article.id\n  };\n  var currentLocationArgPair = getLocationArgPairs('utm');\n\n  if (currentLocationArgPair) {\n    MPArgs.utm = currentLocationArgPair[1];\n  }\n\n  MP('View Article Detail', MPArgs);\n}\n\nwindow.___D = function () {\n  return store.getState();\n};","import C from './action-constants'; // Action on requesting article starts\n\nexport function requestArticle(pendingID) {\n  return {\n    type: C.REQUEST_ARTICLE,\n    status: 'request',\n    pendingID: pendingID\n  };\n} // Action on requesting article fails\n\nexport function requestArticleFail()\n/*lastRequestFailedArticleID*/\n{\n  return {\n    type: C.REQUEST_ARTICLE_FAILURE,\n    status: 'failed'\n  };\n} // action on loading request result\n\nexport function loadArticle(ID, data) {\n  // FIXME: should we do this here?\n  var title = data.name;\n\n  if (title) {\n    document.title = \"Fancy | \".concat(title);\n  }\n\n  return {\n    type: C.LOAD_ARTICLE,\n    status: 'idle',\n    ID: ID,\n    data: data\n  };\n} // Action on close overlay\n\nexport function openArticle() {\n  return {\n    type: C.OPEN_ARTICLE\n  };\n} // Action on close overlay\n\nexport function closeArticle() {\n  return {\n    type: C.CLOSE_ARTICLE,\n    ID: null,\n    pendingID: null,\n    article: null\n  };\n}\nexport function updateAppContext(contextObject) {\n  return {\n    type: C.UPDATE_APP_CONTEXT,\n    context: contextObject\n  };\n}","// App state that does not usually change during app lifecycle. (i.e. Login state)\n// import assign from 'object-assign';\n// module-level login state object and setter\nvar state = {\n  viewer: {}\n};\nexport default state;\n/*\nexport function statify(config) {\n    assign(state, config);\n    state.loginNeededAttr = config.loggedIn ? {} : {'data-require_login': \"true\"};\n}\n*/\n\nexport function updateState(k, v) {\n  state[k] = v;\n}","import _typeof from \"@babel/runtime/helpers/typeof\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport { index } from 'fancyutils'; // Cache bucket\n\nexport var ArticleCache = /*#__PURE__*/function () {\n  function ArticleCache() {\n    var _this = this;\n\n    _classCallCheck(this, ArticleCache);\n\n    _defineProperty(this, \"articles\", {});\n\n    _defineProperty(this, \"count\", 0);\n\n    _defineProperty(this, \"exists\", function (id, type, ignoreCralwed) {\n      var cac = _this.get(id, type);\n\n      var existence = cac != null && _typeof(cac) === 'object';\n\n      if (ignoreCralwed) {\n        existence = existence && cac.isCrawled !== true;\n      }\n\n      return existence;\n    });\n\n    _defineProperty(this, \"_get\", function (id) {\n      return _this[ArticleCache.ARTICLES][id] || null;\n    });\n\n    _defineProperty(this, \"get\", function (id) {\n      var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ArticleCache.ARTICLES;\n\n      var cac = _this[type][id] || _this.getCrawled(id, type);\n\n      return cac;\n    });\n\n    _defineProperty(this, \"getCrawled\", function (id, type) {\n      var cac = _this[type][id];\n\n      if (cac && cac.isCrawled) {\n        return cac;\n      } else {\n        return null;\n      }\n    });\n\n    _defineProperty(this, \"add\", function (id, data, type) {\n      // to add, cache should not be exist or crawled one\n      var cac = _this[type][id];\n\n      if (cac == null || cac.isCrawled === true) {\n        _this[type][id] = data;\n        _this.count += 1;\n      } else {\n        console.warn('cache.add(): Cache overwrite');\n      }\n    });\n\n    _defineProperty(this, \"remove\", function (id, type) {\n      if (_this[type][id]) {\n        delete _this[type][id];\n        _this.count -= 1;\n      } else {\n        console.warn('cache.remove(): Non-existing cache removal');\n      }\n    });\n\n    _defineProperty(this, \"update\", function (id) {\n      var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ArticleCache.ARTICLES;\n      var selector = arguments.length > 2 ? arguments[2] : undefined;\n      var value = arguments.length > 3 ? arguments[3] : undefined;\n\n      if (selector == null) {\n        console.warn('ArticleCache#update(): selector is empty');\n        return;\n      }\n\n      var t = _this.get(id, type);\n\n      if (t) {\n        index(t, selector, value);\n      }\n    });\n  }\n\n  _createClass(ArticleCache, [{\n    key: \"sweep\",\n    value: function sweep() {// TODO: should sweep cache if too many cache added by looking `cache.count`\n    }\n  }]);\n\n  return ArticleCache;\n}();\n\n_defineProperty(ArticleCache, \"ARTICLES\", 'articles');\n\nexport var cache = new ArticleCache();","import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from 'react';\nimport { isPlainLeftClick } from 'fancyutils';\nimport { LinkTypes, transition } from '../container/routeutils';\n\nvar ArticleCard = /*#__PURE__*/function (_Component) {\n  _inherits(ArticleCard, _Component);\n\n  function ArticleCard(props) {\n    var _this;\n\n    _classCallCheck(this, ArticleCard);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ArticleCard).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleLinkClick\", function (event) {\n      event.stopPropagation();\n\n      if (isPlainLeftClick(event)) {\n        event.preventDefault();\n        var html_url = _this.props.html_url;\n        transition(html_url, LinkTypes.Timeline);\n      }\n    });\n\n    _this.state = {};\n    _this.handleLinkClick = _.throttle(_this.handleLinkClick, 500);\n    return _this;\n  }\n\n  _createClass(ArticleCard, [{\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.unmounted = true;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          id = _this$props.id,\n          cover_image = _this$props.cover_image,\n          title = _this$props.title,\n          url = _this$props.url,\n          tagline = _this$props.tagline;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"article_item detail\"\n      }, /*#__PURE__*/React.createElement(\"a\", {\n        href: url\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"cover\"\n      }, cover_image && /*#__PURE__*/React.createElement(\"img\", {\n        src: \"/_ui/images/common/blank.gif\",\n        style: {\n          backgroundImage: \"url(\".concat(cover_image.url, \")\")\n        }\n      }), !cover_image && /*#__PURE__*/React.createElement(\"img\", {\n        src: \"/_ui/images/common/blank.gif\"\n      })), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"title\"\n      }, title), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"description\"\n      }, tagline)));\n    }\n  }]);\n\n  return ArticleCard;\n}(Component);\n\nexport { ArticleCard as default };","import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from 'react';\nimport classnames from 'classnames';\nimport { MP, getConciseNumberString } from 'fancyutils';\nimport { Display } from 'fancymixin';\nimport { FancyStatus } from '../config';\nimport { cache } from '../cache';\nimport { onArticleFancyButtonUpdate } from '../SyncedContext';\nexport function handleProfileMouseOver(event) {\n  var $profile = $(event.currentTarget).find('em');\n  $profile.css('margin-left', \"\".concat(-($profile.width() / 2) - 10, \"px\"));\n}\n\nvar FancydUser = function FancydUser(_ref) {\n  var _ref$user = _ref.user,\n      user = _ref$user === void 0 ? {} : _ref$user,\n      display = _ref.display,\n      isViewer = _ref.isViewer;\n  return /*#__PURE__*/React.createElement(\"a\", {\n    href: user.html_url,\n    className: classnames(\"user\", {\n      _viewer: isViewer\n    }),\n    onMouseOver: handleProfileMouseOver,\n    style: display\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: \"/_ui/images/common/blank.gif\",\n    style: {\n      backgroundImage: \"url(\".concat(user.image_url || user.profile_image_url, \")\")\n    }\n  }), /*#__PURE__*/React.createElement(\"em\", null, user.fullname || user.full_name));\n};\n\nvar bgXPosSequence = [0, -54, -108, -163, -218, -272, -327, -436, -490, -545, -599, -654, -708, -763, -817, -872, -926, -981, -1035, -1144, -1199, -1253, -1308, -1417, -1471];\n\nfunction isUserEqual(a, b) {\n  if (a == null || b == null) {\n    return false;\n  }\n\n  return a.id === b.id;\n}\n\nfunction _handleFancydStateOnLoadArticle(slug, _ref2) {\n  var fancyd = _ref2.fancyd,\n      save_count = _ref2.save_count;\n  var stateSetter = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function (_) {\n    return _;\n  };\n  onArticleFancyButtonUpdate(slug, fancyd, getConciseNumberString(save_count));\n  stateSetter({\n    fancyd: fancyd,\n    save_count: save_count,\n    loading: false,\n    fancyStatus: FancyStatus.Idle\n  });\n}\n\nfunction getFancyStatus(nextFancydState) {\n  return nextFancydState ? FancyStatus.Addition : FancyStatus.Removal;\n}\n\nfunction getCompletionIdleStatus(currentFancyState) {\n  var prevFancyState = !currentFancyState;\n  return prevFancyState ? FancyStatus.AfterRemoval : FancyStatus.AfterAddition;\n}\n\nfunction getNextFancydCount(nextFancyd, currentFancydCount) {\n  if (nextFancyd === true) {\n    return currentFancydCount + 1;\n  } else {\n    return currentFancydCount - 1;\n  }\n}\n\nfunction toggleFancy(article, currentState) {\n  var stateSetter = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function (_) {\n    return _;\n  };\n  var fancyd = currentState.fancyd,\n      save_count = currentState.save_count,\n      loading = currentState.loading;\n  var nextFancyd = !fancyd;\n  var nextFancydCount = getNextFancydCount(nextFancyd, save_count);\n\n  if (!loading) {\n    stateSetter({\n      fancyd: nextFancyd,\n      loading: true,\n      fancyStatus: getFancyStatus(nextFancyd)\n    });\n    $.ajax({\n      type: 'POST',\n      url: '/articles/save.json',\n      data: {\n        article_id: article.id,\n        action: nextFancyd ? 'save' : 'unsave'\n      }\n    }).done(function (json) {\n      if (json.article_id && json.saved === !fancyd) {\n        // Completing fancy\n        cache.update(article.slug, undefined, 'saved', nextFancyd);\n        cache.update(article.slug, undefined, 'save_count', nextFancydCount);\n        onArticleFancyButtonUpdate(article.slug, nextFancyd, getConciseNumberString(nextFancydCount));\n        stateSetter({\n          loading: false,\n          fancyd: nextFancyd,\n          save_count: nextFancydCount,\n          fancyStatus: getCompletionIdleStatus(nextFancyd)\n        });\n      } else {\n        // cancelling fancy\n        stateSetter({\n          loading: false,\n          fancyd: fancyd,\n          save_count: save_count,\n          fancyStatus: getFancyStatus(fancyd)\n        });\n      }\n    }).fail(function () {\n      // cancelling fancy\n      stateSetter({\n        loading: false,\n        fancyd: fancyd,\n        save_count: save_count,\n        fancyStatus: getFancyStatus(fancyd)\n      });\n    });\n  }\n}\n\nexport var FancydUsers = /*#__PURE__*/function (_Component) {\n  _inherits(FancydUsers, _Component);\n\n  _createClass(FancydUsers, [{\n    key: \"_getInitialState\",\n    value: function _getInitialState() {\n      return {\n        fancyAnimation: false,\n        // button state\n        fancyd: null,\n        loading: false,\n        save_count: null,\n        fancyStatus: FancyStatus.Idle // fancyStatus = 'Idle', { Idle | Addition | Removal | After- } - Fancy'd status for animation control\n\n      };\n    }\n  }]);\n\n  function FancydUsers(props) {\n    var _this;\n\n    _classCallCheck(this, FancydUsers);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(FancydUsers).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"getFancydCountString\", function () {\n      var save_count = _this.state.save_count;\n      return save_count != null ? getConciseNumberString(save_count, 0) : '0';\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"animateFancyBG\", function (frame) {\n      if (frame === undefined) {\n        _this.animateFancyBG(0);\n      } else if (frame < bgXPosSequence.length) {\n        // Special branching due to misposition in background\n        var xPos = bgXPosSequence[frame];\n        $(_this.fancyBGAnimation).css('background-position-x', \"\".concat(xPos, \"px\"));\n        setTimeout(function () {\n          _this.animateFancyBG(frame + 1);\n        }, 10);\n      } else if (frame >= bgXPosSequence.length) {\n        _this.setState({\n          fancyAnimation: false\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getFancyduserDisplay\", function (user, index, totalLength) {\n      var viewer = _this.props.appContext.viewer;\n      var _this$state = _this.state,\n          fancyd = _this$state.fancyd,\n          fancyStatus = _this$state.fancyStatus;\n      var first = index === 0;\n      var last = index === totalLength - 1;\n      var display;\n\n      if (fancyStatus === FancyStatus.AfterAddition || fancyStatus === FancyStatus.Addition) {\n        // designer satisfaction 1)\n        if (totalLength <= 8) {\n          display = Display.Inline;\n        } else {\n          if (first) {\n            display = Display.Inline;\n          }\n        }\n      } else if (fancyStatus === FancyStatus.AfterRemoval || fancyStatus === FancyStatus.Removal) {\n        if (first) {\n          display = Display.None;\n        } else if (last) {\n          display = Display.Inline;\n        }\n      } // designer satisfaction 2) https://app.asana.com/0/86925821949642/161445424426526\n\n\n      var indexLimit = 8;\n\n      if ((fancyStatus === FancyStatus.AfterAddition || fancyStatus === FancyStatus.Addition || fancyd && fancyStatus === FancyStatus.Idle) && index > indexLimit) {\n        display = Display.None;\n      } else if (fancyStatus === FancyStatus.Removal && index >= indexLimit) {\n        display = Display.None;\n      }\n\n      if (fancyStatus === FancyStatus.Idle && !fancyd && isUserEqual(user, viewer)) {\n        display = Display.None;\n      }\n\n      return display;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"toggleFancy\", function () {\n      toggleFancy(_this.props.article, _this.state, function (ns) {\n        _this.setState(ns);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleFancydStateOnLoadArticle\", function (article) {\n      if (article == null) {\n        article = _this.props.article;\n      }\n\n      _handleFancydStateOnLoadArticle(article.slug, {\n        fancyd: article.saved,\n        save_count: article.save_count\n      }, function (ns) {\n        _this.setState(ns);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleFancyClick\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n      var article = _this.props.article;\n\n      if (!_this.props.appContext.loggedIn) {\n        window.require_login && window.require_login(null, 'fancy_article', article.id);\n        return;\n      }\n\n      var _this$state2 = _this.state,\n          fancyAnimation = _this$state2.fancyAnimation,\n          fancyd = _this$state2.fancyd,\n          loading = _this$state2.loading;\n\n      if (loading) {\n        return;\n      }\n\n      if (!fancyd && !fancyAnimation) {\n        _this.setState({\n          fancyAnimation: true\n        }, function (_) {\n          _this.animateFancyBG();\n        });\n      }\n\n      if (!fancyd) {\n        MP('Fancy', {\n          article_id: article.id\n        });\n      } else {\n        MP('Unfancy', {\n          article_id: article.id\n        });\n      }\n\n      _this.toggleFancy();\n    });\n\n    _this.state = _this._getInitialState();\n\n    _this.fancyBGAnimationRef = function (element) {\n      _this.fancyBGAnimation = element;\n    };\n\n    return _this;\n  }\n\n  _createClass(FancydUsers, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.handleFancydStateOnLoadArticle();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var article = prevProps.article;\n      var np = this.props; // Thing has been updated.\n\n      if (article.id !== np.article.id || article.isCrawled !== np.article.isCrawled) {\n        this.handleFancydStateOnLoadArticle(article);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          _this$props$appContex = _this$props.appContext,\n          loggedIn = _this$props$appContex.loggedIn,\n          viewer = _this$props$appContex.viewer,\n          _this$props$article = _this$props.article,\n          saved_users = _this$props$article.saved_users,\n          user = _this$props$article.user;\n      var _this$state3 = this.state,\n          fancyd = _this$state3.fancyd,\n          fancyAnimation = _this$state3.fancyAnimation,\n          fancyStatus = _this$state3.fancyStatus;\n      var fancydUsers = [loggedIn && viewer, loggedIn && !isUserEqual(viewer, user) && user].concat(saved_users && saved_users.filter(function (fancydUser) {\n        return !isUserEqual(fancydUser, user) && !isUserEqual(fancydUser, viewer);\n      })).filter(function (e) {\n        return e;\n      });\n      var fancydUserAnimClass;\n\n      if (fancyStatus === FancyStatus.Addition) {\n        fancydUserAnimClass = \"add\";\n      } else if (fancyStatus === FancyStatus.Removal) {\n        fancydUserAnimClass = \"remove\";\n      } // designer satisfaction 1)\n      // If user is less than 2 we need to apply special class.\n      // In this way dont owner profile dont get 'consumed': https://app.asana.com/0/86925821949642/173945332708784\n\n\n      var userCountSufficiency = fancydUsers.length <= 2 ? '_insuff' : '_suff';\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"like\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"count\"\n      }, /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handleFancyClick,\n        className: classnames(\"button button-static fancy _count\", {\n          fancyd: fancyd,\n          loading: fancyAnimation\n        })\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        ref: this.fancyBGAnimationRef\n      }, /*#__PURE__*/React.createElement(\"i\", null)), this.getFancydCountString()), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"_fancyd\"\n      })), /*#__PURE__*/React.createElement(\"span\", {\n        className: classnames(\"fancyd_user\", fancydUserAnimClass, userCountSufficiency)\n      }, fancydUsers.map(function (user, index) {\n        var isViewer = isUserEqual(user, viewer);\n        return /*#__PURE__*/React.createElement(FancydUser, {\n          key: index,\n          user: user,\n          display: _this2.getFancyduserDisplay(user, index, fancydUsers.length),\n          isViewer: isViewer\n        });\n      })));\n    }\n  }]);\n\n  return FancydUsers;\n}(Component);","import _typeof from \"@babel/runtime/helpers/typeof\";\nimport _extends from \"@babel/runtime/helpers/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from \"react\";\nimport { convertThingsV1ToRest } from \"fancyutils\";\nimport ThingCard from \"./ThingCard\";\nimport ArticleCard from \"./ArticleCard\";\nimport { cache } from \"../cache\";\nexport var ThingList = /*#__PURE__*/function (_Component) {\n  _inherits(ThingList, _Component);\n\n  function ThingList() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ThingList);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ThingList)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"lastarticleID\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      showShare: false,\n      things: []\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"logExposed\", function (things) {\n      if (typeof window.LogExposed == \"undefined\") return;\n      things.forEach(function (thing) {\n        window.LogExposed.addLog(thing.id + \"\", \"article\");\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"updateThingList\", function (articleID) {\n      if (articleID == null) {\n        return;\n      }\n\n      $.ajax({\n        type: \"get\",\n        url: \"/rest-api/v1/articles/\".concat(articleID, \"/items\")\n      }).done(function (response) {\n        if (!_this.unmounted) {\n          var things = convertThingsV1ToRest(response.article_items).map(function (t) {\n            if (window.isWhitelabel && t.sales) {\n              var url = \"\".concat(t.html_url);\n              t.url = url;\n              t.html_url = url;\n            }\n\n            return t;\n          });\n\n          _this.logExposed(things);\n\n          _this.setState({\n            things: things\n          });\n        }\n      }).fail(function (xhr) {\n        console.warn(\"updateThingList():\", xhr);\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(ThingList, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // Initial loading\n      this.updateThingList(this.props.article.id, true);\n      var things = convertThingsV1ToRest(this.props.article.things);\n      this.setState({\n        things: things\n      });\n      this.lastarticleID = this.props.article.id;\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      var nextProps = this.props; // Article has changed, reset things.\n\n      if (this.lastarticleID !== nextProps.article.id) {\n        var idCopy = nextProps.article.id;\n        this.lastarticleID = idCopy;\n        this.updateThingList(nextProps.article.id, true);\n        var things = convertThingsV1ToRest(nextProps.article.things);\n        this.setState({\n          things: things\n        });\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.unmounted = true;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          article = _this$props.article,\n          appContext = _this$props.appContext,\n          loggedIn = _this$props.appContext.loggedIn,\n          hasPagination = _this$props.hasPagination;\n      var things = this.state.things;\n      var thingsHeader = article.options && article.options.item_header || null;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        id: \"content\",\n        className: \"content \".concat(things.length === 0 ? \"_empty\" : \"\")\n      }, thingsHeader && /*#__PURE__*/React.createElement(\"h3\", null, thingsHeader), things.length > 0 ? /*#__PURE__*/React.createElement(MaybePaginationWindow, {\n        hasPagination: hasPagination,\n        length: things.length\n      }, things && things.map(function (thing, idx) {\n        return /*#__PURE__*/React.createElement(ThingCard, _extends({\n          itemIdx: idx,\n          itemType: \"article\",\n          loggedIn: loggedIn,\n          key: \"timeline-recently-\".concat(idx),\n          onDelete: _this2.handleDelete,\n          viewer: _this2.props.appContext.viewer,\n          appContext: appContext,\n          showDelete: false\n        }, thing));\n      })) : null);\n    }\n  }]);\n\n  return ThingList;\n}(Component);\nexport var MaybePaginationWindow = /*#__PURE__*/function (_Component2) {\n  _inherits(MaybePaginationWindow, _Component2);\n\n  function MaybePaginationWindow() {\n    var _getPrototypeOf3;\n\n    var _this3;\n\n    _classCallCheck(this, MaybePaginationWindow);\n\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    _this3 = _possibleConstructorReturn(this, (_getPrototypeOf3 = _getPrototypeOf(MaybePaginationWindow)).call.apply(_getPrototypeOf3, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this3), \"state\", {\n      page: 0\n    });\n\n    _defineProperty(_assertThisInitialized(_this3), \"handlePrevClick\", function (e) {\n      e.preventDefault();\n      var minPage = 0;\n\n      _this3.setState({\n        page: Math.max(_this3.state.page - 1, minPage)\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this3), \"handleNextClick\", function (e) {\n      e.preventDefault();\n      var maxPage = Math.floor(_this3.props.length / 4) - 1;\n\n      _this3.setState({\n        page: Math.min(_this3.state.page + 1, maxPage)\n      });\n    });\n\n    return _this3;\n  }\n\n  _createClass(MaybePaginationWindow, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          hasPagination = _this$props2.hasPagination,\n          children = _this$props2.children;\n      var style = {};\n\n      if (hasPagination) {\n        style.transform = \"translateX(\".concat(-101 * this.state.page, \"%)\");\n      }\n\n      var stream = /*#__PURE__*/React.createElement(\"ol\", {\n        className: \"stream after\",\n        style: style\n      }, children);\n\n      if (hasPagination) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          className: \"itemSlide\"\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"itemSlideWrap\"\n        }, stream), /*#__PURE__*/React.createElement(\"a\", {\n          href: \"#\",\n          className: \"prev\",\n          onClick: this.handlePrevClick\n        }, \"Prev\"), /*#__PURE__*/React.createElement(\"a\", {\n          href: \"#\",\n          className: \"next\",\n          onClick: this.handleNextClick\n        }, \"Next\"));\n      } else {\n        return stream;\n      }\n    }\n  }]);\n\n  return MaybePaginationWindow;\n}(Component);\nexport var ArticleList = /*#__PURE__*/function (_Component3) {\n  _inherits(ArticleList, _Component3);\n\n  function ArticleList() {\n    var _getPrototypeOf4;\n\n    var _this4;\n\n    _classCallCheck(this, ArticleList);\n\n    for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      args[_key3] = arguments[_key3];\n    }\n\n    _this4 = _possibleConstructorReturn(this, (_getPrototypeOf4 = _getPrototypeOf(ArticleList)).call.apply(_getPrototypeOf4, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this4), \"lastarticleID\", null);\n\n    _defineProperty(_assertThisInitialized(_this4), \"state\", {\n      articles: [],\n      page: 1\n    });\n\n    _defineProperty(_assertThisInitialized(_this4), \"updateArticleList\", function (articleID) {\n      if (articleID == null) {\n        return;\n      }\n\n      $.ajax({\n        type: \"get\",\n        url: window.isWhitelabel ? \"/rest-api/v1/articles?limit=4&concise=true\" : \"/rest-api/v1/articles?featured\"\n      }).done(function (response) {\n        if (!_this4.unmounted) {\n          var articles = response.articles.filter(function (article) {\n            return article.id !== articleID;\n          });\n\n          _this4.setState({\n            articles: articles\n          });\n        }\n      }).fail(function (xhr) {\n        console.warn(\"updateArticleList():\", xhr);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this4), \"handlePrevClick\", function (event) {\n      event.preventDefault();\n      var $this = $(event.target);\n      if ($this.hasClass(\"disabled\")) return;\n\n      _this4.setState({\n        page: _this4.state.page - 1\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this4), \"handleNextClick\", function (event) {\n      event.preventDefault();\n      var $this = $(event.target);\n      if ($this.hasClass(\"disabled\")) return;\n\n      _this4.setState({\n        page: _this4.state.page + 1\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this4), \"getLeftOffset\", function () {\n      var _this4$state = _this4.state,\n          articles = _this4$state.articles,\n          page = _this4$state.page;\n      var left = (page - 1) * -860 - (page > 1 ? 4 : 0);\n      var lastPageNum = (articles.length / 4 | 0) + (articles.length % 4 > 0 ? 1 : 0);\n\n      if (articles.length > 4 && page >= lastPageNum) {\n        var CardWidth = 205;\n        var CardMargin = 10;\n        var CardContainerWidth = 970;\n        var CardContainerPadding = 14;\n        var max = (articles.length - 1) * CardMargin + articles.length * CardWidth - CardContainerWidth + CardContainerPadding * 2;\n        return \"\".concat(Math.max(left, -max), \"px\");\n      } else {\n        return left;\n      }\n    });\n\n    return _this4;\n  }\n\n  _createClass(ArticleList, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // Initial loading\n      this.updateArticleList(this.props.article.id);\n      this.lastarticleID = this.props.article.id;\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      var nextProps = this.props; // Article has changed, reset articles.\n\n      if (this.lastarticleID !== nextProps.article.id) {\n        var idCopy = nextProps.article.id;\n        this.lastarticleID = idCopy;\n        this.updateArticleList(nextProps.article.id, true);\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.unmounted = true;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var appContext = this.props.appContext;\n      var _this$state = this.state,\n          articles = _this$state.articles,\n          page = _this$state.page;\n      var maxPage = Math.ceil(articles.length / 4);\n      var prevDisabled = page == 1;\n      var nextDisabled = page == maxPage;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        id: \"sidebar\"\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper recommend-article\"\n      }, /*#__PURE__*/React.createElement(\"h3\", {\n        className: \"stit\"\n      }, \"MORE ARTICLES\"), articles.length ? /*#__PURE__*/React.createElement(\"div\", {\n        className: \"article_wrap\",\n        style: {\n          left: this.getLeftOffset()\n        }\n      }, articles && articles.map(function (article, idx) {\n        return /*#__PURE__*/React.createElement(ArticleCard, _extends({\n          key: article.id,\n          itemIdx: idx,\n          appContext: appContext\n        }, article));\n      })) : /*#__PURE__*/React.createElement(\"div\", null), articles.length > 4 && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"paging\"\n      }, /*#__PURE__*/React.createElement(\"a\", {\n        href: \"#\",\n        className: \"\".concat(prevDisabled ? \"disabled\" : \"\", \" prev\"),\n        onClick: this.handlePrevClick\n      }, \"Prev\"), /*#__PURE__*/React.createElement(\"a\", {\n        href: \"#\",\n        className: \"\".concat(nextDisabled ? \"disabled\" : \"\", \" next\"),\n        onClick: this.handleNextClick\n      }, \"Next\"))));\n    }\n  }]);\n\n  return ArticleList;\n}(Component);\nexport var AdminHeader = /*#__PURE__*/function (_Component4) {\n  _inherits(AdminHeader, _Component4);\n\n  function AdminHeader(props) {\n    var _this5;\n\n    _classCallCheck(this, AdminHeader);\n\n    _this5 = _possibleConstructorReturn(this, _getPrototypeOf(AdminHeader).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this5), \"handleLiveClick\", function (event) {\n      event.preventDefault();\n\n      var self = _assertThisInitialized(_this5);\n\n      var $this = $(event.target);\n      var article = _this5.props.article;\n      var message = \"Are you sure you want to set \".concat(article.title, \" live on \").concat(window.isWhitelabel ? \"Gear\" : \"Fancy\", \"?\");\n      if ($this.hasClass(\"on\")) message = \"Are you sure you want to hide \".concat(article.title, \" from \").concat(window.isWhitelabel ? \"Gear\" : \"Fancy\", \"?\");\n      var original_labels = window.alertify.labels;\n      window.alertify.set({\n        labels: {\n          ok: $this.hasClass(\"on\") ? \"Hide\" : \"Set Live\",\n          cancel: \"Cancel\"\n        }\n      });\n      window.alertify.confirm(message, function (yes) {\n        if (yes) {\n          var is_active = !$this.hasClass(\"on\");\n          $.post(\"/_admin/articles/update_active.json\", {\n            article_id: article.id,\n            is_active: is_active\n          }, function (json) {\n            if (json.error) {\n              window.alertify.alert(json.error);\n            } else {\n              window.alertify.alert(is_active ? \"Activated\" : \"Deactivated\");\n              self.setState({\n                is_active: is_active\n              });\n              cache.update(self.props.article.slug, undefined, \"is_active\", is_active);\n            }\n          });\n        }\n      });\n      window.alertify.set({\n        labels: original_labels\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this5), \"handleEditArticleClick\", function (e) {\n      e.preventDefault();\n      var article = _this5.props.article;\n      window.open(\"/_admin/articles/edit?id=\".concat(article.id));\n    });\n\n    _this5.state = {\n      is_active: props.article.is_active\n    };\n    return _this5;\n  }\n\n  _createClass(AdminHeader, [{\n    key: \"render\",\n    value: function render() {\n      var is_active = this.state.is_active;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"admin-header\"\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"inner\"\n      }, /*#__PURE__*/React.createElement(\"h2\", null, \"Admin Panel\"), /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handleEditArticleClick\n      }, \"Edit Article\"), /*#__PURE__*/React.createElement(\"label\", null, \"Live\"), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"\".concat(is_active ? \"on\" : \"\", \" btn-switch\"),\n        onClick: this.handleLiveClick\n      })));\n    }\n  }]);\n\n  return AdminHeader;\n}(Component);\nexport function initGallery(container) {\n  /*! Hammer.JS - v2.0.8 - 2016-04-23\n  * http://hammerjs.github.io/\n  *\n  * Copyright (c) 2016 Jorik Tangelder;\n  * Licensed under the MIT license */\n  !function (a, b, c, d) {\n    \"use strict\";\n\n    function e(a, b, c) {\n      return setTimeout(j(a, c), b);\n    }\n\n    function f(a, b, c) {\n      return Array.isArray(a) ? (g(a, c[b], c), !0) : !1;\n    }\n\n    function g(a, b, c) {\n      var e;\n      if (a) if (a.forEach) a.forEach(b, c);else if (a.length !== d) for (e = 0; e < a.length;) {\n        b.call(c, a[e], e, a), e++;\n      } else for (e in a) {\n        a.hasOwnProperty(e) && b.call(c, a[e], e, a);\n      }\n    }\n\n    function h(b, c, d) {\n      var e = \"DEPRECATED METHOD: \" + c + \"\\n\" + d + \" AT \\n\";\n      return function () {\n        var c = new Error(\"get-stack-trace\"),\n            d = c && c.stack ? c.stack.replace(/^[^\\(]+?[\\n$]/gm, \"\").replace(/^\\s+at\\s+/gm, \"\").replace(/^Object.<anonymous>\\s*\\(/gm, \"{anonymous}()@\") : \"Unknown Stack Trace\",\n            f = a.console && (a.console.warn || a.console.log);\n        return f && f.call(a.console, e, d), b.apply(this, arguments);\n      };\n    }\n\n    function i(a, b, c) {\n      var d,\n          e = b.prototype;\n      d = a.prototype = Object.create(e), d.constructor = a, d._super = e, c && la(d, c);\n    }\n\n    function j(a, b) {\n      return function () {\n        return a.apply(b, arguments);\n      };\n    }\n\n    function k(a, b) {\n      return _typeof(a) == oa ? a.apply(b ? b[0] || d : d, b) : a;\n    }\n\n    function l(a, b) {\n      return a === d ? b : a;\n    }\n\n    function m(a, b, c) {\n      g(q(b), function (b) {\n        a.addEventListener(b, c, !1);\n      });\n    }\n\n    function n(a, b, c) {\n      g(q(b), function (b) {\n        a.removeEventListener(b, c, !1);\n      });\n    }\n\n    function o(a, b) {\n      for (; a;) {\n        if (a == b) return !0;\n        a = a.parentNode;\n      }\n\n      return !1;\n    }\n\n    function p(a, b) {\n      return a.indexOf(b) > -1;\n    }\n\n    function q(a) {\n      return a.trim().split(/\\s+/g);\n    }\n\n    function r(a, b, c) {\n      if (a.indexOf && !c) return a.indexOf(b);\n\n      for (var d = 0; d < a.length;) {\n        if (c && a[d][c] == b || !c && a[d] === b) return d;\n        d++;\n      }\n\n      return -1;\n    }\n\n    function s(a) {\n      return Array.prototype.slice.call(a, 0);\n    }\n\n    function t(a, b, c) {\n      for (var d = [], e = [], f = 0; f < a.length;) {\n        var g = b ? a[f][b] : a[f];\n        r(e, g) < 0 && d.push(a[f]), e[f] = g, f++;\n      }\n\n      return c && (d = b ? d.sort(function (a, c) {\n        return a[b] > c[b];\n      }) : d.sort()), d;\n    }\n\n    function u(a, b) {\n      for (var c, e, f = b[0].toUpperCase() + b.slice(1), g = 0; g < ma.length;) {\n        if (c = ma[g], e = c ? c + f : b, e in a) return e;\n        g++;\n      }\n\n      return d;\n    }\n\n    function v() {\n      return ua++;\n    }\n\n    function w(b) {\n      var c = b.ownerDocument || b;\n      return c.defaultView || c.parentWindow || a;\n    }\n\n    function x(a, b) {\n      var c = this;\n      this.manager = a, this.callback = b, this.element = a.element, this.target = a.options.inputTarget, this.domHandler = function (b) {\n        k(a.options.enable, [a]) && c.handler(b);\n      }, this.init();\n    }\n\n    function y(a) {\n      var b,\n          c = a.options.inputClass;\n      return new (b = c ? c : xa ? M : ya ? P : wa ? R : L)(a, z);\n    }\n\n    function z(a, b, c) {\n      var d = c.pointers.length,\n          e = c.changedPointers.length,\n          f = b & Ea && d - e === 0,\n          g = b & (Ga | Ha) && d - e === 0;\n      c.isFirst = !!f, c.isFinal = !!g, f && (a.session = {}), c.eventType = b, A(a, c), a.emit(\"hammer.input\", c), a.recognize(c), a.session.prevInput = c;\n    }\n\n    function A(a, b) {\n      var c = a.session,\n          d = b.pointers,\n          e = d.length;\n      c.firstInput || (c.firstInput = D(b)), e > 1 && !c.firstMultiple ? c.firstMultiple = D(b) : 1 === e && (c.firstMultiple = !1);\n      var f = c.firstInput,\n          g = c.firstMultiple,\n          h = g ? g.center : f.center,\n          i = b.center = E(d);\n      b.timeStamp = ra(), b.deltaTime = b.timeStamp - f.timeStamp, b.angle = I(h, i), b.distance = H(h, i), B(c, b), b.offsetDirection = G(b.deltaX, b.deltaY);\n      var j = F(b.deltaTime, b.deltaX, b.deltaY);\n      b.overallVelocityX = j.x, b.overallVelocityY = j.y, b.overallVelocity = qa(j.x) > qa(j.y) ? j.x : j.y, b.scale = g ? K(g.pointers, d) : 1, b.rotation = g ? J(g.pointers, d) : 0, b.maxPointers = c.prevInput ? b.pointers.length > c.prevInput.maxPointers ? b.pointers.length : c.prevInput.maxPointers : b.pointers.length, C(c, b);\n      var k = a.element;\n      o(b.srcEvent.target, k) && (k = b.srcEvent.target), b.target = k;\n    }\n\n    function B(a, b) {\n      var c = b.center,\n          d = a.offsetDelta || {},\n          e = a.prevDelta || {},\n          f = a.prevInput || {};\n      b.eventType !== Ea && f.eventType !== Ga || (e = a.prevDelta = {\n        x: f.deltaX || 0,\n        y: f.deltaY || 0\n      }, d = a.offsetDelta = {\n        x: c.x,\n        y: c.y\n      }), b.deltaX = e.x + (c.x - d.x), b.deltaY = e.y + (c.y - d.y);\n    }\n\n    function C(a, b) {\n      var c,\n          e,\n          f,\n          g,\n          h = a.lastInterval || b,\n          i = b.timeStamp - h.timeStamp;\n\n      if (b.eventType != Ha && (i > Da || h.velocity === d)) {\n        var j = b.deltaX - h.deltaX,\n            k = b.deltaY - h.deltaY,\n            l = F(i, j, k);\n        e = l.x, f = l.y, c = qa(l.x) > qa(l.y) ? l.x : l.y, g = G(j, k), a.lastInterval = b;\n      } else c = h.velocity, e = h.velocityX, f = h.velocityY, g = h.direction;\n\n      b.velocity = c, b.velocityX = e, b.velocityY = f, b.direction = g;\n    }\n\n    function D(a) {\n      for (var b = [], c = 0; c < a.pointers.length;) {\n        b[c] = {\n          clientX: pa(a.pointers[c].clientX),\n          clientY: pa(a.pointers[c].clientY)\n        }, c++;\n      }\n\n      return {\n        timeStamp: ra(),\n        pointers: b,\n        center: E(b),\n        deltaX: a.deltaX,\n        deltaY: a.deltaY\n      };\n    }\n\n    function E(a) {\n      var b = a.length;\n      if (1 === b) return {\n        x: pa(a[0].clientX),\n        y: pa(a[0].clientY)\n      };\n\n      for (var c = 0, d = 0, e = 0; b > e;) {\n        c += a[e].clientX, d += a[e].clientY, e++;\n      }\n\n      return {\n        x: pa(c / b),\n        y: pa(d / b)\n      };\n    }\n\n    function F(a, b, c) {\n      return {\n        x: b / a || 0,\n        y: c / a || 0\n      };\n    }\n\n    function G(a, b) {\n      return a === b ? Ia : qa(a) >= qa(b) ? 0 > a ? Ja : Ka : 0 > b ? La : Ma;\n    }\n\n    function H(a, b, c) {\n      c || (c = Qa);\n      var d = b[c[0]] - a[c[0]],\n          e = b[c[1]] - a[c[1]];\n      return Math.sqrt(d * d + e * e);\n    }\n\n    function I(a, b, c) {\n      c || (c = Qa);\n      var d = b[c[0]] - a[c[0]],\n          e = b[c[1]] - a[c[1]];\n      return 180 * Math.atan2(e, d) / Math.PI;\n    }\n\n    function J(a, b) {\n      return I(b[1], b[0], Ra) + I(a[1], a[0], Ra);\n    }\n\n    function K(a, b) {\n      return H(b[0], b[1], Ra) / H(a[0], a[1], Ra);\n    }\n\n    function L() {\n      this.evEl = Ta, this.evWin = Ua, this.pressed = !1, x.apply(this, arguments);\n    }\n\n    function M() {\n      this.evEl = Xa, this.evWin = Ya, x.apply(this, arguments), this.store = this.manager.session.pointerEvents = [];\n    }\n\n    function N() {\n      this.evTarget = $a, this.evWin = _a, this.started = !1, x.apply(this, arguments);\n    }\n\n    function O(a, b) {\n      var c = s(a.touches),\n          d = s(a.changedTouches);\n      return b & (Ga | Ha) && (c = t(c.concat(d), \"identifier\", !0)), [c, d];\n    }\n\n    function P() {\n      this.evTarget = bb, this.targetIds = {}, x.apply(this, arguments);\n    }\n\n    function Q(a, b) {\n      var c = s(a.touches),\n          d = this.targetIds;\n      if (b & (Ea | Fa) && 1 === c.length) return d[c[0].identifier] = !0, [c, c];\n      var e,\n          f,\n          g = s(a.changedTouches),\n          h = [],\n          i = this.target;\n      if (f = c.filter(function (a) {\n        return o(a.target, i);\n      }), b === Ea) for (e = 0; e < f.length;) {\n        d[f[e].identifier] = !0, e++;\n      }\n\n      for (e = 0; e < g.length;) {\n        d[g[e].identifier] && h.push(g[e]), b & (Ga | Ha) && delete d[g[e].identifier], e++;\n      }\n\n      return h.length ? [t(f.concat(h), \"identifier\", !0), h] : void 0;\n    }\n\n    function R() {\n      x.apply(this, arguments);\n      var a = j(this.handler, this);\n      this.touch = new P(this.manager, a), this.mouse = new L(this.manager, a), this.primaryTouch = null, this.lastTouches = [];\n    }\n\n    function S(a, b) {\n      a & Ea ? (this.primaryTouch = b.changedPointers[0].identifier, T.call(this, b)) : a & (Ga | Ha) && T.call(this, b);\n    }\n\n    function T(a) {\n      var b = a.changedPointers[0];\n\n      if (b.identifier === this.primaryTouch) {\n        var c = {\n          x: b.clientX,\n          y: b.clientY\n        };\n        this.lastTouches.push(c);\n\n        var d = this.lastTouches,\n            e = function e() {\n          var a = d.indexOf(c);\n          a > -1 && d.splice(a, 1);\n        };\n\n        setTimeout(e, cb);\n      }\n    }\n\n    function U(a) {\n      for (var b = a.srcEvent.clientX, c = a.srcEvent.clientY, d = 0; d < this.lastTouches.length; d++) {\n        var e = this.lastTouches[d],\n            f = Math.abs(b - e.x),\n            g = Math.abs(c - e.y);\n        if (db >= f && db >= g) return !0;\n      }\n\n      return !1;\n    }\n\n    function V(a, b) {\n      this.manager = a, this.set(b);\n    }\n\n    function W(a) {\n      if (p(a, jb)) return jb;\n      var b = p(a, kb),\n          c = p(a, lb);\n      return b && c ? jb : b || c ? b ? kb : lb : p(a, ib) ? ib : hb;\n    }\n\n    function X() {\n      if (!fb) return !1;\n      var b = {},\n          c = a.CSS && a.CSS.supports;\n      return [\"auto\", \"manipulation\", \"pan-y\", \"pan-x\", \"pan-x pan-y\", \"none\"].forEach(function (d) {\n        b[d] = c ? a.CSS.supports(\"touch-action\", d) : !0;\n      }), b;\n    }\n\n    function Y(a) {\n      this.options = la({}, this.defaults, a || {}), this.id = v(), this.manager = null, this.options.enable = l(this.options.enable, !0), this.state = nb, this.simultaneous = {}, this.requireFail = [];\n    }\n\n    function Z(a) {\n      return a & sb ? \"cancel\" : a & qb ? \"end\" : a & pb ? \"move\" : a & ob ? \"start\" : \"\";\n    }\n\n    function $(a) {\n      return a == Ma ? \"down\" : a == La ? \"up\" : a == Ja ? \"left\" : a == Ka ? \"right\" : \"\";\n    }\n\n    function _(a, b) {\n      var c = b.manager;\n      return c ? c.get(a) : a;\n    }\n\n    function aa() {\n      Y.apply(this, arguments);\n    }\n\n    function ba() {\n      aa.apply(this, arguments), this.pX = null, this.pY = null;\n    }\n\n    function ca() {\n      aa.apply(this, arguments);\n    }\n\n    function da() {\n      Y.apply(this, arguments), this._timer = null, this._input = null;\n    }\n\n    function ea() {\n      aa.apply(this, arguments);\n    }\n\n    function fa() {\n      aa.apply(this, arguments);\n    }\n\n    function ga() {\n      Y.apply(this, arguments), this.pTime = !1, this.pCenter = !1, this._timer = null, this._input = null, this.count = 0;\n    }\n\n    function ha(a, b) {\n      return b = b || {}, b.recognizers = l(b.recognizers, ha.defaults.preset), new ia(a, b);\n    }\n\n    function ia(a, b) {\n      this.options = la({}, ha.defaults, b || {}), this.options.inputTarget = this.options.inputTarget || a, this.handlers = {}, this.session = {}, this.recognizers = [], this.oldCssProps = {}, this.element = a, this.input = y(this), this.touchAction = new V(this, this.options.touchAction), ja(this, !0), g(this.options.recognizers, function (a) {\n        var b = this.add(new a[0](a[1]));\n        a[2] && b.recognizeWith(a[2]), a[3] && b.requireFailure(a[3]);\n      }, this);\n    }\n\n    function ja(a, b) {\n      var c = a.element;\n\n      if (c.style) {\n        var d;\n        g(a.options.cssProps, function (e, f) {\n          d = u(c.style, f), b ? (a.oldCssProps[d] = c.style[d], c.style[d] = e) : c.style[d] = a.oldCssProps[d] || \"\";\n        }), b || (a.oldCssProps = {});\n      }\n    }\n\n    function ka(a, c) {\n      var d = b.createEvent(\"Event\");\n      d.initEvent(a, !0, !0), d.gesture = c, c.target.dispatchEvent(d);\n    }\n\n    var la,\n        ma = [\"\", \"webkit\", \"Moz\", \"MS\", \"ms\", \"o\"],\n        na = b.createElement(\"div\"),\n        oa = \"function\",\n        pa = Math.round,\n        qa = Math.abs,\n        ra = Date.now;\n    la = \"function\" != typeof Object.assign ? function (a) {\n      if (a === d || null === a) throw new TypeError(\"Cannot convert undefined or null to object\");\n\n      for (var b = Object(a), c = 1; c < arguments.length; c++) {\n        var e = arguments[c];\n        if (e !== d && null !== e) for (var f in e) {\n          e.hasOwnProperty(f) && (b[f] = e[f]);\n        }\n      }\n\n      return b;\n    } : Object.assign;\n    var sa = h(function (a, b, c) {\n      for (var e = Object.keys(b), f = 0; f < e.length;) {\n        (!c || c && a[e[f]] === d) && (a[e[f]] = b[e[f]]), f++;\n      }\n\n      return a;\n    }, \"extend\", \"Use `assign`.\"),\n        ta = h(function (a, b) {\n      return sa(a, b, !0);\n    }, \"merge\", \"Use `assign`.\"),\n        ua = 1,\n        va = /mobile|tablet|ip(ad|hone|od)|android/i,\n        wa = (\"ontouchstart\" in a),\n        xa = u(a, \"PointerEvent\") !== d,\n        ya = wa && va.test(navigator.userAgent),\n        za = \"touch\",\n        Aa = \"pen\",\n        Ba = \"mouse\",\n        Ca = \"kinect\",\n        Da = 25,\n        Ea = 1,\n        Fa = 2,\n        Ga = 4,\n        Ha = 8,\n        Ia = 1,\n        Ja = 2,\n        Ka = 4,\n        La = 8,\n        Ma = 16,\n        Na = Ja | Ka,\n        Oa = La | Ma,\n        Pa = Na | Oa,\n        Qa = [\"x\", \"y\"],\n        Ra = [\"clientX\", \"clientY\"];\n    x.prototype = {\n      handler: function handler() {},\n      init: function init() {\n        this.evEl && m(this.element, this.evEl, this.domHandler), this.evTarget && m(this.target, this.evTarget, this.domHandler), this.evWin && m(w(this.element), this.evWin, this.domHandler);\n      },\n      destroy: function destroy() {\n        this.evEl && n(this.element, this.evEl, this.domHandler), this.evTarget && n(this.target, this.evTarget, this.domHandler), this.evWin && n(w(this.element), this.evWin, this.domHandler);\n      }\n    };\n    var Sa = {\n      mousedown: Ea,\n      mousemove: Fa,\n      mouseup: Ga\n    },\n        Ta = \"mousedown\",\n        Ua = \"mousemove mouseup\";\n    i(L, x, {\n      handler: function handler(a) {\n        var b = Sa[a.type];\n        b & Ea && 0 === a.button && (this.pressed = !0), b & Fa && 1 !== a.which && (b = Ga), this.pressed && (b & Ga && (this.pressed = !1), this.callback(this.manager, b, {\n          pointers: [a],\n          changedPointers: [a],\n          pointerType: Ba,\n          srcEvent: a\n        }));\n      }\n    });\n    var Va = {\n      pointerdown: Ea,\n      pointermove: Fa,\n      pointerup: Ga,\n      pointercancel: Ha,\n      pointerout: Ha\n    },\n        Wa = {\n      2: za,\n      3: Aa,\n      4: Ba,\n      5: Ca\n    },\n        Xa = \"pointerdown\",\n        Ya = \"pointermove pointerup pointercancel\";\n    a.MSPointerEvent && !a.PointerEvent && (Xa = \"MSPointerDown\", Ya = \"MSPointerMove MSPointerUp MSPointerCancel\"), i(M, x, {\n      handler: function handler(a) {\n        var b = this.store,\n            c = !1,\n            d = a.type.toLowerCase().replace(\"ms\", \"\"),\n            e = Va[d],\n            f = Wa[a.pointerType] || a.pointerType,\n            g = f == za,\n            h = r(b, a.pointerId, \"pointerId\");\n        e & Ea && (0 === a.button || g) ? 0 > h && (b.push(a), h = b.length - 1) : e & (Ga | Ha) && (c = !0), 0 > h || (b[h] = a, this.callback(this.manager, e, {\n          pointers: b,\n          changedPointers: [a],\n          pointerType: f,\n          srcEvent: a\n        }), c && b.splice(h, 1));\n      }\n    });\n    var Za = {\n      touchstart: Ea,\n      touchmove: Fa,\n      touchend: Ga,\n      touchcancel: Ha\n    },\n        $a = \"touchstart\",\n        _a = \"touchstart touchmove touchend touchcancel\";\n    i(N, x, {\n      handler: function handler(a) {\n        var b = Za[a.type];\n\n        if (b === Ea && (this.started = !0), this.started) {\n          var c = O.call(this, a, b);\n          b & (Ga | Ha) && c[0].length - c[1].length === 0 && (this.started = !1), this.callback(this.manager, b, {\n            pointers: c[0],\n            changedPointers: c[1],\n            pointerType: za,\n            srcEvent: a\n          });\n        }\n      }\n    });\n    var ab = {\n      touchstart: Ea,\n      touchmove: Fa,\n      touchend: Ga,\n      touchcancel: Ha\n    },\n        bb = \"touchstart touchmove touchend touchcancel\";\n    i(P, x, {\n      handler: function handler(a) {\n        var b = ab[a.type],\n            c = Q.call(this, a, b);\n        c && this.callback(this.manager, b, {\n          pointers: c[0],\n          changedPointers: c[1],\n          pointerType: za,\n          srcEvent: a\n        });\n      }\n    });\n    var cb = 2500,\n        db = 25;\n    i(R, x, {\n      handler: function handler(a, b, c) {\n        var d = c.pointerType == za,\n            e = c.pointerType == Ba;\n\n        if (!(e && c.sourceCapabilities && c.sourceCapabilities.firesTouchEvents)) {\n          if (d) S.call(this, b, c);else if (e && U.call(this, c)) return;\n          this.callback(a, b, c);\n        }\n      },\n      destroy: function destroy() {\n        this.touch.destroy(), this.mouse.destroy();\n      }\n    });\n    var eb = u(na.style, \"touchAction\"),\n        fb = eb !== d,\n        gb = \"compute\",\n        hb = \"auto\",\n        ib = \"manipulation\",\n        jb = \"none\",\n        kb = \"pan-x\",\n        lb = \"pan-y\",\n        mb = X();\n    V.prototype = {\n      set: function set(a) {\n        a == gb && (a = this.compute()), fb && this.manager.element.style && mb[a] && (this.manager.element.style[eb] = a), this.actions = a.toLowerCase().trim();\n      },\n      update: function update() {\n        this.set(this.manager.options.touchAction);\n      },\n      compute: function compute() {\n        var a = [];\n        return g(this.manager.recognizers, function (b) {\n          k(b.options.enable, [b]) && (a = a.concat(b.getTouchAction()));\n        }), W(a.join(\" \"));\n      },\n      preventDefaults: function preventDefaults(a) {\n        var b = a.srcEvent,\n            c = a.offsetDirection;\n        if (this.manager.session.prevented) return void b.preventDefault();\n        var d = this.actions,\n            e = p(d, jb) && !mb[jb],\n            f = p(d, lb) && !mb[lb],\n            g = p(d, kb) && !mb[kb];\n\n        if (e) {\n          var h = 1 === a.pointers.length,\n              i = a.distance < 2,\n              j = a.deltaTime < 250;\n          if (h && i && j) return;\n        }\n\n        return g && f ? void 0 : e || f && c & Na || g && c & Oa ? this.preventSrc(b) : void 0;\n      },\n      preventSrc: function preventSrc(a) {\n        this.manager.session.prevented = !0, a.preventDefault();\n      }\n    };\n    var nb = 1,\n        ob = 2,\n        pb = 4,\n        qb = 8,\n        rb = qb,\n        sb = 16,\n        tb = 32;\n    Y.prototype = {\n      defaults: {},\n      set: function set(a) {\n        return la(this.options, a), this.manager && this.manager.touchAction.update(), this;\n      },\n      recognizeWith: function recognizeWith(a) {\n        if (f(a, \"recognizeWith\", this)) return this;\n        var b = this.simultaneous;\n        return a = _(a, this), b[a.id] || (b[a.id] = a, a.recognizeWith(this)), this;\n      },\n      dropRecognizeWith: function dropRecognizeWith(a) {\n        return f(a, \"dropRecognizeWith\", this) ? this : (a = _(a, this), delete this.simultaneous[a.id], this);\n      },\n      requireFailure: function requireFailure(a) {\n        if (f(a, \"requireFailure\", this)) return this;\n        var b = this.requireFail;\n        return a = _(a, this), -1 === r(b, a) && (b.push(a), a.requireFailure(this)), this;\n      },\n      dropRequireFailure: function dropRequireFailure(a) {\n        if (f(a, \"dropRequireFailure\", this)) return this;\n        a = _(a, this);\n        var b = r(this.requireFail, a);\n        return b > -1 && this.requireFail.splice(b, 1), this;\n      },\n      hasRequireFailures: function hasRequireFailures() {\n        return this.requireFail.length > 0;\n      },\n      canRecognizeWith: function canRecognizeWith(a) {\n        return !!this.simultaneous[a.id];\n      },\n      emit: function emit(a) {\n        function b(b) {\n          c.manager.emit(b, a);\n        }\n\n        var c = this,\n            d = this.state;\n        qb > d && b(c.options.event + Z(d)), b(c.options.event), a.additionalEvent && b(a.additionalEvent), d >= qb && b(c.options.event + Z(d));\n      },\n      tryEmit: function tryEmit(a) {\n        return this.canEmit() ? this.emit(a) : void (this.state = tb);\n      },\n      canEmit: function canEmit() {\n        for (var a = 0; a < this.requireFail.length;) {\n          if (!(this.requireFail[a].state & (tb | nb))) return !1;\n          a++;\n        }\n\n        return !0;\n      },\n      recognize: function recognize(a) {\n        var b = la({}, a);\n        return k(this.options.enable, [this, b]) ? (this.state & (rb | sb | tb) && (this.state = nb), this.state = this.process(b), void (this.state & (ob | pb | qb | sb) && this.tryEmit(b))) : (this.reset(), void (this.state = tb));\n      },\n      process: function process(a) {},\n      getTouchAction: function getTouchAction() {},\n      reset: function reset() {}\n    }, i(aa, Y, {\n      defaults: {\n        pointers: 1\n      },\n      attrTest: function attrTest(a) {\n        var b = this.options.pointers;\n        return 0 === b || a.pointers.length === b;\n      },\n      process: function process(a) {\n        var b = this.state,\n            c = a.eventType,\n            d = b & (ob | pb),\n            e = this.attrTest(a);\n        return d && (c & Ha || !e) ? b | sb : d || e ? c & Ga ? b | qb : b & ob ? b | pb : ob : tb;\n      }\n    }), i(ba, aa, {\n      defaults: {\n        event: \"pan\",\n        threshold: 10,\n        pointers: 1,\n        direction: Pa\n      },\n      getTouchAction: function getTouchAction() {\n        var a = this.options.direction,\n            b = [];\n        return a & Na && b.push(lb), a & Oa && b.push(kb), b;\n      },\n      directionTest: function directionTest(a) {\n        var b = this.options,\n            c = !0,\n            d = a.distance,\n            e = a.direction,\n            f = a.deltaX,\n            g = a.deltaY;\n        return e & b.direction || (b.direction & Na ? (e = 0 === f ? Ia : 0 > f ? Ja : Ka, c = f != this.pX, d = Math.abs(a.deltaX)) : (e = 0 === g ? Ia : 0 > g ? La : Ma, c = g != this.pY, d = Math.abs(a.deltaY))), a.direction = e, c && d > b.threshold && e & b.direction;\n      },\n      attrTest: function attrTest(a) {\n        return aa.prototype.attrTest.call(this, a) && (this.state & ob || !(this.state & ob) && this.directionTest(a));\n      },\n      emit: function emit(a) {\n        this.pX = a.deltaX, this.pY = a.deltaY;\n        var b = $(a.direction);\n        b && (a.additionalEvent = this.options.event + b), this._super.emit.call(this, a);\n      }\n    }), i(ca, aa, {\n      defaults: {\n        event: \"pinch\",\n        threshold: 0,\n        pointers: 2\n      },\n      getTouchAction: function getTouchAction() {\n        return [jb];\n      },\n      attrTest: function attrTest(a) {\n        return this._super.attrTest.call(this, a) && (Math.abs(a.scale - 1) > this.options.threshold || this.state & ob);\n      },\n      emit: function emit(a) {\n        if (1 !== a.scale) {\n          var b = a.scale < 1 ? \"in\" : \"out\";\n          a.additionalEvent = this.options.event + b;\n        }\n\n        this._super.emit.call(this, a);\n      }\n    }), i(da, Y, {\n      defaults: {\n        event: \"press\",\n        pointers: 1,\n        time: 251,\n        threshold: 9\n      },\n      getTouchAction: function getTouchAction() {\n        return [hb];\n      },\n      process: function process(a) {\n        var b = this.options,\n            c = a.pointers.length === b.pointers,\n            d = a.distance < b.threshold,\n            f = a.deltaTime > b.time;\n        if (this._input = a, !d || !c || a.eventType & (Ga | Ha) && !f) this.reset();else if (a.eventType & Ea) this.reset(), this._timer = e(function () {\n          this.state = rb, this.tryEmit();\n        }, b.time, this);else if (a.eventType & Ga) return rb;\n        return tb;\n      },\n      reset: function reset() {\n        clearTimeout(this._timer);\n      },\n      emit: function emit(a) {\n        this.state === rb && (a && a.eventType & Ga ? this.manager.emit(this.options.event + \"up\", a) : (this._input.timeStamp = ra(), this.manager.emit(this.options.event, this._input)));\n      }\n    }), i(ea, aa, {\n      defaults: {\n        event: \"rotate\",\n        threshold: 0,\n        pointers: 2\n      },\n      getTouchAction: function getTouchAction() {\n        return [jb];\n      },\n      attrTest: function attrTest(a) {\n        return this._super.attrTest.call(this, a) && (Math.abs(a.rotation) > this.options.threshold || this.state & ob);\n      }\n    }), i(fa, aa, {\n      defaults: {\n        event: \"swipe\",\n        threshold: 10,\n        velocity: .3,\n        direction: Na | Oa,\n        pointers: 1\n      },\n      getTouchAction: function getTouchAction() {\n        return ba.prototype.getTouchAction.call(this);\n      },\n      attrTest: function attrTest(a) {\n        var b,\n            c = this.options.direction;\n        return c & (Na | Oa) ? b = a.overallVelocity : c & Na ? b = a.overallVelocityX : c & Oa && (b = a.overallVelocityY), this._super.attrTest.call(this, a) && c & a.offsetDirection && a.distance > this.options.threshold && a.maxPointers == this.options.pointers && qa(b) > this.options.velocity && a.eventType & Ga;\n      },\n      emit: function emit(a) {\n        var b = $(a.offsetDirection);\n        b && this.manager.emit(this.options.event + b, a), this.manager.emit(this.options.event, a);\n      }\n    }), i(ga, Y, {\n      defaults: {\n        event: \"tap\",\n        pointers: 1,\n        taps: 1,\n        interval: 300,\n        time: 250,\n        threshold: 9,\n        posThreshold: 10\n      },\n      getTouchAction: function getTouchAction() {\n        return [ib];\n      },\n      process: function process(a) {\n        var b = this.options,\n            c = a.pointers.length === b.pointers,\n            d = a.distance < b.threshold,\n            f = a.deltaTime < b.time;\n        if (this.reset(), a.eventType & Ea && 0 === this.count) return this.failTimeout();\n\n        if (d && f && c) {\n          if (a.eventType != Ga) return this.failTimeout();\n          var g = this.pTime ? a.timeStamp - this.pTime < b.interval : !0,\n              h = !this.pCenter || H(this.pCenter, a.center) < b.posThreshold;\n          this.pTime = a.timeStamp, this.pCenter = a.center, h && g ? this.count += 1 : this.count = 1, this._input = a;\n          var i = this.count % b.taps;\n          if (0 === i) return this.hasRequireFailures() ? (this._timer = e(function () {\n            this.state = rb, this.tryEmit();\n          }, b.interval, this), ob) : rb;\n        }\n\n        return tb;\n      },\n      failTimeout: function failTimeout() {\n        return this._timer = e(function () {\n          this.state = tb;\n        }, this.options.interval, this), tb;\n      },\n      reset: function reset() {\n        clearTimeout(this._timer);\n      },\n      emit: function emit() {\n        this.state == rb && (this._input.tapCount = this.count, this.manager.emit(this.options.event, this._input));\n      }\n    }), ha.VERSION = \"2.0.8\", ha.defaults = {\n      domEvents: !1,\n      touchAction: gb,\n      enable: !0,\n      inputTarget: null,\n      inputClass: null,\n      preset: [[ea, {\n        enable: !1\n      }], [ca, {\n        enable: !1\n      }, [\"rotate\"]], [fa, {\n        direction: Na\n      }], [ba, {\n        direction: Na\n      }, [\"swipe\"]], [ga], [ga, {\n        event: \"doubletap\",\n        taps: 2\n      }, [\"tap\"]], [da]],\n      cssProps: {\n        userSelect: \"none\",\n        touchSelect: \"none\",\n        touchCallout: \"none\",\n        contentZooming: \"none\",\n        userDrag: \"none\",\n        tapHighlightColor: \"rgba(0,0,0,0)\"\n      }\n    };\n    var ub = 1,\n        vb = 2;\n    ia.prototype = {\n      set: function set(a) {\n        return la(this.options, a), a.touchAction && this.touchAction.update(), a.inputTarget && (this.input.destroy(), this.input.target = a.inputTarget, this.input.init()), this;\n      },\n      stop: function stop(a) {\n        this.session.stopped = a ? vb : ub;\n      },\n      recognize: function recognize(a) {\n        var b = this.session;\n\n        if (!b.stopped) {\n          this.touchAction.preventDefaults(a);\n          var c,\n              d = this.recognizers,\n              e = b.curRecognizer;\n          (!e || e && e.state & rb) && (e = b.curRecognizer = null);\n\n          for (var f = 0; f < d.length;) {\n            c = d[f], b.stopped === vb || e && c != e && !c.canRecognizeWith(e) ? c.reset() : c.recognize(a), !e && c.state & (ob | pb | qb) && (e = b.curRecognizer = c), f++;\n          }\n        }\n      },\n      get: function get(a) {\n        if (a instanceof Y) return a;\n\n        for (var b = this.recognizers, c = 0; c < b.length; c++) {\n          if (b[c].options.event == a) return b[c];\n        }\n\n        return null;\n      },\n      add: function add(a) {\n        if (f(a, \"add\", this)) return this;\n        var b = this.get(a.options.event);\n        return b && this.remove(b), this.recognizers.push(a), a.manager = this, this.touchAction.update(), a;\n      },\n      remove: function remove(a) {\n        if (f(a, \"remove\", this)) return this;\n\n        if (a = this.get(a)) {\n          var b = this.recognizers,\n              c = r(b, a);\n          -1 !== c && (b.splice(c, 1), this.touchAction.update());\n        }\n\n        return this;\n      },\n      on: function on(a, b) {\n        if (a !== d && b !== d) {\n          var c = this.handlers;\n          return g(q(a), function (a) {\n            c[a] = c[a] || [], c[a].push(b);\n          }), this;\n        }\n      },\n      off: function off(a, b) {\n        if (a !== d) {\n          var c = this.handlers;\n          return g(q(a), function (a) {\n            b ? c[a] && c[a].splice(r(c[a], b), 1) : delete c[a];\n          }), this;\n        }\n      },\n      emit: function emit(a, b) {\n        this.options.domEvents && ka(a, b);\n        var c = this.handlers[a] && this.handlers[a].slice();\n\n        if (c && c.length) {\n          b.type = a, b.preventDefault = function () {\n            b.srcEvent.preventDefault();\n          };\n\n          for (var d = 0; d < c.length;) {\n            c[d](b), d++;\n          }\n        }\n      },\n      destroy: function destroy() {\n        this.element && ja(this, !1), this.handlers = {}, this.session = {}, this.input.destroy(), this.element = null;\n      }\n    }, la(ha, {\n      INPUT_START: Ea,\n      INPUT_MOVE: Fa,\n      INPUT_END: Ga,\n      INPUT_CANCEL: Ha,\n      STATE_POSSIBLE: nb,\n      STATE_BEGAN: ob,\n      STATE_CHANGED: pb,\n      STATE_ENDED: qb,\n      STATE_RECOGNIZED: rb,\n      STATE_CANCELLED: sb,\n      STATE_FAILED: tb,\n      DIRECTION_NONE: Ia,\n      DIRECTION_LEFT: Ja,\n      DIRECTION_RIGHT: Ka,\n      DIRECTION_UP: La,\n      DIRECTION_DOWN: Ma,\n      DIRECTION_HORIZONTAL: Na,\n      DIRECTION_VERTICAL: Oa,\n      DIRECTION_ALL: Pa,\n      Manager: ia,\n      Input: x,\n      TouchAction: V,\n      TouchInput: P,\n      MouseInput: L,\n      PointerEventInput: M,\n      TouchMouseInput: R,\n      SingleTouchInput: N,\n      Recognizer: Y,\n      AttrRecognizer: aa,\n      Tap: ga,\n      Pan: ba,\n      Swipe: fa,\n      Pinch: ca,\n      Rotate: ea,\n      Press: da,\n      on: m,\n      off: n,\n      each: g,\n      merge: ta,\n      extend: sa,\n      assign: la,\n      inherit: i,\n      bindFn: j,\n      prefixed: u\n    });\n    var wb = \"undefined\" != typeof a ? a : \"undefined\" != typeof self ? self : {};\n    wb.Hammer = ha, \"function\" == typeof define && define.amd ? define(function () {\n      return ha;\n    }) : \"undefined\" != typeof module && module.exports ? module.exports = ha : a[c] = ha;\n  }(window, document, \"Hammer\");\n  var $this = $(container);\n  $this.find(\".description .gallery li:first-child\").addClass(\"active\");\n  $this.find(\".description .gallery .paging a:first-child\").addClass(\"current\");\n  $this.find(\".description .gallery img\").on('load', function () {\n    var totalW = 104;\n\n    for (var i = 0; i < $this.find(\".description .gallery li\").length; i++) {\n      totalW = totalW + $this.find(\".description .gallery li:eq(\" + i + \") img\").width() + 20;\n      $this.find(\".description .gallery .photo-list\").width(totalW);\n    }\n  });\n  $this.find(\".description .gallery\").each(function (i, e) {\n    var _window = window,\n        Hammer = _window.Hammer;\n    new Hammer(e).on('swipe', function (_ref) {\n      var type = _ref.type,\n          direction = _ref.direction;\n      console.log(arguments[0]);\n\n      if (type === 'swipe') {\n        if (direction === Hammer.DIRECTION_LEFT) {\n          $(e).find('.paging .prev')[0].click();\n        } else if (direction === Hammer.DIRECTION_RIGHT) {\n          $(e).find('.paging .next')[0].click();\n        }\n      }\n    });\n  });\n}","import _extends from \"@babel/runtime/helpers/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from \"react\";\nimport classnames from \"classnames\";\nimport { numberFormat, isPlainLeftClick } from \"fancyutils\";\nimport { MoreShare, MoreShareFacade } from \"common-components\";\nimport appState from \"../appstate\";\nimport { addItemToCart, logAddCartMixpanel } from \"../../overlay-thing/components/map.cart\";\nimport { getSafeNameProp, getThingName } from \"./map\";\nimport { LinkTypes, transition } from \"../container/routeutils\";\nimport { FancydUsers } from \"./ThingFancydUsers\";\nimport { OaContainer } from \"../container/entry-events\";\nvar itemTraits = {\n  article: {\n    utm: \"article\",\n    section: \"items\",\n    via: \"article\"\n  },\n  similar: {\n    section: \"recommended\",\n    utm: \"rec\",\n    via: \"thing more\"\n  },\n  recently: {\n    section: \"recently viewed\",\n    utm: \"rv\",\n    via: \"thing more\"\n  }\n};\n\nvar ThingCard = /*#__PURE__*/function (_Component) {\n  _inherits(ThingCard, _Component);\n\n  function ThingCard(props) {\n    var _this;\n\n    _classCallCheck(this, ThingCard);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ThingCard).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      fancydCount: 0,\n      quantity: 1,\n      optionID: null,\n      showCart: false,\n      popupOpened: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCartAddition\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      _this.addToCart();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleQuickCartToggle\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      var saleAvailable = _this.isSaleAvailable();\n\n      var saleOptionExists = _this.isSaleOptionExists();\n\n      if (saleAvailable) {\n        if (saleOptionExists) {\n          _this.setState({\n            showCart: !_this.state.showCart\n          });\n        } else {\n          _this.addToCart();\n        }\n      } else {\n        _this.setState({\n          showCart: !_this.state.showCart\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isSaleAvailable\", function () {\n      var sales_available = _this.props.sales_available;\n\n      var sales = _this.getSales();\n\n      if (sales) {\n        return sales_available && sales.quantity !== 0;\n      } else {\n        return false;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getSaleOption\", function () {\n      var saleOptionExists = _this.isSaleOptionExists();\n\n      var sales = _this.getSales();\n\n      if (sales && saleOptionExists) {\n        var optionID = _this.state.optionID || sales.options[0].id;\n        var option = sales.options.filter(function (option) {\n          return option.id === optionID;\n        })[0] || null;\n        return option;\n      } else {\n        return null;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isSaleOptionExists\", function () {\n      var sales = _this.getSales();\n\n      if (sales) {\n        return sales.has_options === true;\n      } else {\n        return false;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isSaleOptionAvailable\", function () {\n      var option = _this.getSaleOption();\n\n      if (option) {\n        return option.available_for_sale === true && option.quantity !== 0;\n      } else {\n        return false;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getSales\", function () {\n      return _this.props.sales;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getFancydCount\", function () {\n      return _.isNumber(_this.state.fancydCount) ? _this.state.fancydCount : _this.props.fancyd_count;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleFancydCount\", function (diff) {\n      _this.setState({\n        fancydCount: _this.state.fancydCount + diff\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getQuantityRange\", function () {\n      var saleOptionExists = _this.isSaleOptionExists();\n\n      var max;\n\n      if (saleOptionExists && _this.isSaleOptionAvailable()) {\n        max = _this.getSaleOption().quantity;\n      } else if (_this.isSaleAvailable()) {\n        max = _this.getSales().quantity;\n      }\n\n      return max == null ? [\"1\"] : _.range(1, Math.min(10, max + 1));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleOptionChange\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      _this.setState({\n        optionID: parseInt(event.target.value, 10),\n        quantity: 1\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleOptionQuantityChange\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      _this.setState({\n        quantity: parseInt(event.target.value, 10)\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleTrickClick\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      _this.setState({\n        showCart: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleRecentlyDelete\", function () {\n      $.post(\"/remove_recently_viewed_thing\", {\n        thing_id: _this.props.id\n      }, function (json) {\n        if (!json || json.status_code !== 1) {\n          window.alertify.alert(\"Sorry, failed to remove \\\"\".concat(_this.props.name, \"\\\". Please retry.\"));\n        } else {\n          _this.props.onDelete(_this.props);\n        }\n      }).fail(function () {\n        window.alertify.alert(\"Sorry, failed to remove \\\"\".concat(_this.props.name, \"\\\". Please retry.\"));\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleLinkClick\", function (event) {\n      event.stopPropagation();\n\n      if (isPlainLeftClick(event)) {\n        event.preventDefault();\n        if (!window.isWhitelabel) OaContainer.scrollToTop();\n        transition(_this.html_url(), LinkTypes.Timeline);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleShowSomething\", function (popupOpened) {\n      _this.setState({\n        popupOpened: popupOpened\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleNotifySoldout\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      if (!appState.loggedIn) {\n        window.require_login && window.require_login();\n        return;\n      }\n\n      var sales = _this.getSales();\n\n      var params = {\n        sale_item_id: sales.sale_id\n      };\n\n      var waiting = _this.getWaiting(sales);\n\n      if (waiting) {\n        params.remove = 1;\n      }\n\n      $.ajax({\n        type: \"post\",\n        url: \"/wait_for_product.json\",\n        data: params,\n        dataType: \"json\"\n      }).done(function (json) {\n        if (!json || json.status_code == null) {\n          return;\n        }\n\n        if (json.status_code == 0 && json.message) {\n          window.alertify.alert(json.message);\n          return;\n        }\n\n        var waiting = params.remove ? false : true;\n\n        _this.setState({\n          waiting: waiting\n        });\n      }).fail(function (json) {\n        if (json && json.message) {\n          window.alertify.alert(json.message);\n        } else {\n          window.alertify.alert(\"There was an error while processing your request. Please try again later.\");\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getWaiting\", function () {\n      var sales = _this.getSales();\n\n      if (sales) {\n        if (_this.state.waiting == null) {\n          return sales.waiting;\n        } else {\n          return _this.state.waiting;\n        }\n      } else {\n        return false;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"html_url\", function () {\n      var _ref = itemTraits[_this.props.itemType] || {},\n          utm = _ref.utm;\n\n      return \"\".concat(_this.props.html_url).concat(utm ? \"?utm=\" + utm : \"\");\n    });\n\n    _this.handleLinkClick = _.throttle(_this.handleLinkClick, 500);\n    return _this;\n  }\n\n  _createClass(ThingCard, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.setState({\n        fancydCount: this.props.fancyd_count || 0\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.unmounted = true;\n    }\n  }, {\n    key: \"addToCart\",\n    value: function addToCart() {\n      var _this2 = this;\n\n      if (!appState.loggedIn) {\n        window.require_login && window.require_login();\n        return;\n      }\n\n      var _this$props = this.props,\n          id = _this$props.id,\n          itemType = _this$props.itemType;\n      var quantity = this.state.quantity;\n      var sales = this.getSales();\n      var saleAvailable = this.isSaleAvailable();\n      var saleOptionExists = this.isSaleOptionExists();\n      var option = this.getSaleOption();\n\n      if (!saleAvailable || this.state.loading) {\n        return;\n      }\n\n      if (isNaN(quantity) || quantity <= 0) {\n        alert(gettext(\"Please select a valid quantity.\"));\n        return;\n      }\n\n      var param = {\n        seller_id: sales.seller.id,\n        // sisi\n        thing_id: id,\n        // tid\n        sale_item_id: sales.sale_id,\n        // sii\n        quantity: quantity\n      };\n\n      if (saleOptionExists && option) {\n        param.option_id = option.id;\n      }\n\n      var traits = itemTraits[itemType];\n      var title = getThingName(this.props);\n      this.setState({\n        loading: true\n      }, function () {\n        var log = {\n          salesID: sales.sale_id,\n          utm: traits.utm,\n          section: traits.section,\n          via: traits.via\n        };\n\n        if (option) {\n          log.saleOptionID = option.id;\n        }\n\n        logAddCartMixpanel(log); // ga shit\n\n        var discounting = sales && sales.discount_percentage !== \"0\";\n        var meta = {\n          title: title,\n          price: discounting ? sales.retail_price : sales.deal_price,\n          brand_name: sales.seller.brand_name\n        };\n        addItemToCart(param, function () {\n          if (!_this2.unmounted) {\n            _this2.setState({\n              loading: false\n            });\n          }\n        }, meta);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          id = _this$props2.id,\n          thumb_image_url_310 = _this$props2.thumb_image_url_310,\n          thumb_image_url_558 = _this$props2.thumb_image_url_558,\n          itemIdx = _this$props2.itemIdx,\n          loggedIn = _this$props2.loggedIn,\n          viewer = _this$props2.viewer,\n          showDelete = _this$props2.showDelete;\n      var _this$state = this.state,\n          showCart = _this$state.showCart,\n          loading = _this$state.loading,\n          popupOpened = _this$state.popupOpened;\n      var html_url = this.html_url();\n      var sales = this.getSales();\n      var discounting = sales && sales.discount_percentage !== \"0\";\n      var waiting = this.getWaiting();\n      var saleAvailable = this.isSaleAvailable();\n      var saleOptionExists = this.isSaleOptionExists();\n      var saleOptionAvailable = this.isSaleOptionAvailable();\n      var showFrom = sales && sales.max_price !== null && sales.min_price !== null && sales.max_price > sales.min_price;\n      return __Config.new_card ? /*#__PURE__*/React.createElement(\"li\", {\n        className: classnames({\n          \"quick-cart\": loading,\n          active: popupOpened || showCart\n        })\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: classnames(\"figure-item new\", {\n          toggled: showCart\n        })\n      }, /*#__PURE__*/React.createElement(\"figure\", null, /*#__PURE__*/React.createElement(\"a\", {\n        href: html_url,\n        rel: \"thing-\".concat(id),\n        onClick: this.handleLinkClick,\n        \"data-prevent-overlay\": \"true\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"figure\"\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: \"/_ui/images/common/blank.gif\",\n        style: {\n          backgroundImage: \"url(\".concat(thumb_image_url_558 || thumb_image_url_310, \")\")\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"buttons\"\n      }, /*#__PURE__*/React.createElement(FancydUsers, {\n        thing: this.props,\n        appContext: this.props.appContext,\n        displayCount: 6,\n        showFancydUser: false\n      }), /*#__PURE__*/React.createElement(MoreShareFacade, {\n        objectType: \"thing\",\n        objectId: id,\n        loggedIn: loggedIn,\n        title: getThingName(this.props),\n        viewerUsername: viewer.username,\n        onShowSomething: this.handleShowSomething\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: classnames(\"show_cart\", {\n          opened: showCart\n        }),\n        style: !sales ? {\n          display: \"none\"\n        } : undefined\n      }, sales && /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn-cart nopopup\",\n        onClick: this.handleCartAddition,\n        disabled: !saleOptionAvailable\n      }, /*#__PURE__*/React.createElement(\"em\", null, \"Add to Cart\")), /*#__PURE__*/React.createElement(\"em\", {\n        className: \"sale-item-input\"\n      }, /*#__PURE__*/React.createElement(\"small\", {\n        className: \"trick\",\n        style: {\n          display: showCart ? \"block\" : undefined\n        },\n        onClick: this.handleTrickClick\n      }), saleAvailable ? /*#__PURE__*/React.createElement(\"span\", {\n        className: \"frm\"\n      }, saleOptionExists && /*#__PURE__*/React.createElement(\"select\", {\n        name: \"option_id\",\n        id: \"\".concat(id, \"-option_id\"),\n        onChange: this.handleOptionChange\n      }, sales.options.map(function (option, i) {\n        return /*#__PURE__*/React.createElement(\"option\", {\n          key: \"other-item-\".concat(itemIdx, \"-saleoption-\").concat(i),\n          value: option.id\n        }, option.option, \" -\", \" \", !option.available_for_sale || option.quantity === 0 ? gettext(\"Sold out\") : \"$\".concat(numberFormat(option.deal_price, 0)));\n      })), /*#__PURE__*/React.createElement(\"select\", {\n        className: \"option\",\n        id: \"\".concat(id, \"-quantity\"),\n        name: \"quantity\",\n        disabled: !saleOptionAvailable,\n        onChange: this.handleOptionQuantityChange\n      }, this.getQuantityRange().map(function (e, i) {\n        return /*#__PURE__*/React.createElement(\"option\", {\n          key: \"other-item-\".concat(itemIdx, \"-quantityOption-\").concat(i),\n          value: e\n        }, e);\n      })), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"add_to_cart btns-green-embo\",\n        onClick: this.handleCartAddition,\n        disabled: !saleOptionAvailable\n      }, gettext(\"Add to Cart\"))) : /*#__PURE__*/React.createElement(\"span\", {\n        className: \"frm\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"notify-soldout\"\n      }, \"Sorry, this item has sold out\"), /*#__PURE__*/React.createElement(\"button\", {\n        className: classnames(\"btns-green-embo btn-notify\", {\n          subscribed: waiting\n        }),\n        onClick: this.handleNotifySoldout\n      }, waiting ? \"Subscribed\" : \"Notify me when available\"))))), /*#__PURE__*/React.createElement(\"figcaption\", null, /*#__PURE__*/React.createElement(\"a\", {\n        href: html_url,\n        className: \"title\",\n        rel: \"thing-\".concat(id),\n        onClick: this.handleLinkClick,\n        \"data-prevent-overlay\": \"true\"\n      }, /*#__PURE__*/React.createElement(\"b\", _extends({\n        className: \"title\"\n      }, getSafeNameProp(this.props))), sales && /*#__PURE__*/React.createElement(\"span\", {\n        className: \"price \".concat(discounting ? \"sales\" : \"\", \" \").concat(saleAvailable ? \"\" : \"soldout\")\n      }, discounting && /*#__PURE__*/React.createElement(\"small\", {\n        key: \"ThingCard2-price-deal\"\n      }, \"$\", numberFormat(sales.retail_price, 0)), showFrom ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"em\", {\n        className: \"from\"\n      }, \"from \"), \" $\", numberFormat(sales.min_price, 0)) : \"$\\n                                        \".concat(numberFormat(sales.deal_price, 0))))), /*#__PURE__*/React.createElement(\"a\", {\n        className: \"delete\",\n        onClick: this.handleRecentlyDelete\n      }))) : /*#__PURE__*/React.createElement(\"li\", {\n        className: classnames({\n          \"quick-cart\": loading,\n          active: popupOpened || showCart\n        })\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: classnames(\"figure-item\", {\n          toggled: showCart\n        })\n      }, /*#__PURE__*/React.createElement(\"figure\", null, /*#__PURE__*/React.createElement(\"a\", {\n        href: html_url,\n        rel: \"thing-\".concat(id),\n        onClick: this.handleLinkClick\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"back\"\n      }), /*#__PURE__*/React.createElement(\"img\", {\n        className: \"figure\",\n        style: {\n          backgroundImage: \"url(\".concat(thumb_image_url_310, \")\")\n        },\n        src: \"/_ui/images/common/blank.gif\"\n      }))), /*#__PURE__*/React.createElement(\"figcaption\", null, /*#__PURE__*/React.createElement(\"span\", {\n        className: classnames(\"show_cart\", {\n          opened: showCart\n        }),\n        style: {\n          display: sales ? null : \"none\"\n        }\n      }, sales && /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn-cart nopopup \".concat(discounting ? \"sales\" : \"\", \" \").concat(saleAvailable ? \"\" : \"soldout\"),\n        onClick: this.handleQuickCartToggle\n      }, /*#__PURE__*/React.createElement(\"em\", null, discounting ? [/*#__PURE__*/React.createElement(\"small\", {\n        key: \"ThingCard2-price-deal\"\n      }, \"$\", numberFormat(sales.retail_price, 0)), \"$\".concat(numberFormat(sales.deal_price, 0))] : \"$\".concat(numberFormat(sales.deal_price, 0)))), /*#__PURE__*/React.createElement(\"em\", {\n        className: \"sale-item-input\"\n      }, /*#__PURE__*/React.createElement(\"small\", {\n        className: \"trick\",\n        style: {\n          display: showCart ? \"block\" : null\n        },\n        onClick: this.handleTrickClick\n      }), saleAvailable ? /*#__PURE__*/React.createElement(\"span\", {\n        className: \"frm\"\n      }, saleOptionExists && /*#__PURE__*/React.createElement(\"select\", {\n        name: \"option_id\",\n        id: \"\".concat(id, \"-option_id\"),\n        onChange: this.handleOptionChange\n      }, sales.options.map(function (option, i) {\n        return /*#__PURE__*/React.createElement(\"option\", {\n          key: \"other-item-\".concat(itemIdx, \"-saleoption-\").concat(i),\n          value: option.id\n        }, option.option, \" -\", \" \", !option.available_for_sale || option.quantity === 0 ? gettext(\"Sold out\") : \"$\".concat(numberFormat(option.deal_price, 0)));\n      })), /*#__PURE__*/React.createElement(\"select\", {\n        className: \"option\",\n        id: \"\".concat(id, \"-quantity\"),\n        name: \"quantity\",\n        disabled: !saleOptionAvailable,\n        onChange: this.handleOptionQuantityChange\n      }, this.getQuantityRange().map(function (e, i) {\n        return /*#__PURE__*/React.createElement(\"option\", {\n          key: \"other-item-\".concat(itemIdx, \"-quantityOption-\").concat(i),\n          value: e\n        }, e);\n      })), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"add_to_cart btns-green-embo\",\n        onClick: this.handleCartAddition,\n        disabled: !saleOptionAvailable\n      }, gettext(\"Add to Cart\"))) : /*#__PURE__*/React.createElement(\"span\", {\n        className: \"frm\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"notify-soldout\"\n      }, \"Sorry, this item has sold out\"), /*#__PURE__*/React.createElement(\"button\", {\n        className: classnames(\"btns-green-embo btn-notify\", {\n          subscribed: waiting\n        }),\n        onClick: this.handleNotifySoldout\n      }, waiting ? \"Subscribed\" : \"Notify me when available\")))), /*#__PURE__*/React.createElement(\"a\", _extends({\n        href: html_url,\n        className: \"title\",\n        rel: \"thing-\".concat(id),\n        onClick: this.handleLinkClick\n      }, getSafeNameProp(this.props))), /*#__PURE__*/React.createElement(\"span\", {\n        className: classnames(\"buttons\"\n        /*, { 'no-cart': saleAvailable }*/\n        )\n      }, /*#__PURE__*/React.createElement(FancydUsers, {\n        thing: this.props,\n        appContext: this.props.appContext\n      }), /*#__PURE__*/React.createElement(MoreShare, {\n        objectType: \"thing\",\n        objectId: id,\n        loggedIn: loggedIn,\n        title: getThingName(this.props),\n        viewerUsername: viewer.username,\n        onShowSomething: this.handleShowSomething\n      }))), showDelete && /*#__PURE__*/React.createElement(\"a\", {\n        className: \"delete\",\n        onClick: this.handleRecentlyDelete\n      })));\n    }\n  }]);\n\n  return ThingCard;\n}(Component);\n\n_defineProperty(ThingCard, \"defaultProps\", {\n  showDelete: true\n});\n\nexport { ThingCard as default };","import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from 'react';\nimport classnames from 'classnames';\nimport { MP, getConciseNumberString } from 'fancyutils';\nimport { Display } from 'fancymixin';\nimport { FancyStatus } from '../config';\nimport { cache } from '../cache';\nexport function handleProfileMouseOver(event) {\n  var $profile = $(event.currentTarget).find('em');\n  $profile.css('margin-left', \"\".concat(-($profile.width() / 2) - 10, \"px\"));\n}\n\nvar FancydUser = function FancydUser(_ref) {\n  var _ref$user = _ref.user,\n      user = _ref$user === void 0 ? {} : _ref$user,\n      display = _ref.display,\n      isViewer = _ref.isViewer;\n  return /*#__PURE__*/React.createElement(\"a\", {\n    href: user.html_url,\n    className: classnames(\"user\", {\n      _viewer: isViewer\n    }),\n    onMouseOver: handleProfileMouseOver,\n    style: display\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: \"/_ui/images/common/blank.gif\",\n    style: {\n      backgroundImage: \"url(\".concat(user.user_square_image_small || user.image_url, \")\")\n    }\n  }), /*#__PURE__*/React.createElement(\"em\", null, user.full_name || user.fullname));\n};\n\nfunction isUserEqual(a, b) {\n  if (a == null || b == null) {\n    return false;\n  }\n\n  return a.id === b.id;\n}\n\nvar bgXPosSequence = [0, -54, -108, -163, -218, -272, -327, -436, -490, -545, -599, -654, -708, -763, -817, -872, -926, -981, -1035, -1144, -1199, -1253, -1308, -1417, -1471];\n\nfunction _handleFancydStateOnLoadThing(thingID, _ref2) {\n  var fancyd = _ref2.fancyd,\n      fancyd_count = _ref2.fancyd_count;\n  var stateSetter = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function (_) {\n    return _;\n  };\n  // onFancyButtonUpdate(thingID, fancyd, getConciseNumberString(fancyd_count));\n  stateSetter({\n    fancyd: fancyd,\n    fancyd_count: fancyd_count,\n    loading: false,\n    fancyStatus: FancyStatus.Idle\n  });\n}\n\nfunction getFancyStatus(nextFancydState) {\n  return nextFancydState ? FancyStatus.Addition : FancyStatus.Removal;\n}\n\nfunction getCompletionIdleStatus(currentFancyState) {\n  var prevFancyState = !currentFancyState;\n  return prevFancyState ? FancyStatus.AfterRemoval : FancyStatus.AfterAddition;\n}\n\nfunction getNextFancydCount(nextFancyd, currentFancydCount) {\n  if (nextFancyd === true) {\n    return currentFancydCount + 1;\n  } else {\n    return currentFancydCount - 1;\n  }\n}\n\nfunction toggleFancy(thingID, currentState) {\n  var stateSetter = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function (_) {\n    return _;\n  };\n  var fancyd = currentState.fancyd,\n      fancyd_count = currentState.fancyd_count,\n      loading = currentState.loading;\n  var nextFancyd = !fancyd;\n  var nextFancydCount = getNextFancydCount(nextFancyd, fancyd_count);\n\n  if (!loading) {\n    stateSetter({\n      fancyd: nextFancyd,\n      loading: true,\n      fancyd_count: nextFancydCount,\n      fancyStatus: getFancyStatus(nextFancyd)\n    });\n    $.ajax({\n      type: 'PUT',\n      url: \"/rest-api/v1/things/\".concat(thingID),\n      data: {\n        fancyd: nextFancyd\n      }\n    }).done(function (json) {\n      if (json.id && json.fancyd === !fancyd) {\n        // Completing fancy\n        var _nextFancydCount = json.fancyd === true ? (fancyd_count || 0) + 1 : (fancyd_count || 0) - 1;\n\n        cache.update(thingID, undefined, 'fancyd', nextFancyd);\n        cache.update(thingID, undefined, 'fancyd_count', _nextFancydCount); // onFancyButtonUpdate(thingID, nextFancyd, getConciseNumberString(nextFancydCount));\n\n        stateSetter({\n          loading: false,\n          fancyd: nextFancyd,\n          fancyd_count: _nextFancydCount,\n          fancyStatus: getCompletionIdleStatus(nextFancyd)\n        });\n      } else {\n        // cancelling fancy\n        stateSetter({\n          loading: false,\n          fancyd: fancyd,\n          fancyd_count: fancyd_count,\n          fancyStatus: getFancyStatus(fancyd)\n        });\n      }\n    }).fail(function () {\n      // cancelling fancy\n      stateSetter({\n        loading: false,\n        fancyd: fancyd,\n        fancyd_count: fancyd_count,\n        fancyStatus: getFancyStatus(fancyd)\n      });\n    });\n  }\n} // workaround for profile heads overflow on animation\n\n\nvar bigContainerStyle = {\n  width: '285px'\n};\nexport var FancydUsers = /*#__PURE__*/function (_Component) {\n  _inherits(FancydUsers, _Component);\n\n  _createClass(FancydUsers, [{\n    key: \"_getInitialState\",\n    value: function _getInitialState() {\n      return {\n        fancyAnimation: false,\n        // button state\n        fancyd: null,\n        loading: false,\n        fancyd_count: null,\n        fancyStatus: FancyStatus.Idle // fancyStatus = 'Idle', { Idle | Addition | Removal | After- } - Fancy'd status for animation control\n\n      };\n    }\n  }]);\n\n  function FancydUsers(props) {\n    var _this;\n\n    _classCallCheck(this, FancydUsers);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(FancydUsers).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"getFancydCountString\", function () {\n      var fancyd_count = _this.state.fancyd_count;\n      return fancyd_count != null ? getConciseNumberString(fancyd_count, 0) : '0';\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"animateFancyBG\", function (frame) {\n      if (frame === undefined) {\n        _this.animateFancyBG(0);\n      } else if (frame < bgXPosSequence.length) {\n        // Special branching due to misposition in background\n        var xPos = bgXPosSequence[frame];\n        $(_this.fancyBGAnimation).css('background-position-x', \"\".concat(xPos, \"px\"));\n        setTimeout(function () {\n          _this.animateFancyBG(frame + 1);\n        }, 10);\n      } else if (frame >= bgXPosSequence.length) {\n        _this.setState({\n          fancyAnimation: false\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getFancyduserDisplay\", function (user, index, totalLength) {\n      var _this$props = _this.props,\n          viewer = _this$props.appContext.viewer,\n          bigContainer = _this$props.bigContainer;\n      var _this$state = _this.state,\n          fancyd = _this$state.fancyd,\n          fancyStatus = _this$state.fancyStatus;\n      var first = index === 0;\n      var last = index === totalLength - 1;\n      var display;\n\n      if (fancyStatus === FancyStatus.AfterAddition || fancyStatus === FancyStatus.Addition) {\n        // designer satisfaction 1)\n        if (totalLength <= 2) {\n          display = Display.Inline;\n        } else {\n          if (first) {\n            display = Display.Inline;\n          }\n        }\n      } else if (fancyStatus === FancyStatus.AfterRemoval || fancyStatus === FancyStatus.Removal) {\n        if (first) {\n          display = Display.None;\n        } else if (last) {\n          display = Display.Inline;\n        }\n      } // designer satisfaction 2) https://app.asana.com/0/86925821949642/161445424426526\n\n\n      var indexLimit = bigContainer ? 6 : 5;\n\n      if ((fancyStatus === FancyStatus.AfterAddition || fancyStatus === FancyStatus.Addition || fancyStatus === FancyStatus.Removal || fancyd && fancyStatus === FancyStatus.Idle) && index > indexLimit) {\n        display = Display.None;\n      }\n\n      if (fancyStatus === FancyStatus.Idle && !fancyd && isUserEqual(user, viewer)) {\n        display = Display.None;\n      }\n\n      return display;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"toggleFancy\", function () {\n      toggleFancy(_this.props.thing.id, _this.state, function (ns) {\n        _this.setState(ns);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleFancydStateOnLoadThing\", function (thing) {\n      if (thing == null) {\n        thing = _this.props.thing;\n      }\n\n      _handleFancydStateOnLoadThing(thing.id, {\n        fancyd: thing.fancyd,\n        fancyd_count: thing.fancyd_count\n      }, function (ns) {\n        _this.setState(ns);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleFancyClick\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      if (!_this.props.appContext.loggedIn) {\n        window.require_login && window.require_login();\n        return;\n      }\n\n      var thing = _this.props.thing;\n      var _this$state2 = _this.state,\n          fancyAnimation = _this$state2.fancyAnimation,\n          fancyd = _this$state2.fancyd,\n          loading = _this$state2.loading;\n\n      if (loading) {\n        return;\n      }\n\n      if (!fancyd && !fancyAnimation) {\n        _this.setState({\n          fancyAnimation: true\n        }, function (_) {\n          _this.animateFancyBG();\n        });\n      }\n\n      if (!fancyd) {\n        MP('Fancy', {\n          thing_id: thing.id\n        });\n      } else {\n        MP('Unfancy', {\n          thing_id: thing.id\n        });\n      }\n\n      _this.toggleFancy();\n    });\n\n    _this.state = _this._getInitialState();\n\n    _this.fancyBGAnimationRef = function (element) {\n      _this.fancyBGAnimation = element;\n    };\n\n    return _this;\n  }\n\n  _createClass(FancydUsers, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.handleFancydStateOnLoadThing();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(_ref3) {\n      var thing = _ref3.thing;\n\n      // Thing has been updated.\n      if (thing.id !== this.props.thing.id || thing.isCrawled !== this.props.thing.isCrawled) {\n        this.handleFancydStateOnLoadThing(thing);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props2 = this.props,\n          _this$props2$appConte = _this$props2.appContext,\n          loggedIn = _this$props2$appConte.loggedIn,\n          viewer = _this$props2$appConte.viewer,\n          _this$props2$thing = _this$props2.thing,\n          fancyd_users = _this$props2$thing.fancyd_users,\n          user = _this$props2$thing.user,\n          bigContainer = _this$props2.bigContainer;\n      var _this$state3 = this.state,\n          fancyd = _this$state3.fancyd,\n          fancyAnimation = _this$state3.fancyAnimation,\n          fancyStatus = _this$state3.fancyStatus;\n      var fancydUsers = [loggedIn && viewer, loggedIn && !isUserEqual(viewer, user) && user].concat(fancyd_users && fancyd_users.filter(function (fancydUser) {\n        return !isUserEqual(fancydUser, user) && !isUserEqual(fancydUser, viewer);\n      })).filter(function (e) {\n        return e;\n      });\n      var fancydUserAnimClass;\n\n      if (fancyStatus === FancyStatus.Addition) {\n        fancydUserAnimClass = \"add\";\n      } else if (fancyStatus === FancyStatus.Removal) {\n        fancydUserAnimClass = \"remove\";\n      } // designer satisfaction 1)\n      // If user is less than 2 we need to apply special class.\n      // In this way dont owner profile dont get 'consumed': https://app.asana.com/0/86925821949642/173945332708784\n\n\n      var userCountSufficiency = fancydUsers.length <= 2 ? '_insuff' : '_suff';\n      return /*#__PURE__*/React.createElement(\"span\", {\n        style: bigContainer && bigContainerStyle,\n        className: \"fancyd_users-wrap\"\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"count\"\n      }, /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handleFancyClick,\n        className: classnames(\"button button-static fancy _count\", {\n          fancyd: fancyd,\n          loading: fancyAnimation\n        })\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        ref: this.fancyBGAnimationRef\n      }, /*#__PURE__*/React.createElement(\"i\", null)), this.getFancydCountString()), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"_fancyd\"\n      })), /*#__PURE__*/React.createElement(\"span\", {\n        className: classnames(\"fancyd_user\", fancydUserAnimClass, userCountSufficiency)\n      }, fancydUsers.map(function (user, index) {\n        var isViewer = isUserEqual(user, viewer);\n        return /*#__PURE__*/React.createElement(FancydUser, {\n          key: index,\n          user: user,\n          display: _this2.getFancyduserDisplay(user, index, fancydUsers.length),\n          isViewer: isViewer\n        });\n      })));\n    }\n  }]);\n\n  return FancydUsers;\n}(Component);","import _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _extends from \"@babel/runtime/helpers/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport React, { Component, lazy, Suspense } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { connect } from \"react-redux\";\nimport { MoreShare, Video } from \"common-components\";\nimport { isStaticArticlePage } from \"fancyutils\";\nimport dateFormat from 'date-fns/format';\nimport { historyData } from \"../container/history\";\nimport { FancydUsers } from \"./ArticleFancydUsers\";\nimport { OaContainer } from \"../container/entry-events\";\nimport { AdminHeader, ArticleList, ThingList, initGallery } from \"./ArticleWidgets\";\nimport \"../Shortcode\";\nimport { applyProductSlide } from 'common-components';\n\nfunction mapStateToProps(state) {\n  var appContext = state.appContext,\n      _state$article = state.article,\n      data = _state$article.data,\n      isFetching = _state$article.isFetching,\n      status = _state$article.status;\n\n  if (data && data.content && window.convertArticleShortcode) {\n    data.content = window.convertArticleShortcode(data.content);\n  }\n\n  return {\n    appContext: appContext,\n    status: status,\n    article: data,\n    isFetching: isFetching\n  };\n}\n\nvar Lightbox = /*#__PURE__*/lazy(function () {\n  return import(\n  /* webpackChunkName: \"OverlayArticle\" */\n  'react-images');\n}); // Container class for overlayed article detail.\n\nexport var OverlayArticle = /*#__PURE__*/function (_Component) {\n  _inherits(OverlayArticle, _Component);\n\n  function OverlayArticle() {\n    _classCallCheck(this, OverlayArticle);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(OverlayArticle).apply(this, arguments));\n  }\n\n  _createClass(OverlayArticle, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      OaContainer.scrollToTop();\n      applyProductSlide(); // fitvids 1.2.0\n\n      !function (t) {\n        t.fn.fitVids = function (e) {\n          var i = {\n            customSelector: null,\n            ignore: null\n          };\n\n          if (!document.getElementById(\"fit-vids-style\")) {\n            var r = document.head || document.getElementsByTagName(\"head\")[0],\n                a = \".fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}\",\n                d = document.createElement(\"div\");\n            d.innerHTML = '<p>x</p><style id=\"fit-vids-style\">' + a + \"</style>\", r.appendChild(d.childNodes[1]);\n          }\n\n          return e && t.extend(i, e), this.each(function () {\n            var e = ['iframe[src*=\"player.vimeo.com\"]', 'iframe[src*=\"youtube.com\"]', 'iframe[src*=\"youtube-nocookie.com\"]', 'iframe[src*=\"kickstarter.com\"][src*=\"video.html\"]', \"object\", \"embed\"];\n            i.customSelector && e.push(i.customSelector);\n            var r = \".fitvidsignore\";\n            i.ignore && (r = r + \", \" + i.ignore);\n            var a = t(this).find(e.join(\",\"));\n            a = a.not(\"object object\"), a = a.not(r), a.each(function () {\n              var e = t(this);\n\n              if (!(e.parents(r).length > 0 || \"embed\" === this.tagName.toLowerCase() && e.parent(\"object\").length || e.parent(\".fluid-width-video-wrapper\").length)) {\n                e.css(\"height\") || e.css(\"width\") || !isNaN(e.attr(\"height\")) && !isNaN(e.attr(\"width\")) || (e.attr(\"height\", 9), e.attr(\"width\", 16));\n                var i = \"object\" === this.tagName.toLowerCase() || e.attr(\"height\") && !isNaN(parseInt(e.attr(\"height\"), 10)) ? parseInt(e.attr(\"height\"), 10) : e.height(),\n                    a = isNaN(parseInt(e.attr(\"width\"), 10)) ? e.width() : parseInt(e.attr(\"width\"), 10),\n                    d = i / a;\n\n                if (!e.attr(\"name\")) {\n                  var o = \"fitvid\" + t.fn.fitVids._count;\n                  e.attr(\"name\", o), t.fn.fitVids._count++;\n                }\n\n                e.wrap('<div class=\"fluid-width-video-wrapper\"></div>').parent(\".fluid-width-video-wrapper\").css(\"padding-top\", 100 * d + \"%\"), e.removeAttr(\"height\").removeAttr(\"width\");\n              }\n            });\n          });\n        }, t.fn.fitVids._count = 0;\n      }(window.jQuery || window.Zepto);\n      $('.media-youtube').fitVids();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var pt = prevProps.article;\n      var ct = this.props.article;\n\n      if (ct != null) {\n        if (!pt || pt.id !== ct.id) {\n          if (!isStaticArticlePage()) {\n            $(\"#overlay-article > .popup\").attr(\"tabindex\", -1).focus();\n          }\n\n          OaContainer.scrollToTop();\n        }\n\n        if (this.props.appContext.viewer.is_admin_senior) {\n          $(\"body\").addClass(\"admin\");\n        } else {\n          $(\"body\").removeClass(\"admin\");\n        }\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          article = _this$props.article,\n          viewer = _this$props.appContext.viewer;\n      var display = null;\n\n      if (historyData.locationIsArticlePage) {\n        if (article != null) {\n          display = /*#__PURE__*/React.createElement(\"div\", null, viewer.is_admin_senior && /*#__PURE__*/React.createElement(AdminHeader, this.props), /*#__PURE__*/React.createElement(Article, this.props), /*#__PURE__*/React.createElement(\"div\", {\n            className: \"container\"\n          }, /*#__PURE__*/React.createElement(ThingList, _extends({}, this.props, {\n            hasPagination: window.isWhitelabel\n          })), /*#__PURE__*/React.createElement(ArticleList, this.props)));\n        } else {\n          display = /*#__PURE__*/React.createElement(\"div\", null);\n        }\n      } else {\n        display = /*#__PURE__*/React.createElement(\"div\", null);\n      }\n\n      return display;\n    }\n  }]);\n\n  return OverlayArticle;\n}(Component);\nexport default connect(mapStateToProps)(OverlayArticle);\n\nvar Article = /*#__PURE__*/function (_Component2) {\n  _inherits(Article, _Component2);\n\n  function Article(props) {\n    var _this;\n\n    _classCallCheck(this, Article);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Article).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      lightboxImages: [],\n      lightboxOpen: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleGalleryClick\", function (event) {\n      var $this = $(event.target);\n\n      if (window.isWhitelabelV2) {\n        if ($this.is(\".gallery .paging a\")) {\n          event.preventDefault();\n\n          var _$gallery = $this.closest(\".gallery\");\n\n          var _$paging = _$gallery.find(\".paging\");\n\n          var len = _$gallery.find('.paging a.pager').length;\n\n          var galleryNth = $('.gallery').index($this.closest(\".gallery\"));\n          var indexSelector = \".gallery:eq(\".concat(galleryNth, \") .paging a.pager\");\n\n          var _idx;\n\n          var incdec = 0;\n\n          if ($this.is(\".btn .prev\")) {\n            _idx = _$gallery.find('.paging a.pager.current').index(indexSelector);\n            incdec = -1;\n          } else if ($this.is(\".btn .next\")) {\n            _idx = _$gallery.find('.paging a.pager.current').index(indexSelector);\n            incdec = +1;\n          } else {\n            _idx = $this.index(indexSelector);\n          }\n\n          _idx += incdec;\n\n          if (_idx < 0) {\n            _idx = len - 1;\n          } else if (_idx >= len - 1) {\n            _idx = 0;\n          }\n\n          _$paging.find(\"a.current\").removeClass(\"current\").end().find(\"a.pager:eq(\".concat(_idx, \")\")).addClass(\"current\");\n\n          _$gallery.find(\"li.active\").removeClass(\"active\").end().find(\"li:eq(\".concat(_idx, \")\")).addClass(\"active\");\n        }\n      } else {\n        if ($this.is(\".gallery .paging a, .gallery li *\")) {\n          if ($this.is(\":not(.gallery li a.linked, .gallery li a.linked *)\")) {\n            event.preventDefault();\n          }\n\n          if ($this.is(\".gallery li *\")) {\n            $this = $this.closest(\"li\");\n          }\n\n          var $gallery = $this.closest(\".gallery\");\n          var $paging = $gallery.find(\".paging\");\n          var idx = $this.index();\n          $paging.find(\"a.current\").removeClass(\"current\").end().find(\"a:eq(\" + idx + \")\").addClass(\"current\");\n          $gallery.find(\"li.active\").removeClass(\"active\").end().find(\"li:eq(\" + idx + \")\").addClass(\"active\");\n          var left = 0;\n\n          if (idx == 0) {\n            left = 0;\n          } else if (idx == $gallery.find(\"li\").length - 1) {\n            left = $gallery.width() - $gallery.find(\".photo-list\").width();\n          } else {\n            left = ($gallery.width() - $gallery.find(\"li:eq(\" + idx + \")\").width()) / 2 - $gallery.find(\"li:eq(\" + idx + \")\").position().left;\n          }\n\n          $gallery.find(\".photo-list\").css(\"left\", left + \"px\");\n        }\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"prepareProductSlide\", function (event, $this) {\n      var $slide = $this.closest('.product');\n\n      if ($slide.data('slideInit')) {\n        event.preventDefault();\n      } else {\n        $slide.productSlide({\n          itemPerSlide: 4,\n          center: true\n        });\n        setTimeout(function () {\n          $this.click();\n        }, 500);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleContentClick\", function (event) {\n      var $this = $(event.target);\n\n      if ($this.is(\".gallery *\")) {\n        _this.handleGalleryClick(event);\n      } else if ($this.is(\".description .grid\")) {\n        _this.prepareLightboxOpen();\n      } else if ($this.is('.itemSlide .prev, .itemSlide .next')) {\n        _this.prepareProductSlide(event, $this);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleClickPrev\", function () {\n      _this.setState({\n        lightboxCurrentImage: Math.max(_this.state.lightboxCurrentImage - 1, 0)\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleClickNext\", function () {\n      _this.setState({\n        lightboxCurrentImage: Math.min(_this.state.lightboxCurrentImage + 1, _this.state.lightboxImages.length - 1)\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleClose\", function () {\n      _this.setState({\n        lightboxOpen: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleClickThumbnail\", function (idx) {\n      _this.setState({\n        lightboxCurrentImage: idx\n      });\n    });\n\n    if ($(\"#article-fonts\").length === 0) {\n      $(document.head).append('<link rel=\"stylesheet\" id=\"article-fonts\" href=\"//fonts.googleapis.com/css?family=Merriweather:300,300i,400,400i,700,700i,900,900i|Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Source+Sans+Pro:200,200i,300,300i,400,400i,600,600i,700,700i,900,900i|Merriweather+Sans:300,300i,400,400i,700,700i,800,800i\" type=\"text/css\" />');\n\n      if ($(\"body\").is(\".static-article\")) {\n        $(\"#container-wrapper #scroll-to-top\").hide();\n      }\n    }\n\n    return _this;\n  }\n\n  _createClass(Article, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // Initial loading\n      initGallery(ReactDOM.findDOMNode(this));\n\n      if (window.isWhitelabelV2) {\n        setTimeout(function () {\n          $('.itemSlide.product').productSlide({\n            itemPerSlide: 4,\n            center: true\n          });\n        }, 2500);\n      }\n    }\n  }, {\n    key: \"prepareLightboxOpen\",\n    // lightbox stuff\n    value: function prepareLightboxOpen() {\n      this.setState({\n        lightboxOpen: true,\n        lightboxCurrentImage: 0,\n        lightboxImages: $('.grid img').toArray().map(function (e) {\n          return {\n            src: $(e).data('src')\n          };\n        })\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          _this$props2$appConte = _this$props2.appContext,\n          lastFullyRenderedArticleID = _this$props2$appConte.lastFullyRenderedArticleID,\n          viewer = _this$props2$appConte.viewer,\n          loggedIn = _this$props2$appConte.loggedIn,\n          article = _this$props2.article;\n      var video;\n      var coverImgUrl = '';\n\n      if (article.cover_image) {\n        coverImgUrl = article.cover_image.url;\n      }\n\n      if (Video.isVideoAvailableForArticle(article)) {\n        var videoProps = {\n          object: article,\n          display: true,\n          autoplay: article.cover_video.autoplay || false,\n          lastFullyRenderedObjectID: lastFullyRenderedArticleID\n        };\n\n        if (coverImgUrl) {\n          videoProps.poster = coverImgUrl;\n        }\n\n        video = /*#__PURE__*/React.createElement(Video, videoProps);\n      }\n\n      var coverImage = /*#__PURE__*/React.createElement(\"div\", {\n        className: \"inner-wrapper\"\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        id: \"coverImage\",\n        className: \"cover image purple\"\n      }, video, !video && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"image\"\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        id: \"coverImg\",\n        src: coverImgUrl\n      }))));\n      var author = article.options && article.options.authors && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"author\",\n        dangerouslySetInnerHTML: {\n          __html: article.options.authors\n        }\n      });\n      return /*#__PURE__*/React.createElement(\"div\", {\n        id: \"summary\",\n        className: \"wrapper article-wrapper\"\n      }, !window.isWhitelabelV2 && coverImage, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"info\"\n      }, /*#__PURE__*/React.createElement(\"h1\", {\n        className: \"title\"\n      }, /*#__PURE__*/React.createElement(\"b\", null, article.title), \" \", /*#__PURE__*/React.createElement(\"small\", null, article.tagline)), window.isWhitelabelV2 && author, window.isWhitelabelV2 && article.date_created && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"date text-placeholder\"\n      }, dateFormat(article.date_created || new Date(), 'MMMM DD, YYYY')), window.isWhitelabel ? null : /*#__PURE__*/React.createElement(FancydUsers, this.props), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"interaction\"\n      }, /*#__PURE__*/React.createElement(MoreShare, {\n        objectType: \"article\",\n        objectId: article.id,\n        loggedIn: loggedIn,\n        title: article.title,\n        viewerUsername: viewer.username,\n        showShortcuts: true,\n        fromThingSidebar: true\n      }), article.options && article.options.action_button && _.isString(article.options.action_button.text) && article.options.action_button.text.trim() && /*#__PURE__*/React.createElement(\"a\", {\n        href: \"\".concat(article.options.action_button.link),\n        className: \"btn-shop\"\n      }, article.options.action_button.text), window.isWhitelabel ? /*#__PURE__*/React.createElement(FancydUsers, this.props) : null)), window.isWhitelabelV2 && coverImage, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"description more\"\n      }, !window.isWhitelabelV2 && author, /*#__PURE__*/React.createElement(\"div\", {\n        dangerouslySetInnerHTML: {\n          __html: article.content\n        },\n        onClick: this.handleContentClick\n      })), window.isWhitelabelV2 && /*#__PURE__*/React.createElement(Suspense, {\n        fallback: /*#__PURE__*/React.createElement(\"div\", null)\n      }, /*#__PURE__*/React.createElement(Lightbox, {\n        fallback: /*#__PURE__*/React.createElement(\"div\", null),\n        images: this.state.lightboxImages,\n        isOpen: this.state.lightboxOpen,\n        preventScroll: true,\n        showThumbnails: true,\n        currentImage: this.state.lightboxCurrentImage,\n        onClickPrev: this.handleClickPrev,\n        onClickNext: this.handleClickNext,\n        onClose: this.handleClose,\n        onClickThumbnail: this.handleClickThumbnail\n      })));\n    }\n  }]);\n\n  return Article;\n}(Component);","import { isEmpty } from 'fancyutils';\nexport function getDescription(article) {\n  return article.description;\n}\nexport function formatPrice(amount) {\n  var newPrice = amount.toFixed(2) + '';\n  var regex = /(\\d)(\\d{3})([,\\.]|$)/;\n\n  while (regex.test(newPrice)) {\n    newPrice = newPrice.replace(regex, '$1,$2$3');\n  }\n\n  if (window.numberType === 2) {\n    newPrice = newPrice.replace(/,/g, ' ').replace(/\\./g, ',');\n  }\n\n  return newPrice;\n}\nexport function getSafeNameProp(_ref) {\n  var emojified_name = _ref.emojified_name,\n      name = _ref.name;\n\n  if (emojified_name) {\n    return {\n      dangerouslySetInnerHTML: {\n        __html: emojified_name\n      }\n    };\n  } else {\n    return {\n      children: name\n    };\n  }\n}\n\nfunction salesAvailable(thing) {\n  if (!isEmpty(thing.sales)) {\n    return thing.sales_available;\n  }\n\n  return false;\n}\n\nexport function getThingName(thing) {\n  if (thing.type === 'giftcard') {\n    return gettext('Fancy Gift Card');\n  } else if (salesAvailable(thing)) {\n    return thing.sales.name;\n  } else {\n    return thing.name;\n  }\n}","export var FancyStatus = {\n  Addition: 'Addition',\n  Removal: 'Removal',\n  AfterAddition: 'AfterAddition',\n  AfterRemoval: 'AfterRemoval',\n  Idle: 'Idle'\n};\nvar commonWrapperSelector = '#sidebar .wrapper.article';\nexport var Selectors = {\n  HomepageWrapper: commonWrapperSelector\n};","import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport React, { Component } from 'react';\nimport { closeOverlay } from '../action/action-helpers';\nimport store from '../store/store';\nimport { historyHook } from './history';\n\nvar App = /*#__PURE__*/function (_Component) {\n  _inherits(App, _Component);\n\n  function App() {\n    _classCallCheck(this, App);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(App).apply(this, arguments));\n  }\n\n  _createClass(App, [{\n    key: \"handleCloseArticle\",\n    value: function handleCloseArticle(event) {\n      event.preventDefault();\n      event.stopPropagation();\n      store.dispatch(closeOverlay());\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"popup article \".concat(window.isWhitelabel ? 'whitelabel-article' : '', \" \").concat(window.isWhitelabelV2 ? 'whitelabel-article-v2' : ''),\n        id: \"article-container\"\n      }, this.props.children, /*#__PURE__*/React.createElement(\"a\", {\n        href: \"#\",\n        className: \"ly-close\",\n        onClick: this.handleCloseArticle\n      }, \"Close\"));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","import { KEYS, didClickOn, getObjectTypeFromUrl, getPathname, isPlainLeftClick, isHomepage } from \"fancyutils\";\nimport store from \"../store/store\";\nimport { Selectors } from \"../config\";\nimport { LinkTypes, transition } from \"./routeutils\";\nimport { closeOverlay } from \"../action/action-helpers\";\nimport { historyData } from './history';\n\nfunction handleOverlayArticleKeyEvents(event) {\n  if (event.target.tagName === \"TEXTAREA\" || event.target.tagName === \"INPUT\") {\n    return;\n  }\n\n  switch (event.which) {\n    case KEYS.ESC:\n      // If popup is not on\n      if ($(\"#popup_container:visible\").length === 0) {\n        store.dispatch(closeOverlay());\n      }\n\n      break;\n  }\n}\n\nfunction conditionalTransition(aElement) {\n  // Turn off video\n  $(\"#container-wrapper .btn-pause\").attr(\"scroll\", true).click(); // Ensure anchor is static (sticked to homepage timeline) or not.\n\n  if (isHomepage() && $(Selectors.HomepageWrapper).has(aElement)) {\n    transition(aElement.getAttribute(\"href\"), LinkTypes.Static);\n  } else {\n    transition(aElement.getAttribute(\"href\"));\n  }\n}\n\nvar oneshotEventAttached = false;\nexport function attachEntryEvents() {\n  if (oneshotEventAttached) {\n    return;\n  }\n\n  oneshotEventAttached = true; // Remove pre-existing url event and start transition first\n\n  $(document.body).off(\"click.overlayArticleInit\");\n\n  if (window.__INIT_ARTICLE_ANCHOR != null) {\n    conditionalTransition(window.__INIT_ARTICLE_ANCHOR);\n    delete window.__INIT_ARTICLE_ANCHOR;\n  } // TODO: replace to class-based event binding\n\n\n  $(document.body).on(\"click\", \"a\", function (event) {\n    if (isPlainLeftClick(event) && this.getAttribute(\"data-prevent-overlay\") == null && getObjectTypeFromUrl(getPathname(this)) === \"Article\") {\n      event.preventDefault(); // note: key event will be detached inside `closeOverlay()` call\n\n      $(document).on(\"keydown.overlayArticle\", handleOverlayArticleKeyEvents);\n      conditionalTransition(this);\n    }\n  });\n  $(\"#overlay-article\").on(\"click\", function (event) {\n    var $targ = $(event.target);\n\n    if (didClickOn($targ, \"#article-container\") || historyData.initialPageIsArticlePage) {//pass\n    } else {\n      store.dispatch(closeOverlay());\n    }\n  });\n}\nexport var OaContainer = {\n  isStatic: function isStatic() {\n    return $(document.body).is(\".static-article\");\n  },\n  getDynamic: function getDynamic() {\n    return $(\"#article-container\");\n  },\n  getStatic: function getStatic() {\n    return $(document);\n  },\n  get: function get() {\n    return this.isStatic() ? this.getStatic() : this.getDynamic();\n  },\n  scrollToTop: function scrollToTop() {\n    if (this.isStatic()) {\n      $(document.body.parentElement).scrollTop(0);\n    } else {\n      this.getDynamic().scrollTop(0);\n    }\n  }\n};","import { extractMetaFromArticleURL, extractMetaFromURL } from 'fancyutils';\nimport { history } from 'common-components';\nimport store from '../store/store';\nimport { closeOverlay, fetchArticle } from '../action/action-helpers';\nimport { closeArticle } from '../action/actions';\nvar initialArticlePageID = extractMetaFromArticleURL(location.pathname).id;\nvar initialPageIsArticlePage = initialArticlePageID != null; // This stores initial static page history info that needs to be restored when modal get closed.\n\nexport var historyData = {\n  initialPath: location.pathname,\n\n  /* mut */\n  preservedHref: location.href,\n  // Preserved Href just before open, and to be returned when closed.\n  initialArticlePageID: initialArticlePageID,\n  initialPageIsArticlePage: initialPageIsArticlePage,\n  initialTitle: document.title,\n  // This prop indicates current location is (static) article page. Mutable.\n  locationIsArticlePage: initialPageIsArticlePage,\n  overlayIsOn: false\n};\nexport function runOverlay(articleID, articleURLType) {\n  var killCache = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var queryString = arguments.length > 3 ? arguments[3] : undefined;\n\n  if (!$(document.body).hasClass('error-page')) {\n    // Context needs to be isolated from hook: https://github.com/rackt/redux-router/issues/157\n    requestIdleCallback(function () {\n      $(document.body).addClass('article-overlay-on');\n      store.dispatch(fetchArticle(articleID, articleURLType, killCache, queryString));\n      historyData.overlayIsOn = true;\n    });\n  }\n}\nexport function stopOverlay() {\n  historyData.overlayIsOn = false;\n  store.dispatch(closeOverlay());\n}\nexport function historyHook(_ref) {\n  var pathname = _ref.pathname,\n      search = _ref.search;\n  var meta = extractMetaFromArticleURL(pathname);\n  var articleID = meta && meta.id; // When initially (statically) renderred page is article page\n  // Moving to new article page\n\n  historyData.locationIsArticlePage = articleID != null;\n\n  if (historyData.locationIsArticlePage) {\n    runOverlay(articleID, meta.type, false, search);\n  } else if (historyData.overlayIsOn) {\n    stopOverlay();\n  }\n}\nhistory.listen(historyHook);","import { extractMetaFromArticleURL, getObjectTypeFromUrl, isStaticPage, stripPathname } from 'fancyutils';\nimport { history } from 'common-components';\nimport { historyData } from './history';\nexport var LinkTypes = {\n  Dynamic: 0,\n  Static: 1,\n  Timeline: 2,\n  Internal: 3 // no update needed\n\n}; // `staticLink`: transition from statically attached links\n\nexport function transition(href) {\n  // ID-only\n  if (!_.isNaN(Number(href))) {\n    href = \"/articles/\".concat(href);\n  }\n\n  if (getObjectTypeFromUrl(href) === 'Article') {\n    var meta = extractMetaFromArticleURL(href); // Update URL to go back when overlay is closed\n\n    if (!historyData.overlayIsOn) {\n      historyData.preservedHref = location.href;\n    }\n\n    history.push(stripPathname(meta.href), null);\n  } else {\n    redirect(href);\n  }\n}\nexport function closeModal() {\n  if (isStaticPage()) {\n    return;\n  }\n\n  $(document.body).removeClass('article-overlay-on');\n}\nexport function redirect(destination) {\n  if (destination == null) {\n    return false;\n  } else {\n    location.href = destination;\n    return true;\n  }\n}","// This is entrypoint, which `React.render` takes place after DOM is ready.\nimport React from \"react\";\nimport { Route, Router, Switch } from \"react-router-dom\";\nimport { render } from \"react-dom\";\nimport { Provider } from \"react-redux\";\nimport { selectOrCreate } from \"fancyutils\";\nimport { history } from 'common-components';\nimport App from \"./container/app\";\nimport { attachEntryEvents } from \"./container/entry-events\";\nimport store from \"./store/store\";\nimport OverlayArticle from \"./components/article\";\nimport { historyHook } from \"./container/history\";\n\nvar onLoad = function onLoad() {\n  require(\"./shared\");\n\n  var overlayArticleContainer = selectOrCreate(\"#overlay-article\");\n  var $overlayArticleContainer = $(overlayArticleContainer);\n\n  if ($overlayArticleContainer.hasClass('seo')) {\n    $overlayArticleContainer.empty();\n    $overlayArticleContainer.removeClass('seo');\n  }\n\n  render( /*#__PURE__*/React.createElement(Provider, {\n    store: store\n  }, /*#__PURE__*/React.createElement(Router, {\n    history: history\n  }, /*#__PURE__*/React.createElement(App, null, /*#__PURE__*/React.createElement(Switch, null, /*#__PURE__*/React.createElement(Route, {\n    path: \"/articles/*\",\n    component: OverlayArticle\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"*\",\n    component: function component() {\n      return null;\n    }\n  }))))), overlayArticleContainer, function () {\n    history.listen(historyHook);\n    historyHook({\n      pathname: location.pathname,\n      search: location.search\n    }); // should init once\n\n    attachEntryEvents();\n  });\n};\n\nvar loaded = false;\nvar timer = setInterval(function () {\n  if (loaded) {\n    return;\n  }\n\n  if (window.$ && document.readyState !== 'loading') {\n    loaded = true;\n    clearInterval(timer);\n    onLoad();\n  }\n}, 250);","import { combineReducers } from 'redux';\nimport { extractMetaFromURL, update, updateShallow, isEmpty } from 'fancyutils';\nimport C from './action/action-constants';\nimport { getInitialStoreState } from './store/initial-store';\nimport { updateState } from './appstate';\n\nvar isLoggedIn = function isLoggedIn(viewer) {\n  return !isEmpty(viewer) && viewer.id != null;\n};\n\nvar loaded = false;\nvar lastFullyRenderedArticleID = 0;\n\nfunction appContext() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getInitialStoreState('appContext');\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case C.OPEN_ARTICLE:\n      return updateShallow(state, {\n        visible: true\n      });\n\n    case C.CLOSE_ARTICLE:\n      lastFullyRenderedArticleID = 0;\n      loaded = false;\n      return updateShallow(state, {\n        visible: false,\n        lastFullyRenderedArticleID: lastFullyRenderedArticleID\n      });\n\n    case C.UPDATE_APP_CONTEXT:\n      return updateShallow(state, action.context);\n\n    case C.LOAD_ARTICLE:\n      {\n        // Due to multi-stage rendering (cache -> from-server-data -> ...) \n        // it is unable to check state change correctly just by comparing ID;\n        // Therefore, we set internal state per every update cycle and check \n        // if state is fully updated.\n        // FIXME: when cached response exist, it marks as rendered before\n        if (loaded === true && lastFullyRenderedArticleID !== action.data.id) {\n          lastFullyRenderedArticleID = action.data.id;\n        }\n\n        var viewer = action.data.viewer || window.viewer || {};\n        var loggedIn = isLoggedIn(viewer);\n        var userCountry = action.data.current_country_code || state.userCountry;\n        updateState('loggedIn', loggedIn);\n        updateState('viewer', viewer);\n        loaded = true;\n        return update(state, {\n          lastFullyRenderedArticleID: lastFullyRenderedArticleID,\n          loggedIn: loggedIn,\n          viewer: viewer,\n          userCountry: userCountry\n        });\n      }\n\n    default:\n      return state;\n  }\n}\n\nfunction populateArticleContext(articleData) {\n  articleData.loading = articleData.fromServer !== true;\n  articleData.URLMeta = extractMetaFromURL(location.href); // FIXME: provide current pathname\n\n  articleData.owner = articleData.user;\n} // Article context\n\n\nfunction article() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getInitialStoreState('article');\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case C.LOAD_ARTICLE:\n      populateArticleContext(action.data);\n      return updateShallow(state, {\n        data: action.data,\n        status: action.status,\n        ID: action.ID,\n        pendingID: null,\n        isFetching: false\n      });\n\n    case C.REQUEST_ARTICLE:\n      return update(state, {\n        pendingID: action.pendingID,\n        status: action.status,\n        isFetching: true\n      });\n\n    case C.REQUEST_ARTICLE_FAILURE:\n      return update(state, {\n        status: action.status,\n        isFetching: false\n      });\n    // Reset state\n\n    case C.CLOSE_ARTICLE:\n      return updateShallow(getInitialStoreState('article'));\n\n    default:\n      return state;\n  }\n}\n\nvar rootReducer = combineReducers({\n  appContext: appContext,\n  article: article\n});\nexport default rootReducer;","import { getFancyDepsRoot } from 'fancyutils';\nimport store from './store/store';\nimport { cache } from './cache';\nimport { transition } from './container/routeutils'; // import { reloadCurrentArticle } from './container/history';\n\ngetFancyDepsRoot().Shared = {\n  getStore: function getStore() {\n    return store.getState();\n  },\n  cache: cache,\n  transition: transition // reloadCurrentArticle,\n\n};","import { createStore, applyMiddleware } from 'redux';\nimport thunk from 'redux-thunk';\nimport rootReducer from '../reducers';\nvar middleware = [thunk];\nexport var configureStore = function configureStore(initialState) {\n  return createStore(rootReducer, initialState, applyMiddleware.apply(void 0, middleware));\n};","// Warning: objects has to be flat in each context\nexport function getInitialStoreState(contextName) {\n  switch (contextName) {\n    case 'appContext':\n      return {\n        visible: false,\n        viewer: {},\n        loggedIn: null,\n        userCountry: 'US'\n      };\n\n    case 'article':\n      return {\n        data: null,\n        ID: null,\n        pendingID: null,\n        isFetching: null,\n        status: 'idle' // { idle | request | failed }\n\n      };\n\n    default:\n      console.warn('`getInitialStoreState()`: Unknown context name ', contextName);\n  }\n}\n;\nvar contexts = ['article', 'appContext'];\nexport function getAllInitialStoreState() {\n  return contexts.reduce(function (state, contextKey) {\n    state[contextKey] = getInitialStoreState(contextKey);\n    return state;\n  }, {});\n}","import { configureStore } from './configure-store';\nimport { getAllInitialStoreState } from './initial-store';\nvar store = configureStore(getAllInitialStoreState());\nexport default store;","import { getLocationArgPairs } from 'fancyutils';\nvar _window = window,\n    Fancy = _window.Fancy,\n    track_event = _window.track_event,\n    dataLayer = _window.dataLayer,\n    from_sds_page = _window.from_sds_page,\n    TrackingEvents = _window.TrackingEvents;\nexport function logAddCartMixpanel(_ref) {\n  var salesID = _ref.salesID,\n      saleOptionID = _ref.saleOptionID,\n      utm = _ref.utm,\n      section = _ref.section,\n      via = _ref.via;\n\n  if (salesID == null) {\n    return;\n  }\n\n  if (utm == null) {\n    var currentLocationArgPair = getLocationArgPairs('utm');\n\n    if (currentLocationArgPair) {\n      utm = currentLocationArgPair[1];\n    }\n  }\n\n  var log = {\n    'sale id': salesID,\n    via: via || 'thing page',\n    utm: utm\n  };\n\n  if (section) {\n    log.section = section;\n  }\n\n  if (saleOptionID && salesID !== saleOptionID) {\n    log['option id'] = saleOptionID;\n  }\n\n  try {\n    window.track_event && track_event('Add to Cart', log);\n  } catch (e) {}\n\n  return log;\n}\nexport function addItemToCart(param, callback, meta) {\n  // should be replaced by Fancy.CartAPI.addItem\n  param.from_sds_page = from_sds_page;\n\n  if (window.dataLayer) {\n    window.dataLayer.push({\n      event: 'Add_to_Cart_Button',\n      product_id: param['sale_item_id'],\n      option_id: param['option_id'],\n      products: undefined,\n      products_info: undefined,\n      revenue: undefined\n    });\n  }\n\n  return $.ajax({\n    type: 'POST',\n    url: '/add_item_to_cart.json',\n    data: param\n  }).done(function (json) {\n    if (!json || json.status_code == null) {\n      return;\n    }\n\n    if (json.status_code === 1) {\n      if (meta) {\n        TrackingEvents.addToCart([{\n          id: param.sale_item_id,\n          brand: meta.brand_name,\n          name: meta.title,\n          quantity: param.quantity,\n          price: meta.price,\n          variant: json.option\n        }]); // avoid NaN\n      }\n\n      var args = {\n        'THING_ID': param.thing_id,\n        'ITEMCODE': json.itemcode,\n        'THUMBNAIL_IMAGE_URL': json.image_url,\n        'ITEMNAME': json.itemname,\n        'QUANTITY': json.quantity,\n        'PRICE': json.price,\n        'OPTIONS': json.option,\n        'HTML_URL': json.html_url,\n        'CART_ID': json.cart_id\n      };\n\n      if (json.fancy_price) {\n        args.FANCY_PRICE = json.fancy_price;\n      }\n\n      Fancy.Cart.addItem(args);\n      Fancy.Cart.openPopup();\n    } else if (json.status_code == 0) {\n      if (json.message) {\n        alert(json.message);\n      }\n    }\n  }).always(function () {\n    callback && callback();\n  });\n}"],"mappings":";;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;AC/QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;AC7HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3mBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3XA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;AC9aA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;AC3DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;AClHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;ACjCA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;A","sourceRoot":""}