{"version":3,"sources":["webpack://fancy/./_static/modules/ui/overlay-thing/API.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/FancydUsers.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/Overlay.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/Recommendation.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/Thing.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/ThingCard.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/ThingDetails.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/map.cart.ts","webpack://fancy/./_static/modules/ui/overlay-thing/components/sidebar/action-buttons.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/sidebar/heads/Mixin.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/sidebar/heads/SaleItem.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/sidebar/heads/index.tsx","webpack://fancy/./_static/modules/ui/overlay-thing/components/sidebar/index.js","webpack://fancy/./_static/modules/ui/overlay-thing/data/Countries.js"],"names":["deleteThing","thing","callback","alertify","confirm","ok","param","thing_id","id","uid","user","ntid","$","post","xml","find","length","text","location","href","msg","alert","_handleFancydStateOnLoadThing","thingID","fancyd","fancyd_count","stateSetter","_","loading","fancyStatus","FancyStatus","Idle","getFancyStatus","nextFancydState","getCompletionIdleStatus","currentFancyState","prevFancyState","getNextFancydCount","nextFancyd","currentFancydCount","toggleFancy","currentState","nextFancydCount","ajax","type","url","data","done","json","cache","undefined","fail","bigContainerStyle","width","FancydUsers","fancyAnimation","props","state","getConciseNumberString","ns","setState","event","preventDefault","stopPropagation","appContext","loggedIn","window","require_login","MP","_getInitialState","handleFancydStateOnLoadThing","prevProps","prevThing","isCrawled","bigContainer","handleFancyClick","classnames","getFancydCountString","Component","displayCount","FooterReviews","lazy","getAdminSidebar","viewer","admin","AdminComponent","is_admin_business","is_admin_design","is_admin_wholesale","show_on_homepage","_Overlay","pt","ct","isStaticPage","scrollTop","attr","focus","sales","options","nonSoldoutOptions","filter","o","soldout","minimumOption","min","Number","price","store","updateSaleContext","saleOptionID","display","historyData","showReview","isEmpty","reviews","isSafari","ReduxComponentEnhancer","connect","mapStateToThingProps","Overlay","Views","Similar","Recently","scrollTouchdown","isReached","similarLoading","updateSimilar","shouldShowRecommendation","OtContainer","wHeight","height","$content","tabHeight","outerHeight","footerHeight","topOffset","offset","top","Timeline","currentView","recently","similar","updateRecently","reset","similarCursorEndReached","nextCursorString","similarNextCursor","CURRENT_LANGCODE","next_cursor","results","unmounted","converted","convertThingsV1ToRest","cacheSimilarThings","logExposed","things","isArray","concat","xhr","console","warn","always","response","i","deletedThing","scrollEvent","debounceUntilTimeout","lastthingID","nextProps","idCopy","thingContext","current","handleToggleSimilar","__Config","nostore","gettext","handleToggleRecently","map","similarThing","idx","recentlyThing","handleDelete","RecommendationItemLoading","Display","forEach","ThingCache","LogExposed","addLog","zoomMargin","ThingViewConfig","zoomBoxSize","zoomScale","ThumbnailsLimit","StaticThingViewConfig","Thing","savedTID","loaded","index","tid","dispatch","slideContext","thumbnailIndex","setTimeout","_isRequestFresh","setThumbnailIndex","promisifiedFetchImage","getImage","src","transitionDuration","diff","saleContext","option","getCurrentSaleOption","thingImagesLength","getSaleImages","nextIndex","ret","changeFigureTo","getAbsoluteIndex","boundarySize","img","marginHoriz","marginVert","$fig","pageX","pageY","$wrapper","wrapper","meta","getImageMeta","left","topPosition","showZoomImage","zoomImageStyle","zd","getZoomImageDimension","zoomImageContainerX","minmax","zoomImageContainerY","backgroundLeft","backgroundTop","bgPosX","bgPosY","backgroundPosition","isZoomable","nextZoom","zoom","moveZoomImage","thumbnailsLimit","saleImages","image","schemeless","style","backgroundImage","getImageURL","opacity","lineHeight","currentThumbIsVideo","thumbType","then","EditPopup","renderPopup","MaxDimension","extend","shouldVideoDisplayed","Basic","on","trigger","assign","backgroundSize","thumbnailChanged","handleThumbnailsLimitChange","More","lastFullyRenderedThingID","META","getDetailType","saleItemId","getSaleItemId","seller","getSeller","showZoom","videoDisplay","prevNextStyle","PlainThing","LaunchApp","element","video","handleZoomBGClick","handleZoomBGMouseMove","startZoom","zoomShow","getBGImageStyle","Video","fullScreen","handleVideoStyle","handleZoomImageClick","getZoomImageStyle","isFit","getBoundaryImageStyle","emojified_name","name","handlePrev","handleNext","username","is_admin_senior","is_admin_brand","is_admin_cs","can_be_modified","is_admin_content","handleEdit","itemTraits","article","utm","section","via","ThingCard","fancydCount","quantity","optionID","showCart","popupOpened","addToCart","appState","itemType","getSales","saleAvailable","isSaleAvailable","saleOptionExists","isSaleOptionExists","getSaleOption","isNaN","seller_id","sale_item_id","sale_id","option_id","traits","title","getThingName","log","salesID","logAddCartMixpanel","discounting","discount_percentage","retail_price","deal_price","brand_name","addItemToCart","sales_available","has_options","available_for_sale","isNumber","max","isSaleOptionAvailable","range","Math","parseInt","target","value","status_code","onDelete","isPlainLeftClick","transition","html_url","LinkTypes","params","waiting","getWaiting","remove","dataType","message","handleLinkClick","throttle","thumb_image_url_310","thumb_image_url_558","itemIdx","saleOptionAvailable","showFrom","max_price","min_price","new_card","active","toggled","handleShowSomething","opened","handleCartAddition","handleTrickClick","handleOptionChange","numberFormat","handleOptionQuantityChange","getQuantityRange","e","subscribed","handleNotifySoldout","getSafeNameProp","handleRecentlyDelete","handleQuickCartToggle","ItemDetail","ReturnPolicyDetailPopup","showMore","onThumbnailsLimitChange","currentTarget","closest","handleChangeFigure","detailRef","detail","shortDescription","children","toArray","reduce","p","n","DetailHeight","setDescriptionDisplayState","full_name","thumbIsVideo","thumbnailURL","Hotel","cdnUtils","optionProps","option_name","handleSelectImage","handleViewAllImages","__html","getDescription","handleMore","handleLess","DeliveryInformation","userCountry","ShippingCountriesPopup","deliveryIsDomestic","ableToShip","expected_delivery_day_1","international_shipping","hideShippingWindow","deliveryDate","getDomesticDeliveryDate","getIntlDeliveryDate","handleShipCountryClick","getCountryByCode","Fancy","track_event","dataLayer","from_sds_page","TrackingEvents","currentLocationArgPair","getLocationArgPairs","push","product_id","products","products_info","revenue","brand","variant","args","itemcode","image_url","itemname","cart_id","fancy_price","FANCY_PRICE","Cart","addItem","openPopup","ActionButtons","handlePurchase","saleOption","request","selectedQuantity","personalization","SaleOptions","currentValue","v","expander","defaultValue","printer","disabled","onChange","onClick","onFocus","unselectedLabel","CartButton","label","SelectBox","className","tabIndex","s","labelValue","MultiOptionState","option_meta","orderMap","m","selected","targetIndex","values","filteredOptions","order","sel","uniq","getPossibleValuesForIndex","MultiOption","multiOptionState","sid","multiOptions","getMultiOptions","indexTypeOf","additional","selectedArray","selectedValue","key","swatch","thumbnail","MultiSelectBox","onMultiSelectBoxChange","MultiSelectBoxOption","MultiSwatch","onClickSwatch","MultiSwatchOption","backgroundColor","MultiThumbnail","onClickThumbnail","MultiThumbnailOption","MultiButton","onClickMutliButton","MultiButtonOption","optionValueFunction","opt","saleNamePrinter","SaleItemSidebarHead","CurrencyPopup","currentCurrency","currencyCode","renderCurrencyPopup","currencyIsUSD","currencySymbol","currencyMoney","approxText","FancyApplePay","os","total","amount","displayItems","checkAvailability","available","testmode","updateAppContext","applePayDisplay","applePayTest","getInitialMultiOptionState","updateSaleOptionIDFromMultiOptionState","presetOptionId","String","selectedOptionName","replace","join","selectedOption","DEBUG","extractSaleOptionIDFromMultiOptionState","amendedID","amendSaleOptionFromMultiOptionState","nextSelected","button","dropdown","some","el","indexOfType","tagName","onClickMultiOptionGen","convertCurrency","initializeMultiOption","checkApplePay","nsc","nextSaleOptionID","_o","mos","so","eq","escapeSelector","get","click","paymentRequest","update","nonSoldout","selectedNonSoldoutOption","nextValue","priceChanges","currencyChanges","discountPercentage","parseFloat","retailPrice","remaining_quantity","optionIsMulti","isOptionMulti","salesOptionsAvailable","isSalesOptionsAvailable","currencyCodeStyle","quantitySelectRange","showSelectbox","cartButtonStyle","applePayButton","Keys","Wrap","Body","Price","sale","floatFormatMinusTwo","handleCurrencyPopupUSD","getApproxText","handleCurrencyPopup","Form","SaleItemOptionsExpander","handleSizeGuidePopup","handleQuantityChange","personalizable","handlePersonalizationChange","handleNotifyLater","sio","ApplePayButton","clicked","country","requestPurchase","err","trace","handleApplePayCheckout","SalesOverview","SizeGuidePopup","hasSizeGuide","size_guide_id","shippingInfo","shipping_info","cost","origin","return_exchange_policy_title","handlePolicyDislplay","description","SidebarHead","SaleItem","is_admin_any","Head","getHead","Sidebar","RequestSalePopup","self","reported","success","$xml","$st","reported_by_viewer","showQuestion","from_list","requestSale","Giftcard","sidebarMerchantInfo","is_seller","reportLabel","handleRequestSaleOpen","handleReport","SidebarMerchantInfo","toggleFollow","followContext","precondition","profile_is_private","following","followStore","popular_seller_saleitems","isFollowingStore","sellerImageAttrs","saleitem_seller","logo_type","indexOf","alt","pops","position","right","fontSize","textDecoration","color","si","handleFollowToggle","seller_followed_count","AskQuestionPopover","sending","showQuestionSuccess","questionFile","questionFileValue","question","threadUrl","files","trim","formData","FormData","append","processData","contentType","res","thread","didClickOn","off","handleQuestionClose","handleAsking","handleQuestionChange","handleQuestionAddFile","handleQuestionFileChange","handleQuestionFileDelete","handleQuestionFileSend","Countries","code","CountriesPair","pairs","sort","a","b","localeCompare"],"mappings":"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","file":"_static_modules_ui_overlay-thing_components_Overlay_tsx.30d6adbfaaee5c1d22f8.js","sourcesContent":["export function deleteThing(thing, callback) {\n    alertify.confirm(\"Remove this from Fancy?\", function(ok) {\n        if (ok) {\n            const param = {\n                thing_id: thing.id,\n                uid: thing.user.id,\n                ntid: thing.ntid,\n            };\n            $.post(\"/remove_new_thing.xml\", param, function(xml) {\n                if ($(xml).find(\"status_code\").length>0 && $(xml).find(\"status_code\").text()==1) {\n                    location.href = $(xml).find(\"url\").text();\n                } else if ($(xml).find(\"status_code\").length>0 && $(xml).find(\"status_code\").text()==0) {\n                    var msg = $(xml).find(\"message\").text();\n                    alertify.alert(msg);\n                }\n                callback && callback();\n            }, \"xml\");\n        } else {\n            callback && callback();\n        }\n    });\n}\n","import React, { Component } from \"react\";\nimport classnames from \"classnames\";\nimport { MP, getConciseNumberString } from \"fancyutils\";\n\nimport { FancyStatus } from \"../config\";\nimport { cache } from \"../cache\";\n\n\nfunction _handleFancydStateOnLoadThing(thingID, { fancyd, fancyd_count }, stateSetter = _ => _) {\n    stateSetter({\n        fancyd,\n        fancyd_count,\n        loading: false,\n        fancyStatus: FancyStatus.Idle\n    });\n}\n\nfunction getFancyStatus(nextFancydState) {\n    return nextFancydState ? FancyStatus.Addition : FancyStatus.Removal;\n}\nfunction getCompletionIdleStatus(currentFancyState) {\n    const prevFancyState = !currentFancyState;\n    return prevFancyState ? FancyStatus.AfterRemoval : FancyStatus.AfterAddition;\n}\nfunction getNextFancydCount(nextFancyd, currentFancydCount) {\n    if (nextFancyd === true) {\n        return currentFancydCount + 1;\n    } else {\n        return currentFancydCount - 1;\n    }\n}\nfunction toggleFancy(thingID, currentState, stateSetter = _ => _) {\n    const { fancyd, fancyd_count, loading } = currentState;\n    const nextFancyd = !fancyd;\n    const nextFancydCount = getNextFancydCount(nextFancyd, fancyd_count);\n\n    if (!loading) {\n        stateSetter({\n            fancyd: nextFancyd,\n            loading: true,\n            fancyd_count: nextFancydCount,\n            fancyStatus: getFancyStatus(nextFancyd)\n        });\n\n        $.ajax({\n            type: \"PUT\",\n            url: `/rest-api/v1/things/${thingID}`,\n            data: {\n                fancyd: nextFancyd\n            }\n        })\n            .done(function(json) {\n                if (json.id && json.fancyd === !fancyd) {\n                    // Completing fancy\n                    const nextFancydCount = json.fancyd === true ? (fancyd_count || 0) + 1 : (fancyd_count || 0) - 1;\n\n                    cache.update(thingID, undefined, \"fancyd\", nextFancyd);\n                    cache.update(thingID, undefined, \"fancyd_count\", nextFancydCount);\n\n                    stateSetter({\n                        loading: false,\n                        fancyd: nextFancyd,\n                        fancyd_count: nextFancydCount,\n                        fancyStatus: getCompletionIdleStatus(nextFancyd)\n                    });\n                } else {\n                    // cancelling fancy\n                    stateSetter({ loading: false, fancyd, fancyd_count, fancyStatus: getFancyStatus(fancyd) });\n                }\n            })\n            .fail(function() {\n                // cancelling fancy\n                stateSetter({ loading: false, fancyd, fancyd_count, fancyStatus: getFancyStatus(fancyd) });\n            });\n    }\n}\n\n// workaround for profile heads overflow on animation\nconst bigContainerStyle = { width: \"285px\" };\n\nexport class FancydUsers extends Component {\n    static defaultProps = {\n        displayCount: 8\n    };\n\n    _getInitialState() {\n        return {\n            fancyAnimation: false,\n            // button state\n            fancyd: null,\n            loading: false,\n            fancyd_count: null,\n            fancyStatus: FancyStatus.Idle // fancyStatus = 'Idle', { Idle | Addition | Removal | After- } - Fancy'd status for animation control\n        };\n    }\n\n    constructor(props) {\n        super(props);\n        this.state = this._getInitialState();\n    }\n\n    getFancydCountString = () => {\n        const { fancyd_count } = this.state;\n        return fancyd_count != null ? getConciseNumberString(fancyd_count, 0) : \"0\";\n    };\n\n    toggleFancy = () => {\n        toggleFancy(this.props.thing.id, this.state, ns => {\n            this.setState(ns);\n        });\n    };\n\n    handleFancydStateOnLoadThing = thing => {\n        if (thing == null) {\n            thing = this.props.thing;\n        }\n        _handleFancydStateOnLoadThing(thing.id, { fancyd: thing.fancyd, fancyd_count: thing.fancyd_count }, ns => {\n            this.setState(ns);\n        });\n    };\n\n    handleFancyClick = event => {\n        event.preventDefault();\n        event.stopPropagation();\n        const { thing } = this.props;\n        if (!this.props.appContext.loggedIn) {\n            window.require_login(null, \"fancy_thing\", thing.id);\n            return;\n        }\n        const { fancyd, loading } = this.state;\n        if (loading) {\n            return;\n        }\n\n        if (!fancyd) {\n            MP(\"Fancy\", { thing_id: thing.id });\n        } else {\n            MP(\"Unfancy\", { thing_id: thing.id });\n        }\n\n        this.toggleFancy();\n    };\n\n    componentDidMount() {\n        this.handleFancydStateOnLoadThing();\n    }\n\n    componentDidUpdate(prevProps) {\n        // Thing has been updated.\n        const { thing } = this.props;\n        const prevThing = prevProps.thing;\n        if (thing.id !== prevThing.id || thing.isCrawled !== prevThing.isCrawled) {\n            this.handleFancydStateOnLoadThing(thing);\n        }\n    }\n\n    render() {\n        const {\n            bigContainer,\n        } = this.props;\n        const { fancyd } = this.state;\n\n        return (\n            <span style={bigContainer && bigContainerStyle} className=\"fancyd_users-wrap\">\n                <span className=\"count\">\n                    <a\n                        onClick={this.handleFancyClick}\n                        className={classnames(\"button button-static fancy _count\", {\n                            fancyd\n                        })}>\n                        {this.getFancydCountString()}\n                    </a>\n                    <span className=\"_fancyd\" />\n                </span>\n            </span>\n        );\n    }\n}\n","import React, { Component, lazy, Suspense } from \"react\";\nimport type { ReactElement } from \"react\";\nimport { connect } from \"react-redux\";\nimport { isEmpty, isStaticPage, isSafari } from \"fancyutils\";\n\nimport { Sidebar } from \"./sidebar/index\";\nimport { historyData } from \"../container/history\";\nimport { mapStateToThingProps } from \"./map\";\n\nconst FooterReviews = lazy(() => import(/* webpackChunkName: \"OverlayThing.extras\" */ \"./FooterReviews\"));\n\nimport Thing from \"./Thing\";\nimport { OverlayPropsV1 } from \"ftypes\";\nimport Timeline from \"./Recommendation\";\n\nimport { updateSaleContext } from \"../action/action-helpers\";\nimport store from \"../store/store\";\n\nfunction getAdminSidebar(props: OverlayPropsV1) {\n    const {\n        appContext: { viewer },\n        thing,\n    } = props;\n    let admin = null;\n\n    let AdminComponent;\n    if (viewer.is_admin_business || viewer.is_admin_design) {\n        AdminComponent = lazy(() => import(/* webpackChunkName: \"OverlayThing.admin\" */ \"./Admin\"));\n    } else if (viewer.is_admin_wholesale && thing.show_on_homepage) {\n        AdminComponent = lazy(() => import(/* webpackChunkName: \"OverlayThing.admin\" */ \"./AdminSimple\"));\n    }\n    if (AdminComponent) {\n        admin = (\n            <Suspense fallback={<div />}>\n                <AdminComponent {...props} fallback={<div />} />\n            </Suspense>\n        );\n    }\n\n    return admin;\n}\n\n// Container class for overlayed thing detail.\nclass _Overlay extends Component<OverlayPropsV1> {\n    // health check\n    componentDidUpdate(prevProps: OverlayPropsV1) {\n        const pt = prevProps.thing;\n        const ct = this.props.thing;\n\n        if (ct != null) {\n            if (!pt || pt.id !== ct.id) {\n                if (isStaticPage()) {\n                    $(window).scrollTop(0);\n                } else {\n                    $(\"#overlay-thing > .popup\").attr(\"tabindex\", -1).focus();\n                }\n                if (ct.sales && ct.sales.options && ct.sales.options.length > 1) {\n                    const nonSoldoutOptions = ct.sales.options.filter((o) => !o.soldout);\n                    let minimumOption;\n                    if (nonSoldoutOptions.length > 0) {\n                        minimumOption = _.min(nonSoldoutOptions, (o) => Number(o.price));\n                    } else {\n                        minimumOption = _.min(ct.sales.options, (o) => Number(o.price));\n                    }\n                    if (ct.sales.options[0].id !== minimumOption.id) {\n                        store.dispatch(updateSaleContext({ saleOptionID: minimumOption.id }));\n                    }\n                }\n            }\n        }\n    }\n\n    render() {\n        const { thing } = this.props;\n\n        let display: ReactElement | null = null;\n        if (historyData.locationIsThingPage) {\n            if (thing != null) {\n                const showReview = thing.sales && !isEmpty(thing.sales.reviews);\n                display = (\n                    <div\n                        className={`wrapper-content thing-detail-container thing-detail-overlay ${\n                            isSafari() ? \"safari\" : \"\"\n                        }`}\n                        key=\"thing-detail-container\">\n                        <div className=\"content\">\n                            <Thing {...this.props} />\n                            {showReview && (\n                                <Suspense fallback={<div />}>\n                                    <FooterReviews {...this.props} />\n                                </Suspense>\n                            )}\n                        </div>\n                        <Sidebar {...this.props} />\n                        <Timeline fallback={<div className=\"timeline other-thing newcard loading\" />} {...this.props} />\n                        {getAdminSidebar(this.props)}\n                        <a href=\"#header\" id=\"scroll-to-top\" style={{ display: \"inline\" }}>\n                            <span>Jump to top</span>\n                        </a>\n                    </div>\n                );\n            } else {\n                display = (\n                    <div\n                        className=\"wrapper-content thing-detail-container thing-detail-overlay\"\n                        key=\"thing-detail-container\"\n                    />\n                );\n            }\n        } else {\n            display = <div key=\"thing-detail-container\" />;\n        }\n\n        return display;\n    }\n}\n\nconst ReduxComponentEnhancer = connect<OverlayPropsV1>(mapStateToThingProps);\nconst Overlay = ReduxComponentEnhancer(_Overlay);\nexport default Overlay;\n","import React, { Component } from \"react\";\nimport classnames from \"classnames\";\n\nimport { isEmpty, convertThingsV1ToRest, debounceUntilTimeout } from \"fancyutils\";\nimport { Display } from \"fancymixin\";\n\nimport { OtContainer, scrollEvent } from \"../container/entry-events\";\nimport { ThingCache, cache } from \"../cache\";\nimport ThingCard from \"./ThingCard\";\n\nconst Views = {\n    Similar: \"similar\",\n    Recently: \"recently\",\n};\n\n// bound later to timeline\nfunction scrollTouchdown(isReached) {\n    if (this.state.similarLoading || isReached !== true) {\n        return;\n    }\n    this.updateSimilar(this.props.thing.id);\n}\n\nfunction shouldShowRecommendation() {\n    if (!OtContainer.isStatic()) {\n        return true;\n    }\n    const wHeight = $(window).height();\n    const $content = $(\"#overlay-thing .wrapper-content .content > .wrapper\");\n    const tabHeight = $(\"#overlay-thing .wrapper-content .timeline .tabs\").outerHeight();\n    const footerHeight = $(\"#overlay-thing .timeline .tabs\").outerHeight();\n    const topOffset = $content.offset().top;\n    return wHeight - (topOffset + ($content.height() + tabHeight) + footerHeight) > 0;\n}\n\nexport default class Timeline extends Component {\n    // Non-react states\n    similarCursorEndReached = null;\n    lastthingID = null;\n    similarNextCursor = null;\n    recentlyNextCursor = null;\n    state = {\n        currentView: Views.Similar,\n        similarLoading: false,\n        recently: [],\n        similar: [],\n    };\n\n    handleToggleSimilar = (event) => {\n        event.preventDefault();\n        this.setState({ currentView: Views.Similar });\n    };\n\n    handleToggleRecently = (event) => {\n        event.preventDefault();\n        this.updateRecently(this.props.thing.id);\n        this.setState({ currentView: Views.Recently });\n    };\n\n    // @param reset - thing is changed, page is 1\n    updateSimilar = (thingID, reset) => {\n        if (thingID == null || this.state.similarLoading || this.similarCursorEndReached) {\n            return;\n        }\n        this.setState({ similarLoading: true }, () => {\n            var nextCursorString = \"\";\n            if (this.similarNextCursor != null) {\n                nextCursorString = `&cursor=${this.similarNextCursor}`;\n            }\n\n            $.ajax({\n                type: \"get\",\n                url: `/might_also_fancy.json?include_sale_item_option=True&rapi_compl=True&thing_id=${thingID}&lang=${\n                    window.CURRENT_LANGCODE || \"\"\n                }&count=20${nextCursorString}`,\n            })\n                .done(({ next_cursor, results }) => {\n                    if (!this.unmounted) {\n                        const { similar } = this.state;\n                        const converted = convertThingsV1ToRest(results);\n                        cacheSimilarThings(converted);\n                        logExposed(converted);\n\n                        // Update/Insert things array\n                        var things;\n                        if (reset || isEmpty(similar)) {\n                            things = converted;\n                        } else if (_.isArray(similar)) {\n                            things = similar.concat(converted);\n                        }\n\n                        // Write if page is reached end.\n                        // this.similarCursorEndReached = ( next_cursor == null || !converted.length) ;    // End reached\n                        this.similarCursorEndReached = true; // End reached\n                        this.similarNextCursor = next_cursor;\n                        this.setState({ similar: things });\n                    }\n                })\n                .fail(function (xhr) {\n                    console.warn(\"updateSimilar():\", xhr);\n                })\n                .always(() => {\n                    this.setState({ similarLoading: false });\n                });\n        });\n    };\n\n    updateRecently = (thingID) => {\n        if (thingID == null) {\n            return;\n        }\n        // TODO: Should update overlay viewed things.\n        $.ajax({\n            type: \"get\",\n            url: `/recently_viewed_things_json?include_sale_item_option=True&rapi_compl=True&thing_id=${thingID}`,\n        })\n            .done((response) => {\n                if (!this.unmounted) {\n                    const recently = convertThingsV1ToRest(response).filter((_, i) => i < 20);\n                    logExposed(recently);\n\n                    this.setState({ recently });\n                }\n            })\n            .fail(function (xhr) {\n                console.warn(\"updateRecently():\", xhr);\n            });\n    };\n\n    handleDelete = (deletedThing) => {\n        this.setState({ recently: this.state.recently.filter((thing) => thing.id !== deletedThing.id) });\n    };\n\n    componentDidMount() {\n        // // in case browser is too big, load manually\n        if (shouldShowRecommendation() || !this.props.thing.sales) {\n            this.updateSimilar(this.props.thing.id);\n        }\n        scrollEvent.attach(debounceUntilTimeout(scrollTouchdown, 150, this));\n        this.lastthingID = this.props.thing.id;\n    }\n\n    componentDidUpdate() {\n        const nextProps = this.props;\n\n        // Thing has changed, reset similar things.\n        if (this.lastthingID !== nextProps.thing.id) {\n            const idCopy = nextProps.thing.id;\n            this.lastthingID = idCopy;\n            this.similarCursorEndReached = null;\n            this.similarNextCursor = null;\n            if (shouldShowRecommendation() || !nextProps.thing.sales) {\n                this.updateSimilar(nextProps.thing.id, true);\n            }\n        }\n    }\n\n    componentWillUnmount() {\n        this.unmounted = true;\n        // this.thingContext.disconnectTimeline();\n        delete this.thingContext;\n    }\n\n    render() {\n        const {\n            appContext,\n            appContext: { loggedIn },\n            thing,\n        } = this.props;\n        const { currentView, recently, similar } = this.state;\n\n        return (\n            <div className={classnames(\"timeline other-thing newcard\", { loading: thing.loading })}>\n                <ul className=\"tabs after\">\n                    <li>\n                        <a\n                            className={classnames(Views.Similar, { current: currentView === Views.Similar })}\n                            onClick={this.handleToggleSimilar}>\n                            {__Config.nostore ? gettext(\"Similar items\") : gettext(\"You may also Fancy\")}\n                        </a>\n                    </li>\n                    <li>\n                        <a\n                            className={classnames(Views.Recently, { current: currentView === Views.Recently })}\n                            onClick={this.handleToggleRecently}>\n                            {gettext(\"Recently viewed\")}\n                        </a>\n                    </li>\n                </ul>\n                {currentView === Views.Similar && (\n                    <div\n                        className=\"inner similar\"\n                        style={{ display: similar.length > 0 || this.state.similarLoading ? \"block\" : \"none\" }}>\n                        <ul className=\"after fancy-suggestions\">\n                            {similar &&\n                                similar.map((similarThing, idx) => (\n                                    <ThingCard\n                                        itemIdx={idx}\n                                        itemType=\"similar\"\n                                        loggedIn={loggedIn}\n                                        key={`timeline-similar-${idx}`}\n                                        viewer={this.props.appContext.viewer}\n                                        appContext={appContext}\n                                        {...similarThing}\n                                    />\n                                ))}\n                        </ul>\n                        <RecommendationItemLoading display={this.state.similarLoading} />\n                    </div>\n                )}\n                {currentView === Views.Recently && (\n                    <div className=\"inner recently\" style={{ display: recently.length > 0 ? \"block\" : \"none\" }}>\n                        <ul className=\"after fancy-suggestions\">\n                            {recently &&\n                                recently.map((recentlyThing, idx) => (\n                                    <ThingCard\n                                        itemIdx={idx}\n                                        itemType=\"recently\"\n                                        loggedIn={loggedIn}\n                                        key={`timeline-recently-${idx}`}\n                                        onDelete={this.handleDelete}\n                                        viewer={this.props.appContext.viewer}\n                                        appContext={appContext}\n                                        {...recentlyThing}\n                                    />\n                                ))}\n                        </ul>\n                    </div>\n                )}\n            </div>\n        );\n    }\n}\n\nfunction RecommendationItemLoading({ display }) {\n    return (\n        <div id=\"infscr-loading\" style={Display.NoneIf(!display)}>\n            <img alt=\"Loading...\" src=\"/_ui/images/common/loading.gif\" />\n            <div />\n        </div>\n    );\n}\n\nfunction cacheSimilarThings(things) {\n    things.forEach((thing) => {\n        if (!cache.exists(thing.id, ThingCache.THINGS)) {\n            cache.add(thing.id, thing, ThingCache.THINGS);\n        }\n    });\n}\n\nfunction logExposed(things) {\n    if (typeof LogExposed == \"undefined\") return;\n    things.forEach((thing) => {\n        window.LogExposed.addLog(thing.id + \"\", \"thing related\");\n    });\n}\n","import React, { Component } from \"react\";\nimport assign from \"object-assign\";\nimport classnames from \"classnames\";\nimport { schemeless, isEmpty, promisifiedFetchImage, renderPopup, minmax, getLocationArgPairs } from \"fancyutils\";\nimport { Display } from \"fancymixin\";\nimport { Video } from \"common-components\";\n\nimport { deleteThing } from \"../API\";\nimport { setThumbnailIndex } from \"../action/actions\";\nimport { updateSaleContext } from \"../action/action-helpers\";\nimport { getCurrentSaleOption, getSaleItemId, getDetailType, getSaleImages, getSeller } from \"./map\";\nimport { ItemDetail } from \"./ThingDetails\";\nimport { StaticThingViewConfig, ThingViewConfig } from \"../config\";\nimport { OverlayPropsV1 } from \"ftypes\";\n\nconst { zoomMargin, zoomBoxSize, zoomScale } = ThingViewConfig;\nconst { ThumbnailsLimit } = StaticThingViewConfig;\n\nexport default class Thing extends Component<OverlayPropsV1, {\n    loaded: boolean,\n    zoom: boolean,\n    zoomImageStyle: Object,\n    thumbnailsLimit: number\n}> {\n    transitionDuration = 350;\n    constructor(props) {\n        super(props);\n        this.state = {\n            loaded: true,\n            zoom: false,\n            zoomImageStyle: Display.None,\n            thumbnailsLimit: ThumbnailsLimit.Basic\n        };\n        $(window).on(\"resize.ThingView\", () => {\n            ThingViewConfig.boundarySize = $(\"#overlay-thing .figure-item figure:visible\").width();\n        });\n    }\n\n    componentDidMount() {\n        $(window).trigger(\"resize.ThingView\");\n    }\n\n    _isRequestFresh = (savedTID: string) => {\n        return !this.state.loaded && savedTID === this.props.thing.id;\n    };\n\n    changeFigureTo = (index, saleOptionID) => {\n        const tid = this.props.thing.id;\n        if (saleOptionID) {\n            this.props.dispatch(updateSaleContext({ saleOptionID }));\n        }\n        if (index !== this.props.slideContext.thumbnailIndex && this.state.loaded === true) {\n            this.setState({ loaded: false }, () => {\n                setTimeout(() => {\n                    if (this._isRequestFresh(tid)) {\n                        this.props.dispatch(setThumbnailIndex(index));\n                        promisifiedFetchImage(\n                            this.getImage(index).src,\n                            () => {\n                                if (this._isRequestFresh(tid)) {\n                                    this.setState({ loaded: true });\n                                }\n                            },\n                            1500\n                        );\n                    }\n                }, this.transitionDuration);\n            });\n        }\n    };\n\n    getAbsoluteIndex = diff => {\n        var {\n            thing,\n            thing: { sales },\n            slideContext,\n            saleContext\n        } = this.props;\n        const option = getCurrentSaleOption(sales, saleContext, true);\n        var thingImagesLength = getSaleImages(thing, option).length;\n        var nextIndex = slideContext.thumbnailIndex + diff;\n        var ret;\n        // => end of index reached (reversed)\n        if (nextIndex < 0) {\n            ret = (nextIndex + thingImagesLength) % thingImagesLength;\n            // => end of index reached\n        } else if (nextIndex >= thingImagesLength) {\n            ret = 0;\n        } else {\n            ret = nextIndex % thingImagesLength;\n        }\n        return ret;\n    };\n\n    handlePrev = event => {\n        event.preventDefault();\n        event.stopPropagation();\n        this.changeFigureTo(this.getAbsoluteIndex(-1));\n    };\n\n    handleNext = event => {\n        event.preventDefault();\n        event.stopPropagation();\n        this.changeFigureTo(this.getAbsoluteIndex(+1));\n    };\n\n    isZoomable = () => {\n        const { boundarySize } = ThingViewConfig;\n        return this.getImage().width > boundarySize;\n    };\n\n    // Calculate zoomed image dimension.\n    getZoomImageDimension = img => {\n        const { boundarySize } = ThingViewConfig;\n        return {\n            width: boundarySize * zoomScale + zoomMargin,\n            height: ((boundarySize * img.height) / img.width) * zoomScale + zoomMargin\n        };\n    };\n\n    // TODO: cache\n    getImageMeta = img => {\n        const { boundarySize } = ThingViewConfig;\n        let width, height, marginHoriz, marginVert;\n\n        // responsive encoding\n        // - regular mode\n        const $fig = $(\"#overlay-thing .figure-item figure\");\n        if ($(window).width() > 700) {\n            width = $fig.width();\n            height = $fig.height();\n            marginHoriz = 0;\n            if (width > height) {\n                marginHoriz = 0;\n                marginVert = (boundarySize - height) / 2;\n            } else {\n                marginHoriz = (boundarySize - width) / 2;\n                marginVert = 0;\n            }\n        // - mobile mode\n        } else {\n        }\n        return { width, height, marginHoriz, marginVert };\n    };\n\n    moveZoomImage = (pageX, pageY) => {\n        const { boundarySize } = ThingViewConfig;\n        const $wrapper = $(this.wrapper);\n        const img = this.getImage();\n        const meta = this.getImageMeta(img);\n\n        const offset = $wrapper.offset();\n        const left = pageX - offset.left;\n        const top = pageY - offset.top;\n\n        // Fishy\n        const topPosition = top - (boundarySize - meta.height) / 2;\n        let showZoomImage;\n        if ($(window).width() <= 700) {\n            showZoomImage = false;\n        } else {\n            showZoomImage = left > 0 && topPosition > 0 && topPosition < meta.height;\n        }\n\n        var zoomImageStyle;\n        if (showZoomImage) {\n            const zd = this.getZoomImageDimension(img);\n            const zoomImageContainerX = minmax(\n                left - zoomMargin,\n                meta.marginHoriz,\n                meta.marginHoriz + meta.width - zoomBoxSize\n            ); // 0 need to be fixed\n            const zoomImageContainerY = minmax(\n                top - zoomMargin,\n                meta.marginVert,\n                meta.marginVert + meta.height - zoomBoxSize\n            ); // 0 need to be fixed\n\n            const backgroundLeft = (zd.width * left) / boundarySize - zoomMargin;\n            const backgroundTop = (zd.height * top) / boundarySize - zoomMargin;\n\n            const bgPosX = -minmax(backgroundLeft, 0, zd.width - zoomBoxSize);\n            const bgPosY = -minmax(backgroundTop, 0, zd.height - zoomBoxSize);\n\n            zoomImageStyle = {\n                left: `${zoomImageContainerX}px`,\n                top: `${zoomImageContainerY}px`,\n                backgroundPosition: `${bgPosX}px ${bgPosY}px`,\n                display: \"inline\"\n            };\n        } else {\n            zoomImageStyle = Display.None;\n        }\n        this.setState({ zoomImageStyle }); // FIXME\n    };\n\n    handleZoomBGClick = event => {\n        event.preventDefault();\n        event.stopPropagation();\n        if (this.isZoomable()) {\n            const nextZoom = !this.state.zoom;\n            this.setState({ zoom: nextZoom });\n            if (nextZoom) {\n                this.moveZoomImage(event.pageX, event.pageY);\n            }\n        }\n    };\n\n    handleZoomBGMouseMove = ({ pageX, pageY }) => {\n        // TODO: deactivate event on video thing\n        if (this.state.zoom) {\n            this.moveZoomImage(pageX, pageY);\n        }\n    };\n\n    // Disable zoom mode when zoom mode is on.\n    handleZoomImageClick = event => {\n        event.preventDefault();\n        event.stopPropagation();\n        this.setState({ zoom: false });\n    };\n\n    getImage = () => {\n        const {\n            thing,\n            thing: { sales },\n            slideContext: { thumbnailIndex },\n            saleContext\n        } = this.props;\n        const { thumbnailsLimit } = this.state;\n        const option = getCurrentSaleOption(sales, saleContext, true);\n        const saleImages = getSaleImages(thing, option, thumbnailsLimit);\n        if (saleImages.length > thumbnailIndex) {\n            return saleImages[thumbnailIndex];\n        } else {\n            return saleImages[0];\n        }\n    };\n\n    getImageURL = () => {\n        const image = this.getImage();\n        return `url(${schemeless(image.src)})`;\n    };\n\n    // Set zoomed image's style\n    getZoomImageStyle() {\n        var ret = {};\n        if (this.isZoomable() && this.state.zoom) {\n            const img = this.getImage();\n            const zd = this.getZoomImageDimension(img);\n            assign(ret, this.state.zoomImageStyle, {\n                backgroundSize: `${zd.width}px ${zd.height}px`,\n                backgroundImage: `url(${img.src})`\n            });\n        } else {\n            ret.display = \"none\";\n        }\n\n        return ret;\n    }\n\n    getBGImageStyle = () => {\n        const { boundarySize } = ThingViewConfig;\n        const style = {\n            backgroundImage: this.getImageURL(),\n            opacity: this.state.loaded ? 1 : 0,\n        };\n\n        if (this.props.slideContext.thumbnailIndex !== 0) {\n            style.lineHeight = `${boundarySize - 2}px`;\n            style.height = boundarySize;\n        }\n\n        return style;\n    };\n\n    shouldVideoDisplayed = () => {\n        const currentThumbIsVideo = this.getImage().thumbType === \"video\";\n        return currentThumbIsVideo;\n    };\n\n    isFit() {\n        return this.getImage().width > 640 || this.props.slideContext.thumbnailIndex === 0;\n    }\n\n    handleThumbnailsLimitChange = thumbnailsLimit => {\n        this.setState({ thumbnailsLimit });\n    };\n\n    handleEdit = () => {\n        const { appContext, thing } = this.props;\n        import(/* webpackChunkName: \"OverlayThing.popup\" */'./popup/index')\n            .then(({ EditPopup }) => {\n                renderPopup(EditPopup, { appContext, thing });\n            });\n    };\n\n    handleDelete = event => {\n        event.preventDefault();\n        event.stopPropagation();\n        deleteThing(this.props.thing);\n    };\n\n    // to keep image boundary as limit of height 640px\n    // https://app.asana.com/0/260912680807/231933133767205\n    MaxDimension = 640;\n    getBoundaryImageStyle = () => {\n        let { width, height } = this.getImage();\n        // let dominant;\n        if (height > width) {\n            if (height > this.MaxDimension) {\n                width = width / (height / this.MaxDimension);\n                height = this.MaxDimension;\n            }\n        }\n        return _.extend(\n            {\n                width,\n                height\n            },\n            Display.NoneIf(this.shouldVideoDisplayed())\n        );\n    };\n\n    // second-positioned vids need to be vertically centered.\n    // https://app.asana.com/0/260912680807/506063369708942/f\n    handleVideoStyle = () => {\n        if (this.props.slideContext.thumbnailIndex !== 0 && this.shouldVideoDisplayed()) {\n            return {\n                top: `${($(\"#overlay-thing .figure-item .figure\").height() -\n                    $(\"#overlay-thing .video_player\").height()) /\n                    2}px`\n            };\n        }\n        return {};\n    };\n\n    componentDidUpdate(nextProps) {\n        const thumbnailChanged = nextProps.slideContext.thumbnailIndex !== this.props.slideContext.thumbnailIndex;\n        if (thumbnailChanged && nextProps.slideContext.thumbnailIndex > this.state.thumbnailsLimit - 1) {\n            this.handleThumbnailsLimitChange(ThumbnailsLimit.More);\n        }\n    }\n\n    render() {\n        var {\n            appContext: { viewer, lastFullyRenderedThingID },\n            thing,\n            thing: { sales, META },\n            saleContext\n        } = this.props;\n        var type = getDetailType(thing);\n\n        // Admin sale item view\n        var saleItemId = getSaleItemId(thing, viewer);\n        var seller = getSeller(thing);\n        var showZoom = this.isZoomable();\n        const option = getCurrentSaleOption(sales, saleContext, true);\n\n        const videoDisplay = this.shouldVideoDisplayed();\n        // show prev/next arrow only for sale items\n        var prevNextStyle;\n        if (\n            META.PlainThing ||\n            META.LaunchApp ||\n            getSaleImages(thing, option, 2).length !== 2 // When image is only 1 (or possibly 0)\n        ) {\n            prevNextStyle = Display.None;\n        }\n        return (\n            <div\n                className=\"wrapper figure-section\"\n                ref={element => {\n                    this.wrapper = element;\n                }}>\n                <div className={classnames(\"figure-item\", { video: videoDisplay })}>\n                    <figure>\n                        <span\n                            onClick={this.handleZoomBGClick}\n                            onMouseMove={this.handleZoomBGMouseMove}\n                            className={classnames(\"figure\", {\n                                startZoom: this.state.zoom,\n                                zoomShow: showZoom,\n                                loading: thing.loading\n                            })}\n                            style={this.getBGImageStyle()}>\n                            {Video.isVideoAvailableForThing(thing) && (\n                                <Video\n                                    object={thing}\n                                    display={videoDisplay}\n                                    lastFullyRenderedObjectID={lastFullyRenderedThingID}\n                                    allow={{ fullScreen: true }}\n                                    style={this.handleVideoStyle()}\n                                />\n                            )}\n                            <em\n                                className=\"zoomImage\"\n                                onClick={this.handleZoomImageClick}\n                                style={this.getZoomImageStyle()}\n                            />\n                            <img\n                                src={schemeless(this.getImage().src)}\n                                className={this.isFit() ? \"fit\" : undefined}\n                                style={this.getBoundaryImageStyle()}\n                                alt={thing.emojified_name || thing.name}\n                            />\n                            <a onClick={this.handlePrev} className=\"prev\" style={prevNextStyle} />\n                            <a onClick={this.handleNext} className=\"next\" style={prevNextStyle} />\n                        </span>\n                        {!isEmpty(thing.user) && !isEmpty(thing.user.username) && (\n                            <span className=\"submitted\">\n                                Submitted by <b>{thing.user.username}</b>\n                            </span>\n                        )}\n                        <span className=\"figure-button\">\n                            {saleItemId &&\n                                seller &&\n                                (viewer.is_admin_senior ||\n                                    viewer.is_admin_business ||\n                                    viewer.is_admin_brand ||\n                                    viewer.is_admin_cs) && (\n                                    <a\n                                        href={`/merchant/products/${saleItemId}/edit?seller_id=${seller.id}`}\n                                        className=\"edit_sale\"\n                                        target=\"_blank\">\n                                        {gettext(\"Edit Sale\")} <small>({gettext(\"Moderator\")})</small>\n                                    </a>\n                                )}\n                            {!isEmpty(sales) &&\n                                (viewer.id == seller.id && !(viewer.is_admin_senior || viewer.is_admin_business)) && (\n                                    <a href={`/merchant/products/${sales.id}/edit`} className=\"edit_sale\" target=\"_blank\">\n                                        {gettext(\"Edit Sale\")}\n                                    </a>\n                                )}\n                            {(thing.can_be_modified || viewer.is_admin_content || viewer.is_admin_business) && (\n                                <a className=\"edit\" onClick={this.handleEdit}>\n                                    {gettext(\"Edit\")}\n                                </a>\n                            )}\n                            {((!isEmpty(thing.user) &&\n                                thing.user.username != null &&\n                                thing.user.username === viewer.username) ||\n                                viewer.is_admin_senior ||\n                                viewer.is_admin_business) && (\n                                <a className=\"remove_new_thing delete\" onClick={this.handleDelete}>\n                                    {gettext(\"Delete item\")}\n                                </a>\n                            )}\n                        </span>\n                    </figure>\n                    {type && (\n                        <ItemDetail\n                            {...this.props}\n                            type={type}\n                            handleChangeFigure={this.changeFigureTo}\n                            thumbnailsLimit={this.state.thumbnailsLimit}\n                            onThumbnailsLimitChange={this.handleThumbnailsLimitChange}\n                        />\n                    )}\n                </div>\n            </div>\n        );\n    }\n}\n","import React, { Component } from \"react\";\nimport classnames from \"classnames\";\nimport { numberFormat, isPlainLeftClick } from \"fancyutils\";\nimport { MoreShareFacade } from \"common-components\";\n\nimport appState from \"../appstate\";\nimport { addItemToCart, logAddCartMixpanel } from \"./map.cart\";\nimport { getSafeNameProp, getThingName } from \"./map\";\nimport { LinkTypes, transition } from \"../container/routeutils\";\nimport { FancydUsers } from \"./FancydUsers\";\nimport { OtContainer } from \"../container/entry-events\";\n\nconst itemTraits = {\n    article: {\n        utm: \"article\",\n        section: \"items\",\n        via: \"article\",\n    },\n    similar: {\n        section: \"recommended\",\n        utm: \"rec\",\n        via: \"thing more\",\n    },\n    recently: {\n        section: \"recently viewed\",\n        utm: \"rv\",\n        via: \"thing more\",\n    },\n};\n\nexport default class ThingCard extends Component {\n    state = {\n        fancydCount: 0,\n        quantity: 1,\n        optionID: null,\n        showCart: false,\n        popupOpened: false,\n    };\n\n    constructor(props) {\n        super(props);\n        this.handleLinkClick = _.throttle(this.handleLinkClick, 500);\n    }\n\n    componentDidMount() {\n        this.setState({ fancydCount: this.props.fancyd_count || 0 });\n    }\n\n    componentWillUnmount() {\n        this.unmounted = true;\n    }\n\n    handleCartAddition = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        this.addToCart();\n    };\n\n    addToCart = () => {\n        if (!appState.loggedIn) {\n            window.require_login && window.require_login();\n            return;\n        }\n        const { id, itemType } = this.props;\n        const { quantity } = this.state;\n\n        const sales = this.getSales();\n        const saleAvailable = this.isSaleAvailable();\n        const saleOptionExists = this.isSaleOptionExists();\n        const option = this.getSaleOption();\n\n        if (!saleAvailable || this.state.loading) {\n            return;\n        }\n        if (isNaN(quantity) || quantity <= 0) {\n            alert(gettext(\"Please select a valid quantity.\"));\n            return;\n        }\n\n        const param = {\n            seller_id: sales.seller.id, // sisi\n            thing_id: id, // tid\n            sale_item_id: sales.sale_id, // sii\n            quantity,\n        };\n        if (saleOptionExists && option) {\n            param.option_id = option.id;\n        }\n\n        const traits = itemTraits[itemType];\n        const title = getThingName(this.props);\n        this.setState({ loading: true }, () => {\n            const log = {\n                salesID: sales.sale_id,\n                utm: traits.utm,\n                section: traits.section,\n                via: traits.via,\n            };\n            if (option) {\n                log.saleOptionID = option.id;\n            }\n            logAddCartMixpanel(log);\n            // ga shit\n            const discounting = sales && sales.discount_percentage !== \"0\";\n            const meta = {\n                title,\n                price: discounting ? sales.retail_price : sales.deal_price,\n                brand_name: sales.seller.brand_name,\n            };\n            addItemToCart(\n                param,\n                () => {\n                    if (!this.unmounted) {\n                        this.setState({ loading: false });\n                    }\n                },\n                meta\n            );\n        });\n    };\n\n    handleQuickCartToggle = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        const saleAvailable = this.isSaleAvailable();\n        const saleOptionExists = this.isSaleOptionExists();\n        if (saleAvailable) {\n            if (saleOptionExists) {\n                this.setState({ showCart: !this.state.showCart });\n            } else {\n                this.addToCart();\n            }\n        } else {\n            this.setState({ showCart: !this.state.showCart });\n        }\n    };\n\n    isSaleAvailable = () => {\n        const { sales_available } = this.props;\n        const sales = this.getSales();\n        if (sales) {\n            return sales_available && sales.quantity !== 0;\n        } else {\n            return false;\n        }\n    };\n\n    getSaleOption = () => {\n        const saleOptionExists = this.isSaleOptionExists();\n        const sales = this.getSales();\n        if (sales && saleOptionExists) {\n            const optionID = this.state.optionID || sales.options[0].id;\n            const option = sales.options.filter((option) => option.id === optionID)[0] || null;\n            return option;\n        } else {\n            return null;\n        }\n    };\n\n    isSaleOptionExists = () => {\n        const sales = this.getSales();\n        if (sales) {\n            return sales.has_options === true;\n        } else {\n            return false;\n        }\n    };\n\n    isSaleOptionAvailable = () => {\n        const option = this.getSaleOption();\n        if (option) {\n            return option.available_for_sale === true && option.quantity !== 0;\n        } else {\n            return false;\n        }\n    };\n\n    getSales = () => {\n        return this.props.sales;\n    };\n\n    getFancydCount = () => {\n        return _.isNumber(this.state.fancydCount) ? this.state.fancydCount : this.props.fancyd_count;\n    };\n\n    handleFancydCount = (diff) => {\n        this.setState({\n            fancydCount: this.state.fancydCount + diff,\n        });\n    };\n\n    getQuantityRange = () => {\n        const saleOptionExists = this.isSaleOptionExists();\n        var max;\n        if (saleOptionExists && this.isSaleOptionAvailable()) {\n            max = this.getSaleOption().quantity;\n        } else if (this.isSaleAvailable()) {\n            max = this.getSales().quantity;\n        }\n        return max == null ? [\"1\"] : _.range(1, Math.min(10, max + 1));\n    };\n\n    handleOptionChange = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        this.setState({ optionID: parseInt(event.target.value, 10), quantity: 1 });\n    };\n\n    handleOptionQuantityChange = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        this.setState({ quantity: parseInt(event.target.value, 10) });\n    };\n\n    handleTrickClick = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        this.setState({ showCart: false });\n    };\n\n    handleRecentlyDelete = () => {\n        $.post(\"/remove_recently_viewed_thing\", { thing_id: this.props.id }, (json) => {\n            if (!json || json.status_code !== 1) {\n                window.alertify.alert(`Sorry, failed to remove \"${this.props.name}\". Please retry.`);\n            } else {\n                this.props.onDelete(this.props);\n            }\n        }).fail(() => {\n            window.alertify.alert(`Sorry, failed to remove \"${this.props.name}\". Please retry.`);\n        });\n    };\n\n    handleLinkClick = (event) => {\n        event.stopPropagation();\n        if (isPlainLeftClick(event)) {\n            event.preventDefault();\n            OtContainer.scrollToTop();\n\n            transition(this.html_url(), LinkTypes.Timeline);\n        }\n    };\n\n    handleShowSomething = (popupOpened) => {\n        this.setState({ popupOpened });\n    };\n\n    handleNotifySoldout = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        if (!appState.loggedIn) {\n            return window.require_login();\n        }\n        const sales = this.getSales();\n        const params = { sale_item_id: sales.sale_id };\n        const waiting = this.getWaiting(sales);\n        if (waiting) {\n            params.remove = 1;\n        }\n\n        $.ajax({\n            type: \"post\",\n            url: \"/wait_for_product.json\",\n            data: params,\n            dataType: \"json\",\n        })\n            .done((json) => {\n                if (!json || json.status_code == null) {\n                    return;\n                }\n                if (json.status_code == 0 && json.message) {\n                    window.alertify.alert(json.message);\n                    return;\n                }\n                const waiting = params.remove ? false : true;\n                this.setState({ waiting });\n            })\n            .fail(function (json) {\n                if (json && json.message) {\n                    window.alertify.alert(json.message);\n                } else {\n                    window.alertify.alert(\"There was an error while processing your request. Please try again later.\");\n                }\n            });\n    };\n\n    getWaiting = () => {\n        const sales = this.getSales();\n        if (sales) {\n            if (this.state.waiting == null) {\n                return sales.waiting;\n            } else {\n                return this.state.waiting;\n            }\n        } else {\n            return false;\n        }\n    };\n\n    html_url = () => {\n        const { utm } = itemTraits[this.props.itemType] || {};\n        return `${this.props.html_url}${utm ? \"?utm=\" + utm : \"\"}`;\n    };\n\n    render() {\n        const { id, thumb_image_url_310, thumb_image_url_558, itemIdx, loggedIn, viewer } = this.props;\n        const { showCart, loading, popupOpened } = this.state;\n        const html_url = this.html_url();\n\n        const sales = this.getSales();\n        const discounting = sales && sales.discount_percentage !== \"0\";\n        const waiting = this.getWaiting();\n\n        const saleAvailable = this.isSaleAvailable();\n        const saleOptionExists = this.isSaleOptionExists();\n        const saleOptionAvailable = this.isSaleOptionAvailable();\n        const showFrom =\n            sales && sales.max_price !== null && sales.min_price !== null && sales.max_price > sales.min_price;\n\n        return __Config.new_card ? (\n            <li className={classnames({ \"quick-cart\": loading, active: popupOpened || showCart })}>\n                <div className={classnames(\"figure-item new\", { toggled: showCart })}>\n                    <figure>\n                        <a\n                            href={html_url}\n                            rel={`thing-${id}`}\n                            onClick={this.handleLinkClick}\n                            data-prevent-overlay=\"true\">\n                            <span className=\"figure\">\n                                <img\n                                    src=\"/_ui/images/common/blank.gif\"\n                                    style={{ backgroundImage: `url(${thumb_image_url_558 || thumb_image_url_310})` }}\n                                />\n                            </span>\n                        </a>\n                        <div className=\"buttons\">\n                            <FancydUsers\n                                thing={this.props}\n                                appContext={this.props.appContext}\n                                displayCount={6}\n                                showFancydUser={false}\n                            />\n                            <MoreShareFacade\n                                objectType=\"thing\"\n                                objectId={id}\n                                loggedIn={loggedIn}\n                                title={getThingName(this.props)}\n                                viewerUsername={viewer.username}\n                                onShowSomething={this.handleShowSomething}\n                            />\n                        </div>\n                        <div\n                            className={classnames(\"show_cart\", { opened: showCart })}\n                            style={!sales ? { display: \"none\" } : undefined}>\n                            {sales && (\n                                <button\n                                    className=\"btn-cart nopopup\"\n                                    onClick={this.handleCartAddition}\n                                    disabled={!saleOptionAvailable}>\n                                    <em>Add to Cart</em>\n                                </button>\n                            )}\n                            <em className=\"sale-item-input\">\n                                <small\n                                    className=\"trick\"\n                                    style={{ display: showCart ? \"block\" : undefined }}\n                                    onClick={this.handleTrickClick}\n                                />\n                                {saleAvailable ? (\n                                    <span className=\"frm\">\n                                        {saleOptionExists && (\n                                            <select\n                                                name=\"option_id\"\n                                                id={`${id}-option_id`}\n                                                onChange={this.handleOptionChange}>\n                                                {sales.options.map((option, i) => (\n                                                    <option\n                                                        key={`other-item-${itemIdx}-saleoption-${i}`}\n                                                        value={option.id}>\n                                                        {option.option} -{\" \"}\n                                                        {!option.available_for_sale || option.quantity === 0\n                                                            ? gettext(\"Sold out\")\n                                                            : `$${numberFormat(option.deal_price, 0)}`}\n                                                    </option>\n                                                ))}\n                                            </select>\n                                        )}\n                                        <select\n                                            className=\"option\"\n                                            id={`${id}-quantity`}\n                                            name=\"quantity\"\n                                            disabled={!saleOptionAvailable}\n                                            onChange={this.handleOptionQuantityChange}>\n                                            {this.getQuantityRange().map((e, i) => (\n                                                <option key={`other-item-${itemIdx}-quantityOption-${i}`} value={e}>\n                                                    {e}\n                                                </option>\n                                            ))}\n                                        </select>\n                                        <button\n                                            className=\"add_to_cart btns-green-embo\"\n                                            onClick={this.handleCartAddition}\n                                            disabled={!saleOptionAvailable}>\n                                            {gettext(\"Add to Cart\")}\n                                        </button>\n                                    </span>\n                                ) : (\n                                    <span className=\"frm\">\n                                        <span className=\"notify-soldout\">Sorry, this item has sold out</span>\n                                        <button\n                                            className={classnames(\"btns-green-embo btn-notify\", {\n                                                subscribed: waiting,\n                                            })}\n                                            onClick={this.handleNotifySoldout}>\n                                            {waiting ? \"Subscribed\" : \"Notify me when available\"}\n                                        </button>\n                                    </span>\n                                )}\n                            </em>\n                        </div>\n                    </figure>\n                    <figcaption>\n                        <a\n                            href={html_url}\n                            className=\"title\"\n                            rel={`thing-${id}`}\n                            onClick={this.handleLinkClick}\n                            data-prevent-overlay=\"true\">\n                            <b className=\"title\" {...getSafeNameProp(this.props)} />\n                            {sales && (\n                                <span\n                                    className={`price ${discounting ? \"sales\" : \"\"} ${saleAvailable ? \"\" : \"soldout\"}`}>\n                                    {discounting && (\n                                        <small key=\"ThingCard2-price-deal\">\n                                            ${numberFormat(sales.retail_price, 0)}\n                                        </small>\n                                    )}\n                                    {showFrom ? (\n                                        <React.Fragment>\n                                            <em className=\"from\">from </em> ${numberFormat(sales.min_price, 0)}\n                                        </React.Fragment>\n                                    ) : (\n                                        `$\n                                        ${numberFormat(sales.deal_price, 0)}`\n                                    )}\n                                </span>\n                            )}\n                        </a>\n                    </figcaption>\n                    <a className=\"delete\" onClick={this.handleRecentlyDelete} />\n                </div>\n            </li>\n        ) : (\n            <li className={classnames({ \"quick-cart\": loading, active: popupOpened || showCart })}>\n                <div className={classnames(\"figure-item\", { toggled: showCart })}>\n                    <figure>\n                        <a\n                            href={html_url}\n                            rel={`thing-${id}`}\n                            onClick={this.handleLinkClick}\n                            data-prevent-overlay=\"true\">\n                            <span className=\"back\" />\n                            <span className=\"figure\">\n                                <img\n                                    src=\"/_ui/images/common/blank.gif\"\n                                    style={{ backgroundImage: `url(${thumb_image_url_558 || thumb_image_url_310})` }}\n                                />\n                            </span>\n                        </a>\n                    </figure>\n                    <figcaption>\n                        <span\n                            className={classnames(\"show_cart\", { opened: showCart })}\n                            style={!sales ? { display: \"none\" } : undefined}>\n                            {sales && (\n                                <button\n                                    className={`price btn-cart nopopup ${discounting ? \"sales\" : \"\"} ${\n                                        saleAvailable ? \"\" : \"soldout\"\n                                    }`}\n                                    onClick={this.handleQuickCartToggle}>\n                                    <em>\n                                        {discounting && (\n                                            <small key=\"ThingCard2-price-deal\">\n                                                ${numberFormat(sales.retail_price, 0)}\n                                            </small>\n                                        )}\n                                        <b>\n                                            {showFrom ? (\n                                                <React.Fragment>\n                                                    <em className=\"from\">from </em> ${numberFormat(sales.min_price, 0)}\n                                                </React.Fragment>\n                                            ) : (\n                                                `$${numberFormat(sales.deal_price, 0)}`\n                                            )}\n                                        </b>\n                                    </em>\n                                </button>\n                            )}\n                            <em className=\"sale-item-input\">\n                                <small\n                                    className=\"trick\"\n                                    style={{ display: showCart ? \"block\" : null }}\n                                    onClick={this.handleTrickClick}\n                                />\n                                {saleAvailable ? (\n                                    <span className=\"frm\">\n                                        {saleOptionExists && (\n                                            <select\n                                                name=\"option_id\"\n                                                id={`${id}-option_id`}\n                                                onChange={this.handleOptionChange}>\n                                                {sales.options.map((option, i) => (\n                                                    <option\n                                                        key={`other-item-${itemIdx}-saleoption-${i}`}\n                                                        value={option.id}>\n                                                        {option.option} -{\" \"}\n                                                        {!option.available_for_sale || option.quantity === 0\n                                                            ? gettext(\"Sold out\")\n                                                            : `$${numberFormat(option.deal_price, 0)}`}\n                                                    </option>\n                                                ))}\n                                            </select>\n                                        )}\n                                        <select\n                                            className=\"option\"\n                                            id={`${id}-quantity`}\n                                            name=\"quantity\"\n                                            disabled={!saleOptionAvailable}\n                                            onChange={this.handleOptionQuantityChange}>\n                                            {this.getQuantityRange().map((e, i) => (\n                                                <option key={`other-item-${itemIdx}-quantityOption-${i}`} value={e}>\n                                                    {e}\n                                                </option>\n                                            ))}\n                                        </select>\n                                        <button\n                                            className=\"add_to_cart btns-green-embo\"\n                                            onClick={this.handleCartAddition}\n                                            disabled={!saleOptionAvailable}>\n                                            {gettext(\"Add to Cart\")}\n                                        </button>\n                                    </span>\n                                ) : (\n                                    <span className=\"frm\">\n                                        <span className=\"notify-soldout\">Sorry, this item has sold out</span>\n                                        <button\n                                            className={classnames(\"btns-green-embo btn-notify\", {\n                                                subscribed: waiting,\n                                            })}\n                                            onClick={this.handleNotifySoldout}>\n                                            {waiting ? \"Subscribed\" : \"Notify me when available\"}\n                                        </button>\n                                    </span>\n                                )}\n                            </em>\n                        </span>\n                        <a\n                            href={html_url}\n                            className=\"title\"\n                            rel={`thing-${id}`}\n                            onClick={this.handleLinkClick}\n                            data-prevent-overlay=\"true\"\n                            {...getSafeNameProp(this.props)}\n                        />\n                        <span className={classnames(\"buttons\" /*, { 'no-cart': saleAvailable }*/)}>\n                            <FancydUsers\n                                thing={this.props}\n                                appContext={this.props.appContext}\n                                displayCount={6}\n                                showFancydUser={false}\n                            />\n                            <MoreShareFacade\n                                objectType=\"thing\"\n                                objectId={id}\n                                loggedIn={loggedIn}\n                                title={getThingName(this.props)}\n                                viewerUsername={viewer.username}\n                                onShowSomething={this.handleShowSomething}\n                            />\n                        </span>\n                    </figcaption>\n                    <a className=\"delete\" onClick={this.handleRecentlyDelete} />\n                </div>\n            </li>\n        );\n    }\n}\n","import React, { Component } from 'react';\nimport classnames from 'classnames';\nimport { cdnUtils, renderPopup } from 'fancyutils';\nimport { Display } from 'fancymixin';\n\nimport {\n    getDescription,\n    getSales,\n    getDomesticDeliveryDate,\n    getIntlDeliveryDate,\n    getSaleImages,\n} from './map';\nimport { getCountryByCode } from '../data/Countries';\nimport { StaticThingViewConfig } from '../config';\nimport { getCurrentSaleOption } from './map';\n\nconst { ThumbnailsLimit } = StaticThingViewConfig;\n\n\nexport class ItemDetail extends Component {\n    DetailHeight = 175;\n    constructor(props) {\n        super(props);\n        this.state = {\n            showMore: false,\n            shortDescription: false\n        };\n    }\n\n    handlePolicyDislplay = (event) => {\n        event.preventDefault();\n        const { thing: { sales }} = this.props;\n        if (sales) {\n            import(/* webpackChunkName: \"OverlayThing.popup\" */'./popup/index')\n            .then(({ ReturnPolicyDetailPopup }) => {\n                renderPopup(ReturnPolicyDetailPopup, { sales });\n            });\n        }\n    }\n\n    handleMore = (event) => {\n        event.preventDefault();\n        this.setState({ showMore: true });\n    }\n\n    handleLess = (event) => {\n        event.preventDefault();\n        this.setState({ showMore: false });\n    }\n\n    handleViewAllImages = () => {\n        this.props.onThumbnailsLimitChange(ThumbnailsLimit.More);\n    }\n/*\n    handleCheckArea(event) {\n        // TODO: check log in\n        event.preventDefault();\n    }\n*/\n    handleSelectImage = (event) => {\n        event.preventDefault();\n        const idx = parseInt($(event.currentTarget).attr('data-idx'));\n        const saleOptionID = parseInt($(event.currentTarget).closest('li').attr('data-option-id')) || undefined;\n        this.props.handleChangeFigure(idx, saleOptionID);\n    }\n\n    setDescriptionDisplayState = () => {\n        const detailRef = $(this.detail);\n        var shortDescription;\n        if (detailRef.length > 0) {\n            // Get some of very first two children, which is not 'more' or 'less'\n            shortDescription = detailRef.children()\n                                        .filter(i => i <= 1)\n                                        .toArray()\n                                        .reduce((p, n) => p + $(n).outerHeight(), 0) < this.DetailHeight;\n        } else {\n            shortDescription = false;\n        }\n        this.props.onThumbnailsLimitChange(ThumbnailsLimit.Basic);\n        this.setState({\n            shortDescription,\n            showMore: false,\n        });\n    }\n\n    componentDidMount() {\n        this.setDescriptionDisplayState();\n    }\n\n    componentDidUpdate(prevProps) {\n        if (prevProps.appContext.lastFullyRenderedThingID !==\n            this.props.appContext.lastFullyRenderedThingID\n        ) {\n            this.setDescriptionDisplayState();\n        }\n    }\n\n    render () {\n        const {\n            //appContext: { userCountry },\n            thing,\n            thing: { META },\n            type,\n            slideContext: { thumbnailIndex },\n            thumbnailsLimit, \n            saleContext\n        } = this.props;\n        const { shortDescription, showMore } = this.state;\n\n        const sales = getSales(type, thing);\n        const option = getCurrentSaleOption(sales, saleContext, true);\n\n        const saleImages = getSaleImages(thing, option, thumbnailsLimit);\n\n        if (type === 'urlOnly') {\n            if(thing.user){\n                return (\n                    <div className=\"figure-detail after\" key=\"thing-figure-detail\" style={Display.NoneIf(thing.loading)}>\n                        <p className=\"asset\">\n                            {gettext(\"Added by \")}\n                            <a href={thing.user.html_url} target=\"_blank\">\n                                {thing.user.full_name}\n                            </a>\n                        </p>\n                    </div>\n                );\n            } else {\n                return null;\n            }\n        }\n\n        return (\n            <div className=\"figure-detail after\" key=\"thing-figure-detail\" style={Display.NoneIf(thing.loading)}>\n                <div className=\"thumbnail-list\">\n                    <ul className=\"after\">\n                        {saleImages\n                            .map((image, idx) => {\n                                const thumbIsVideo = image.thumbType === 'video';\n                                const thumbnailURL = (thumbIsVideo || META.Hotel) ? image.src : cdnUtils.getResizeURL(image.src, 100, 'crop', true, true);\n                                const optionProps = {};\n                                if (image.option_name) {\n                                    optionProps['data-option-name'] = image.option_name;\n                                }\n                                if (image.option_id) {\n                                    optionProps['data-option-id'] = image.option_id;\n                                }\n                                return (\n                                    <li key={idx} className={thumbnailIndex === idx ? 'current' : null} {...optionProps}>\n                                        <a data-idx={idx}\n                                           style={{ backgroundImage: `url(${thumbnailURL})`}}\n                                           className={classnames(\"thumb\", { \"active\": thumbnailIndex === idx, \"video-thumb\": thumbIsVideo })}\n                                           onClick={this.handleSelectImage}\n                                        />\n                                    </li>\n                                );\n                            })\n                        }\n                        {(saleImages.length >= thumbnailsLimit) &&\n                            <li>\n                                <a className=\"more\" onClick={this.handleViewAllImages}>{gettext(\"View all images\")}</a>\n                            </li>\n                        }\n                    </ul>\n                </div>\n                <div className=\"description\">\n                    <div className={classnames(\"detail\", { 'show': showMore, 'short': shortDescription })} ref={(element) => {this.detail = element;}}>\n                        <h4 className=\"tit\">{gettext('Description')}</h4>\n                        <div dangerouslySetInnerHTML={{ __html: getDescription(type, thing) }}/>\n                        <a onClick={this.handleMore} className=\"more\">{gettext(\"Show More\")}</a>\n                        <a onClick={this.handleLess} className=\"less\">{gettext(\"Show Less\")}</a>\n                    </div>\n                    {(type === 'sales') &&\n                        <ul className=\"after\">\n                            {/*sales.available_for_sameday_shipping &&\n                                <li>\n                                    <label>{gettext('Same-Day Delivery')}</label>\n                                    <span className=\"same-delivery\">\n                                        <i className=\"icon\"></i>{gettext('Get it delivered today.')}\n                                        <a onClick={this.handleCheckArea}\n                                           className=\"same-day-shipping-pop\"> {gettext('Check your area')}\n                                        </a>\n                                    </span>\n                                </li>\n                            */}\n                        </ul>\n                    }\n                </div>\n            </div>\n        );\n    }\n}\n\nexport class DeliveryInformation extends Component {\n    handleShipCountryClick = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        const { appContext: { userCountry }, dispatch } = this.props;\n        import(/* webpackChunkName: \"OverlayThing.popup\" */'./popup/index')\n            .then(({ ShippingCountriesPopup }) => {\n                renderPopup(ShippingCountriesPopup, { dispatch, userCountry });\n            });\n    };\n\n    render() {\n        const { appContext: { userCountry }, thing, type } = this.props;\n\n        const sales = getSales(type, thing);\n        const deliveryIsDomestic = sales && userCountry === 'US';\n        const ableToShip = (deliveryIsDomestic && sales.expected_delivery_day_1) ||\n                           userCountry !== 'US' && sales.international_shipping;\n        const hideShippingWindow = deliveryIsDomestic && !sales.expected_delivery_day_1;\n\n        var deliveryDate;\n        if (ableToShip) {\n            if (deliveryIsDomestic) {\n                deliveryDate = getDomesticDeliveryDate(sales)\n            } else {\n                deliveryDate = getIntlDeliveryDate(sales)\n            }\n        }\n\n        return <li className={`${deliveryIsDomestic ? 'domestic' : 'international'} shipping`}\n                   style={Display.NoneIf(!ableToShip)}>\n            <label>{deliveryDate ? gettext('Estimated Delivery') : gettext('Delivery')}</label>\n            <span className=\"able\" style={Display.NoneIf(!ableToShip)}>\n                {deliveryDate ? `${deliveryDate} days to ` : 'Ships to '}\n                <a onClick={this.handleShipCountryClick}>{getCountryByCode(userCountry)}</a>\n            </span>\n            <span className=\"unable\" style={Display.NoneIf(ableToShip || hideShippingWindow)}>\n                Unable to ship to <a onClick={this.handleShipCountryClick}>{userCountry}</a>\n            </span>\n        </li>\n    }\n}\n","import { getLocationArgPairs } from 'fancyutils';\nimport { GlobalFancySomething } from 'ftypes';\n\n\ndeclare global {\n    interface Window {\n        _: typeof import('underscore');\n        track_event: Function;\n        alertify: alertify.IAlertifyStatic;\n        dataLayer: Array<any>;\n        Fancy: GlobalFancySomething;\n        from_sds_page: boolean;\n        TrackingEvents: {\n            addToCart(_: any): any\n        }\n    }\n}\n\nconst { Fancy, track_event, dataLayer, from_sds_page, TrackingEvents } = window;\n\nexport function logAddCartMixpanel({\n    salesID,\n    saleOptionID,\n    utm,\n    section,\n    via,\n} : {\n    salesID: any;\n    saleOptionID: any;\n    utm: any;\n    section: any;\n    via: any;\n}) {\n    if (salesID == null) {\n        return;\n    }\n    if (utm == null) {\n        const currentLocationArgPair = getLocationArgPairs('utm');\n        if (currentLocationArgPair) {\n            utm = currentLocationArgPair[1];\n        }\n    }\n    const log = {\n        'sale id': salesID,\n        via: via || 'thing page',\n        utm: utm,\n    };\n    if (section) {\n        log.section = section;\n    }\n    if (saleOptionID && salesID !== saleOptionID) {\n        log['option id'] = saleOptionID;\n    }\n    try {\n        window.track_event && track_event('Add to Cart', log);\n    } catch (e) {}\n    return log;\n}\n\nexport function addItemToCart(param, callback, meta) {\n    // should be replaced by Fancy.CartAPI.addItem\n    param.from_sds_page = from_sds_page;\n    if (window.dataLayer) {\n        window.dataLayer.push({\n            event: 'Add_to_Cart_Button',\n            product_id: param['sale_item_id'],\n            option_id: param['option_id'],\n            products: undefined,\n            products_info: undefined,\n            revenue: undefined\n        });\n    }\n    return $.ajax({\n        type: 'POST',\n        url: '/add_item_to_cart.json',\n        data: param\n    })\n    .done(json => {\n        if (!json || json.status_code == null) {\n            return;\n        }\n        if (json.status_code === 1) {\n            if (meta) {\n                TrackingEvents.addToCart([{\n                    id: param.sale_item_id,\n                    brand: meta.brand_name,\n                    name: meta.title,\n                    quantity: param.quantity,\n                    price: meta.price,\n                    variant: json.option,\n                }]); // avoid NaN\n            }\n            var args: any = {\n                'THING_ID': param.thing_id,\n                'ITEMCODE': json.itemcode,\n                'THUMBNAIL_IMAGE_URL': json.image_url,\n                'ITEMNAME': json.itemname,\n                'QUANTITY':json.quantity,\n                'PRICE': json.price,\n                'OPTIONS': json.option,\n                'HTML_URL': json.html_url,\n                'CART_ID': json.cart_id,\n            };\n            if (json.fancy_price) {\n                args.FANCY_PRICE = json.fancy_price;\n            }\n            Fancy.Cart.addItem(args);\n            Fancy.Cart.openPopup();\n        } else if (json.status_code == 0) {\n            if(json.message) {\n                alert(json.message);\n            }\n        }\n    })\n    .always(function() { callback && callback(); });\n}\n","import React, { Component } from 'react';\nimport { MoreShareFacade } from 'common-components';\n\nimport { getThingName } from '../map';\nimport { FancydUsers } from '../FancydUsers';\n\n\nexport default class ActionButtons extends Component {\n    render() {\n        const {\n            appContext: { loggedIn, viewer },\n            thing,\n        } = this.props;\n\n        return (\n            <div className=\"figure-button action-button-v2\">\n                <span className=\"buttons\">\n                    <FancydUsers {...this.props} bigContainer={true} displayCount={4} />\n                    <MoreShareFacade objectType=\"thing\" objectId={thing.id} loggedIn={loggedIn} title={getThingName(thing)}\n                                     viewerUsername={viewer.username} showShortcuts={true} fromThingSidebar={true} />\n                </span>\n            </div>\n        );\n    }\n}\n\n","import React from \"react\";\nimport classnames from \"classnames\";\nimport { getCurrentSaleOption, getThingName } from \"../../map\";\nimport { addItemToCart, logAddCartMixpanel } from \"../../map.cart\";\n\n// Generic purchase handler, needs to be bound to insatnce on initialization.\n/*\n    data-sii={sales.id}\n    data-sisi={sales.seller_id}\n    data-tid={thing.id}\n*/\nexport function handlePurchase(event) {\n    event.preventDefault();\n    const {\n        thing,\n        thing: { sales },\n        saleContext\n    } = this.props;\n    const saleOption = getCurrentSaleOption(sales, saleContext, true);\n    const soldout = saleOption == null ? sales.soldout : saleOption.soldout;\n    if (soldout || this.state.loading) {\n        return;\n    }\n    const saleOptionID = saleOption != null ? saleOption.id : null;\n\n    this.setState({ loading: true }, () => {\n        const log = {\n            salesID: sales.id\n        };\n        if (saleOption) {\n            log.saleOptionID = saleOptionID;\n        }\n        logAddCartMixpanel(log);\n        const request = {\n            thing_id: thing.id,\n            seller_id: thing.sales.seller.id,\n            sale_item_id: sales.id,\n            quantity: saleContext.selectedQuantity,\n            personalization: saleContext.personalization\n        };\n        if (saleOptionID != null) {\n            request.option_id = saleOptionID;\n        }\n        const discounting = sales && sales.discount_percentage !== \"0\";\n        const meta = {\n            title: getThingName(thing),\n            price: discounting ? sales.retail_price : sales.deal_price,\n            brand_name: sales.seller.brand_name\n        };\n        addItemToCart(\n            request,\n            () => {\n                this.setState({ loading: false });\n            },\n            meta\n        );\n    });\n}\n\nconst SaleOptions = ({\n    options = [\"1\"],\n    currentValue = \"1\",\n    id = \"\",\n    value = v => v,\n    expander,\n    defaultValue,\n    printer,\n    disabled,\n    onChange,\n    onClick,\n    onFocus,\n    unselectedLabel\n}) => {\n    expander =\n        expander ||\n        ((option, idx) => (\n            <option key={`sale_options-${idx}`} value={value(option)}>\n                {printer(option)}\n            </option>\n        ));\n\n    return (\n        <select\n            id={id}\n            className={classnames(\"select-boxes2\", { 'one-option': options.length <= 1 })}\n            value={value(currentValue) || defaultValue}\n            disabled={disabled}\n            onChange={onChange}\n            onClick={onClick}\n            onFocus={onFocus}>\n            {unselectedLabel && <option value=\"\">{unselectedLabel}</option>}\n            {options.map(expander)}\n        </select>\n    );\n};\n\nexport const CartButton = props => (\n    <button {...props} label={null}>\n        {props.label}\n    </button>\n);\n\nexport const SelectBox = props => {\n    let { className, disabled, label, currentValue, defaultValue, id, printer, tabIndex, unselectedLabel, options = ['1'] } = props;\n\n    printer = printer != null ? printer : s => s;\n    defaultValue = defaultValue != null ? defaultValue : \"1\";\n    className = className != null ? className : null;\n\n    var labelValue;\n    if (unselectedLabel != null && currentValue === \"\") {\n        labelValue = unselectedLabel;\n    } else {\n        labelValue = printer(currentValue != null ? currentValue : defaultValue);\n    }\n\n    return (\n        <p className={className}>\n            <label>{label}</label>\n            <span className={`trick-select ${id}`}>\n                <a className={classnames(\"selectBox\", { disabled, 'one-option': options.length <= 1 })} tabIndex={tabIndex || \"1\"}>\n                    <span className=\"selectBox-label\">{labelValue}</span>\n                    <span className=\"selectBox-arrow\" />\n                </a>\n                <SaleOptions {...props} printer={printer} defaultValue={defaultValue} />\n            </span>\n        </p>\n    );\n};\n\nexport class MultiOptionState {\n    constructor(options, option_meta) {\n        this.options = options;\n        this.option_meta = option_meta;\n        const orderMap = {};\n        option_meta.forEach(m => {\n            if (orderMap[m.type] == null) {\n                orderMap[m.type] = { length: 1 };\n                orderMap[m.type][m.name] = 0;\n            } else {\n                orderMap[m.type][m.name] = orderMap[m.type].length;\n                orderMap[m.type].length += 1;\n            }\n        });\n        this.orderMap = orderMap;\n    }\n    // i.e.) getPossibleValues(['a', '1', '가'], 1) => ['1', '3', '6']\n    // output: get possible options for 2nd option dependent on ('a' / 1st option)\n    getPossibleValuesForIndex(selected, targetIndex) {\n        const { options, option_meta, orderMap } = this;\n        if (targetIndex === 0) {\n            return option_meta[0].values;\n        }\n        let filteredOptions = options;\n        option_meta\n            .map(m => {\n                const order = orderMap[m.type][m.name];\n                if (selected[m.type][order]) {\n                    return selected[m.type][order];\n                } else {\n                    return selected[m.type][0];\n                }\n            })\n            .forEach((sel, idx) => {\n                if (idx < targetIndex) {\n                    filteredOptions = filteredOptions.filter(option => option.values[idx] === sel);\n                }\n            });\n        return _.uniq(filteredOptions.map(o => o.values[targetIndex])); // FIXME\n    }\n\n    getMultiOptions(selected) {\n        return this.option_meta.map((meta, idx) => {\n            return [meta, this.getPossibleValuesForIndex(selected, idx)];\n        });\n        /*\n        returns [\n            [type, ['a', 'b', 'c']],\n            [type, ['1', '2']],\n            [tyep, ['red', 'white', 'black']]\n        ]\n        */\n    }\n}\n\nexport const MultiOption = props => {\n    const { selected, multiOptionState, sid } = props;\n    if (multiOptionState == null) {\n        return null;\n    } \n    const multiOptions = multiOptionState.getMultiOptions(selected);\n    return multiOptions.map(([meta, values], idx) => {\n        const { type, name } = meta;\n\n        const indexTypeOf = multiOptionState.orderMap[type] && multiOptionState.orderMap[type][name];\n        const additional = {\n            name,\n            values,\n            indexTypeOf,\n            selectedArray: selected && selected[type],\n            selectedValue: selected && selected[type] && selected[type][indexTypeOf],\n            key: `${sid}-${idx}`\n        };\n        if (type === \"dropdown\") {\n            return <MultiSelectBox {...props} {...additional} />;\n        } else if (type === \"swatch\") {\n            additional.swatch = meta.swatch;\n            return <MultiSwatch {...props} {...additional} />;\n        } else if (type === \"thumbnail\") {\n            additional.thumbnail = meta.thumbnail;\n            return <MultiThumbnail {...props} {...additional} />;\n        } else if (type === \"button\") {\n            return <MultiButton {...props} {...additional} />;\n        }\n    });\n};\n\nexport const MultiSelectBox = props => {\n    const { values, name, onMultiSelectBoxChange, indexTypeOf, selectedValue } = props;\n    return (\n        <div className=\"multi-option\">\n            <label>{name}</label>\n            <select onChange={onMultiSelectBoxChange} selected={selectedValue} className={values.length <= 1 ? 'one-option' : null}>\n                {values.map(value => {\n                    return <MultiSelectBoxOption value={value} indexTypeOf={indexTypeOf} />\n                })}\n            </select>\n        </div>\n    );\n};\n\nconst MultiSelectBoxOption = props => {\n    const { value, indexTypeOf } = props;\n    return (\n        <option data-value={value} data-index-typeof={indexTypeOf} value={value}>\n            {value}\n        </option>\n    );\n};\n\nexport const MultiSwatch = props => {\n    const { name, values, swatch, indexTypeOf, selectedValue, onClickSwatch } = props;\n    return (\n        <div className=\"multi-option swatch\">\n            <label>{name}</label>\n            <span className=\"value\">{selectedValue}</span>\n            <ul>\n                {values.map(value => {\n                    return <MultiSwatchOption\n                            value={value}\n                            swatch={swatch}\n                            indexTypeOf={indexTypeOf}\n                            selectedValue={selectedValue}\n                            onClick={onClickSwatch}\n                        />\n                })}\n            </ul>\n        </div>\n    );\n};\n\nconst MultiSwatchOption = props => {\n    const { value, swatch, indexTypeOf, selectedValue, onClick } = props;\n    return (\n        <li>\n            <a\n                href=\"#\"\n                style={{ backgroundColor: swatch[value] }}\n                onClick={onClick}\n                data-value={value}\n                data-index-typeof={indexTypeOf}\n                className={selectedValue === value ? \"selected\" : \"\"}\n            />\n        </li>\n    );\n};\n\nexport const MultiThumbnail = props => {\n    const { values, name, thumbnail, onClickThumbnail, indexTypeOf, selectedValue } = props;\n\n    return (\n        <div className=\"multi-option thumbnail\">\n            <label>{name}</label>\n            <span className=\"value\">{selectedValue}</span>\n            <ul>\n                {values.map(value => {\n                    return <MultiThumbnailOption\n                            onClick={onClickThumbnail}\n                            value={value}\n                            indexTypeOf={indexTypeOf}\n                            selectedValue={selectedValue}\n                            thumbnail={thumbnail}\n                        />\n                })}\n            </ul>\n        </div>\n    );\n};\n\nconst MultiThumbnailOption = ({ onClick, value, indexTypeOf, selectedValue, thumbnail }) => {\n    return (\n        <li>\n            <a\n                href=\"#\"\n                onClick={onClick}\n                data-value={value}\n                data-index-typeof={indexTypeOf}\n                className={selectedValue === value ? \"selected\" : \"\"}>\n                <img\n                    src=\"/_ui/images/common/blank.gif\"\n                    style={{ backgroundImage: `url(\"${thumbnail[value]}\")` }}\n                    alt={value}\n                />\n            </a>\n        </li>\n    );\n};\n\nexport const MultiButton = props => {\n    const { values, name, onClickMutliButton, indexTypeOf, selectedValue } = props;\n    return (\n        <div className=\"multi-option button\">\n            <label>{name}</label>\n            <ul>\n                {values.map(value => {\n                    return <MultiButtonOption\n                            onClick={onClickMutliButton}\n                            indexTypeOf={indexTypeOf}\n                            selectedValue={selectedValue}\n                            value={value}\n                        />\n                })}\n            </ul>\n        </div>\n    );\n};\n\nconst MultiButtonOption = props => {\n    const { value, onClick, indexTypeOf, selectedValue } = props;\n    return (\n        <li>\n            <button\n                onClick={onClick}\n                className={selectedValue === value ? \"selected\" : \"\"}\n                data-value={value}\n                data-index-typeof={indexTypeOf}>\n                {value}\n            </button>\n        </li>\n    );\n};\n","import React, { Component } from \"react\";\nimport classnames from \"classnames\";\nimport { floatFormatMinusTwo, numberFormat, renderPopup, escapeSelector, getLocationArgPairs } from \"fancyutils\";\nimport { Display } from \"fancymixin\";\n\nimport appState from \"../../../appstate\";\nimport { convertCurrency, updateSaleContext } from \"../../../action/action-helpers\";\nimport ActionButtons from \"../action-buttons\";\nimport { updateAppContext } from \"../../../action/actions\";\nimport {\n    currencyIsUSD,\n    getCurrentSaleOption,\n    getSafeNameProp,\n    getWaiting,\n    isSalesOptionsAvailable,\n    getSales,\n    getDescription,\n    getDomesticDeliveryDate,\n    getIntlDeliveryDate,\n} from \"../../map\";\nimport { Keys } from \"../../Perf\";\nimport { CartButton, SelectBox, handlePurchase, MultiOption, MultiOptionState } from \"./Mixin\";\nimport { getCountryByCode } from \"../../../data/Countries\";\nimport { OverlayPropsV1 } from \"ftypes\";\n\nfunction optionValueFunction(opt) {\n    return opt.id;\n}\nconst saleNamePrinter = (opt) => `${opt.name} - $${opt.price}`;\n\nexport default class SaleItemSidebarHead extends Component<\n    OverlayPropsV1,\n    {\n        loading: boolean;\n        selected: Object;\n        disabled: Array<any>;\n    }\n> {\n    state = {\n        loading: false,\n        selected: {},\n        disabled: [],\n    };\n\n    constructor(props: OverlayPropsV1) {\n        super(props);\n        this.handlePurchase = handlePurchase.bind(this);\n        // for multi options\n        this.onClickThumbnail = this.onClickMultiOptionGen(\"thumbnail\");\n        this.onClickSwatch = this.onClickMultiOptionGen(\"swatch\");\n        this.onMultiSelectBoxChange = this.onClickMultiOptionGen(\"dropdown\");\n        this.onClickMutliButton = this.onClickMultiOptionGen(\"button\");\n    }\n\n    renderCurrencyPopup = () => {\n        import(/* webpackChunkName: \"OverlayThing.popup\" */ \"../../popup/index\").then(({ CurrencyPopup }) => {\n            renderPopup(CurrencyPopup, { currentCurrency: this.props.saleContext.currencyCode });\n        });\n    };\n\n    handleCurrencyPopup = (event: React.SyntheticEvent<EventTarget>) => {\n        event.preventDefault();\n        this.renderCurrencyPopup();\n    };\n\n    handleCurrencyPopupUSD = (event: React.SyntheticEvent<EventTarget>) => {\n        event.preventDefault();\n        if (!currencyIsUSD(this.props)) {\n            return false;\n        }\n        this.renderCurrencyPopup();\n    };\n\n    getApproxText = () => {\n        var { currencySymbol, currencyMoney } = this.props.saleContext;\n        var approxText = gettext(\"Approximately\");\n        return `${approxText} ${currencySymbol}${currencyMoney} `;\n    };\n\n    handleOptionChange = (event: React.SyntheticEvent<HTMLInputElement>) => {\n        const { dispatch } = this.props;\n        const saleOptionID = parseInt(event.currentTarget.value, 10);\n        dispatch(updateSaleContext({ saleOptionID }));\n    };\n\n    handleQuantityChange = (event: React.SyntheticEvent<HTMLInputElement>) => {\n        const { dispatch } = this.props;\n        const selectedQuantity = parseInt(event.currentTarget.value, 10);\n        dispatch(updateSaleContext({ selectedQuantity }));\n    };\n\n    handlePersonalizationChange = (event: React.SyntheticEvent<HTMLInputElement>) => {\n        const { dispatch } = this.props;\n        const personalization = event.currentTarget.value;\n        dispatch(updateSaleContext({ personalization }));\n    };\n\n    handleNotifyLater = (event: React.SyntheticEvent<EventTarget>) => {\n        event.preventDefault();\n        event.stopPropagation();\n        if (!appState.loggedIn) {\n            return window.require_login();\n        }\n        const {\n            thing: { sales },\n            saleContext,\n        } = this.props;\n        const opt = getCurrentSaleOption(sales, saleContext, true);\n        const params = { sale_item_id: sales.id };\n\n        if (opt != null) {\n            params.option_id = opt.id;\n        }\n\n        const waiting = getWaiting(sales, saleContext);\n        if (waiting) {\n            params.remove = 1;\n        }\n\n        $.ajax({\n            type: \"post\",\n            url: \"/wait_for_product.json\",\n            data: params,\n            dataType: \"json\",\n        }).done((json) => {\n            if (!json || json.status_code == null) {\n                return;\n            }\n            if (json.status_code == 0 && json.message) {\n                alertify.alert(json.message);\n                return;\n            }\n            const waiting = params.remove ? false : true;\n            this.props.dispatch(updateSaleContext({ waiting }));\n        });\n    };\n\n    checkApplePay = () => {\n        if (window.FancyApplePay) {\n            const { sales } = this.props.thing;\n            const os = sales.options.filter((o) => !o.soldout);\n            const data = {\n                total: { label: sales.title, amount: (sales.price * 100) | 0 },\n            };\n\n            if (os.length > 0) {\n                data.displayItems = os.map((o) => ({\n                    label: o.name,\n                    amount: (Number(o.price) * 100) | 0,\n                }));\n            }\n\n            FancyApplePay.checkAvailability((available, testmode) => {\n                if (available) {\n                    this.props.dispatch(\n                        updateAppContext({\n                            applePayDisplay: true,\n                            applePayTest: testmode,\n                        })\n                    );\n                }\n            }, data);\n        }\n    };\n\n    componentDidMount() {\n        if (!currencyIsUSD(this.props)) {\n            const { saleContext } = this.props;\n            convertCurrency(saleContext.currencyCode, saleContext.price);\n        }\n        this.initializeMultiOption();\n        this.checkApplePay();\n    }\n\n    componentDidUpdate(prevProps) {\n        if (prevProps.thing.id !== this.props.thing.id) {\n            this.initializeMultiOption();\n            this.checkApplePay();\n            return;\n        }\n\n        const {\n            saleContext,\n            thing: { sales },\n        } = prevProps;\n\n        const nsc = this.props.saleContext;\n        const nextSaleOptionID = nsc.saleOptionID;\n        if (saleContext.saleOptionID !== nextSaleOptionID) {\n            const o = _.find(sales.options, (_o) => _o.id === nextSaleOptionID);\n            // option sync\n            if (o) {\n                const mos = $(\".sale-item-input .multi-option\");\n                o.values.forEach((v, i) => {\n                    const so = mos\n                        .eq(i)\n                        .find(`[data-value=\"${escapeSelector(v)}\"]:not(.selected)`)\n                        .get(0);\n                    if (so) {\n                        so.click();\n                    }\n                });\n                if (window.FancyApplePay && FancyApplePay.paymentRequest) {\n                    FancyApplePay.paymentRequest.update({\n                        total: {\n                            label: o.name,\n                            amount: (Number(o.price) * 100) | 0,\n                        },\n                    });\n                }\n            }\n        }\n    }\n\n    initializeMultiOption = () => {\n        const {\n            thing: {\n                sales: { options, option_meta },\n            },\n            saleContext,\n            dispatch,\n        } = this.props;\n\n        this.setState(this.getInitialMultiOptionState(options, option_meta), () => {\n            // don't block selecting cheapest item\n            if (!(options && options.length > 1)) {\n                this.updateSaleOptionIDFromMultiOptionState();\n            }\n            // ?option={number} support\n            const presetOptionId = getLocationArgPairs(\"option\");\n            if (presetOptionId && presetOptionId[1] && String(saleContext.saleOptionID) !== presetOptionId[1]) {\n                dispatch(updateSaleContext({ saleOptionID: parseInt(presetOptionId[1], 10) }));\n            }\n        });\n    };\n\n    getInitialMultiOptionState(options, option_meta) {\n        const selected = { swatch: [], button: [], thumbnail: [], dropdown: [] };\n        if (option_meta.length > 0) {\n            const nonSoldout = options.filter((o) => o.quantity !== 0);\n            if (nonSoldout.length !== 0) {\n                const selectedNonSoldoutOption = nonSoldout[0]; // temporary - FIXME\n                option_meta.forEach(function (opt, i) {\n                    const { type } = opt;\n                    const nextValue = selectedNonSoldoutOption.values[i];\n                    selected[type].push(nextValue);\n                });\n            } else {\n                // set first available multi option\n                option_meta.forEach(function (opt) {\n                    const { type } = opt;\n                    const nextValue = opt.values[0];\n                    selected[type].push(nextValue);\n                });\n            }\n        }\n        const multiOptionState = new MultiOptionState(options, option_meta);\n        return { selected, multiOptionState };\n    }\n\n    extractSaleOptionIDFromMultiOptionState = (selected) => {\n        const {\n            thing: { sales },\n        } = this.props;\n        if (selected == null) {\n            selected = this.state.selected;\n        }\n        const { multiOptionState } = this.state;\n\n        const selectedOptionName = multiOptionState.option_meta\n            .map((m) => {\n                const order = multiOptionState.orderMap[m.type][m.name];\n                if (selected[m.type][order]) {\n                    return selected[m.type][order].replace(\" / \", \"/\");\n                } else {\n                    return selected[m.type][0];\n                }\n            })\n            .join(\" / \");\n        const selectedOption = _.find(sales.options, (opt) => opt.name === selectedOptionName);\n        if (selectedOption) {\n            return selectedOption.id;\n        } else {\n            window.DEBUG &&\n                console.warn(\"no option found for \", selectedOptionName, \"meta:\", sales.options, this.state.selected);\n        }\n    };\n\n    updateSaleOptionIDFromMultiOptionState = () => {\n        const { dispatch } = this.props;\n        let saleOptionID = this.extractSaleOptionIDFromMultiOptionState();\n        if (saleOptionID === undefined) {\n            const amendedID = this.amendSaleOptionFromMultiOptionState();\n            if (amendedID) {\n                saleOptionID = amendedID;\n            } else {\n                window.DEBUG && console.warn(\"Couldn't recover option\");\n            }\n        }\n        dispatch(updateSaleContext({ saleOptionID }));\n    };\n\n    amendSaleOptionFromMultiOptionState = () => {\n        const { selected, multiOptionState } = this.state;\n        const nextSelected = { swatch: [], button: [], thumbnail: [], dropdown: [] };\n        multiOptionState.option_meta.forEach(({ type, name }, index) => {\n            const order = multiOptionState.orderMap[type][name];\n            const selectedValue = selected[type][order];\n            if (index === 0) {\n                nextSelected[type][order] = selectedValue;\n                return;\n            }\n            const values = multiOptionState.getPossibleValuesForIndex(selected, index);\n            let value;\n            if (values.some((v) => v === selectedValue)) {\n                value = selectedValue;\n            } else {\n                value = values[0];\n            }\n            selected[type][order] = value; // even though it will be flushed out, it will affect next options so fix it as well\n            nextSelected[type][order] = value;\n        });\n        this.setState({ selected: nextSelected });\n        return this.extractSaleOptionIDFromMultiOptionState(nextSelected);\n    };\n\n    onClickMultiOptionGen = (type) => {\n        return (e) => {\n            const el = e.currentTarget;\n            let value;\n            let indexOfType;\n            if (el.tagName === \"SELECT\") {\n                value = el.value;\n                indexOfType = Number($(el).find(\":selected\").attr(\"data-index-typeof\"));\n            } else {\n                value = $(el).attr(\"data-value\");\n                indexOfType = Number($(el).attr(\"data-index-typeof\"));\n            }\n            if (e.currentTarget.className === \"disabled\") {\n                return;\n            }\n\n            this.state.selected[type][indexOfType] = value;\n            // forceful trigger even though no differences in value.\n            this.setState({ selected: _.extend({}, this.state.selected) }, this.updateSaleOptionIDFromMultiOptionState);\n        };\n    };\n\n    onClickThumbnail = null;\n    onClickSwatch = null;\n    onMultiSelectBoxChange = null;\n    onClickMutliButton = null;\n\n    UNSAFE_componentWillReceiveProps(nextProps) {\n        const { saleContext } = this.props;\n        const nsc = nextProps.saleContext;\n        const priceChanges = saleContext.price !== nsc.price;\n        const currencyChanges = saleContext.currencyCode !== nsc.currencyCode;\n        if (priceChanges || currencyChanges) {\n            if (!currencyIsUSD(nextProps)) {\n                const { saleContext } = nextProps;\n                convertCurrency(saleContext.currencyCode, saleContext.price, true); // FIXME: unable to comparison since price update comes first (SaleItemSidebarHead.componentWillReceiveProps())\n            }\n        }\n    }\n\n    isOptionMulti(): boolean {\n        const {\n            thing: { sales },\n        } = this.props;\n        // sales.\n        if (sales.option_meta.length > 1) {\n            return true;\n        } else if (sales.option_meta.length === 1) {\n            return sales.option_meta[0].type !== \"dropdown\";\n        } else {\n            return false;\n        }\n    }\n\n    render() {\n        const {\n            thing: { sales },\n            appContext: { applePayDisplay },\n            saleContext,\n            saleContext: { currencyCode, currencySymbol, currencyMoney, selectedQuantity, price },\n        } = this.props;\n\n        var opt = getCurrentSaleOption(sales, saleContext);\n        var discountPercentage = parseFloat(opt.discount_percentage); // TODO: use decimal?\n        var retailPrice = opt.retail_price;\n        const { soldout, quantity, remaining_quantity } = opt;\n        const { option_meta } = sales;\n        const optionIsMulti = this.isOptionMulti();\n\n        const salesOptionsAvailable = isSalesOptionsAvailable(sales);\n        const discounting = discountPercentage > 0;\n        const converted = currencySymbol != null && currencyMoney != null;\n        const currencyCodeStyle = { display: converted && !currencyIsUSD(this.props) ? \"block\" : \"none\" };\n        const quantitySelectRange = soldout ? [\"1\"] : _.range(1, Math.min(10, (quantity || remaining_quantity) + 1));\n        const showSelectbox = sales.options.length !== 0;\n\n        var cartButtonStyle;\n        if (!soldout) {\n            cartButtonStyle = { display: \"none\" };\n        }\n        const waiting = getWaiting(sales, saleContext);\n\n        var applePayButton;\n        if (applePayDisplay && !soldout) {\n            applePayButton = <ApplePayButton {...this.props} />;\n        }\n\n        return (\n            <div key={Keys.Sidebar.Wrap}>\n                <div className=\"wrapper figure-info\" key={Keys.Sidebar.Body}>\n                    <h1 key={Keys.Sidebar.Title} className=\"title\" {...getSafeNameProp(sales)} />\n                    <p className=\"price\" key={Keys.Sidebar.Price}>\n                        <big className={classnames({ sale: discounting })}>\n                            ${floatFormatMinusTwo(price)}\n                            <small className=\"usd\">\n                                <a\n                                    className={classnames(\"code\", { \"currently-usd\": currencyIsUSD(this.props) })}\n                                    onClick={this.handleCurrencyPopupUSD}>\n                                    USD\n                                </a>\n                            </small>\n                        </big>\n                        {discounting && (\n                            <span className=\"sales\">\n                                <em>${floatFormatMinusTwo(retailPrice, 2)}</em> (Save{\" \"}\n                                {numberFormat(discountPercentage, 0)}%)\n                            </span>\n                        )}\n                        <span className=\"currency_price\" style={currencyCodeStyle}>\n                            {this.getApproxText()}\n                            <a className=\"code\" onClick={this.handleCurrencyPopup}>\n                                {currencyCode}\n                            </a>\n                        </span>\n                    </p>\n                    <div className=\"frm\" key={Keys.Sidebar.Form}>\n                        <fieldset className=\"sale-item-input\">\n                            {showSelectbox && !optionIsMulti && (\n                                <SelectBox\n                                    id=\"option\"\n                                    label={gettext(\"Option\")}\n                                    currentValue={opt}\n                                    value={optionValueFunction}\n                                    printer={saleNamePrinter}\n                                    options={sales.options}\n                                    expander={SaleItemOptionsExpander}\n                                    disabled={!salesOptionsAvailable}\n                                    onChange={this.handleOptionChange}\n                                    handleSizeGuidePopup={this.handleSizeGuidePopup}\n                                />\n                            )}\n                            {showSelectbox && !optionIsMulti && (\n                                <SelectBox\n                                    id=\"quantity\"\n                                    label={gettext(\"Quantity\")}\n                                    defaultValue=\"1\"\n                                    currentValue={selectedQuantity}\n                                    options={quantitySelectRange}\n                                    disabled={!!soldout}\n                                    onChange={this.handleQuantityChange}\n                                />\n                            )}\n                            {optionIsMulti && (\n                                <MultiOption\n                                    sid={sales.id}\n                                    onClickThumbnail={this.onClickThumbnail}\n                                    onClickSwatch={this.onClickSwatch}\n                                    onMultiSelectBoxChange={this.onMultiSelectBoxChange}\n                                    onClickMutliButton={this.onClickMutliButton}\n                                    selected={this.state.selected}\n                                    disabled={this.state.disabled}\n                                    soldout={!!soldout}\n                                    option_meta={option_meta}\n                                    multiOptionState={this.state.multiOptionState}\n                                />\n                            )}\n                            {sales.personalizable && (\n                                <div className=\"personalization\">\n                                    <label>This item can be personalized</label>\n                                    <input\n                                        type=\"text\"\n                                        className=\"text\"\n                                        name=\"personalization\"\n                                        placeholder=\"Personalization details\"\n                                        onChange={this.handlePersonalizationChange}\n                                    />\n                                </div>\n                            )}\n                            {applePayButton}\n                            <CartButton\n                                onClick={this.handlePurchase}\n                                className={classnames(\"add_to_cart btn-cart\", {\n                                    \"btns-blue-embo disabled\": soldout,\n                                    \"btns-green-embo\": !soldout,\n                                })}\n                                disabled={!!soldout}\n                                label={soldout ? gettext(\"Sold out\") : gettext(\"Add to cart\")}\n                            />\n                        </fieldset>\n                        <CartButton\n                            className={classnames(\"btn-create notify-available\", { subscribed: waiting })}\n                            label={waiting ? gettext(\"Subscribed\") : gettext(\"Notify me when available\")}\n                            style={cartButtonStyle}\n                            onClick={this.handleNotifyLater}\n                        />\n                        <SalesOverview {...this.props} />\n                        <ActionButtons {...this.props} />\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nfunction SaleItemOptionsExpander(sio, idx) {\n    return (\n        <option value={sio.id} key={`sale_options-${idx}`}>\n            {sio.soldout === true || !(sio.quantity > 0) ? `${sio.name} - ${gettext(\"Sold out\")}` : sio.name}\n        </option>\n    );\n}\n\nclass ApplePayButton extends Component {\n    handleApplePayCheckout = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        if (window.FancyApplePay.clicked) {\n            return;\n        }\n        window.FancyApplePay.clicked = true;\n        const {\n            appContext: { /*applePayDisplay, */ applePayTest },\n        } = this.props;\n        const {\n            thing: { sales },\n            saleContext: { saleOptionID, selectedQuantity, price },\n        } = this.props;\n        const salesOptionsAvailable = isSalesOptionsAvailable(sales);\n\n        var title = sales.title;\n        var country = sales.seller.country;\n        var sale_item_id = sales.id;\n        var seller_id = sales.seller.id;\n        var quantity = selectedQuantity;\n\n        var option_id = null;\n        var option = null;\n        if (salesOptionsAvailable) {\n            option_id = parseInt(saleOptionID, 10) || null; // ? should be same value with option except get casted\n            option = saleOptionID;\n        }\n\n        try {\n            window.FancyApplePay.requestPurchase(\"Dynamic\", {\n                sale_item_id,\n                seller_id,\n                option_id,\n                quantity,\n                price,\n                title,\n                option,\n                country,\n                testmode: applePayTest,\n            });\n        } catch (err) {\n            window.DEBUG && console.trace(err);\n            alert(err);\n            window.FancyApplePay.clicked = false;\n        }\n    };\n\n    render() {\n        return (\n            <div\n                className=\"apple-pay-button apple-pay-thing-button apple-pay-button-with-text apple-pay-button-black-with-text checkout-express\"\n                onClick={this.handleApplePayCheckout}>\n                <span className=\"text\">Buy With</span>\n                <span className=\"logo\" />\n            </div>\n        );\n    }\n}\n\nexport class SalesOverview extends Component {\n    handleShipCountryClick = (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        const {\n            appContext: { userCountry },\n            dispatch,\n        } = this.props;\n        import(/* webpackChunkName: \"OverlayThing.popup\" */ \"../../popup/index\").then(({ ShippingCountriesPopup }) => {\n            renderPopup(ShippingCountriesPopup, { dispatch, userCountry });\n        });\n    };\n\n    handlePolicyDislplay = (event) => {\n        event.preventDefault();\n        const {\n            thing: { sales },\n        } = this.props;\n        if (sales) {\n            import(/* webpackChunkName: \"OverlayThing.popup\" */ \"../../popup/index\").then(\n                ({ ReturnPolicyDetailPopup }) => {\n                    renderPopup(ReturnPolicyDetailPopup, { sales });\n                }\n            );\n        }\n    };\n\n    handleSizeGuidePopup = (event) => {\n        event.preventDefault();\n        import(/* webpackChunkName: \"OverlayThing.popup\" */ \"../../popup/index\").then(({ SizeGuidePopup }) => {\n            renderPopup(SizeGuidePopup, this.props);\n        });\n    };\n\n    render() {\n        const {\n            appContext: { userCountry },\n            thing,\n            type,\n        } = this.props;\n\n        const sales = getSales(type, thing)!;\n        const hasSizeGuide = sales.size_guide_id != null; /*|| (sales.size_chart_ids && sales.size_chart_ids.length)*/\n        const deliveryIsDomestic = sales && userCountry === \"US\";\n        const ableToShip =\n            (deliveryIsDomestic && sales.expected_delivery_day_1) ||\n            (userCountry !== \"US\" && sales.international_shipping);\n        const hideShippingWindow = deliveryIsDomestic && !sales.expected_delivery_day_1;\n\n        var deliveryDate;\n        if (ableToShip) {\n            if (deliveryIsDomestic) {\n                deliveryDate = getDomesticDeliveryDate(sales);\n            } else {\n                deliveryDate = getIntlDeliveryDate(sales);\n            }\n        }\n\n        const shippingInfo : { [k:string] : any } = sales.shipping_info || {};\n\n        return (\n            <div className=\"overview\">\n                <label>Overview</label>\n                <ul className=\"after\">\n                    {shippingInfo.cost && <li className=\"tips\">{shippingInfo.cost}</li>}\n                    <li\n                        className={`${deliveryIsDomestic ? \"domestic\" : \"international\"} shipping`}\n                        style={Display.NoneIf(hideShippingWindow)}>\n                        <label>{deliveryDate ? gettext(\"Estimated Delivery\") : gettext(\"Delivery\")}</label>\n                        <span className=\"able\">{shippingInfo.window}</span>\n                    </li>\n                    {shippingInfo.origin && (\n                        <li className=\"shipping\">\n                            <span>{shippingInfo.origin}</span>\n                        </li>\n                    )}\n                    {sales.return_exchange_policy_title && (\n                        <li>\n                            <label>{gettext(\"Return policy\")}</label>\n                            <span>\n                                {sales.return_exchange_policy_title + \". \"}\n                                <a onClick={this.handlePolicyDislplay}>{gettext(\"View details\")}</a>\n                            </span>\n                        </li>\n                    )}\n                    {hasSizeGuide && (\n                        <li className=\"sizeguide\">\n                            <a href=\"#\" onClick={this.handleSizeGuidePopup}>\n                                View size guide\n                            </a>\n                        </li>\n                    )}\n                </ul>\n                <div className=\"description\">\n                    <div className={classnames(\"detail show\")}>\n                        <h4 className=\"tit\">{gettext(\"Description\")}</h4>\n                        <div dangerouslySetInnerHTML={{ __html: sales.description }} />\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","import React, { Component, lazy, Suspense } from \"react\";\nimport SaleItem from \"./SaleItem\";\n\nexport default class SidebarHead extends Component {\n    getHead(META) {\n        if (META.type === \"SaleItem\") {\n            return SaleItem;\n        } else {\n            if (META.type === \"PlainThing\") {\n                return lazy(() => import(/* webpackChunkName: \"OverlayThing.extras\" */ \"./PlainThing\"));\n            } else if (META.type === \"Giftcard\") {\n                return lazy(() => import(/* webpackChunkName: \"OverlayThing.extras\" */ \"./Giftcard\"));\n            } else if (META.type === \"Vanity\") {\n                return lazy(() => import(/* webpackChunkName: \"OverlayThing.extras\" */ \"./Vanity\"));\n            } else if (META.type === \"Hotel\") {\n                return lazy(() => import(/* webpackChunkName: \"OverlayThing.extras\" */ \"./Hotel\"));\n            } else if (META.type === \"LaunchApp\") {\n                return lazy(() => import(/* webpackChunkName: \"OverlayThing.extras\" */ \"./LaunchApp\"));\n            }\n        }\n    }\n\n    render() {\n        var {\n            thing: { META },\n            appContext: { viewer },\n        } = this.props;\n\n        if (!viewer.is_admin_any && META.type === 'PlainThing') {\n            location.href = '/';\n            return null;\n        }\n\n        const Head = this.getHead(META);\n        if (META.type === \"SaleItem\") {\n            return <Head {...this.props} fallback={<div className=\"wrapper figure-info\" />} />;\n        } else {\n            return (\n                <Suspense fallback={<div />}>\n                    <Head {...this.props} fallback={<div className=\"wrapper figure-info\" />} />\n                </Suspense>\n            );\n        }\n    }\n}\n","import React, { Component } from \"react\";\nimport classnames from \"classnames\";\nimport { isEmpty, cdnUtils, didClickOn, renderPopup, getConciseNumberString } from \"fancyutils\";\nimport { BGImage, Display } from \"fancymixin\";\n\nimport appState from \"../../appstate\";\nimport { toggleFollow } from \"../../action/action-helpers\";\nimport SidebarHead from \"./heads/index\";\n\nexport class Sidebar extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            reported: props.thing.reported_by_viewer,\n            showQuestion: false,\n        };\n    }\n\n    handleRequestSaleOpen = (event) => {\n        event.preventDefault();\n        const { thing } = this.props;\n        import(/* webpackChunkName: \"OverlayThing.popup\" */ \"../popup/index\").then(({ RequestSalePopup }) => {\n            renderPopup(RequestSalePopup, { thing });\n        });\n        return false;\n    };\n\n    componentDidUpdate(prevProps) {\n        const nextProps = this.props;\n        if (nextProps.thing.id !== prevProps.thing.id) {\n            this.setState({ reported: nextProps.thing.reported_by_viewer });\n        }\n    }\n\n    handleReport = (event) => {\n        event.preventDefault();\n        if (!appState.loggedIn) {\n            window.require_login();\n            return;\n        }\n        const self = this;\n        if (self.state.reported) {\n            window.alertify.confirm(window.gettext(\"Cancel Report this?\"), function (e) {\n                if (e) {\n                    $.ajax({\n                        type: \"post\",\n                        url: \"/cancel_report_thing.xml\",\n                        data: { tid: self.props.thing.id },\n                        dataType: \"xml\",\n                        success(xml) {\n                            var $xml = $(xml);\n                            var $st = $xml.find(\"status_code\");\n                            if ($st.length && $st.text() === \"1\") {\n                                window.alertify.alert(window.gettext(\"Cancelled your report.\"));\n                                self.setState({ reported: false });\n                            }\n                        },\n                    });\n                }\n            });\n        } else {\n            window.alertify.confirm(window.gettext(\"Report this as inappropriate or broken?\"), function (e) {\n                if (e) {\n                    $.ajax({\n                        type: \"post\",\n                        url: \"/report_thing.xml\",\n                        data: { tid: self.props.thing.id },\n                        dataType: \"xml\",\n                        success(xml) {\n                            var $xml = $(xml);\n                            var $st = $xml.find(\"status_code\");\n                            if ($st.length && $st.text() === \"1\") {\n                                window.alertify.alert(window.gettext(\"Reported. We'll look into it.\"));\n                                self.setState({ reported: true });\n                            }\n                        },\n                    });\n                }\n            });\n        }\n    };\n\n    render() {\n        var {\n            thing,\n            thing: { META, from_list, sales, sales_available },\n        } = this.props;\n\n        // Should we display 'Request for sale' button?\n        var requestSale = !(sales_available || META.Giftcard || META.Hotel || META.LaunchApp);\n        // Should we show merchant information?\n        var sidebarMerchantInfo;\n        if (sales_available && sales.seller.is_seller && thing.type !== \"fancybox\" && thing.type !== \"vanity_number\") {\n            sidebarMerchantInfo = <SidebarMerchantInfo {...this.props} />;\n        }\n\n        var reported = appState.loggedIn && this.state.reported;\n        var reportLabel = reported ? gettext(\"Undo Reporting\") : gettext(\"Report as inappropriate\");\n\n        return (\n            <aside className=\"sidebar\">\n                <SidebarHead {...this.props} />\n                {/*<SidebarApplePayAd />*/}\n                {sidebarMerchantInfo}\n                {/*<SidebarFancydFriends {...this.props} />*/}\n                {/*(!isEmpty(added_lists) || category_item) && <SidebarAddmore thing={thing} />*/}\n                {/*from_list && <SidebarFromList {...this.props} />*/}\n                {thing && (\n                    <div className=\"flagged\">\n                        {requestSale && <a onClick={this.handleRequestSaleOpen}>{gettext(\"Request for sale\")}</a>}\n                        <a onClick={this.handleReport} className={classnames(\"report-link\", { reported })}>\n                            {reportLabel}\n                        </a>\n                    </div>\n                )}\n            </aside>\n        );\n    }\n}\n\nclass SidebarMerchantInfo extends Component {\n    handleFollowToggle = (event) => {\n        event.preventDefault();\n        if (!appState.loggedIn) {\n            return window.require_login();\n        }\n        var {\n            thing: { sales },\n            dispatch,\n        } = this.props;\n        dispatch(toggleFollow({ seller_id: sales.seller.id }));\n    };\n\n    isFollowingStore(sales, followContext) {\n        var precondition = sales.seller.id !== appState.viewer.id && sales.seller.profile_is_private !== 1;\n        var following = followContext.followStore.following === true;\n\n        return precondition && following;\n    }\n\n    render() {\n        const {\n            appContext: { viewer },\n            thing,\n            thing: {\n                sales,\n                sales: { popular_seller_saleitems },\n            },\n            followContext,\n        } = this.props;\n        const following = this.isFollowingStore(sales, followContext);\n\n        const sellerImageAttrs = {};\n        // FIXME: check serialization\n        if (sales.saleitem_seller && sales.saleitem_seller.logo_type) {\n            if (sales.saleitem_seller.logo_type.indexOf(\"resize-ec.thefancy.com/letters\") == -1) {\n                sellerImageAttrs.url = cdnUtils.resizedSchemelessImage(sales.saleitem_seller.logo_type, 360, \"crop\");\n            } else {\n                sellerImageAttrs.url = sales.saleitem_seller.logo_type.replace(/letters\\/[0-9]+\\//, \"letters/360/\");\n            }\n            sellerImageAttrs.schemeless = true;\n            sellerImageAttrs.alt = `${sales.seller.brand_name} logo image`;\n        }\n\n        const pops = _.uniq(popular_seller_saleitems, false, (e) => e.thing_id).filter((_, idx) => idx < 4);\n        // fill blanks\n        while (pops.length < 4) {\n            pops.push(null);\n        }\n\n        return (\n            <div className={classnames(\"wrapper from thing-more merchant-info\", { loading: thing.loading })}>\n                {__Config.nostore ? (\n                    <div style={{ display: \"flex\" }}>\n                        <h3 className=\"tit\">{gettext(\"You may also like\")}</h3>\n                        <h3\n                            className=\"tit\"\n                            style={{\n                                position: \"absolute\",\n                                right: 0,\n                                fontSize: \"14px\",\n                                textDecoration: \"underline\",\n                            }}>\n                            <a\n                                href={`/shop/${sales.seller.username}`}\n                                style={{\n                                    color: \"#373d48\",\n                                }}>\n                                {gettext(\"See more\")}\n                            </a>\n                        </h3>\n                    </div>\n                ) : (\n                    <a href={`/shop/${sales.seller.username}`} className=\"tit\">\n                        <BGImage {...sellerImageAttrs} />\n                        <small>{gettext(\"More from\")}</small>\n                        <b>\n                            {sales.discount_percentage > 0 && sales.seller.id === 616001\n                                ? \"Fancy Sales\"\n                                : sales.seller.brand_name}\n                        </b>\n                    </a>\n                )}\n                {!isEmpty(popular_seller_saleitems) && (\n                    <ul className=\"after\">\n                        {pops.map((si, idx) => (\n                            <li key={`popular_seller_saleitems-${idx}`}>\n                                <a\n                                    data-idx={idx}\n                                    className=\"figure-img\"\n                                    rel={si ? `thing-${si.thing_id}` : `thing`}\n                                    href={si ? si.html_url : \"#\"}\n                                    onClick={\n                                        si\n                                            ? null\n                                            : (e) => {\n                                                  e.preventDefault();\n                                              }\n                                    }>\n                                    <span\n                                        className=\"price\"\n                                        style={\n                                            si\n                                                ? {\n                                                      backgroundImage: `url(${cdnUtils.resizedSchemelessImage(\n                                                          si.image,\n                                                          160,\n                                                          \"crop\"\n                                                      )})`,\n                                                  }\n                                                : null\n                                        }\n                                    />\n                                </a>\n                            </li>\n                        ))}\n                    </ul>\n                )}\n                {!__Config.nostore && (\n                    <button\n                        className={classnames(\"btns-gray-embo\", following ? \"following\" : \"follow\")}\n                        onClick={this.handleFollowToggle}\n                        style={Display.NoneIf(viewer.id === sales.seller.id)}>\n                        {following ? gettext(\"Following\") : gettext(\"Follow\")}\n                        <small>{getConciseNumberString(sales.seller.seller_followed_count || 0)}</small>\n                    </button>\n                )}\n                <AskQuestionPopover {...this.props} />\n            </div>\n        );\n    }\n}\n\nclass AskQuestionPopover extends Component {\n    state = {\n        sending: false,\n        showQuestion: false,\n        showQuestionSuccess: false,\n        questionFile: null,\n        questionFileValue: \"\",\n        question: \"\",\n        threadUrl: \"\",\n    };\n\n    componentDidUpdate(prevProps) {\n        const nextProps = this.props;\n        if (nextProps.thing.id !== prevProps.thing.id) {\n            this.handleQuestionClose();\n        }\n    }\n\n    handleQuestionClose = (e) => {\n        if (e) {\n            e.preventDefault();\n        }\n        this.setState({\n            sending: false,\n            showQuestion: false,\n            showQuestionSuccess: false,\n            questionFile: null,\n            questionFileValue: \"\",\n            question: \"\",\n            threadUrl: \"\",\n        });\n    };\n\n    handleQuestionFileChange = (e) => {\n        let questionFile, questionFileValue;\n        if (e.target.files) {\n            questionFile = e.target.files[0];\n            questionFileValue = e.target.value;\n        } else {\n            questionFile = null;\n        }\n        this.setState({ questionFile, questionFileValue });\n    };\n\n    handleQuestionFileDelete = (e) => {\n        e.preventDefault();\n        this.setState({ questionFile: null });\n    };\n\n    handleQuestionChange = (event) => {\n        this.setState({ question: event.target.value });\n    };\n\n    handleQuestionFileSend = () => {\n        const { sending, question, questionFile } = this.state;\n        const {\n            thing,\n            thing: { sales },\n        } = this.props;\n\n        if (sending) {\n            return;\n        }\n        if (appState.loggedIn !== true) {\n            window.require_login();\n            return;\n        }\n        if ($.trim(question).length > 2048) {\n            window.alertify.alert(\"Sorry, message is too long. Please write less than 2048 characters.\");\n            return;\n        }\n        this.setState({ sending: true }, () => {\n            const formData = new window.FormData();\n            formData.append(\"seller_id\", sales.seller.id);\n            formData.append(\"things\", thing.id);\n            formData.append(\"message\", question);\n            formData.append(\"attachments\", questionFile);\n\n            $.ajax({\n                url: \"/messages/send-message.json\",\n                processData: false,\n                contentType: false,\n                type: \"POST\",\n                data: formData,\n            })\n                .done((res) => {\n                    if (!res.status_code) {\n                        window.alertify.alert(\n                            res.message || \"Sorry, we couldn't send your message right now. Please try again later.\"\n                        );\n                    } else {\n                        this.setState({ showQuestionSuccess: true, threadUrl: res.thread.url });\n                    }\n                })\n                .fail(() => {\n                    window.alertify.alert(\"Failed to send question. Please try again\");\n                })\n                .always(() => {\n                    this.setState({ sending: false });\n                });\n        });\n    };\n\n    handleAsking = () => {\n        this.setState({ showQuestion: true }, () => {\n            $(\"#overlay-thing\").on(\"click.showQuestion\", (event) => {\n                if (!didClickOn($(event.target), \".ask_seller\") && !didClickOn($(event.target), \".ask\")) {\n                    $(\"#overlay-thing\").off(\"click.showQuestion\");\n                    this.setState({ showQuestion: false });\n                    return false;\n                }\n            });\n            // due to preact behavior, need timeout. otherwise close popup right after opening\n        });\n        return false;\n    };\n\n    render() {\n        const {\n            thing: { sales },\n        } = this.props;\n        const { showQuestion, showQuestionSuccess, questionFile, sending, threadUrl } = this.state;\n\n        const sellerImageAttrs = {};\n        // FIXME: check serialization\n        if (sales.saleitem_seller && sales.saleitem_seller.logo_type) {\n            sellerImageAttrs.url = cdnUtils.resizedSchemelessImage(sales.saleitem_seller.logo_type, 80, \"crop\");\n            sellerImageAttrs.schemeless = true;\n            sellerImageAttrs.alt = `${sales.seller.brand_name} logo image`;\n        }\n        return (\n            <React.Fragment>\n                <a className=\"ask\" onClick={this.handleAsking}>\n                    {gettext(\"Ask a Question\")}\n                </a>\n                <div className=\"ask_seller\" style={Display.NoneIf(!showQuestion)}>\n                    <p className=\"title\">\n                        <BGImage {...sellerImageAttrs} /> {sales.seller.brand_name}\n                    </p>\n                    <fieldset>\n                        <p>\n                            <textarea\n                                className=\"text\"\n                                placeholder={`Ask a question about ${sales.title}`}\n                                onChange={this.handleQuestionChange}\n                            />\n                        </p>\n                        <div className=\"file\">\n                            <span className=\"uploader\" style={Display.NoneIf(questionFile)}>\n                                Add Attachment\n                                <input\n                                    type=\"file\"\n                                    onClick={this.handleQuestionAddFile}\n                                    onChange={this.handleQuestionFileChange}\n                                    value={this.state.questionFileValue}\n                                    accept=\"image/*\"\n                                />\n                            </span>\n                            <span className=\"uploaded\" style={Display.BlockIf(questionFile)}>\n                                {questionFile ? questionFile.name : \"\"}\n                                <a href=\"#\" className=\"delete\" onClick={this.handleQuestionFileDelete} />\n                            </span>\n                        </div>\n                        <button\n                            className=\"btns-blue-embo _send\"\n                            onClick={this.handleQuestionFileSend}\n                            disabled={sending}>\n                            Send\n                        </button>\n                    </fieldset>\n                    <a href=\"#\" className=\"close\" onClick={this.handleQuestionClose} />\n                    <div className=\"success\" style={Display.BlockIf(showQuestion && showQuestionSuccess)}>\n                        <p>\n                            Message sent <a href={threadUrl}>View message</a>\n                        </p>\n                        <a href=\"#\" className=\"close\" onClick={this.handleQuestionClose}>\n                            Close\n                        </a>\n                    </div>\n                </div>\n            </React.Fragment>\n        );\n    }\n}\n","export const Countries = {\n  'AE': 'United Arab Emirates',\n  'AF': 'Afghanistan',\n  'AG': 'Antigua And Barbuda',\n  'AI': 'Anguilla',\n  'AL': 'Albania',\n  'AM': 'Armenia',\n  'AN': 'Netherlands Antilles',\n  'AO': 'Angola',\n  'AQ': 'Antarctica',\n  'AR': 'Argentina',\n  'AS': 'American Samoa',\n  'AT': 'Austria',\n  'AU': 'Australia',\n  'AW': 'Aruba',\n  'AX': 'Aaland Islands',\n  'AZ': 'Azerbaijan',\n  'BA': 'Bosnia And Herzegowina',\n  'BB': 'Barbados',\n  'BD': 'Bangladesh',\n  'BE': 'Belgium',\n  'BF': 'Burkina Faso',\n  'BG': 'Bulgaria',\n  'BH': 'Bahrain',\n  'BI': 'Burundi',\n  'BJ': 'Benin',\n  'BM': 'Bermuda',\n  'BN': 'Brunei Darussalam',\n  'BO': 'Bolivia',\n  'BR': 'Brazil',\n  'BS': 'Bahamas',\n  'BT': 'Bhutan',\n  'BV': 'Bouvet Island',\n  'BW': 'Botswana',\n  'BY': 'Belarus',\n  'BZ': 'Belize',\n  'CA': 'Canada',\n  'CC': 'Cocos (keeling) Islands',\n  'CD': 'Congo, Democratic Republic Of (was Zaire)',\n  'CF': 'Central African Republic',\n  'CG': 'Congo, Republic Of',\n  'CH': 'Switzerland',\n  'CI': \"Cote D'ivoire\",\n  'CK': 'Cook Islands',\n  'CL': 'Chile',\n  'CM': 'Cameroon',\n  'CN': 'China',\n  'CO': 'Colombia',\n  'CR': 'Costa Rica',\n  'CU': 'Cuba',\n  'CV': 'Cape Verde',\n  'CX': 'Christmas Island',\n  'CY': 'Cyprus',\n  'CZ': 'Czech Republic',\n  'DE': 'Germany',\n  'DJ': 'Djibouti',\n  'DK': 'Denmark',\n  'DM': 'Dominica',\n  'DO': 'Dominican Republic',\n  'DZ': 'Algeria',\n  'EC': 'Ecuador',\n  'EE': 'Estonia',\n  'EG': 'Egypt',\n  'EH': 'Western Sahara',\n  'ES': 'Spain',\n  'ET': 'Ethiopia',\n  'FI': 'Finland',\n  'FJ': 'Fiji',\n  'FK': 'Falkland Islands (malvinas)',\n  'FM': 'Micronesia, Federated States Of',\n  'FO': 'Faroe Islands',\n  'FR': 'France',\n  'GA': 'Gabon',\n  'GB': 'United Kingdom',\n  'GD': 'Grenada',\n  'GE': 'Georgia',\n  'GF': 'French Guiana',\n  'GH': 'Ghana',\n  'GI': 'Gibraltar',\n  'GL': 'Greenland',\n  'GM': 'Gambia',\n  'GN': 'Guinea',\n  'GP': 'Guadeloupe',\n  'GQ': 'Equatorial Guinea',\n  'GR': 'Greece',\n  'GS': 'South Georgia And The South Sandwich Islands',\n  'GT': 'Guatemala',\n  'GU': 'Guam',\n  'GW': 'Guinea-bissau',\n  'GY': 'Guyana',\n  'HK': 'Hong Kong',\n  'HM': 'Heard And Mc Donald Islands',\n  'HN': 'Honduras',\n  'HR': 'Croatia (local Name: Hrvatska)',\n  'HT': 'Haiti',\n  'HU': 'Hungary',\n  'ID': 'Indonesia',\n  'IE': 'Ireland',\n  'IL': 'Israel',\n  'IN': 'India',\n  'IO': 'British Indian Ocean Territory',\n  'IQ': 'Iraq',\n  'IR': 'Iran (islamic Republic Of)',\n  'IS': 'Iceland',\n  'IT': 'Italy',\n  'JM': 'Jamaica',\n  'JO': 'Jordan',\n  'JP': 'Japan',\n  'KE': 'Kenya',\n  'KG': 'Kyrgyzstan',\n  'KH': 'Cambodia',\n  'KI': 'Kiribati',\n  'KM': 'Comoros',\n  'KN': 'Saint Kitts And Nevis',\n  'KP': 'Korea, North',\n  'KR': 'Korea, Republic Of',\n  'KW': 'Kuwait',\n  'KY': 'Cayman Islands',\n  'KZ': 'Kazakhstan',\n  'LA': \"Lao People's Democratic Republic\",\n  'LB': 'Lebanon',\n  'LC': 'Saint Lucia',\n  'LI': 'Liechtenstein',\n  'LK': 'Sri Lanka',\n  'LR': 'Liberia',\n  'LS': 'Lesotho',\n  'LT': 'Lithuania',\n  'LU': 'Luxembourg',\n  'LV': 'Latvia',\n  'LY': 'Libyan Arab Jamahiriya',\n  'MA': 'Morocco',\n  'MC': 'Monaco',\n  'MD': 'Moldova, Republic Of',\n  'ME': 'Montenegro',\n  'MG': 'Madagascar',\n  'MH': 'Marshall Islands',\n  'MK': 'Macedonia, The Former Yugoslav Republic Of',\n  'ML': 'Mali',\n  'MM': 'Myanmar',\n  'MN': 'Mongolia',\n  'MO': 'Macau',\n  'MP': 'Northern Mariana Islands',\n  'MQ': 'Martinique',\n  'MR': 'Mauritania',\n  'MS': 'Montserrat',\n  'MT': 'Malta',\n  'MU': 'Mauritius',\n  'MV': 'Maldives',\n  'MW': 'Malawi',\n  'MX': 'Mexico',\n  'MY': 'Malaysia',\n  'MZ': 'Mozambique',\n  'NA': 'Namibia',\n  'NC': 'New Caledonia',\n  'NE': 'Niger',\n  'NF': 'Norfolk Island',\n  'NG': 'Nigeria',\n  'NI': 'Nicaragua',\n  'NL': 'Netherlands',\n  'NO': 'Norway',\n  'NP': 'Nepal',\n  'NR': 'Nauru',\n  'NU': 'Niue',\n  'NZ': 'New Zealand',\n  'OM': 'Oman',\n  'PA': 'Panama',\n  'PE': 'Peru',\n  'PF': 'French Polynesia',\n  'PG': 'Papua New Guinea',\n  'PH': 'Philippines',\n  'PK': 'Pakistan',\n  'PL': 'Poland',\n  'PM': 'Saint Pierre And Miquelon',\n  'PN': 'Pitcairn',\n  'PR': 'Puerto Rico',\n  'PS': 'Palestinian Territory',\n  'PT': 'Portugal',\n  'PW': 'Palau',\n  'PY': 'Paraguay',\n  'QA': 'Qatar',\n  'RE': 'Reunion',\n  'RO': 'Romania',\n  'RS': 'Serbia',\n  'RU': 'Russian Federation',\n  'RW': 'Rwanda',\n  'SA': 'Saudi Arabia',\n  'SB': 'Solomon Islands',\n  'SC': 'Seychelles',\n  'SD': 'Sudan',\n  'SD': 'Sudan',\n  'SE': 'Sweden',\n  'SG': 'Singapore',\n  'SH': 'Saint Helena',\n  'SI': 'Slovenia',\n  'SJ': 'Svalbard And Jan Mayen Islands',\n  'SK': 'Slovakia',\n  'SL': 'Sierra Leone',\n  'SM': 'San Marino',\n  'SN': 'Senegal',\n  'SO': 'Somalia',\n  'SR': 'Suriname',\n  'SS': 'South Sudan',\n  'ST': 'Sao Tome And Principe',\n  'SV': 'El Salvador',\n  'SY': 'Syrian Arab Republic',\n  'SZ': 'Swaziland',\n  'TC': 'Turks And Caicos Islands',\n  'TD': 'Chad',\n  'TF': 'French Southern Territories',\n  'TG': 'Togo',\n  'TH': 'Thailand',\n  'TJ': 'Tajikistan',\n  'TK': 'Tokelau',\n  'TL': 'Timor-leste',\n  'TM': 'Turkmenistan',\n  'TN': 'Tunisia',\n  'TO': 'Tonga',\n  'TR': 'Turkey',\n  'TT': 'Trinidad And Tobago',\n  'TV': 'Tuvalu',\n  'TW': 'Taiwan',\n  'TZ': 'Tanzania, United Republic Of',\n  'UA': 'Ukraine',\n  'UG': 'Uganda',\n  'UM': 'United States Minor Outlying Islands',\n  //'US': 'United States Of America',\n  'US': 'USA',\n  'UY': 'Uruguay',\n  'UZ': 'Uzbekistan',\n  'VA': 'Vatican City State (holy See)',\n  'VC': 'Saint Vincent And The Grenadines',\n  'VE': 'Venezuela',\n  'VG': 'Virgin Islands (british)',\n  'VI': 'Virgin Islands (u.s.)',\n  'VN': 'Viet Nam',\n  'VU': 'Vanuatu',\n  'WF': 'Wallis And Futuna Islands',\n  'WS': 'Samoa',\n  'YE': 'Yemen',\n  'YT': 'Mayotte',\n  'ZA': 'South Africa',\n  'ZM': 'Zambia',\n  'ZW': 'Zimbabwe'\n};\n\nexport function getCountryByCode(code) {\n    return Countries[code];\n}\n\nexport const CountriesPair = _.pairs(Countries).sort((a,b) => a[0].localeCompare(b[0])); // {code: name, ...} => [[code, name], ...] \n"],"sourceRoot":""}