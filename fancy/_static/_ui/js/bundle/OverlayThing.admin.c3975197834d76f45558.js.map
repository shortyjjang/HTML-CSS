{"version":3,"file":"OverlayThing.admin.c3975197834d76f45558.js","sources":["webpack://fancy/./_static/_ui/js/ajaxfileupload.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/Admin.js","webpack://fancy/./_static/modules/ui/overlay-thing/components/AdminSimple.js"],"sourcesContent":["// Support HTML5 file upload by taegon kim\n;\n\n(function ($) {\n  var xhr, plugin;\n  if (window.XMLHttpRequest) xhr = new window.XMLHttpRequest();\n\n  if (xhr && 'upload' in xhr && 'onprogress' in xhr.upload && window.FileReader && window.FormData) {\n    // yeap! this browser supports HTML5 ajax file upload!\n    plugin = {\n      ajaxFileUpload: function ajaxFileUpload(s) {\n        var xhr = new window.XMLHttpRequest(),\n            reader = new FileReader(),\n            $file,\n            file,\n            xml = {}; // import global settings\n\n        s = $.extend({}, $.ajaxSettings, s); // get a file object\n\n        $file = $('#' + s.fileElementId);\n        file = $file[0].files[0];\n\n        reader.onload = function (event) {\n          var data = new FormData();\n          data.append('csrfmiddlewaretoken', getCookie('csrftoken'));\n          data.append($file.attr('name'), file);\n          var settings = {\n            url: s.url,\n            type: 'POST',\n            data: data,\n            async: true,\n            cache: false,\n            processData: false,\n            contentType: false,\n            success: s.success || $.noop,\n            error: s.error || $.noop,\n            complete: s.complete || $.noop,\n            xhr: function xhr() {\n              var xhr = $.ajaxSettings.xhr();\n\n              xhr.upload.onprogress = function (event) {\n                var percent = 0,\n                    pos = event.loaded || event.position,\n                    total = event.total;\n\n                if (event.lengthComputable) {\n                  percent = Math.ceil(pos / total * 100);\n                  (s.progress || $.noop)(percent);\n                }\n              };\n\n              return xhr;\n            }\n          };\n          if (s.dataType) settings.dataType = s.dataType;\n          $.ajax(settings);\n        };\n\n        reader.onerror = function () {\n          if (s.error) s.error();\n          if (s.complete) s.complete();\n        };\n\n        reader.readAsArrayBuffer(file);\n      }\n    };\n  } else {\n    // for old browser\n    plugin = {\n      createUploadIframe: function createUploadIframe(id, uri) {\n        //create frame\n        var frameId = 'jUploadFrame' + id,\n            $io;\n        $io = $('<iframe id=\"' + frameId + '\" name=\"' + frameId + '\" />');\n\n        if (window.ActiveXObject) {\n          if (typeof uri == 'boolean') {\n            $io[0].src = 'javascript:false';\n          } else if (typeof uri == 'string') {\n            $io[0].src = uri;\n          }\n        }\n\n        $io.css({\n          position: 'absolute',\n          top: -1000,\n          left: -1000\n        }).appendTo('body');\n        return $io;\n      },\n      createUploadForm: function createUploadForm(id, fileElementId) {\n        //create form\n        var formId = 'jUploadForm' + id,\n            fileId = 'jUploadFile' + id,\n            csrfId = 'jUploadCSRF' + id;\n        var $form = $('<form  action=\"\" method=\"POST\" name=\"' + formId + '\" id=\"' + formId + '\" enctype=\"multipart/form-data\"></form>');\n        var $oldFile = $('#' + fileElementId),\n            $newFile = $oldFile.clone(true);\n        $oldFile.attr('id', fileId).before($newFile).appendTo($form); // CSRF \n\n        var $inputHidden = $('#' + csrfId);\n\n        if (!$inputHidden.length) {\n          $inputHidden = $('<input type=\"hidden\" id=\"' + csrfId + '\" name=\"csrfmiddlewaretoken\">').appendTo($form);\n        }\n\n        $inputHidden.val(getCookie('csrftoken')); // remove the previous form and add new form\n\n        $form.css({\n          position: 'absolute',\n          top: -1000,\n          left: -1000\n        }).appendTo('body');\n        return $form;\n      },\n      ajaxFileUpload: function ajaxFileUpload(s) {\n        // TODO introduce global settings, allowing the client to modify them for all requests, not only timeout\n        s = $.extend({}, $.ajaxSettings, s);\n        var id = new Date().getTime();\n        var frameId = 'jUploadFrame' + id,\n            formId = 'jUploadForm' + id;\n        var $form = $.createUploadForm(id, s.fileElementId);\n        var $io = $.createUploadIframe(id, s.secureuri); // Watch for a new set of requests\n\n        if (s.global && !$.active++) {\n          $.event.trigger(\"ajaxStart\");\n        }\n\n        var requestDone = false,\n            xml = {}; // Create the request object\n\n        if (s.global) $.event.trigger(\"ajaxSend\", [xml, s]); // Wait for a response to come back\n\n        var uploadCallback = function uploadCallback(isTimeout) {\n          var io = document.getElementById(frameId);\n\n          try {\n            if (io.contentWindow) {\n              xml.responseText = io.contentWindow.document.body ? io.contentWindow.document.body.innerHTML : null;\n              xml.responseXML = io.contentWindow.document.XMLDocument ? io.contentWindow.document.XMLDocument : io.contentWindow.document;\n            } else if (io.contentDocument) {\n              xml.responseText = io.contentDocument.document.body ? io.contentDocument.document.body.innerHTML : null;\n              xml.responseXML = io.contentDocument.document.XMLDocument ? io.contentDocument.document.XMLDocument : io.contentDocument.document;\n            }\n          } catch (e) {\n            $.handleError(s, xml, null, e);\n          }\n\n          if (xml || isTimeout == \"timeout\") {\n            requestDone = true;\n            var status;\n\n            try {\n              status = isTimeout != \"timeout\" ? \"success\" : \"error\"; // Make sure that the request was successful or notmodified\n\n              if (status != \"error\") {\n                // process the data (runs the xml through httpData regardless of callback)\n                var data = $.uploadHttpData(xml, s.dataType); // If a local callback was specified, fire it and pass it the data\n\n                if (s.success) s.success(data, status); // Fire the global callback\n\n                if (s.global) $.event.trigger(\"ajaxSuccess\", [xml, s]);\n              } else {\n                $.handleError(s, xml, status);\n              }\n            } catch (e) {\n              status = \"error\";\n              $.handleError(s, xml, status, e);\n            } // The request was completed\n\n\n            if (s.global) $.event.trigger(\"ajaxComplete\", [xml, s]); // Handle the global AJAX counter\n\n            if (s.global && ! --jQuery.active) $.event.trigger(\"ajaxStop\"); // Process result\n\n            if (s.complete) s.complete(xml, status);\n            $io.off();\n            setTimeout(function () {\n              try {\n                $io.remove();\n                $form.remove();\n              } catch (e) {\n                $.handleError(s, xml, null, e);\n              }\n            }, 100);\n            xml = null;\n          }\n        }; // Timeout checker\n\n\n        if (s.timeout > 0) {\n          setTimeout(function () {\n            // Check to see if the request is still happening\n            if (!requestDone) uploadCallback(\"timeout\");\n          }, s.timeout);\n        }\n\n        try {\n          var enctype = 'multipart/form-data';\n          $form.attr({\n            action: s.url,\n            method: 'POST',\n            target: frameId,\n            enctype: enctype\n          }).submit();\n        } catch (e) {\n          $.handleError(s, xml, null, e);\n        }\n\n        if (window.attachEvent) {\n          document.getElementById(frameId).attachEvent('onload', uploadCallback);\n        } else {\n          document.getElementById(frameId).addEventListener('load', uploadCallback, false);\n        }\n\n        return {\n          abort: function abort() {}\n        };\n      },\n      uploadHttpData: function uploadHttpData(r, type) {\n        var data = !type || type == \"xml\" ? r.responseXML : r.responseText; // If the type is \"script\", eval it in global context\n\n        if (type == \"script\") $.globalEval(data); // Get the JavaScript object, if JSON is used.\n\n        if (type == \"json\") data = $.parseJSON($(r.responseText).text()); // evaluate scripts within html\n\n        if (type == \"html\") $(\"<div>\").html(data).evalScripts();\n        return data;\n      }\n    };\n  }\n\n  jQuery.extend(plugin);\n\n  if (!jQuery.handleError) {\n    jQuery.extend({\n      handleError: function handleError(s, xhr, status, e) {\n        if (s.error) {\n          s.error.call(s.context || window, xhr, status, e);\n        }\n\n        if (s.global) {\n          (s.context ? $(s.context) : $.event).trigger('ajaxError', [xhr, s, e]);\n        }\n      }\n    });\n  }\n})(window.jQuery);\n\nfunction getCookie(name) {\n  var regex = new RegExp('(^|[ ;])' + name + '\\\\s*=\\\\s*([^\\\\s;]+)');\n  return regex.test(document.cookie) ? unescape(RegExp.$2) : null;\n}","import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React, { Component } from \"react\";\nimport { Display } from \"fancymixin\";\nimport { didClickOn, eitherFancy, getFancyDepsRoot, xmlUtil } from \"fancyutils\"; // 'yy-mm-dd H:i:s';\n\nfunction formatISODate(date) {\n  return date ? removeISOString(date.toISOString()) : \"\";\n}\n\nfunction removeISOString(dateTimeString) {\n  return dateTimeString.replace(/T/, \" \").split(\".\")[0];\n}\n\nfunction handleInput(stateKey, component) {\n  return function InputHandler(event) {\n    var el = event.target;\n    var key = el.type === \"checkbox\" ? \"checked\" : \"value\";\n    component.setState(_defineProperty({}, stateKey, el[key]));\n  };\n}\n\nvar Admin = /*#__PURE__*/function (_Component) {\n  _inherits(Admin, _Component);\n\n  function Admin(props) {\n    var _this;\n\n    _classCallCheck(this, Admin);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Admin).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      showOnHomepage: null,\n      showOnHomepageChecked: null,\n      showInSearch: null,\n      datePublished: null,\n      datePublishedIntermediate: \"\",\n      salesShowInNewest: null,\n      salesExcludeFromPopular: null,\n      salesEditorPicked: null,\n      salesEditorPickedIntermediate: \"\",\n      salesEditorPickedChecked: null,\n      salesVideoFeatured: null,\n      thingVideoUrl: \"\",\n      collapse: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"loading\", false);\n\n    _defineProperty(_assertThisInitialized(_this), \"setThingAdminState\", function (thing) {\n      var datePublished = new Date(thing.date_published) || new Date();\n      var salesEditorPicked = thing.sales && (thing.sales.editor_picked ? new Date(thing.sales.editor_picked) : new Date());\n\n      _this.setState({\n        showOnHomepage: thing.show_on_homepage,\n        showOnHomepageChecked: thing.show_on_homepage == true,\n        datePublished: datePublished,\n        datePublishedIntermediate: formatISODate(datePublished),\n        salesShowInNewest: thing.sales && thing.sales.show_in_newest,\n        showInSearch: thing.show_in_search,\n        salesExcludeFromPopular: thing.exclude_from_popular,\n        salesEditorPicked: salesEditorPicked,\n        salesEditorPickedIntermediate: salesEditorPicked instanceof Date ? formatISODate(salesEditorPicked) : \"\",\n        thingVideoUrl: thing.metadata && thing.metadata.video_url ? thing.metadata.video_url : \"\",\n        salesEditorPickedChecked: (thing.sales && thing.sales.editor_picked) != null,\n        salesVideoFeatured: thing.sales && thing.sales.video && thing.sales.video.featured\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleReassign\", function () {\n      var thing = _this.props.thing;\n      var thing_id = thing.id;\n      var user_id = thing.user.id;\n      var new_thing_id = thing.ntid;\n      var reassign_thing_id = $(_this.reassignInput).val().trim();\n\n      if (!Number.isInteger(Number(reassign_thing_id))) {\n        alert(\"Please enter thing_id\");\n        return false;\n      }\n\n      if (thing_id == reassign_thing_id) {\n        alert(\"Please check thing_id. You can't merge this to itself.\");\n        return false;\n      }\n\n      if (_this.loading) {\n        return false;\n      }\n\n      if (window.confirm(\"sure to delete the current thing and reassign to thing_id: \".concat(reassign_thing_id, \"?\"))) {\n        if (_this.loading) {\n          return false;\n        }\n\n        _this.loading = true;\n        $.post(\"/merge_duplicate_things.xml\", {\n          reassign_thing_id: reassign_thing_id,\n          thing_id: thing_id,\n          new_thing_id: new_thing_id,\n          user_id: user_id\n        }, function (xml) {\n          if (xmlUtil.isSuccess(xml)) {\n            alert(\"done\");\n            location.href = $(xml).find(\"url\").text();\n          } else if (xmlUtil.isFail(xml)) {\n            var msg = $(xml).find(\"message\").text();\n            alert(msg);\n          }\n        }, \"xml\").fail(function () {\n          alert(\"There was an error.\");\n        }).always(function () {\n          _this.loading = false;\n        });\n      }\n\n      return false;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleOwnerChange\", function () {\n      if (_this.loading) {\n        return false;\n      }\n\n      _this.loading = true;\n      var thing = _this.props.thing;\n      var thing_id = thing.id;\n      var old_user_id = thing.user.id;\n      var new_thing_id = thing.ntid;\n      var new_owner_name = $(_this.changeOwnerInput).val().trim();\n\n      if (thing.user.username === new_owner_name) {\n        alert(\"The thing is already owned by the user.\");\n        _this.loading = false;\n        return false;\n      }\n\n      var placeholder_str = $(_this.changeOwnerInput).attr(\"placeholder\").trim();\n\n      if (new_owner_name == placeholder_str || new_owner_name.length === 0) {\n        alert(\"Please enter new username.\");\n        _this.loading = false;\n        return false;\n      }\n\n      if (window.confirm(\"sure to owner of the current thing to username: \".concat(new_owner_name, \"?\"))) {\n        $.ajax({\n          type: \"post\",\n          url: \"/change_new_thing_owner.xml\",\n          data: {\n            new_owner_name: new_owner_name,\n            thing_id: thing_id,\n            new_thing_id: new_thing_id,\n            old_user_id: old_user_id\n          },\n          dataType: \"xml\"\n        }).done(function (xml) {\n          if (xmlUtil.isSuccess(xml)) {\n            alert(\"done\");\n            eitherFancy(\"Shared\", function (_ref) {\n              var reloadCurrentThing = _ref.reloadCurrentThing;\n              reloadCurrentThing();\n            });\n          } else if (xmlUtil.isFail(xml)) {\n            alert($(xml).find(\"message\").text());\n          }\n        }).fail(function () {\n          alert(\"There was an error.\");\n        }).always(function () {\n          _this.loading = false;\n        });\n      } else {\n        _this.loading = false;\n      }\n\n      return false;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleFeaturedVideo\", function (event) {\n      if (_this.loading) {\n        return false;\n      }\n\n      _this.loading = true;\n      var salesVideoFeatured = event.target.checked;\n\n      _this.setState({\n        salesVideoFeatured: salesVideoFeatured\n      }, function () {\n        var thing = _this.props.thing;\n        var thing_id = thing.id;\n        var user_id = thing.user.id;\n        var new_thing_id = thing.ntid;\n        var show_on_homepage = salesVideoFeatured;\n        $.post(\"/set_show_video_on_homepage.xml\", {\n          thing_id: thing_id,\n          new_thing_id: new_thing_id,\n          user_id: user_id,\n          show_on_homepage: show_on_homepage\n        }, function (xml) {\n          if (xmlUtil.isSuccess(xml)) {\n            alert(\"Video Setting saved\");\n            eitherFancy(\"Shared\", function (_ref2) {\n              var cache = _ref2.cache;\n              return cache.update(thing_id, undefined, \"show_on_homepage\", show_on_homepage);\n            });\n          } else if (xmlUtil.isFail(xml)) {\n            alert($(xml).find(\"message\").text());\n          }\n        }, \"xml\").fail(function () {\n          alert(\"There was an error.\");\n        }).always(function () {\n          _this.loading = false;\n        });\n        return false;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handlePublishedDateChange\", function (nextState) {\n      if (_this.loading) {\n        return false;\n      }\n\n      _this.loading = true;\n      var thing = _this.props.thing;\n      var datePublishedIntermediate = _this.state.datePublishedIntermediate;\n      var showOnHomepageChecked = nextState && nextState.showOnHomepageChecked;\n\n      if (showOnHomepageChecked == null) {\n        showOnHomepageChecked = _this.state.showOnHomepageChecked;\n      }\n\n      var date_published;\n\n      if (showOnHomepageChecked) {\n        var inputDate = new Date(datePublishedIntermediate);\n\n        if (Number.isNaN(inputDate)) {\n          alert(\"illformatted date - please put ISO date (i.e. 2020-01-01 10:10:10)\");\n          return false;\n        }\n\n        inputDate = new Date(inputDate.getTime() - inputDate.getTimezoneOffset() * 60000); // utc date\n\n        inputDate = new Date(inputDate.getTime() - inputDate.getTimezoneOffset() * 60000); // apply timezone offset\n\n        date_published = formatISODate(inputDate);\n      }\n\n      var show_on_homepage = showOnHomepageChecked ? 1 : 0;\n      var thing_id = thing.id;\n      var user_id = thing.user.id;\n      var new_thing_id = thing.ntid;\n      var payload = {\n        new_thing_id: new_thing_id,\n        thing_id: thing_id,\n        show_on_homepage: show_on_homepage,\n        user_id: user_id\n      };\n\n      if (date_published) {\n        payload.date_published = date_published;\n      }\n\n      $.post(\"/set_show_on_homepage.xml\", payload, function (xml) {\n        if (xmlUtil.isSuccess(xml)) {\n          alert(\"publish option set\");\n        } else if (xmlUtil.isFail(xml)) {\n          alert($(xml).find(\"message\").text());\n        }\n      }, \"xml\").fail(function () {\n        alert(\"There was an error.\");\n      }).always(function () {\n        _this.loading = false;\n      });\n      return false;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleShowNewest\", function (event) {\n      if (_this.loading) {\n        return false;\n      }\n\n      _this.loading = true;\n      var salesShowInNewest = event.target.checked;\n\n      _this.setState({\n        salesShowInNewest: salesShowInNewest\n      }, function () {\n        var thing = _this.props.thing;\n        var salesShowInNewest = _this.state.salesShowInNewest;\n        var sale_item_id = thing.sales && thing.sales.id;\n        $.post(\"/set_show_in_newest.xml\", {\n          sale_item_id: sale_item_id,\n          show_in_newest: salesShowInNewest ? \"true\" : \"false\"\n        }, function (xml) {\n          if (xmlUtil.isSuccess(xml)) {\n            alert(\"show in newest set\");\n          } else if (xmlUtil.isFail(xml)) {\n            alert($(xml).find(\"message\").text());\n          }\n        }, \"xml\").fail(function () {\n          alert(\"There was an error.\");\n        }).always(function () {\n          _this.loading = false;\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleShowInSearch\", function (event) {\n      if (_this.loading) {\n        return false;\n      }\n\n      _this.loading = true;\n      var showInSearch = event.target.checked;\n\n      _this.setState({\n        showInSearch: showInSearch\n      }, function () {\n        var thing = _this.props.thing;\n        var showInSearch = _this.state.showInSearch;\n        var thing_id = thing.id;\n        $.post(\"/set_show_in_search.json\", {\n          thing_id: thing_id,\n          show_in_search: showInSearch ? \"true\" : \"false\"\n        }, function (json) {\n          if (json.success) {\n            alert(\"show_in_search set\");\n          }\n        }, \"json\").fail(function () {\n          alert(\"There was an error.\");\n        }).always(function () {\n          _this.loading = false;\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleExcludePopular\", function (event) {\n      if (_this.loading) {\n        return false;\n      }\n\n      _this.loading = true;\n      var salesExcludeFromPopular = event.target.checked;\n\n      _this.setState({\n        salesExcludeFromPopular: salesExcludeFromPopular\n      }, function () {\n        var thing = _this.props.thing;\n        var salesExcludeFromPopular = _this.state.salesExcludeFromPopular;\n        var thing_id = thing.id;\n        $.post(\"/set_exclude_from_popular.json\", {\n          thing_id: thing_id,\n          exclude_from_popular: salesExcludeFromPopular ? \"true\" : \"false\"\n        }, function (json) {\n          if (json.success) {\n            alert(\"exclude_from_popular set\");\n          }\n        }, \"json\").fail(function () {\n          alert(\"There was an error.\");\n        }).always(function () {\n          _this.loading = false;\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleEditorPickChange\", function () {\n      if (_this.loading) {\n        return false;\n      }\n\n      _this.loading = true;\n      var thing = _this.props.thing;\n      var _this$state = _this.state,\n          salesEditorPickedIntermediate = _this$state.salesEditorPickedIntermediate,\n          salesEditorPickedChecked = _this$state.salesEditorPickedChecked;\n      var inputDate = new Date(salesEditorPickedIntermediate);\n\n      if (Number.isNaN(inputDate)) {\n        alert(\"illformatted date - please put ISO date (i.e. 2016-03-11 02:48:44)\");\n        return false;\n      }\n\n      inputDate = new Date(inputDate.getTime() - inputDate.getTimezoneOffset() * 60000);\n      var thing_id = thing.id;\n      var user_id = thing.user.id;\n      var new_thing_id = thing.ntid;\n      var editor_picked = salesEditorPickedChecked ? formatISODate(inputDate) : \"\";\n      $.post(\"/set_editor_picked.xml\", {\n        editor_picked: editor_picked,\n        thing_id: thing_id,\n        new_thing_id: new_thing_id,\n        user_id: user_id\n      }, function (xml) {\n        if (xmlUtil.isSuccess(xml)) {\n          alert(\"editors picked set\");\n        } else if (xmlUtil.isFail(xml)) {\n          alert($(xml).find(\"message\").text());\n        }\n      }, \"xml\").fail(function () {\n        alert(\"There was an error.\");\n      }).always(function () {\n        _this.loading = false;\n      });\n      return false;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleThingVideoUrl\", function () {\n      if (_this.loading) {\n        return false;\n      }\n\n      _this.loading = true;\n      var thing = _this.props.thing;\n      var thingVideoUrl = _this.state.thingVideoUrl;\n      var thing_id = thing.id;\n      var user_id = thing.user.id;\n      $.post(\"/set_thing_video_url.xml\", {\n        thing_id: thing_id,\n        user_id: user_id,\n        video_url: thingVideoUrl\n      }, function (xml) {\n        if (xmlUtil.isSuccess(xml)) {\n          alert(\"video url set\");\n        } else if (xmlUtil.isFail(xml)) {\n          alert($(xml).find(\"message\").text());\n        }\n      }, \"xml\").fail(function () {\n        alert(\"There was an error.\");\n      }).always(function () {\n        _this.loading = false;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCollapseClick\", function () {\n      _this.setState({\n        collapse: !_this.state.collapse\n      });\n    });\n\n    _this.changeOwnerInputRef = function (element) {\n      _this.changeOwnerInput = element;\n    };\n\n    _this.reassignInputRef = function (element) {\n      _this.reassignInput = element;\n    };\n\n    return _this;\n  }\n\n  _createClass(Admin, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var thing = this.props.thing;\n\n      if (prevProps.appContext.lastFullyRenderedThingID !== this.props.appContext.lastFullyRenderedThingID && thing.fromServer) {\n        this.setThingAdminState(thing);\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var adminForm = $(\".admin-user-frm\");\n\n      if (adminForm.length > 0) {\n        adminForm.draggable({\n          handle: \".stit\"\n        });\n      }\n\n      var thing = this.props.thing;\n\n      if (thing.fromServer) {\n        this.setThingAdminState(thing);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          viewer = _this$props.appContext.viewer,\n          thing = _this$props.thing,\n          sales = _this$props.thing.sales;\n      var _this$state2 = this.state,\n          datePublishedIntermediate = _this$state2.datePublishedIntermediate,\n          showOnHomepageChecked = _this$state2.showOnHomepageChecked,\n          salesShowInNewest = _this$state2.salesShowInNewest,\n          showInSearch = _this$state2.showInSearch,\n          salesExcludeFromPopular = _this$state2.salesExcludeFromPopular,\n          salesEditorPickedChecked = _this$state2.salesEditorPickedChecked,\n          salesEditorPickedIntermediate = _this$state2.salesEditorPickedIntermediate,\n          salesVideoFeatured = _this$state2.salesVideoFeatured,\n          thingVideoUrl = _this$state2.thingVideoUrl,\n          collapse = _this$state2.collapse;\n      var canSeeOrder = sales && !thing.is_fancybox && !thing.is_vanity_number_thing;\n      var canSeeCart = viewer.is_admin_senior && !viewer.is_admin_manager;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"wrapper admin-user-frm \".concat(collapse ? \"show\" : \"\")\n      }, /*#__PURE__*/React.createElement(\"h3\", {\n        className: \"stit\"\n      }, \"Admin\"), /*#__PURE__*/React.createElement(\"a\", {\n        onClick: this.handleCollapseClick,\n        className: \"collapse\"\n      }), /*#__PURE__*/React.createElement(\"form\", null, /*#__PURE__*/React.createElement(\"ul\", null, canSeeOrder && /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"a\", {\n        href: \"/admin/view-sale-orders-by-thing-id?thing_id=\".concat(thing.id)\n      }, \"View Orders\")), canSeeOrder && canSeeCart && /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"a\", {\n        href: \"/admin/view-users-by-cart-item?sale_id=\".concat(sales.id)\n      }, \"View Carts\")), /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(\"a\", {\n        href: \"/view-edit-new-thing?ntid=\".concat(thing.ntid, \"&ooid=\").concat(thing.user && thing.user.id)\n      }, \"Edit Directory Entries\")), /*#__PURE__*/React.createElement(\"li\", null, \"Fancy'd: \", thing.fancyd_count))), /*#__PURE__*/React.createElement(\"dl\", null, /*#__PURE__*/React.createElement(\"dt\", null, \"Change owner\"), /*#__PURE__*/React.createElement(\"dd\", {\n        className: \"change-owner\"\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"text full\",\n        ref: this.changeOwnerInputRef,\n        placeholder: \"Enter new username\"\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btns-blue-embo btn-owner\",\n        onClick: this.handleOwnerChange\n      }, \"Submit\"))), /*#__PURE__*/React.createElement(\"dl\", {\n        className: \"show-on-homepage\"\n      }, /*#__PURE__*/React.createElement(\"dt\", null, \"Show on homepage\"), /*#__PURE__*/React.createElement(\"dd\", {\n        className: \"after\"\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        className: \"left\"\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        id: \"homepage_y\",\n        name: \"homepage\",\n        checked: showOnHomepageChecked,\n        onChange: function onChange(e) {\n          handleInput(\"showOnHomepageChecked\", _this2)(e);\n\n          if (!e.target.checked) {\n            _this2.handlePublishedDateChange({\n              showOnHomepageChecked: false\n            });\n          }\n        }\n      }), /*#__PURE__*/React.createElement(\"label\", {\n        htmlFor: \"homepage_y\"\n      }, \"Show\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"left\"\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        id: \"time_date_published\",\n        className: \"text\",\n        value: datePublishedIntermediate,\n        onChange: handleInput(\"datePublishedIntermediate\", this),\n        style: Display.NoneIf(!showOnHomepageChecked)\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btns-blue-embo btn-date-published\",\n        onClick: this.handlePublishedDateChange\n      }, \"Submit\")))), /*#__PURE__*/React.createElement(\"form\", null, /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"showon\"\n      }, /*#__PURE__*/React.createElement(\"li\", {\n        className: \"exclude_pop\",\n        key: \"exclude_pop\"\n      }, /*#__PURE__*/React.createElement(\"label\", null, \"Exclude from Popular\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        id: \"exclude_from_pop\",\n        name: \"exclude_from_pop\",\n        checked: salesExcludeFromPopular,\n        onChange: this.handleExcludePopular\n      })), /*#__PURE__*/React.createElement(\"li\", {\n        className: \"show_in_search\",\n        key: \"show_in_search\"\n      }, /*#__PURE__*/React.createElement(\"label\", null, \"Show in Search\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        id: \"show_in_search\",\n        name: \"show_in_search\",\n        checked: showInSearch,\n        onChange: this.handleShowInSearch\n      })), sales && sales.video && sales.video.is_ready && /*#__PURE__*/React.createElement(\"li\", {\n        className: \"after\",\n        id: \"homepage_video\"\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        id: \"homepage_video_y\",\n        name: \"homepage_video\",\n        checked: salesVideoFeatured,\n        onChange: this.handleFeaturedVideo\n      }), /*#__PURE__*/React.createElement(\"label\", {\n        htmlFor: \"homepage_video_y\"\n      }, \"Show video on Timeline\")), sales && [/*#__PURE__*/React.createElement(\"li\", {\n        className: \"feature_item_on\",\n        key: \"feature_item_on\"\n      }, /*#__PURE__*/React.createElement(\"label\", null, \"Show on Editor's Picks\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        id: \"feature_item_epick\",\n        name: \"feature_item\",\n        checked: salesEditorPickedChecked,\n        onChange: handleInput(\"salesEditorPickedChecked\", this)\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"time-date-epicks\",\n        style: Display.NoneIf(!salesEditorPickedChecked)\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        id: \"time_date_epicks\",\n        className: \"text\",\n        value: salesEditorPickedIntermediate,\n        onChange: handleInput(\"salesEditorPickedIntermediate\", this)\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btns-blue-embo time_date_epicks\",\n        onClick: this.handleEditorPickChange\n      }, \"Submit\"))), /*#__PURE__*/React.createElement(\"li\", {\n        className: \"show_newest\",\n        key: \"show_newest\"\n      }, /*#__PURE__*/React.createElement(\"label\", null, \"Show on Newest\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        id: \"show_in_newest\",\n        name: \"show_in_newest\",\n        checked: salesShowInNewest,\n        onChange: this.handleShowNewest\n      }))])), /*#__PURE__*/React.createElement(\"dl\", {\n        className: \"reassign\"\n      }, /*#__PURE__*/React.createElement(\"dt\", null, \"Reassign\"), /*#__PURE__*/React.createElement(\"dd\", null, /*#__PURE__*/React.createElement(\"input\", {\n        ref: this.reassignInputRef,\n        type: \"text\",\n        className: \"text full\",\n        placeholder: \"Enter Thing_ID\"\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btns-blue-embo btn-reassign\",\n        onClick: this.handleReassign\n      }, \"Submit\"))), /*#__PURE__*/React.createElement(\"dl\", {\n        className: \"videourl\"\n      }, /*#__PURE__*/React.createElement(\"dt\", null, \"Video URL Override\"), /*#__PURE__*/React.createElement(\"dd\", null, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        className: \"text full\",\n        placeholder: \"Enter mp4 URL\",\n        value: thingVideoUrl,\n        onChange: handleInput(\"thingVideoUrl\", this)\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btns-blue-embo btn-videourl\",\n        onClick: this.handleThingVideoUrl\n      }, \"Submit\"))));\n    }\n  }]);\n\n  return Admin;\n}(Component);\n\nexport { Admin as default };\nvar sharedState = {\n  /* mutable */\n  draggingAdmin: false\n};\n$(document).ready(function () {\n  $(document.body).on(\"mousedown\", \"#overlay-thing .popup.overlay-thing\", function (event) {\n    var clickedOn = didClickOn($(event.target), \".thing-detail-container .admin-user-frm\");\n    sharedState.draggingAdmin = clickedOn;\n  });\n});\ngetFancyDepsRoot().Admin = {\n  sharedState: sharedState\n};","import React from 'react';\n\nvar AdminSimple = function AdminSimple(_ref) {\n  var thing = _ref.thing;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"wrapper admin-user-frm\"\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"stit\"\n  }, \"Admin\"), /*#__PURE__*/React.createElement(\"dl\", null, /*#__PURE__*/React.createElement(\"dt\", null, \"Date published\"), /*#__PURE__*/React.createElement(\"dd\", null, /*#__PURE__*/React.createElement(\"label\", null, thing.date_published))));\n};\n\nexport default AdminSimple;"],"mappings":";;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7PA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;;;;;;;;;;;;;;;;;AC1pBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A;;A","sourceRoot":""}