{"version":3,"sources":["webpack://fancy/./_static/_ui/js/ajaxfileupload.js"],"names":["$","xhr","plugin","window","XMLHttpRequest","upload","FileReader","FormData","ajaxFileUpload","s","reader","$file","file","xml","extend","ajaxSettings","fileElementId","files","onload","event","data","append","getCookie","attr","settings","url","type","async","cache","processData","contentType","success","noop","error","complete","onprogress","percent","pos","loaded","position","total","lengthComputable","Math","ceil","progress","dataType","ajax","onerror","readAsArrayBuffer","createUploadIframe","id","uri","frameId","$io","ActiveXObject","src","css","top","left","appendTo","createUploadForm","formId","fileId","csrfId","$form","$oldFile","$newFile","clone","before","$inputHidden","length","val","Date","getTime","secureuri","global","active","trigger","requestDone","uploadCallback","isTimeout","io","document","getElementById","contentWindow","responseText","body","innerHTML","responseXML","XMLDocument","contentDocument","e","handleError","status","uploadHttpData","jQuery","off","setTimeout","remove","timeout","enctype","action","method","target","submit","attachEvent","addEventListener","abort","r","globalEval","parseJSON","text","html","evalScripts","call","context","name","regex","RegExp","test","cookie","unescape","$2"],"mappings":"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","file":"OverlayThing.admin.db09eb762af8c32c5be5.js","sourcesContent":["// Support HTML5 file upload by taegon kim\n\n;(function($){\n\nvar xhr, plugin;\n\nif (window.XMLHttpRequest) xhr = new window.XMLHttpRequest();\nif (xhr && ('upload' in xhr) && ('onprogress' in xhr.upload) && window.FileReader && window.FormData) {\n\t// yeap! this browser supports HTML5 ajax file upload!\n\tplugin = {\n\t\tajaxFileUpload : function(s) {\n\t\t\tvar xhr = new window.XMLHttpRequest(), reader = new FileReader(), $file, file, xml={};\n\n\t\t\t// import global settings\n\t\t\ts = $.extend({}, $.ajaxSettings, s);\n\n\t\t\t// get a file object\n\t\t\t$file = $('#' + s.fileElementId);\n\t\t\tfile  = $file[0].files[0];\n\n\t\t\treader.onload = function(event){\n\t\t\t\tvar data = new FormData();\n\n\t\t\t\tdata.append('csrfmiddlewaretoken', getCookie('csrftoken'));\n\t\t\t\tdata.append($file.attr('name'), file);\n\n\t\t\t\tvar settings = {\n\t\t\t\t\turl   : s.url,\n\t\t\t\t\ttype  : 'POST',\n\t\t\t\t\tdata  : data,\n\t\t\t\t\tasync : true,\n\t\t\t\t\tcache : false,\n\t\t\t\t\tprocessData : false,\n\t\t\t\t\tcontentType : false,\n\t\t\t\t\tsuccess  : s.success || $.noop,\n\t\t\t\t\terror    : s.error || $.noop,\n\t\t\t\t\tcomplete : s.complete || $.noop,\n\t\t\t\t\txhr : function(){\n\t\t\t\t\t\tvar xhr = $.ajaxSettings.xhr();\n\t\t\t\t\t\txhr.upload.onprogress = function(event){\n\t\t\t\t\t\t\tvar percent = 0, pos = event.loaded || event.position, total = event.total;\n\t\t\t\t\t\t\tif (event.lengthComputable) {\n\t\t\t\t\t\t\t\tpercent = Math.ceil(pos / total * 100);\n\t\t\t\t\t\t\t\t(s.progress || $.noop)(percent);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn xhr;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tif (s.dataType) settings.dataType = s.dataType;\n\n\t\t\t\t$.ajax(settings);\n\t\t\t};\n\t\t\treader.onerror = function(){\n\t\t\t\tif (s.error) s.error();\n\t\t\t\tif (s.complete) s.complete();\n\t\t\t};\n\t\t\treader.readAsArrayBuffer(file);\n\t\t}\n\t};\n} else {\n\t// for old browser\n\tplugin = {\n\t\tcreateUploadIframe: function(id, uri) {\n\t\t\t//create frame\n\t\t\tvar frameId = 'jUploadFrame' + id, $io;\n\n\t\t\t$io = $('<iframe id=\"' + frameId + '\" name=\"' + frameId + '\" />');\n\n\t\t\tif(window.ActiveXObject) {\n\t\t\t\tif(typeof uri== 'boolean'){\n\t\t\t\t\t$io[0].src = 'javascript:false';\n\t\t\t\t} else if(typeof uri == 'string'){\n\t\t\t\t\t$io[0].src = uri;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t$io.css({position:'absolute',top:-1000,left:-1000}).appendTo('body');\n\n\t\t\treturn $io;\n\t\t},\n\t\tcreateUploadForm: function(id, fileElementId) {\n\t\t\t//create form\n\t\t\tvar formId = 'jUploadForm' + id, fileId = 'jUploadFile' + id, csrfId = 'jUploadCSRF' + id;\n\t\t\tvar $form = $('<form  action=\"\" method=\"POST\" name=\"' + formId + '\" id=\"' + formId + '\" enctype=\"multipart/form-data\"></form>');\n\t\t\tvar $oldFile = $('#' + fileElementId), $newFile = $oldFile.clone(true);\n\n\t\t\t$oldFile.attr('id', fileId).before($newFile).appendTo($form);\n\n\t\t\t// CSRF \n\t\t\tvar $inputHidden = $('#'+csrfId);\n\t\t\tif (!$inputHidden.length) {\n\t\t\t\t$inputHidden = $('<input type=\"hidden\" id=\"'+csrfId+'\" name=\"csrfmiddlewaretoken\">').appendTo($form);\n\t\t\t}\n\t\t\t$inputHidden.val( getCookie('csrftoken') );\n\n\t\t\t// remove the previous form and add new form\n\t\t\t$form.css({position:'absolute',top:-1000,left:-1000}).appendTo('body');\n\n\t\t\treturn $form;\n\t\t},\n\n\t\tajaxFileUpload: function(s) {\n\t\t\t// TODO introduce global settings, allowing the client to modify them for all requests, not only timeout\n\t\t\ts = $.extend({}, $.ajaxSettings, s);\n\n\t\t\tvar id = new Date().getTime();\n\t\t\tvar frameId = 'jUploadFrame' + id, formId = 'jUploadForm' + id;\n\t\t\tvar $form = $.createUploadForm(id, s.fileElementId);\n\t\t\tvar $io = $.createUploadIframe(id, s.secureuri);\n\n\t\t\t// Watch for a new set of requests\n\t\t\tif ( s.global && ! $.active++ ) {\n\t\t\t\t$.event.trigger( \"ajaxStart\" );\n\t\t\t}\n\n\t\t\tvar requestDone = false, xml = {};\n\t\t\t// Create the request object\n\t\t\tif ( s.global ) $.event.trigger(\"ajaxSend\", [xml, s]);\n\n\t\t\t// Wait for a response to come back\n\t\t\tvar uploadCallback = function(isTimeout) {\n\t\t\t\tvar io = document.getElementById(frameId);\n\t\t\t\ttry {\n\t\t\t\t\tif(io.contentWindow) {\n\t\t\t\t\t\t xml.responseText = io.contentWindow.document.body?io.contentWindow.document.body.innerHTML:null;\n\t\t\t\t\t\t xml.responseXML = io.contentWindow.document.XMLDocument?io.contentWindow.document.XMLDocument:io.contentWindow.document;\n\n\t\t\t\t\t} else if(io.contentDocument) {\n\t\t\t\t\t\t xml.responseText = io.contentDocument.document.body?io.contentDocument.document.body.innerHTML:null;\n\t\t\t\t\t\txml.responseXML = io.contentDocument.document.XMLDocument?io.contentDocument.document.XMLDocument:io.contentDocument.document;\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t\t$.handleError(s, xml, null, e);\n\t\t\t\t}\n\n\t\t\t\tif ( xml || isTimeout == \"timeout\")\n\t\t\t\t{\n\t\t\t\t\trequestDone = true;\n\n\t\t\t\t\tvar status;\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tstatus = isTimeout != \"timeout\" ? \"success\" : \"error\";\n\n\t\t\t\t\t\t// Make sure that the request was successful or notmodified\n\t\t\t\t\t\tif ( status != \"error\" ) {\n\t\t\t\t\t\t\t// process the data (runs the xml through httpData regardless of callback)\n\t\t\t\t\t\t\tvar data = $.uploadHttpData( xml, s.dataType );\n\n\t\t\t\t\t\t\t// If a local callback was specified, fire it and pass it the data\n\t\t\t\t\t\t\tif ( s.success ) s.success( data, status );\n\n\t\t\t\t\t\t\t// Fire the global callback\n\t\t\t\t\t\t\tif( s.global ) $.event.trigger( \"ajaxSuccess\", [xml, s] );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$.handleError(s, xml, status);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tstatus = \"error\";\n\t\t\t\t\t\t$.handleError(s, xml, status, e);\n\t\t\t\t\t}\n\n\t\t\t\t\t// The request was completed\n\t\t\t\t\tif( s.global ) $.event.trigger( \"ajaxComplete\", [xml, s] );\n\n\t\t\t\t\t// Handle the global AJAX counter\n\t\t\t\t\tif ( s.global && ! --jQuery.active ) $.event.trigger( \"ajaxStop\" );\n\n\t\t\t\t\t// Process result\n\t\t\t\t\tif ( s.complete ) s.complete(xml, status);\n\n\t\t\t\t\t$io.off();\n\n\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t$io.remove();\n\t\t\t\t\t\t\t$form.remove();\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t$.handleError(s, xml, null, e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 100);\n\n\t\t\t\t\txml = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Timeout checker\n\t\t\tif ( s.timeout > 0 ) {\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t// Check to see if the request is still happening\n\t\t\t\t\tif( !requestDone ) uploadCallback( \"timeout\" );\n\t\t\t\t}, s.timeout);\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tvar enctype = 'multipart/form-data';\n\t\t\t\t$form.attr({action:s.url, method:'POST', target : frameId, enctype : enctype}).submit();\n\t\t\t} catch(e) {\n\t\t\t\t$.handleError(s, xml, null, e);\n\t\t\t}\n\n\t\t\tif (window.attachEvent) {\n\t\t\t\tdocument.getElementById(frameId).attachEvent('onload', uploadCallback);\n\t\t\t} else {\n\t\t\t\tdocument.getElementById(frameId).addEventListener('load', uploadCallback, false);\n\t\t\t}\n\n\t\t\treturn {abort: function () {}};\n\t\t},\n\t\tuploadHttpData: function( r, type ) {\n\t\t\tvar data = (!type || type == \"xml\") ? r.responseXML : r.responseText;\n\n\t\t\t// If the type is \"script\", eval it in global context\n\t\t\tif ( type == \"script\" ) $.globalEval( data );\n\t\t\t// Get the JavaScript object, if JSON is used.\n\t\t\tif ( type == \"json\" ) data = $.parseJSON($(r.responseText).text());\n\t\t\t// evaluate scripts within html\n\t\t\tif ( type == \"html\" ) $(\"<div>\").html(data).evalScripts();\n\n\t\t\treturn data;\n\t\t}\n\t};\n}\n\njQuery.extend(plugin);\n\nif (!jQuery.handleError) {\n\tjQuery.extend({\n\t\thandleError : function(s, xhr, status, e) {\n\t\t\tif (s.error) {\n\t\t\t\ts.error.call(s.context || window, xhr, status, e);\n\t\t\t}\n\n\t\t\tif (s.global) {\n\t\t\t\t(s.context ? $(s.context) : $.event).trigger('ajaxError', [xhr, s, e]);\n\t\t\t}\n\t\t}\n\t});\n}\n\n})(window.jQuery);\n\nfunction getCookie(name) {\n    var regex = new RegExp('(^|[ ;])'+name+'\\\\s*=\\\\s*([^\\\\s;]+)');\n    return regex.test(document.cookie)?unescape(RegExp.$2):null;\n}\n"],"sourceRoot":""}